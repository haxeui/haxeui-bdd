{
"version":3,
"file":"main-html.js",
"sourceRoot":"file:///",
"sources":["C:/Servers/Haxe/haxe/std/js/_std/EReg.hx","C:/Servers/Haxe/haxe/std/js/_std/HxOverrides.hx","C:/Servers/Haxe/haxe/std/IntIterator.hx","C:/Servers/Haxe/haxe/std/Lambda.hx","C:/Servers/Haxe/haxe/std/List.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/Main.hx","C:/Servers/Haxe/haxe/std/js/_std/Reflect.hx","C:/Servers/Haxe/haxe/std/js/_std/Std.hx","C:/Servers/Haxe/haxe/std/StringBuf.hx","C:/Servers/Haxe/haxe/std/StringTools.hx","C:/Servers/Haxe/haxe/std/js/_std/Type.hx","C:/Servers/Haxe/haxe/std/Xml.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/Component.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/Entity.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/HtmlPlatform.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/Value.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/SignalConnection.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/SignalBase.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/Signal2.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/Signal1.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/animation/AnimatedFloat.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/System.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/Logger.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/PackageLog.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/SpeedAdjuster.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/ComponentBuilder.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/asset/AssetEntry.hx","C:/Servers/Haxe/haxe/std/js/Browser.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/asset/Manifest.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/math/Point.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/display/Sprite.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/display/FillSprite.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/display/Font.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/display/ImageSprite.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/display/TextSprite.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/input/KeyboardEvent.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/input/MouseEvent.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/input/PointerEvent.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/input/TouchPoint.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/math/FMath.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/math/Matrix.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/math/Rectangle.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/BasicAsset.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/BasicAssetPackLoader.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/BasicFile.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/BasicKeyboard.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/BasicMouse.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/BasicPointer.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/BasicTexture.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/BasicTouch.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/CatapultClient.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/DebugLogic.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/DummySound.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/DummyTouch.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/EventGroup.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/KeyCodes.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/MainLoop.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/MathUtil.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/MouseCodes.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/OverdrawGraphics.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/CanvasGraphics.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/CanvasRenderer.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/CanvasTexture.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/CanvasTextureRoot.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/HtmlAssetPackLoader.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/HtmlCatapultClient.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/HtmlLogHandler.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/HtmlMouse.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/HtmlSound.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/HtmlStage.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/HtmlUtil.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/WebAudioSound.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/WebGLBatcher.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/WebGLGraphics.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/WebGLRenderer.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/WebGLTexture.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/html/WebGLTextureRoot.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/shader/ShaderGL.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/shader/DrawPatternGL.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/shader/DrawTextureGL.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/shader/FillRectGL.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/scene/Director.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/scene/Transition.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/Assert.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/BitSets.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/Promise.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/Signal0.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/util/Strings.hx","C:/Servers/Haxe/haxe/std/haxe/CallStack.hx","C:/Servers/Haxe/haxe/std/haxe/Int64.hx","C:/Servers/Haxe/haxe/std/haxe/Log.hx","C:/Servers/Haxe/haxe/std/haxe/Resource.hx","C:/Servers/Haxe/haxe/std/haxe/Serializer.hx","C:/Servers/Haxe/haxe/std/haxe/Timer.hx","C:/Servers/Haxe/haxe/std/haxe/Unserializer.hx","C:/Servers/Haxe/haxe/std/js/_std/haxe/io/Bytes.hx","C:/Servers/Haxe/haxe/std/haxe/crypto/Base64.hx","C:/Servers/Haxe/haxe/std/haxe/crypto/BaseCode.hx","C:/Servers/Haxe/haxe/std/haxe/ds/GenericStack.hx","C:/Servers/Haxe/haxe/std/js/_std/haxe/ds/IntMap.hx","C:/Servers/Haxe/haxe/std/js/_std/haxe/ds/ObjectMap.hx","C:/Servers/Haxe/haxe/std/js/_std/haxe/ds/StringMap.hx","C:/Servers/Haxe/haxe/std/haxe/io/BytesBuffer.hx","C:/Servers/Haxe/haxe/std/haxe/io/Input.hx","C:/Servers/Haxe/haxe/std/haxe/io/BytesInput.hx","C:/Servers/Haxe/haxe/std/haxe/io/BytesOutput.hx","C:/Servers/Haxe/haxe/std/haxe/io/Eof.hx","C:/Servers/Haxe/haxe/std/haxe/io/FPHelper.hx","C:/Servers/Haxe/haxe/std/haxe/io/StringInput.hx","C:/Servers/Haxe/haxe/std/haxe/rtti/Meta.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/AppBase.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/HaxeUIApp.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/Properties.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/GenericConfig.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/styles/Engine.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/Toolkit.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/AssetsBase.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/ToolkitAssets.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/animation/Animation.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/animation/AnimationComponentRef.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/animation/AnimationKeyFrame.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/animation/AnimationManager.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/assets/AssetPlugin.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/ComponentBase.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/ImageDisplayBase.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/ScreenBase.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/flambe/TextSpriteEx.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/TextDisplayBase.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/TextInputBase.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/TimerBase.hx","Z:/HaxeUI2/backends/haxeui-flambe/haxe/ui/backend/flambe/StyleHelper.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/Component.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/core/Component.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/InteractiveComponent.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/core/InteractiveComponent.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/Button.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/Button.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/Behaviour.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/layouts/Layout.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/layouts/DefaultLayout.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/CheckBox.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/CheckBox.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/CheckBoxValue.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/Progress.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/Progress.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/HProgress.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/HProgress.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/Scroll.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/Scroll.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/HScroll.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/HScroll.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/Slider.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/Slider.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/HSlider.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/HSlider.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/Image.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/Image.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/Label.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/Label.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/OptionBox.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/OptionBox.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/OptionBoxValue.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/TabBar.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/TabBar.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/layouts/HorizontalLayout.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/TextField.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/TextField.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/VProgress.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/VProgress.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/VScroll.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/VScroll.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/components/VSlider.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/components/VSlider.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/containers/Box.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/containers/Box.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/containers/HBox.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/containers/HBox.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/containers/dialogs/Dialog.hx","Z:/HaxeUI2/tools/haxeui-bdd/container-src/src/haxe/ui/containers/dialogs/Dialog.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/containers/dialogs/DialogButton.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/containers/dialogs/DialogOptions.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/ComponentClassMap.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/ImageDisplay.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/UIEvent.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/KeyboardEvent.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/MouseEvent.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/Screen.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/TextDisplay.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/core/TextInput.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/focus/FocusManager.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/layouts/VerticalLayout.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/layouts/DelegateLayout.hx","Z:/HaxeUI2/tools/haxeui-remoting/haxe/ui/remoting/client/Client.hx","Z:/HaxeUI2/tools/haxeui-remoting/haxe/ui/remoting/client/ClientSocket.hx","Z:/HaxeUI2/tools/haxeui-remoting/haxe/ui/remoting/client/calls/Call.hx","Z:/HaxeUI2/tools/haxeui-remoting/haxe/ui/remoting/client/calls/CreateComponent.hx","Z:/HaxeUI2/tools/haxeui-remoting/haxe/ui/remoting/client/calls/HighlightComponent.hx","Z:/HaxeUI2/tools/haxeui-remoting/haxe/ui/remoting/client/calls/ListComponents.hx","Z:/HaxeUI2/tools/haxeui-remoting/haxe/ui/remoting/client/calls/RemoveAllChildComponents.hx","Z:/HaxeUI2/tools/haxeui-remoting/haxe/ui/remoting/client/impl/JavaScriptSocket.hx","C:/Servers/Haxe/haxe/lib/hscript/2,0,7/hscript/Interp.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/scripting/ScriptInterp.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/styles/Defs.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/styles/Parser.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/styles/Style.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/themes/Theme.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/themes/ThemeManager.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/CallStackHelper.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/CallbackMap.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/ColorUtil.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/EventMap.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/FunctionArray.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/GUID.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/Rectangle.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/Size.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/Slice9.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/StringUtil.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/Timer.hx","Z:/HaxeUI2/haxeui-core/haxe/ui/util/Variant.hx","C:/Servers/Haxe/haxe/lib/hscript/2,0,7/hscript/Parser.hx","C:/Servers/Haxe/haxe/std/js/Boot.hx","C:/Servers/Haxe/haxe/std/js/html/CanvasElement.hx","C:/Servers/Haxe/haxe/std/js/html/compat/ArrayBuffer.hx","C:/Servers/Haxe/haxe/std/js/html/compat/DataView.hx","C:/Servers/Haxe/haxe/std/js/html/compat/Uint8Array.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/actuators/GenericActuator.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/actuators/SimpleActuator.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/easing/Expo.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/Actuate.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/actuators/MethodActuator.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/actuators/MotionPathActuator.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/actuators/PropertyDetails.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/easing/Back.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/easing/Bounce.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/easing/Cubic.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/easing/Linear.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/easing/Quad.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/easing/Quart.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/easing/Quint.hx","C:/Servers/Haxe/haxe/lib/actuate/1,8,7/motion/easing/Sine.hx","C:/Servers/Haxe/haxe/std/js/_std/Math.hx","C:/Servers/Haxe/haxe/lib/flambe/4,1,0/flambe/platform/ManifestBuilder.hx"],
"sourcesContent":["/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class EReg {\n\n\tvar r : HaxeRegExp;\n\n\tpublic function new( r : String, opt : String ) : Void {\n\t\topt = opt.split(\"u\").join(\"\"); // 'u' (utf8) depends on page encoding\n\t\tthis.r = new HaxeRegExp(r, opt);\n\t}\n\n\tpublic function match( s : String ) : Bool {\n\t\tif( r.global ) r.lastIndex = 0;\n\t\tr.m = r.exec(s);\n\t\tr.s = s;\n\t\treturn (r.m != null);\n\t}\n\n\tpublic function matched( n : Int ) : String {\n\t\treturn if( r.m != null && n >= 0 && n < r.m.length ) r.m[n] else throw \"EReg::matched\";\n\t}\n\n\tpublic function matchedLeft() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn r.s.substr(0,r.m.index);\n\t}\n\n\tpublic function matchedRight() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\tvar sz = r.m.index+r.m[0].length;\n\t\treturn r.s.substr(sz,r.s.length-sz);\n\t}\n\n\tpublic function matchedPos() : { pos : Int, len : Int } {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn { pos : r.m.index, len : r.m[0].length };\n\t}\n\n\tpublic function matchSub( s : String, pos : Int, len : Int = -1):Bool {\n\t\treturn if (r.global) {\n\t\t\tr.lastIndex = pos;\n\t\t\tr.m = r.exec(len < 0 ? s : s.substr(0, pos + len));\n\t\t\tvar b = r.m != null;\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t}\n\t\t\tb;\n\t\t} else {\n\t\t\t// TODO: check some ^/$ related corner cases\n\t\t\tvar b = match( len < 0 ? s.substr(pos) : s.substr(pos,len) );\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t\tr.m.index += pos;\n\t\t\t}\n\t\t\tb;\n\t\t}\n\t}\n\n\tpublic function split( s : String ) : Array<String> {\n\t\t// we can't use directly s.split because it's ignoring the 'g' flag\n\t\tvar d = \"#__delim__#\";\n\t\treturn untyped s.replace(r,d).split(d);\n\t}\n\n\tpublic function replace( s : String, by : String ) : String {\n\t\treturn untyped s.replace(r,by);\n\t}\n\n\tpublic function map( s : String, f : EReg -> String ) : String {\n\t\tvar offset = 0;\n\t\tvar buf = new StringBuf();\n\t\tdo {\n\t\t\tif (offset >= s.length)\n\t\t\t\tbreak;\n\t\t\telse if (!matchSub(s, offset)) {\n\t\t\t\tbuf.add(s.substr(offset));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar p = matchedPos();\n\t\t\tbuf.add(s.substr(offset, p.pos - offset));\n\t\t\tbuf.add(f(this));\n\t\t\tif (p.len == 0) {\n\t\t\t\tbuf.add(s.substr(p.pos, 1));\n\t\t\t\toffset = p.pos + 1;\n\t\t\t}\n\t\t\telse\n\t\t\t\toffset = p.pos + p.len;\n\t\t} while (r.global);\n\t\tif (!r.global && offset > 0 && offset < s.length)\n\t\t\tbuf.add(s.substr(offset));\n\t\treturn buf.toString();\n\t}\n}\n\n@:native(\"RegExp\")\nprivate extern class HaxeRegExp extends js.RegExp {\n\tvar m:js.RegExp.RegExpMatch;\n\tvar s:String;\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:noDoc\nclass HxOverrides {\n\n\tstatic function dateStr( date :Date ) : String {\n\t\tvar m = date.getMonth() + 1;\n\t\tvar d = date.getDate();\n\t\tvar h = date.getHours();\n\t\tvar mi = date.getMinutes();\n\t\tvar s = date.getSeconds();\n\t\treturn date.getFullYear()\n\t\t\t+\"-\"+(if( m < 10 ) \"0\"+m else \"\"+m)\n\t\t\t+\"-\"+(if( d < 10 ) \"0\"+d else \"\"+d)\n\t\t\t+\" \"+(if( h < 10 ) \"0\"+h else \"\"+h)\n\t\t\t+\":\"+(if( mi < 10 ) \"0\"+mi else \"\"+mi)\n\t\t\t+\":\"+(if( s < 10 ) \"0\"+s else \"\"+s);\n\t}\n\n\tstatic function strDate( s : String ) : Date {\n\t\tswitch( s.length ) {\n\t\tcase 8: // hh:mm:ss\n\t\t\tvar k = s.split(\":\");\n\t\t\tvar d : Date = untyped __new__(Date);\n\t\t\tuntyped d[\"setTime\"](0);\n\t\t\tuntyped d[\"setUTCHours\"](k[0]);\n\t\t\tuntyped d[\"setUTCMinutes\"](k[1]);\n\t\t\tuntyped d[\"setUTCSeconds\"](k[2]);\n\t\t\treturn d;\n\t\tcase 10: // YYYY-MM-DD\n\t\t\tvar k = s.split(\"-\");\n\t\t\treturn new Date(cast k[0],cast untyped k[1] - 1,cast k[2],0,0,0);\n\t\tcase 19: // YYYY-MM-DD hh:mm:ss\n\t\t\tvar k = s.split(\" \");\n\t\t\tvar y = k[0].split(\"-\");\n\t\t\tvar t = k[1].split(\":\");\n\t\t\treturn new Date(cast y[0],cast untyped y[1] - 1,cast y[2],cast t[0],cast t[1],cast t[2]);\n\t\tdefault:\n\t\t\tthrow \"Invalid date format : \" + s;\n\t\t}\n\t}\n\n\tstatic function cca( s : String, index : Int ) : Null<Int> {\n\t\tvar x = (cast s).charCodeAt(index);\n\t\tif( x != x ) // fast isNaN\n\t\t\treturn untyped undefined; // isNaN will still return true\n\t\treturn x;\n\t}\n\n\tstatic function substr( s : String, pos : Int, ?len : Int ) : String {\n\t\tif( pos != null && pos != 0 && len != null && len < 0 ) return \"\";\n\t\tif( len == null ) len = s.length;\n\t\tif( pos < 0 ){\n\t\t\tpos = s.length + pos;\n\t\t\tif( pos < 0 ) pos = 0;\n\t\t}else if( len < 0 ){\n\t\t\tlen = s.length + len - pos;\n\t\t}\n\n\t\treturn (untyped s).substr(pos, len);\n\t}\n\n\tstatic function indexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i < 0) {\n\t\t\ti += len;\n\t\t\tif (i < 0) i = 0;\n\t\t}\n\t\twhile (i < len)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function lastIndexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i >= len)\n\t\t\ti = len - 1;\n\t\telse if (i < 0)\n\t\t\ti += len;\n\t\twhile (i >= 0)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti--;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function remove<T>( a : Array<T>, obj : T ) {\n\t\tvar i = a.indexOf(obj);\n\t\tif( i == -1 ) return false;\n\t\ta.splice(i,1);\n\t\treturn true;\n\t}\n\n\tstatic function iter<T>( a : Array<T> ) : Iterator<T> untyped {\n\t\treturn {\n\t\t\tcur : 0,\n\t\t\tarr : a,\n\t\t\thasNext : function() {\n\t\t\t\treturn __this__.cur < __this__.arr.length;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\treturn __this__.arr[__this__.cur++];\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic function __init__() untyped {\n#if !js_es5\n\t\t__feature__('HxOverrides.indexOf', if( Array.prototype.indexOf ) __js__(\"HxOverrides\").indexOf = function(a,o,i) return Array.prototype.indexOf.call(a, o, i));\n\t\t__feature__('HxOverrides.lastIndexOf', if( Array.prototype.lastIndexOf ) __js__(\"HxOverrides\").lastIndexOf = function(a,o,i) return Array.prototype.lastIndexOf.call(a, o, i));\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\n /**\n\tIntIterator is used for implementing interval iterations.\n\n\tIt is usually not used explicitly, but through its special syntax:\n\t`min...max`\n\n\tWhile it is possible to assign an instance of IntIterator to a variable or\n\tfield, it is worth noting that IntIterator does not reset after being used\n\tin a for-loop. Subsequent uses of the same instance will then have no\n\teffect.\n**/\nclass IntIterator {\n\n\tvar min : Int;\n\tvar max : Int;\n\n\t/**\n\t\tIterates from `min` (inclusive) to `max` (exclusive).\n\n\t\tIf `max <= min`, the iterator will not act as a countdown.\n\t**/\n\tpublic inline function new( min : Int, max : Int ) {\n\t\tthis.min = min;\n\t\tthis.max = max;\n\t}\n\n\t/**\n\t\tReturns true if the iterator has other items, false otherwise.\n\t**/\n\tpublic inline function hasNext() {\n\t\treturn min < max;\n\t}\n\n\t/**\n\t\tMoves to the next item of the iterator.\n\n\t\tIf this is called while hasNext() is false, the result is unspecified.\n\t**/\n\tpublic inline function next() {\n\t\treturn min++;\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\n/**\n\tThe `Lambda` class is a collection of methods to support functional\n\tprogramming. It is ideally used with 'using Lambda' and then acts as an\n\textension to Iterable types.\n\n\tOn static platforms, working with the Iterable structure might be slower\n\tthan performing the operations directly on known types, such as Array and\n\tList.\n\n\tIf the first argument to any of the methods is null, the result is\n\tunspecified.\n**/\nclass Lambda {\n\n\t/**\n\t\tCreates an Array from Iterable `it`.\n\n\t\tIf `it` is an Array, this function returns a copy of it.\n\t**/\n\tpublic static function array<A>( it : Iterable<A> ) : Array<A> {\n\t\tvar a = new Array<A>();\n\t\tfor(i in it)\n\t\t\ta.push(i);\n\t\treturn a;\n\t}\n\n\t/**\n\t\tCreates a List form Iterable `it`.\n\n\t\tIf `it` is a List, this function returns a copy of it.\n\t**/\n\tpublic static function list<A>( it : Iterable<A> ) : List<A> {\n\t\tvar l = new List<A>();\n\t\tfor(i in it)\n\t\t\tl.add(i);\n\t\treturn l;\n\t}\n\n\t/**\n\t\tCreates a new List by applying function `f` to all elements of `it`.\n\n\t\tThe order of elements is preserved.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function map<A,B>( it : Iterable<A>, f : A -> B ) : List<B> {\n\t\tvar l = new List<B>();\n\t\tfor( x in it )\n\t\t\tl.add(f(x));\n\t\treturn l;\n\t}\n\n\t/**\n\t\tSimilar to map, but also passes the index of each element to `f`.\n\n\t\tThe order of elements is preserved.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function mapi<A,B>( it : Iterable<A>, f : Int -> A -> B ) : List<B> {\n\t\tvar l = new List<B>();\n\t\tvar i = 0;\n\t\tfor( x in it )\n\t\t\tl.add(f(i++,x));\n\t\treturn l;\n\t}\n\n\t/**\n\t\tTells if `it` contains `elt`.\n\n\t\tThis function returns true as soon as an element is found which is equal\n\t\tto `elt` according to the `==` operator.\n\n\t\tIf no such element is found, the result is false.\n\t**/\n\tpublic static function has<A>( it : Iterable<A>, elt : A ) : Bool {\n\t\tfor( x in it )\n\t\t\tif( x == elt )\n\t\t\t\treturn true;\n\t\treturn false;\n\t}\n\n\t/**\n\t\tTells if `it` contains an element for which `f` is true.\n\n\t\tThis function returns true as soon as an element is found for which a\n\t\tcall to `f` returns true.\n\n\t\tIf no such element is found, the result is false.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function exists<A>( it : Iterable<A>, f : A -> Bool ) {\n\t\tfor( x in it )\n\t\t\tif( f(x) )\n\t\t\t\treturn true;\n\t\treturn false;\n\t}\n\n\t/**\n\t\tTells if `f` is true for all elements of `it`.\n\n\t\tThis function returns false as soon as an element is found for which a\n\t\tcall to `f` returns false.\n\n\t\tIf no such element is found, the result is true.\n\n\t\tIn particular, this function always returns true if `it` is empty.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function foreach<A>( it : Iterable<A>, f : A -> Bool ) {\n\t\tfor( x in it )\n\t\t\tif( !f(x) )\n\t\t\t\treturn false;\n\t\treturn true;\n\t}\n\n\t/**\n\t\tCalls `f` on all elements of `it`, in order.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function iter<A>( it : Iterable<A>, f : A -> Void ) {\n\t\tfor( x in it )\n\t\t\tf(x);\n\t}\n\n\t/**\n\t\tReturns a List containing those elements of `it` for which `f` returned\n\t\ttrue.\n\n\t\tIf `it` is empty, the result is the empty List even if `f` is null.\n\n\t\tOtherwise if `f` is null, the result is unspecified.\n\t**/\n\tpublic static function filter<A>( it : Iterable<A>, f : A -> Bool ) {\n\t\tvar l = new List<A>();\n\t\tfor( x in it )\n\t\t\tif( f(x) )\n\t\t\t\tl.add(x);\n\t\treturn l;\n\t}\n\n\t/**\n\t\tFunctional fold on Iterable `it`, using function `f` with start argument\n\t\t`first`.\n\n\t\tIf `it` has no elements, the result is `first`.\n\n\t\tOtherwise the first element of `it` is passed to `f` alongside `first`.\n\t\tThe result of that call is then passed to `f` with the next element of\n\t\t`it`, and so on until `it` has no more elements.\n\n\t\tIf `it` or `f` are null, the result is unspecified.\n\t**/\n\tpublic static function fold<A,B>( it : Iterable<A>, f : A -> B -> B, first : B ) : B {\n\t\tfor( x in it )\n\t\t\tfirst = f(x,first);\n\t\treturn first;\n\t}\n\n\t/**\n\t\tReturns the number of elements in `it` for which `pred` is true, or the\n\t\ttotal number of elements in `it` if `pred` is null.\n\n\t\tThis function traverses all elements.\n\t**/\n\tpublic static function count<A>( it : Iterable<A>, ?pred : A -> Bool ) {\n\t\tvar n = 0;\n\t\tif( pred == null )\n\t\t\tfor( _ in it )\n\t\t\t\tn++;\n\t\telse\n\t\t\tfor( x in it )\n\t\t\t\tif( pred(x) )\n\t\t\t\t\tn++;\n\t\treturn n;\n\t}\n\n\t/**\n\t\tTells if Iterable `it` does not contain any element.\n\t**/\n\tpublic static function empty<T>( it : Iterable<T> ) : Bool {\n\t\treturn !it.iterator().hasNext();\n\t}\n\n\t/**\n\t\tReturns the index of the first element `v` within Iterable `it`.\n\n\t\tThis function uses operator `==` to check for equality.\n\n\t\tIf `v` does not exist in `it`, the result is -1.\n\t**/\n\tpublic static function indexOf<T>( it : Iterable<T>, v : T ) : Int {\n\t\tvar i = 0;\n\t\tfor( v2 in it ) {\n\t\t\tif( v == v2 )\n\t\t\t\treturn i;\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\t/**\n\t\tReturns the first element of `it` for which `f` is true.\n\n\t\tThis function returns as soon as an element is found for which a call to\n\t\t`f` returns true.\n\n\t\tIf no such element is found, the result is null.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function find<T>( it : Iterable<T>, f : T -> Bool ) : Null<T> {\n\t\tfor( v in it ) {\n\t\t\tif(f(v)) return v;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t\tReturns a new List containing all elements of Iterable `a` followed by\n\t\tall elements of Iterable `b`.\n\n\t\tIf `a` or `b` are null, the result is unspecified.\n\t**/\n\tpublic static function concat<T>( a : Iterable<T>, b : Iterable<T> ) : List<T> {\n\t\tvar l = new List();\n\t\tfor( x in a )\n\t\t\tl.add(x);\n\t\tfor( x in b )\n\t\t\tl.add(x);\n\t\treturn l;\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tA linked-list of elements. The list is composed of two-elements arrays\n\tthat are chained together. It is optimized so that adding or removing an\n\telement does not imply copying the whole array content every time.\n**/\nclass List<T> {\n\n\tprivate var h : Array<Dynamic>;\n\tprivate var q : Array<Dynamic>;\n\n\t/**\n\t\tThe length of `this` List.\n\t**/\n\tpublic var length(default,null) : Int;\n\n\t/**\n\t\tCreates a new empty list.\n\t**/\n\tpublic function new() {\n\t\tlength = 0;\n\t}\n\n\t/**\n\t\tAdds element `item` at the end of `this` List.\n\n\t\t`this.length` increases by 1.\n\t**/\n\tpublic function add( item : T ) {\n\t\tvar x:Array<Dynamic> = #if neko untyped __dollar__array(item,null) #else [item] #end;\n\t\tif( h == null )\n\t\t\th = x;\n\t\telse\n\t\t\tq[1] = x;\n\t\tq = x;\n\t\tlength++;\n\t}\n\n\t/**\n\t\tAdds element `item` at the beginning of `this` List.\n\n\t\t`this.length` increases by 1.\n\t**/\n\tpublic function push( item : T ) {\n\t\tvar x : Array<Dynamic> = #if neko\n\t\t\tuntyped __dollar__array(item,h)\n\t\t#else\n\t\t\t[item,h]\n\t\t#end;\n\t\th = x;\n\t\tif( q == null )\n\t\t\tq = x;\n\t\tlength++;\n\t}\n\n\t/**\n\t\tReturns the first element of `this` List, or null if no elements exist.\n\n\t\tThis function does not modify `this` List.\n\t**/\n\tpublic function first() : Null<T> {\n\t\treturn if( h == null ) null else h[0];\n\t}\n\n\t/**\n\t\tReturns the last element of `this` List, or null if no elements exist.\n\n\t\tThis function does not modify `this` List.\n\t**/\n\tpublic function last() : Null<T> {\n\t\treturn if( q == null ) null else q[0];\n\t}\n\n\n\t/**\n\t\tReturns the first element of `this` List, or null if no elements exist.\n\n\t\tThe element is removed from `this` List.\n\t**/\n\tpublic function pop() : Null<T> {\n\t\tif( h == null )\n\t\t\treturn null;\n\t\tvar x = h[0];\n\t\th = h[1];\n\t\tif( h == null )\n\t\t\tq = null;\n\t\tlength--;\n\t\treturn x;\n\t}\n\n\t/**\n\t\tTells if `this` List is empty.\n\t**/\n\tpublic function isEmpty() : Bool {\n\t\treturn (h == null);\n\t}\n\n\t/**\n\t\tEmpties `this` List.\n\n\t\tThis function does not traverse the elements, but simply sets the\n\t\tinternal references to null and `this.length` to 0.\n\t**/\n\tpublic function clear() : Void {\n\t\th = null;\n\t\tq = null;\n\t\tlength = 0;\n\t}\n\n\t/**\n\t\tRemoves the first occurence of `v` in `this` List.\n\n\t\tIf `v` is found by checking standard equality, it is removed from `this`\n\t\tList and the function returns true.\n\n\t\tOtherwise, false is returned.\n\t**/\n\tpublic function remove( v : T ) : Bool {\n\t\tvar prev = null;\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tif( l[0] == v ) {\n\t\t\t\tif( prev == null )\n\t\t\t\t\th = l[1];\n\t\t\t\telse\n\t\t\t\t\tprev[1] = l[1];\n\t\t\t\tif( q == l )\n\t\t\t\t\tq = prev;\n\t\t\t\tlength--;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tprev = l;\n\t\t\tl = l[1];\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t\tReturns an iterator on the elements of the list.\n\t**/\n\tpublic inline function iterator() : ListIterator<T> {\n\t\treturn new ListIterator<T>(h);\n\t}\n\n\t/**\n\t\tReturns a string representation of `this` List.\n\n\t\tThe result is enclosed in { } with the individual elements being\n\t\tseparated by a comma.\n\t**/\n\tpublic function toString() {\n\t\tvar s = new StringBuf();\n\t\tvar first = true;\n\t\tvar l = h;\n\t\ts.add(\"{\");\n\t\twhile( l != null ) {\n\t\t\tif( first )\n\t\t\t\tfirst = false;\n\t\t\telse\n\t\t\t\ts.add(\", \");\n\t\t\ts.add(Std.string(l[0]));\n\t\t\tl = l[1];\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n\t/**\n\t\tReturns a string representation of `this` List, with `sep` separating\n\t\teach element.\n\t**/\n\tpublic function join(sep : String) {\n\t\tvar s = new StringBuf();\n\t\tvar first = true;\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tif( first )\n\t\t\t\tfirst = false;\n\t\t\telse\n\t\t\t\ts.add(sep);\n\t\t\ts.add(l[0]);\n\t\t\tl = l[1];\n\t\t}\n\t\treturn s.toString();\n\t}\n\n\t/**\n\t\tReturns a list filtered with `f`. The returned list will contain all\n\t\telements for which `f(x) == true`.\n\t**/\n\tpublic function filter( f : T -> Bool ) {\n\t\tvar l2 = new List();\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tvar v = l[0];\n\t\t\tl = l[1];\n\t\t\tif( f(v) )\n\t\t\t\tl2.add(v);\n\t\t}\n\t\treturn l2;\n\t}\n\n\t/**\n\t\tReturns a new list where all elements have been converted by the\n\t\tfunction `f`.\n\t**/\n\tpublic function map<X>(f : T -> X) : List<X> {\n\t\tvar b = new List();\n\t\tvar l = h;\n\t\twhile( l != null ) {\n\t\t\tvar v = l[0];\n\t\t\tl = l[1];\n\t\t\tb.add(f(v));\n\t\t}\n\t\treturn b;\n\t}\n\n}\n\nprivate class ListIterator<T> {\n\tvar head:Array<Dynamic>;\n\tvar val:Dynamic;\n\n\tpublic inline function new(head:Array<Dynamic>) {\n\t\tthis.head = head;\n\t\tthis.val = null;\n\t}\n\n\tpublic inline function hasNext():Bool {\n\t\treturn head != null;\n\t}\n\n\tpublic inline function next():T {\n\t\tval = head[0];\n\t\thead = head[1];\n\t\treturn val;\n\t}\n}\n","package;\r\n\r\nimport haxe.ui.HaxeUIApp;\r\n\r\nclass Main {\r\n    public static function main() {\r\n        var app = new HaxeUIApp();\r\n        app.ready(function() {\r\n            var button:haxe.ui.components.Button = new haxe.ui.components.Button();\r\n            button.text = \"Test\";\r\n            app.addComponent(button);\r\n            app.start();\r\n        });\r\n    }\r\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class Reflect {\n\n\tpublic inline static function hasField( o : Dynamic, field : String ) : Bool {\n\t\treturn untyped __js__('Object').prototype.hasOwnProperty.call(o, field);\n\t}\n\n\tpublic static function field( o : Dynamic, field : String ) : Dynamic {\n\t\ttry return untyped o[field] catch( e : Dynamic ) return null;\n\t}\n\n\tpublic inline static function setField( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\to[field] = value;\n\t}\n\n\tpublic static inline function getProperty( o : Dynamic, field : String ) : Dynamic untyped {\n\t\tvar tmp;\n\t\treturn if( o == null ) __define_feature__(\"Reflect.getProperty\",null) else if( o.__properties__ && (tmp=o.__properties__[\"get_\"+field]) ) o[tmp]() else o[field];\n\t}\n\n\tpublic static inline function setProperty( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\tvar tmp;\n\t\tif( o.__properties__ && (tmp=o.__properties__[\"set_\"+field]) ) o[tmp](value) else o[field] = __define_feature__(\"Reflect.setProperty\",value);\n\t}\n\n\tpublic inline static function callMethod( o : Dynamic, func : haxe.Constraints.Function, args : Array<Dynamic> ) : Dynamic untyped {\n\t\treturn func.apply(o,args);\n\t}\n\n\tpublic static function fields( o : Dynamic ) : Array<String> {\n\t\tvar a = [];\n\t\tif (o != null) untyped {\n\t\t\tvar hasOwnProperty = __js__('Object').prototype.hasOwnProperty;\n\t\t\t__js__(\"for( var f in o ) {\");\n\t\t\tif( f != \"__id__\" && f != \"hx__closures__\" && hasOwnProperty.call(o, f) ) a.push(f);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a;\n\t}\n\n\tpublic static function isFunction( f : Dynamic ) : Bool untyped {\n\t\treturn __js__(\"typeof(f)\") == \"function\" && !(js.Boot.isClass(f) || js.Boot.isEnum(f));\n\t}\n\n\tpublic static function compare<T>( a : T, b : T ) : Int {\n\t\treturn ( a == b ) ? 0 : (((cast a) > (cast b)) ? 1 : -1);\n\t}\n\n\tpublic static function compareMethods( f1 : Dynamic, f2 : Dynamic ) : Bool {\n\t\tif( f1 == f2 )\n\t\t\treturn true;\n\t\tif( !isFunction(f1) || !isFunction(f2) )\n\t\t\treturn false;\n\t\treturn f1.scope == f2.scope && f1.method == f2.method && f1.method != null;\n\t}\n\n\tpublic static function isObject( v : Dynamic ) : Bool untyped {\n\t\tif( v == null )\n\t\t\treturn false;\n\t\tvar t = __js__(\"typeof(v)\");\n\t\treturn (t == \"string\" || (t == \"object\" && v.__enum__ == null)) || (t == \"function\" && (js.Boot.isClass(v) || js.Boot.isEnum(v)) != null);\n\t}\n\n\tpublic static function isEnumValue( v : Dynamic ) : Bool {\n\t\treturn v != null && v.__enum__ != null;\n\t}\n\n\tpublic static function deleteField( o : Dynamic, field : String ) : Bool untyped {\n\t\tif( !hasField(o,field) ) return false;\n\t\t__js__(\"delete\")(o[field]);\n\t\treturn true;\n\t}\n\n\tpublic static function copy<T>( o : T ) : T {\n\t\tvar o2 : Dynamic = {};\n\t\tfor( f in Reflect.fields(o) )\n\t\t\tReflect.setField(o2,f,Reflect.field(o,f));\n\t\treturn o2;\n\t}\n\n\t@:overload(function( f : Array<Dynamic> -> Void ) : Dynamic {})\n\tpublic static function makeVarArgs( f : Array<Dynamic> -> Dynamic ) : Dynamic {\n\t\treturn function() {\n\t\t\tvar a = untyped Array.prototype.slice.call(__js__(\"arguments\"));\n\t\t\treturn f(a);\n\t\t};\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nimport js.Boot;\n\n@:keepInit\n@:coreApi class Std {\n\n\tpublic static inline function is( v : Dynamic, t : Dynamic ) : Bool {\n\t\treturn untyped js.Boot.__instanceof(v,t);\n\t}\n\n\tpublic static inline function instance<T:{},S:T>( value : T, c : Class<S> ) : S {\n\t\treturn untyped __instanceof__(value, c) ? cast value : null;\n\t}\n\n\tpublic static function string( s : Dynamic ) : String {\n\t\treturn untyped js.Boot.__string_rec(s,\"\");\n\t}\n\n\tpublic static inline function int( x : Float ) : Int {\n\t\treturn (cast x) | 0;\n\t}\n\n\tpublic static function parseInt( x : String ) : Null<Int> {\n\t\tvar v = untyped __js__(\"parseInt\")(x, 10);\n\t\t// parse again if hexadecimal\n\t\tif( v == 0 && (x.charCodeAt(1) == 'x'.code || x.charCodeAt(1) == 'X'.code) )\n\t\t\tv = untyped __js__(\"parseInt\")(x);\n\t\tif( untyped __js__(\"isNaN\")(v) )\n\t\t\treturn null;\n\t\treturn cast v;\n\t}\n\n\tpublic static inline function parseFloat( x : String ) : Float {\n\t\treturn untyped __js__(\"parseFloat\")(x);\n\t}\n\n\tpublic static function random( x : Int ) : Int {\n\t\treturn untyped x <= 0 ? 0 : Math.floor(Math.random()*x);\n\t}\n\n\tstatic function __init__() : Void untyped {\n\t\t__feature__(\"js.Boot.getClass\",String.prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"String\"] = String,String));\n\t\t__feature__(\"js.Boot.isClass\",String.__name__ = __feature__(\"Type.getClassName\",[\"String\"],true));\n\t\t__feature__(\"Type.resolveClass\",$hxClasses[\"Array\"] = Array);\n\t\t__feature__(\"js.Boot.isClass\",Array.__name__ = __feature__(\"Type.getClassName\",[\"Array\"],true));\n\t\t__feature__(\"Date.*\", {\n\t\t\t__feature__(\"js.Boot.getClass\",__js__('Date').prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"Date\"] = __js__('Date'),__js__('Date')));\n\t\t\t__feature__(\"js.Boot.isClass\",__js__('Date').__name__ = [\"Date\"]);\n\t\t});\n\t\t__feature__(\"Int.*\",{\n\t\t\tvar Int = __feature__(\"Type.resolveClass\", $hxClasses[\"Int\"] = { __name__ : [\"Int\"] }, { __name__ : [\"Int\"] });\n\t\t});\n\t\t__feature__(\"Dynamic.*\",{\n\t\t\tvar Dynamic = __feature__(\"Type.resolveClass\", $hxClasses[\"Dynamic\"] = { __name__ : [\"Dynamic\"] }, { __name__ : [\"Dynamic\"] });\n\t\t});\n\t\t__feature__(\"Float.*\",{\n\t\t\tvar Float = __feature__(\"Type.resolveClass\", $hxClasses[\"Float\"] = __js__(\"Number\"), __js__(\"Number\"));\n\t\t\tFloat.__name__ = [\"Float\"];\n\t\t});\n\t\t__feature__(\"Bool.*\",{\n\t\t\tvar Bool = __feature__(\"Type.resolveEnum\",$hxClasses[\"Bool\"] = __js__(\"Boolean\"), __js__(\"Boolean\"));\n\t\t\tBool.__ename__ = [\"Bool\"];\n\t\t});\n\t\t__feature__(\"Class.*\",{\n\t\t\tvar Class = __feature__(\"Type.resolveClass\", $hxClasses[\"Class\"] = { __name__ : [\"Class\"] }, { __name__ : [\"Class\"] });\n\t\t});\n\t\t__feature__(\"Enum.*\",{\n\t\t\tvar Enum = {};\n\t\t});\n\t\t__feature__(\"Void.*\",{\n\t\t\tvar Void = __feature__(\"Type.resolveEnum\", $hxClasses[\"Void\"] = { __ename__ : [\"Void\"] }, { __ename__ : [\"Void\"] });\n\t\t});\n\n#if !js_es5\n\t\t__feature__(\"Array.map\",\n\t\t\tif( Array.prototype.map == null )\n\t\t\t\tArray.prototype.map = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length )\n\t\t\t\t\t\ta[i] = f(__this__[i]);\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n\t\t__feature__(\"Array.filter\",\n\t\t\tif( Array.prototype.filter == null )\n\t\t\t\tArray.prototype.filter = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length ) {\n\t\t\t\t\t\tvar e = __this__[i];\n\t\t\t\t\t\tif( f(e) ) a.push(e);\n\t\t\t\t\t}\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tA String buffer is an efficient way to build a big string by appending small\n\telements together.\n\n\tIts cross-platform implementation uses String concatenation internally, but\n\tStringBuf may be optimized for different targets.\n\n\tUnlike String, an instance of StringBuf is not immutable in the sense that\n\tit can be passed as argument to functions which modify it by appending more\n\tvalues. However, the internal buffer cannot be modified.\n**/\nclass StringBuf {\n\n\tvar b:String;\n\n\t/**\n\t\tThe length of `this` StringBuf in characters.\n\t**/\n\tpublic var length(get,never) : Int;\n\n\t/**\n\t\tCreates a new StringBuf instance.\n\n\t\tThis may involve initialization of the internal buffer.\n\t**/\n\tpublic inline function new() {\n\t\tb = \"\";\n\t}\n\n\tinline function get_length() : Int {\n\t\treturn b.length;\n\t}\n\n\t/**\n\t\tAppends the representation of `x` to `this` StringBuf.\n\n\t\tThe exact representation of `x` may vary per platform. To get more\n\t\tconsistent behavior, this function should be called with\n\t\tStd.string(x).\n\n\t\tIf `x` is null, the String \"null\" is appended.\n\t**/\n\tpublic inline function add<T>( x : T ) : Void {\n\t\tb += x;\n\t}\n\n\t/**\n\t\tAppends the character identified by `c` to `this` StringBuf.\n\n\t\tIf `c` is negative or has another invalid value, the result is\n\t\tunspecified.\n\t**/\n\tpublic inline function addChar( c : Int ) : Void {\n\t\tb += String.fromCharCode(c);\n\t}\n\n\t/**\n\t\tAppends a substring of `s` to `this` StringBuf.\n\n\t\tThis function expects `pos` and `len` to describe a valid substring of\n\t\t`s`, or else the result is unspecified. To get more robust behavior,\n\t\t`this.add(s.substr(pos,len))` can be used instead.\n\n\t\tIf `s` or `pos` are null, the result is unspecified.\n\n\t\tIf `len` is omitted or null, the substring ranges from `pos` to the end\n\t\tof `s`.\n\t**/\n\tpublic inline function addSub( s : String, pos : Int, ?len : Int) : Void {\n\t\tb += (len == null ? s.substr(pos) : s.substr(pos, len));\n\t}\n\n\t/**\n\t\tReturns the content of `this` StringBuf as String.\n\n\t\tThe buffer is not emptied by this operation.\n\t**/\n\tpublic inline function toString() : String {\n\t\treturn b;\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n/**\n\tThis class provides advanced methods on Strings. It is ideally used with\n\t'using StringTools' and then acts as an extension to the String class.\n\n\tIf the first argument to any of the methods is null, the result is\n\tunspecified.\n**/\n#if cpp\nusing cpp.NativeString;\n#end\nclass StringTools {\n\t/**\n\t\tEncode an URL by using the standard format.\n\t**/\n\t#if (!java && !cpp) inline #end public static function urlEncode( s : String ) : String {\n\t\t#if flash\n\t\t\treturn untyped __global__[\"encodeURIComponent\"](s);\n\t\t#elseif neko\n\t\t\treturn untyped new String(_urlEncode(s.__s));\n\t\t#elseif js\n\t\t\treturn untyped encodeURIComponent(s);\n\t\t#elseif cpp\n\t\t\treturn untyped s.__URLEncode();\n\t\t#elseif java\n\t\t\ttry\n\t\t\t\treturn untyped __java__(\"java.net.URLEncoder.encode(s, \\\"UTF-8\\\")\")\n\t\t\tcatch (e:Dynamic) throw e;\n\t\t#elseif cs\n\t\t\treturn untyped cs.system.Uri.EscapeDataString(s);\n\t\t#elseif python\n\t\t\treturn python.lib.urllib.Parse.quote(s, \"\");\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n\t/**\n\t\tDecode an URL using the standard format.\n\t**/\n\t#if (!java && !cpp) inline #end public static function urlDecode( s : String ) : String {\n\t\t#if flash\n\t\t\treturn untyped __global__[\"decodeURIComponent\"](s.split(\"+\").join(\" \"));\n\t\t#elseif neko\n\t\t\treturn untyped new String(_urlDecode(s.__s));\n\t\t#elseif js\n\t\t\treturn untyped decodeURIComponent(s.split(\"+\").join(\" \"));\n\t\t#elseif cpp\n\t\t\treturn untyped s.__URLDecode();\n\t\t#elseif java\n\t\t\ttry\n\t\t\t\treturn untyped __java__(\"java.net.URLDecoder.decode(s, \\\"UTF-8\\\")\")\n\t\t\tcatch (e:Dynamic) throw e;\n\t\t#elseif cs\n\t\t\treturn untyped cs.system.Uri.UnescapeDataString(s);\n\t\t#elseif python\n\t\t\treturn python.lib.urllib.Parse.unquote(s);\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n\t/**\n\t\tEscapes HTML special characters of the string `s`.\n\n\t\tThe following replacements are made:\n\n\t\t- `&` becomes `&amp`;\n\t\t- `<` becomes `&lt`;\n\t\t- `>` becomes `&gt`;\n\n\t\tIf `quotes` is true, the following characters are also replaced:\n\n\t\t- `\"` becomes `&quot`;\n\t\t- `'` becomes `&#039`;\n\t**/\n\tpublic static function htmlEscape( s : String, ?quotes : Bool ) : String {\n\t\ts = s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t\treturn quotes ? s.split('\"').join(\"&quot;\").split(\"'\").join(\"&#039;\") : s;\n\t}\n\n\t/**\n\t\tUnescapes HTML special characters of the string `s`.\n\n\t\tThis is the inverse operation to htmlEscape, i.e. the following always\n\t\tholds: htmlUnescape(htmlEscape(s)) == s\n\n\t\tThe replacements follow:\n\n\t\t- `&amp;` becomes `&`\n\t\t- `&lt;` becomes `<`\n\t\t- `&gt;` becomes `>`\n\t\t- `&quot;` becomes `\"`\n\t\t- `&#039;` becomes `'`\n\t**/\n\tpublic static function htmlUnescape( s : String ) : String {\n\t\treturn s.split(\"&gt;\").join(\">\").split(\"&lt;\").join(\"<\").split(\"&quot;\").join('\"').split(\"&#039;\").join(\"'\").split(\"&amp;\").join(\"&\");\n\t}\n\n\t/**\n\t\tTells if the string `s` starts with the string `start`.\n\n\t\tIf `start` is null, the result is unspecified.\n\n\t\tIf `start` is the empty String \"\", the result is true.\n\t**/\n\tpublic static #if (cs || java) inline #end function startsWith( s : String, start : String ) : Bool {\n\t\t#if java\n\t\treturn untyped s.startsWith(start);\n\t\t#elseif cs\n\t\treturn untyped s.StartsWith(start);\n\t\t#elseif cpp\n\t\tif (s.length<start.length)\n\t\t\treturn false;\n\t\tvar p0 = s.c_str();\n\t\tvar p1 = start.c_str();\n\t\tfor(i in 0...start.length)\n\t\t\tif ( p0.at(i) != p1.at(i) )\n\t\t\t\treturn false;\n\t\treturn true;\n\t\t#else\n\t\treturn( s.length >= start.length && s.substr(0, start.length) == start );\n\t\t#end\n\t}\n\n\t/**\n\t\tTells if the string `s` ends with the string `end`.\n\n\t\tIf `end` is null, the result is unspecified.\n\n\t\tIf `end` is the empty String \"\", the result is true.\n\t**/\n\tpublic static #if (cs || java) inline #end function endsWith( s : String, end : String ) : Bool {\n\t\t#if java\n\t\treturn untyped s.endsWith(end);\n\t\t#elseif cs\n\t\treturn untyped s.EndsWith(end);\n\t\t#elseif cpp\n\t\tif (s.length<end.length)\n\t\t\treturn false;\n\t\tvar p0 = s.c_str().add( s.length-end.length );\n\t\tvar p1 = end.c_str();\n\t\tfor(i in 0...end.length)\n\t\t\tif ( p0.at(i) != p1.at(i) )\n\t\t\t\treturn false;\n\t\treturn true;\n\t\t#else\n\t\tvar elen = end.length;\n\t\tvar slen = s.length;\n\t\treturn( slen >= elen && s.substr(slen - elen, elen) == end );\n\t\t#end\n\t}\n\n\t/**\n\t\tTells if the character in the string `s` at position `pos` is a space.\n\n\t\tA character is considered to be a space character if its character code\n\t\tis 9,10,11,12,13 or 32.\n\n\t\tIf `s` is the empty String \"\", or if pos is not a valid position within\n\t\t`s`, the result is false.\n\t**/\n\tpublic static function isSpace( s : String, pos : Int ) : Bool {\n\t\t#if python\n\t\tif (s.length == 0 || pos < 0 || pos >= s.length) return false;\n\t\t#end\n\t\tvar c = s.charCodeAt( pos );\n\t\treturn (c > 8 && c < 14) || c == 32;\n\t}\n\n\t/**\n\t\tRemoves leading space characters of `s`.\n\n\t\tThis function internally calls isSpace() to decide which characters to\n\t\tremove.\n\n\t\tIf `s` is the empty String \"\" or consists only of space characters, the\n\t\tresult is the empty String \"\".\n\t**/\n\tpublic #if cs inline #end static function ltrim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.TrimStart();\n\t\t#else\n\t\tvar l = s.length;\n\t\tvar r = 0;\n\t\twhile( r < l && isSpace(s,r) ){\n\t\t\tr++;\n\t\t}\n\t\tif( r > 0 )\n\t\t\treturn s.substr(r, l-r);\n\t\telse\n\t\t\treturn s;\n\t\t#end\n\t}\n\n\t/**\n\t\tRemoves trailing space characters of `s`.\n\n\t\tThis function internally calls isSpace() to decide which characters to\n\t\tremove.\n\n\t\tIf `s` is the empty String \"\" or consists only of space characters, the\n\t\tresult is the empty String \"\".\n\t**/\n\tpublic #if cs inline #end static function rtrim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.TrimEnd();\n\t\t#else\n\t\tvar l = s.length;\n\t\tvar r = 0;\n\t\twhile( r < l && isSpace(s,l-r-1) ){\n\t\t\tr++;\n\t\t}\n\t\tif( r > 0 ){\n\t\t\treturn s.substr(0, l-r);\n\t\t}else{\n\t\t\treturn s;\n\t\t}\n\t\t#end\n\t}\n\n\t/**\n\t\tRemoves leading and trailing space characters of `s`.\n\n\t\tThis is a convenience function for ltrim(rtrim(s)).\n\t**/\n\tpublic #if (cs || java) inline #end static function trim( s : String ) : String {\n\t\t#if cs\n\t\treturn untyped s.Trim();\n\t\t#elseif java\n\t\treturn untyped s.trim();\n\t\t#else\n\t\treturn ltrim(rtrim(s));\n\t\t#end\n\t}\n\n\t/**\n\t\tConcatenates `c` to `s` until `s.length` is at least `l`.\n\n\t\tIf `c` is the empty String \"\" or if `l` does not exceed `s.length`,\n\t\t`s` is returned unchanged.\n\n\t\tIf `c.length` is 1, the resulting String length is exactly `l`.\n\n\t\tOtherwise the length may exceed `l`.\n\n\t\tIf `c` is null, the result is unspecified.\n\t**/\n\tpublic static function lpad( s : String, c : String, l : Int ) : String {\n\t\tif (c.length <= 0)\n\t\t\treturn s;\n\n\t\twhile (s.length < l) {\n\t\t\ts = c + s;\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tAppends `c` to `s` until `s.length` is at least `l`.\n\n\t\tIf `c` is the empty String \"\" or if `l` does not exceed `s.length`,\n\t\t`s` is returned unchanged.\n\n\t\tIf `c.length` is 1, the resulting String length is exactly `l`.\n\n\t\tOtherwise the length may exceed `l`.\n\n\t\tIf `c` is null, the result is unspecified.\n\t**/\n\tpublic static function rpad( s : String, c : String, l : Int ) : String {\n\t\tif (c.length <= 0)\n\t\t\treturn s;\n\n\t\twhile (s.length < l) {\n\t\t\ts = s + c;\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tReplace all occurences of the String `sub` in the String `s` by the\n\t\tString `by`.\n\n\t\tIf `sub` is the empty String \"\", `by` is inserted after each character\n\t\tof `s`. If `by` is also the empty String \"\", `s` remains unchanged.\n\n\t\tThis is a convenience function for `s.split(sub).join(by)`.\n\n\t\tIf `sub` or `by` are null, the result is unspecified.\n\t**/\n\tpublic static function replace( s : String, sub : String, by : String ) : String {\n\t\t#if java\n\t\tif (sub.length == 0)\n\t\t\treturn s.split(sub).join(by);\n\t\telse\n\t\t\treturn untyped s.replace(sub, by);\n\t\t#elseif cs\n\t\tif (sub.length == 0)\n\t\t\treturn s.split(sub).join(by);\n\t\telse\n\t\t\treturn untyped s.Replace(sub, by);\n\t\t#else\n\t\treturn s.split(sub).join(by);\n\t\t#end\n\t}\n\n\t/**\n\t\tEncodes `n` into a hexadecimal representation.\n\n\t\tIf `digits` is specified, the resulting String is padded with \"0\" until\n\t\tits length equals `digits`.\n\t**/\n\tpublic static function hex( n : Int, ?digits : Int ) {\n\t\t#if flash\n\t\t\tvar n : UInt = n;\n\t\t\tvar s : String = untyped n.toString(16);\n\t\t\ts = s.toUpperCase();\n\t\t#else\n\t\t\tvar s = \"\";\n\t\t\tvar hexChars = \"0123456789ABCDEF\";\n\t\t\tdo {\n\t\t\t\ts = hexChars.charAt(n&15) + s;\n\t\t\t\tn >>>= 4;\n\t\t\t} while( n > 0 );\n\t\t#end\n\t\t#if python\n\t\tif (digits != null && s.length < digits) {\n\t\t\tvar diff = digits - s.length;\n\t\t\tfor (_ in 0...diff) {\n\t\t\t\ts = \"0\" + s;\n\t\t\t}\n\t\t}\n\t\t#else\n\t\tif( digits != null )\n\t\t\twhile( s.length < digits )\n\t\t\t\ts = \"0\"+s;\n\t\t#end\n\t\treturn s;\n\t}\n\n\t/**\n\t\tReturns the character code at position `index` of String `s`, or an\n\t\tend-of-file indicator at if `position` equals `s.length`.\n\n\t\tThis method is faster than String.charCodeAt() on some platforms, but\n\t\tthe result is unspecified if `index` is negative or greater than\n\t\t`s.length`.\n\n\t\tEnd of file status can be checked by calling `StringTools.isEof` with\n\t\tthe returned value as argument.\n\n\t\tThis operation is not guaranteed to work if `s` contains the \\0\n\t\tcharacter.\n\t**/\n\tpublic static inline function fastCodeAt( s : String, index : Int ) : Int {\n\t\t#if neko\n\t\treturn untyped __dollar__sget(s.__s, index);\n\t\t#elseif cpp\n\t\treturn untyped s.cca(index);\n\t\t#elseif flash\n\t\treturn untyped s.cca(index);\n\t\t#elseif java\n\t\treturn ( index < s.length ) ? cast(_charAt(s, index), Int) : -1;\n\t\t#elseif cs\n\t\treturn ( cast(index, UInt) < s.length ) ? cast(s[index], Int) : -1;\n\t\t#elseif js\n\t\treturn (untyped s).charCodeAt(index);\n\t\t#elseif python\n\t\treturn if (index >= s.length) -1 else python.internal.UBuiltins.ord(python.Syntax.arrayAccess(s, index));\n\t\t#else\n\t\treturn untyped s.cca(index);\n\t\t#end\n\t}\n\n\t/*\n\t\tTells if `c` represents the end-of-file (EOF) character.\n\t*/\n\t@:noUsing public static inline function isEof( c : Int ) : Bool {\n\t\t#if (flash || cpp)\n\t\treturn c == 0;\n\t\t#elseif js\n\t\treturn c != c; // fast NaN\n\t\t#elseif neko\n\t\treturn c == null;\n\t\t#elseif cs\n\t\treturn c == -1;\n\t\t#elseif java\n\t\treturn c == -1;\n\t\t#elseif python\n\t\treturn c == -1;\n\t\t#else\n\t\treturn false;\n\t\t#end\n\t}\n\n\t#if java\n\tprivate static inline function _charAt(str:String, idx:Int):java.StdTypes.Char16 return untyped str._charAt(idx);\n\t#end\n\n\t#if neko\n\tprivate static var _urlEncode = neko.Lib.load(\"std\",\"url_encode\",1);\n\tprivate static var _urlDecode = neko.Lib.load(\"std\",\"url_decode\",1);\n\t#end\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nenum ValueType {\n\tTNull;\n\tTInt;\n\tTFloat;\n\tTBool;\n\tTObject;\n\tTFunction;\n\tTClass( c : Class<Dynamic> );\n\tTEnum( e : Enum<Dynamic> );\n\tTUnknown;\n}\n\n@:coreApi class Type {\n\n\tpublic static inline function getClass<T>( o : T ) : Class<T> {\n\t\treturn if (o == null) null else @:privateAccess js.Boot.getClass(o);\n\t}\n\n\tpublic static function getEnum( o : EnumValue ) : Enum<Dynamic> untyped {\n\t\tif( o == null )\n\t\t\treturn null;\n\t\treturn o.__enum__;\n\t}\n\n\tpublic static function getSuperClass( c : Class<Dynamic> ) : Class<Dynamic> untyped {\n\t\treturn c.__super__;\n\t}\n\n\n\tpublic static function getClassName( c : Class<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped c.__name__;\n\t\tif (a == null)\n\t\t\treturn null;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function getEnumName( e : Enum<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped e.__ename__;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function resolveClass( name : String ) : Class<Dynamic> untyped {\n\t\tvar cl : Class<Dynamic> = $hxClasses[name];\n\t\t// ensure that this is a class\n\t\tif( cl == null || !js.Boot.isClass(cl) )\n\t\t\treturn null;\n\t\treturn cl;\n\t}\n\n\tpublic static function resolveEnum( name : String ) : Enum<Dynamic> untyped {\n\t\tvar e : Dynamic = $hxClasses[name];\n\t\t// ensure that this is an enum\n\t\tif( e == null || !js.Boot.isEnum(e) )\n\t\t\treturn null;\n\t\treturn e;\n\t}\n\n\tpublic static function createInstance<T>( cl : Class<T>, args : Array<Dynamic> ) : T untyped {\n\t\tswitch( args.length ) {\n\t\tcase 0:\n\t\t\treturn __new__(cl);\n\t\tcase 1:\n\t\t\treturn __new__(cl,args[0]);\n\t\tcase 2:\n\t\t\treturn __new__(cl,args[0],args[1]);\n\t\tcase 3:\n\t\t\treturn __new__(cl,args[0],args[1],args[2]);\n\t\tcase 4:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3]);\n\t\tcase 5:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4]);\n\t\tcase 6:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5]);\n\t\tcase 7:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6]);\n\t\tcase 8:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);\n\t\tdefault:\n\t\t\tthrow \"Too many arguments\";\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic static function createEmptyInstance<T>( cl : Class<T> ) : T untyped {\n\t\t__js__(\"function empty() {}; empty.prototype = cl.prototype\");\n\t\treturn __js__(\"new empty()\");\n\t}\n\n\tpublic static function createEnum<T>( e : Enum<T>, constr : String, ?params : Array<Dynamic> ) : T {\n\t\tvar f:Dynamic = Reflect.field(e,constr);\n\t\tif( f == null ) throw \"No such constructor \"+constr;\n\t\tif( Reflect.isFunction(f) ) {\n\t\t\tif( params == null ) throw \"Constructor \"+constr+\" need parameters\";\n\t\t\treturn Reflect.callMethod(e,f,params);\n\t\t}\n\t\tif( params != null && params.length != 0 )\n\t\t\tthrow \"Constructor \"+constr+\" does not need parameters\";\n\t\treturn f;\n\t}\n\n\tpublic static function createEnumIndex<T>( e : Enum<T>, index : Int, ?params : Array<Dynamic> ) : T {\n\t\tvar c : String = (untyped e.__constructs__)[index];\n\t\tif( c == null ) throw index+\" is not a valid enum constructor index\";\n\t\treturn createEnum(e,c,params);\n\t}\n\n\tpublic static function getInstanceFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = [];\n\t\tuntyped __js__(\"for(var i in c.prototype) a.push(i)\");\n\t\ta.remove(\"__class__\");\n\t\ta.remove(\"__properties__\");\n\t\treturn a;\n\t}\n\n\tpublic static function getClassFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = Reflect.fields(c);\n\t\ta.remove(\"__name__\");\n\t\ta.remove(\"__interfaces__\");\n\t\ta.remove(\"__properties__\");\n\t\ta.remove(\"__super__\");\n\t\ta.remove(\"__meta__\");\n\t\ta.remove(\"prototype\");\n\t\treturn a;\n\t}\n\n\tpublic static function getEnumConstructs( e : Enum<Dynamic> ) : Array<String> {\n\t\tvar a : Array<String> = untyped e.__constructs__;\n\t\treturn a.copy();\n\t}\n\n\tpublic static function typeof( v : Dynamic ) : ValueType untyped {\n\t\tswitch( __js__(\"typeof\")(v) ) {\n\t\tcase \"boolean\": return TBool;\n\t\tcase \"string\": return TClass(String);\n\t\tcase \"number\":\n\t\t\t// this should handle all cases : NaN, +/-Inf and Floats outside range\n\t\t\tif( Math.ceil(v) == v%2147483648.0 )\n\t\t\t\treturn TInt;\n\t\t\treturn TFloat;\n\t\tcase \"object\":\n\t\t\tif( v == null )\n\t\t\t\treturn TNull;\n\t\t\tvar e = v.__enum__;\n\t\t\tif( e != null )\n\t\t\t\treturn TEnum(e);\n\t\t\tvar c = js.Boot.getClass(v);\n\t\t\tif( c != null )\n\t\t\t\treturn TClass(c);\n\t\t\treturn TObject;\n\t\tcase \"function\":\n\t\t\tif( js.Boot.isClass(v) || js.Boot.isEnum(v) )\n\t\t\t\treturn TObject;\n\t\t\treturn TFunction;\n\t\tcase \"undefined\":\n\t\t\treturn TNull;\n\t\tdefault:\n\t\t\treturn TUnknown;\n\t\t}\n\t}\n\n\tpublic static function enumEq<T>( a : T, b : T ) : Bool untyped {\n\t\tif( a == b )\n\t\t\treturn true;\n\t\ttry {\n\t\t\tif( a[0] != b[0] )\n\t\t\t\treturn false;\n\t\t\tfor( i in 2...a.length )\n\t\t\t\tif( !enumEq(a[i],b[i]) )\n\t\t\t\t\treturn false;\n\t\t\tvar e = a.__enum__;\n\t\t\tif( e != b.__enum__ || e == null )\n\t\t\t\treturn false;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic inline static function enumConstructor( e : EnumValue ) : String {\n\t\treturn untyped e[0];\n\t}\n\n\tpublic inline static function enumParameters( e : EnumValue ) : Array<Dynamic> {\n\t\treturn untyped e.slice(2);\n\t}\n\n\tpublic inline static function enumIndex( e : EnumValue ) : Int {\n\t\treturn untyped e[1];\n\t}\n\n\tpublic static function allEnums<T>( e : Enum<T> ) : Array<T> {\n\t\treturn untyped e.__empty_constructs__;\n\t}\n\n}\n\n","/*\n * Copyright (C)2005-2015 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\n@:enum abstract XmlType(Int) {\n\tvar Element = 0;\n\tvar PCData = 1;\n\tvar CData = 2;\n\tvar Comment = 3;\n\tvar DocType = 4;\n\tvar ProcessingInstruction = 5;\n\tvar Document = 6;\n}\n\nclass Xml {\n\n\tstatic public var Element(default,null) = XmlType.Element;\n\tstatic public var PCData(default,null) = XmlType.PCData;\n\tstatic public var CData(default,null) = XmlType.CData;\n\tstatic public var Comment(default,null) = XmlType.Comment;\n\tstatic public var DocType(default,null) = XmlType.DocType;\n\tstatic public var ProcessingInstruction(default,null) = XmlType.ProcessingInstruction;\n\tstatic public var Document(default,null) = XmlType.Document;\n\n\tstatic public function parse( str : String ) : Xml {\n\t\treturn haxe.xml.Parser.parse(str);\n\t}\n\n\t/**\n\t\tReturns the type of the Xml Node. This should be used before\n\t\taccessing other functions since some might raise an exception\n\t\tif the node type is not correct.\n\t**/\n\tpublic var nodeType(default, null) : XmlType;\n\n\t/**\n\t\tReturns the node name of an Element.\n\t**/\n\t@:isVar public var nodeName(get, set) : String;\n\n\t/**\n\t\tReturns the node value. Only works if the Xml node is not an Element or a Document.\n\t**/\n\t@:isVar public var nodeValue(get, set) : String;\n\n\t/**\n\t\tReturns the parent object in the Xml hierarchy.\n\t\tThe parent can be [null], an Element or a Document.\n\t**/\n\tpublic var parent(default, null) : Xml;\n\n\tvar children:Array<Xml>;\n\tvar attributeMap:Map<String, String>;\n\n\tinline function get_nodeName() {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn nodeName;\n\t}\n\n\tinline function set_nodeName(v) {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn this.nodeName = v;\n\t}\n\n\tinline function get_nodeValue() {\n\t\tif (nodeType == Document || nodeType == Element) {\n\t\t\tthrow 'Bad node type, unexpected $nodeType';\n\t\t}\n\t\treturn nodeValue;\n\t}\n\n\tinline function set_nodeValue(v) {\n\t\tif (nodeType == Document || nodeType == Element) {\n\t\t\tthrow 'Bad node type, unexpected $nodeType';\n\t\t}\n\t\treturn this.nodeValue = v;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createElement( name : String ) : Xml {\n\t\tvar xml = new Xml(Element);\n\t\txml.nodeName = name;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createPCData( data : String ) : Xml {\n\t\tvar xml = new Xml(PCData);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createCData( data : String ) : Xml {\n\t\tvar xml = new Xml(CData);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createComment( data : String ) : Xml {\n\t\tvar xml = new Xml(Comment);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createDocType( data : String ) : Xml {\n\t\tvar xml = new Xml(DocType);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createProcessingInstruction( data : String ) : Xml {\n\t\tvar xml = new Xml(ProcessingInstruction);\n\t\txml.nodeValue = data;\n\t\treturn xml;\n\t}\n\n\t/**\n\t\tCreates a node of the given type.\n\t**/\n\tstatic public function createDocument() : Xml {\n\t\treturn new Xml(Document);\n\t}\n\n\t/**\n\t\tGet the given attribute of an Element node. Returns [null] if not found.\n\t\tAttributes are case-sensitive.\n\t**/\n\tpublic function get( att : String ) : String {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn attributeMap[att];\n\t}\n\n\t/**\n\t\tSet the given attribute value for an Element node.\n\t\tAttributes are case-sensitive.\n\t**/\n\tpublic function set( att : String, value : String ) : Void {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\tattributeMap.set(att, value);\n\t}\n\n\t/**\n\t\tRemoves an attribute for an Element node.\n\t\tAttributes are case-sensitive.\n\t**/\n\tpublic function remove( att : String ) : Void {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\tattributeMap.remove(att);\n\t}\n\n\t/**\n\t\tTells if the Element node has a given attribute.\n\t\tAttributes are case-sensitive.\n\t**/\n\tpublic function exists( att : String ) : Bool {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn attributeMap.exists(att);\n\t}\n\n\t/**\n\t\tReturns an [Iterator] on all the attribute names.\n\t**/\n\tpublic function attributes() : Iterator<String> {\n\t\tif (nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element but found $nodeType';\n\t\t}\n\t\treturn attributeMap.keys();\n\t}\n\n\t/**\n\t\tReturns an iterator of all child nodes.\n\t\tOnly works if the current node is an Element or a Document.\n\t**/\n\tpublic inline function iterator() : Iterator<Xml> {\n\t\tensureElementType();\n\t\treturn children.iterator();\n\t}\n\n\t/**\n\t\tReturns an iterator of all child nodes which are Elements.\n\t\tOnly works if the current node is an Element or a Document.\n\t**/\n\tpublic function elements() : Iterator<Xml> {\n\t\tensureElementType();\n\t\tvar ret = [for (child in children) if (child.nodeType == Element) child];\n\t\treturn ret.iterator();\n\t}\n\n\t/**\n\t\tReturns an iterator of all child nodes which are Elements with the given nodeName.\n\t\tOnly works if the current node is an Element or a Document.\n\t**/\n\tpublic function elementsNamed( name : String ) : Iterator<Xml> {\n\t\tensureElementType();\n\t\tvar ret = [for (child in children) if (child.nodeType == Element && child.nodeName == name) child];\n\t\treturn ret.iterator();\n\t}\n\n\t/**\n\t\tReturns the first child node.\n\t**/\n\tpublic inline function firstChild() : Xml {\n\t\tensureElementType();\n\t\treturn children[0];\n\t}\n\n\t/**\n\t\tReturns the first child node which is an Element.\n\t**/\n\tpublic function firstElement() : Xml {\n\t\tensureElementType();\n\t\tfor (child in children) {\n\t\t\tif (child.nodeType == Element) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t\tAdds a child node to the Document or Element.\n\t\tA child node can only be inside one given parent node, which is indicated by the [parent] property.\n\t\tIf the child is already inside this Document or Element, it will be moved to the last position among the Document or Element's children.\n\t\tIf the child node was previously inside a different node, it will be moved to this Document or Element.\n\t**/\n\tpublic function addChild( x : Xml ) : Void {\n\t\tensureElementType();\n\t\tif (x.parent != null) {\n\t\t\tx.parent.removeChild(x);\n\t\t}\n\t\tchildren.push(x);\n\t\tx.parent = this;\n\t}\n\n\t/**\n\t\tRemoves a child from the Document or Element.\n\t\tReturns true if the child was successfuly removed.\n\t**/\n\tpublic function removeChild( x : Xml ) : Bool {\n\t\tensureElementType();\n\t\tif (children.remove(x)) {\n\t\t\tx.parent = null;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t\tInserts a child at the given position among the other childs.\n\t\tA child node can only be inside one given parent node, which is indicated by the [parent] property.\n\t\tIf the child is already inside this Document or Element, it will be moved to the new position among the Document or Element's children.\n\t\tIf the child node was previously inside a different node, it will be moved to this Document or Element.\n\t**/\n\tpublic function insertChild( x : Xml, pos : Int ) : Void {\n\t\tensureElementType();\n\t\tif (x.parent != null) {\n\t\t\tx.parent.children.remove(x);\n\t\t}\n\t\tchildren.insert(pos, x);\n\t\tx.parent = this;\n\t}\n\n\t/**\n\t\tReturns a String representation of the Xml node.\n\t**/\n\tpublic inline function toString() : String {\n\t\treturn haxe.xml.Printer.print(this);\n\t}\n\n\tfunction new(nodeType:XmlType) {\n\t\tthis.nodeType = nodeType;\n\t\tchildren = [];\n\t\tattributeMap = new Map();\n\t}\n\n\tinline function ensureElementType() {\n\t\tif (nodeType != Document && nodeType != Element) {\n\t\t\tthrow 'Bad node type, expected Element or Document but found $nodeType';\n\t\t}\n\t}\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe;\n\nimport flambe.util.Disposable;\n\n/**\n * Components are bits of data and logic that can be added to entities.\n */\n#if (!macro && !display)\n@:autoBuild(flambe.platform.ComponentBuilder.build())\n#end\n@:componentBase\nclass Component\n    implements Disposable\n{\n    /** The entity this component is attached to, or null. */\n    @:allow(flambe)\n    public var owner (default, null) :Entity = null;\n\n    /** The owner's next component, for iteration. */\n    @:allow(flambe)\n    public var next (default, null) :Component = null;\n\n    /**\n     * The component's name, generated based on its class. Components with the same name replace\n     * eachother when added to an entity.\n     */\n    public var name (get, null) :String;\n\n    /**\n     * Called after this component has been added to an entity.\n     */\n    public function onAdded ()\n    {\n    }\n\n    /**\n     * Called just before this component has been removed from its entity.\n     */\n    public function onRemoved ()\n    {\n    }\n\n    /**\n     * Called just before this component's first update after being added. This is the best place to\n     * put initialization logic that requires accessing other components/entities, since it waits\n     * until the rest of the entity hierarchy is accessible.\n     *\n     * Note that onStart may be delayed until the next frame after adding a component, depending on\n     * where in the update step it was added.\n     */\n    public function onStart ()\n    {\n    }\n\n    /**\n     * Called just before this component will be removed from its entity, if onStart was previously\n     * called.\n     */\n    public function onStop ()\n    {\n    }\n\n    /**\n     * Called when this component receives a game update.\n     * @param dt The time elapsed since the last frame, in seconds.\n     */\n    public function onUpdate (dt :Float)\n    {\n    }\n\n    /**\n     * Removes this component from its owning entity.\n     */\n    public function dispose ()\n    {\n        if (owner != null) {\n            owner.remove(this);\n        }\n    }\n\n    private function get_name () :String\n    {\n        return null; // Subclasses will automagically implement this\n    }\n\n    // Component flags\n    @:allow(flambe) static inline var STARTED = 1 << 0;\n    private static inline var NEXT_FLAG = 1 << 1; // Must be last!\n\n    @:allow(flambe) var _flags :Int = 0;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe;\n\n#if macro\nimport haxe.macro.Context;\nimport haxe.macro.Expr;\nimport haxe.macro.Type;\nusing haxe.macro.ExprTools;\n#end\n\nimport flambe.util.Disposable;\n\nusing Lambda;\nusing flambe.util.BitSets;\n\n/**\n * A node in the entity hierarchy, and a collection of components.\n *\n * To iterate over the hierarchy, use the parent, firstChild, next and firstComponent fields. For\n * example:\n *\n * ```haxe\n * // Iterate over entity's children\n * var child = entity.firstChild;\n * while (child != null) {\n *     var next = child.next; // Store in case the child is removed in process()\n *     process(child);\n *     child = next;\n * }\n * ```\n */\n@:final class Entity\n    implements Disposable\n{\n    /** This entity's parent. */\n    public var parent (default, null) :Entity = null;\n\n    /** This entity's first child. */\n    public var firstChild (default, null) :Entity = null;\n\n    /** This entity's next sibling, for iteration. */\n    public var next (default, null) :Entity = null;\n\n    /** This entity's first component. */\n    public var firstComponent (default, null) :Component = null;\n\n    public function new ()\n    {\n#if flash\n        _compMap = cast new flash.utils.Dictionary();\n#elseif js\n        _compMap = {};\n#end\n    }\n\n    /**\n     * Add a component to this entity. Any previous component of this type will be replaced.\n     * @returns This instance, for chaining.\n     */\n    public function add (component :Component) :Entity\n    {\n        // Remove the component from any previous owner. Don't just call dispose, which has\n        // additional behavior in some components (like Disposer).\n        if (component.owner != null) {\n            component.owner.remove(component);\n        }\n\n        var name = component.name;\n        var prev = getComponent(name);\n        if (prev != null) {\n            // Remove the previous component under this name\n            remove(prev);\n        }\n\n        untyped _compMap[name] = component;\n\n        // Append it to the component list\n        var tail = null, p = firstComponent;\n        while (p != null) {\n            tail = p;\n            p = p.next;\n        }\n        if (tail != null) {\n            tail.next = component;\n        } else {\n            firstComponent = component;\n        }\n\n        component.owner = this;\n        component.next = null;\n        component.onAdded();\n\n        return this;\n    }\n\n    /**\n     * Remove a component from this entity.\n     * @return Whether the component was removed.\n     */\n    public function remove (component :Component) :Bool\n    {\n        var prev :Component = null, p = firstComponent;\n        while (p != null) {\n            var next = p.next;\n            if (p == component) {\n                // Splice out the component\n                if (prev == null) {\n                    firstComponent = next;\n                } else {\n                    prev.owner = this;\n                    prev.next = next;\n                }\n\n                // Remove it from the _compMap\n#if flash\n                untyped __delete__(_compMap, p.name);\n#elseif js\n                untyped __js__(\"delete\")(_compMap[p.name]);\n#end\n\n                // Notify the component it was removed\n                if (p._flags.contains(Component.STARTED)) {\n                    p.onStop();\n                    p._flags = p._flags.remove(Component.STARTED);\n                }\n                p.onRemoved();\n                p.owner = null;\n                p.next = null;\n                return true;\n            }\n            prev = p;\n            p = next;\n        }\n        return false;\n    }\n\n    /**\n     * Gets a component of a given type from this entity.\n     */\n#if (display || dox)\n    public function get<A:Component> (componentClass :Class<A>) :A return null;\n\n#else\n    macro public function get<A:Component> (self :Expr, componentClass :ExprOf<Class<A>>) :ExprOf<A>\n    {\n        var type = requireComponentType(componentClass);\n        var name = macro $componentClass.NAME;\n        return needSafeCast(type)\n            ? macro Std.instance($self.getComponent($name), $componentClass)\n            : macro $self._internal_unsafeCast($self.getComponent($name), $componentClass);\n    }\n#end\n\n    /**\n     * Checks if this entity has a component of the given type.\n     */\n#if (display || dox)\n    public function has<A:Component> (componentClass :Class<A>) :Bool return false;\n\n#else\n    macro public function has<A> (self :Expr, componentClass :ExprOf<Class<A>>) :ExprOf<Bool>\n    {\n        return macro $self.get($componentClass) != null;\n    }\n#end\n\n    /**\n     * Gets a component of a given type from this entity, or any of its parents. Searches upwards in\n     * the hierarchy until the component is found, or returns null if not found.\n     */\n#if (display || dox)\n    public function getFromParents<A:Component> (componentClass :Class<A>) :A return null;\n\n#else\n    macro public function getFromParents<A> (self :Expr, componentClass :ExprOf<Class<A>>) :ExprOf<A>\n    {\n        var type = requireComponentType(componentClass);\n        var name = macro $componentClass.NAME;\n        return needSafeCast(type)\n            ? macro $self._internal_getFromParents($name, $componentClass)\n            : macro $self._internal_unsafeCast($self._internal_getFromParents($name), $componentClass);\n    }\n#end\n\n    /**\n     * Gets a component of a given type from this entity, or any of its children. Searches downwards\n     * in a depth-first search until the component is found, or returns null if not found.\n     */\n#if (display || dox)\n    public function getFromChildren<A:Component> (componentClass :Class<A>) :A return null;\n\n#else\n    macro public function getFromChildren<A> (self :Expr, componentClass :ExprOf<Class<A>>) :ExprOf<A>\n    {\n        var type = requireComponentType(componentClass);\n        var name = macro $componentClass.NAME;\n        return needSafeCast(type)\n            ? macro $self._internal_getFromChildren($name, $componentClass)\n            : macro $self._internal_unsafeCast($self._internal_getFromChildren($name), $componentClass);\n    }\n#end\n\n    /**\n     * Gets a component by name from this entity.\n     */\n    inline public function getComponent (name :String) :Component\n    {\n        return untyped _compMap[name];\n    }\n\n    /**\n     * Adds a child to this entity.\n     * @param append Whether to add the entity to the end or beginning of the child list.\n     * @returns This instance, for chaining.\n     */\n    public function addChild (entity :Entity, append :Bool=true) :Entity\n    {\n        if (entity.parent != null) {\n            entity.parent.removeChild(entity);\n        }\n        entity.parent = this;\n\n        if (append) {\n            // Append it to the child list\n            var tail = null, p = firstChild;\n            while (p != null) {\n                tail = p;\n                p = p.next;\n            }\n            if (tail != null) {\n                tail.next = entity;\n            } else {\n                firstChild = entity;\n            }\n\n        } else {\n            // Prepend it to the child list\n            entity.next = firstChild;\n            firstChild = entity;\n        }\n\n        return this;\n    }\n\n    public function removeChild (entity :Entity)\n    {\n        var prev :Entity = null, p = firstChild;\n        while (p != null) {\n            var next = p.next;\n            if (p == entity) {\n                // Splice out the entity\n                if (prev == null) {\n                    firstChild = next;\n                } else {\n                    prev.next = next;\n                }\n                p.parent = null;\n                p.next = null;\n                return;\n            }\n            prev = p;\n            p = next;\n        }\n    }\n\n    /**\n     * Dispose all of this entity's children, without touching its own components or removing itself\n     * from its parent.\n     */\n    public function disposeChildren ()\n    {\n        while (firstChild != null) {\n            firstChild.dispose();\n        }\n    }\n\n    /**\n     * Removes this entity from its parent, and disposes all its components and children.\n     */\n    public function dispose ()\n    {\n        if (parent != null) {\n            parent.removeChild(this);\n        }\n\n        while (firstComponent != null) {\n            firstComponent.dispose();\n        }\n        disposeChildren();\n    }\n\n    #if debug @:keep #end public function toString () :String\n    {\n        return toStringImpl(\"\");\n    }\n\n    private function toStringImpl (indent :String) :String\n    {\n        var output = \"\";\n        var p = firstComponent;\n        while (p != null) {\n            output += p.name;\n            if (p.next != null) {\n                output += \", \";\n            }\n            p = p.next;\n        }\n        output += \"\\n\";\n\n        // Oof, Haxe doesn't support escaped unicode in string literals\n        var u2514 = String.fromCharCode(0x2514); // └\n        var u241c = String.fromCharCode(0x251c); // ├\n        var u2500 = String.fromCharCode(0x2500); // ─\n        var u2502 = String.fromCharCode(0x2502); // │\n\n        var p = firstChild;\n        while (p != null) {\n            var last = p.next == null;\n            output += indent + (last ? u2514 : u241c) + u2500+u2500+\" \";\n            output += p.toStringImpl(indent + (last ? \" \" : u2502) + \"   \");\n            p = p.next;\n        }\n        return output;\n    }\n\n    // Semi-private helper methods\n#if !display\n    @:extern // Inline even in debug builds\n    inline public function _internal_unsafeCast<A:Component> (component :Component, cl :Class<A>) :A\n    {\n        return cast component;\n    }\n\n    public function _internal_getFromParents<A:Component> (name :String, ?safeCast :Class<A>) :A\n    {\n        var entity = this;\n        do {\n            var component = entity.getComponent(name);\n            if (safeCast != null) {\n                component = Std.instance(component, safeCast);\n            }\n            if (component != null) {\n                return cast component;\n            }\n            entity = entity.parent;\n        } while (entity != null);\n\n        return null; // Not found\n    }\n\n    public function _internal_getFromChildren<A:Component> (name :String, ?safeCast :Class<A>) :A\n    {\n        var component = getComponent(name);\n        if (safeCast != null) {\n            component = Std.instance(component, safeCast);\n        }\n        if (component != null) {\n            return cast component;\n        }\n\n        var child = firstChild;\n        while (child != null) {\n            var component = child._internal_getFromChildren(name, safeCast);\n            if (component != null) {\n                return component;\n            }\n\n            child = child.next;\n        }\n\n        return null; // Not found\n    }\n#end\n\n#if macro\n    // Gets the ClassType from an expression, or aborts if it's not a component class\n    private static function requireComponentType (componentClass :Expr) :ClassType\n    {\n        var path = getClassName(componentClass);\n        if (path != null) {\n            var type = Context.getType(path.join(\".\"));\n            switch (type) {\n            case TInst(ref,_):\n                var cl = ref.get();\n                if (Context.unify(type, Context.getType(\"flambe.Component\")) && cl.superClass != null) {\n                    return cl;\n                }\n            default:\n            }\n        }\n\n        Context.error(\"Expected a class that extends Component, got \" + componentClass.toString(),\n            componentClass.pos);\n        return null;\n    }\n\n    // Gets a class name from a given expression\n    private static function getClassName<A> (componentClass :Expr) :Array<String>\n    {\n        switch (componentClass.expr) {\n        case EConst(CIdent(name)):\n            return [name];\n        case EField(expr, name):\n            var path = getClassName(expr);\n            if (path != null) {\n                path.push(name);\n            }\n            return path;\n        default:\n            return null;\n        }\n    }\n\n    private static function needSafeCast (componentClass :ClassType) :Bool\n    {\n        return !componentClass.superClass.t.get().meta.has(\":componentBase\");\n    }\n#end\n\n    /**\n     * Maps String -> Component. Usually you would use a Haxe Map here, but I'm dropping down to plain\n     * Object/Dictionary for the quickest possible lookups in this critical part of Flambe.\n     */\n    private var _compMap :Dynamic<Component>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.Browser;\nimport js.html.*;\n\nimport flambe.asset.AssetPack;\nimport flambe.asset.Manifest;\nimport flambe.display.Texture;\nimport flambe.subsystem.*;\nimport flambe.util.Assert;\nimport flambe.util.Logger;\nimport flambe.util.Promise;\nimport flambe.util.Signal1;\n\nclass HtmlPlatform\n    implements Platform\n{\n    public static var instance (default, null) :HtmlPlatform = new HtmlPlatform();\n\n    public var mainLoop (default, null) :MainLoop;\n    public var musicPlaying :Bool;\n\n    private function new ()\n    {\n    }\n\n    public function init ()\n    {\n        HtmlUtil.fixAndroidMath();\n\n#if html\n        // If running in a plain web browser, look up the canvas from the embedder\n        var canvas :CanvasElement = null;\n        try {\n            // Use the canvas assigned to us by the flambe.js embedder\n            canvas = (untyped Browser.window).flambe.canvas;\n        } catch (error :Dynamic) {\n        }\n        Assert.that(canvas != null,\n            \"Could not find a Flambe canvas! Are you embedding with flambe.js?\");\n#else\n        // Otherwise create our own\n        var canvas = Browser.document.createCanvasElement();\n        Browser.document.getElementById(\"content\").appendChild(canvas);\n#end\n\n        // Allow the canvas to trap keyboard focus\n        canvas.setAttribute(\"tabindex\", \"0\");\n        // ...but hide the focus rectangle\n        canvas.style.outlineStyle = \"none\";\n        (untyped canvas.style).webkitTapHighlightColor = \"transparent\";\n\n        // Browser optimization hints\n#if !flambe_transparent\n        canvas.setAttribute(\"moz-opaque\", \"true\");\n#end\n        // canvas.style.webkitTransform = \"translateZ(0)\";\n        // canvas.style.backgroundColor = \"#000\";\n\n        _stage = new HtmlStage(canvas);\n        _pointer = new BasicPointer();\n        _mouse = new HtmlMouse(_pointer, canvas);\n\n        _renderer = createRenderer(canvas);\n\n        mainLoop = new MainLoop();\n\n        // Used by browsers that don't support audio very well\n        musicPlaying = false;\n\n        _canvas = canvas;\n        _container = canvas.parentElement;\n        _container.style.overflow = \"hidden\";\n        _container.style.position = \"relative\";\n\n        // Prevent double tap zooming on IE10. Maybe this should be in the MSPointer block below,\n        // but I have no idea without testing, so apply it always\n        // http://msdn.microsoft.com/en-us/library/windows/apps/Hh767313.aspx\n        (untyped _container.style).msTouchAction = \"none\";\n\n        var lastTouchTime = 0;\n        var onMouse = function (event :MouseEvent) {\n            if (event.timeStamp - lastTouchTime < 1000) {\n                // Ignore if there was too recent a touch event, to filter out mouse events emulated\n                // by mobile browsers: http://www.w3.org/TR/touch-events/#mouse-events\n                return;\n            }\n            var bounds = canvas.getBoundingClientRect();\n            var x = getX(event, bounds);\n            var y = getY(event, bounds);\n\n            switch (event.type) {\n            case \"mousedown\":\n                if (event.target == canvas) {\n                    event.preventDefault();\n                    _mouse.submitDown(x, y, event.button);\n                    canvas.focus();\n                }\n\n            case \"mousemove\":\n                _mouse.submitMove(x, y);\n\n            case \"mouseup\":\n                _mouse.submitUp(x, y, event.button);\n\n            case \"mousewheel\", \"DOMMouseScroll\":\n                var velocity = (event.type == \"mousewheel\") ? (untyped event).wheelDelta/40 : -event.detail;\n                if (_mouse.submitScroll(x, y, velocity)) {\n                    // Only prevent page scrolling if the event was handled\n                    event.preventDefault();\n                }\n            }\n        };\n        // Add listeners on the window object so dragging and releasing outside of the canvas works\n        Browser.window.addEventListener(\"mousedown\", onMouse, false);\n        Browser.window.addEventListener(\"mousemove\", onMouse, false);\n        Browser.window.addEventListener(\"mouseup\", onMouse, false);\n\n        // But the wheel listener should only go on the canvas\n        canvas.addEventListener(\"mousewheel\", onMouse, false);\n        canvas.addEventListener(\"DOMMouseScroll\", onMouse, false); // https://bugzil.la/719320\n\n        // Suppress the context menu so right-click events aren't interfered with\n        canvas.addEventListener(\"contextmenu\", function (event) event.preventDefault(), false);\n\n        // Detect touch support. See http://modernizr.github.com/Modernizr/touch.html for more\n        // sophisticated detection methods, but this seems to cover all important browsers\n        var standardTouch :Bool = untyped __js__(\"typeof\")(Browser.window.ontouchstart) != \"undefined\";\n\n        // The pointer event handles mouse movement, touch events, and stylus events.\n        // We check to see if multiple points are supported indicating true touch support.\n        // http://blogs.msdn.com/b/ie/archive/2011/10/19/handling-multi-touch-and-mouse-input-in-all-browsers.aspx\n        var msTouch :Bool = untyped __js__(\"'msMaxTouchPoints' in window.navigator && (window.navigator.msMaxTouchPoints > 1)\");\n\n        if (standardTouch || msTouch) {\n            var basicTouch = new BasicTouch(_pointer, standardTouch ?\n                4 : (untyped Browser.navigator).msMaxTouchPoints);\n            _touch = basicTouch;\n\n            var onTouch = function (event :Dynamic) {\n                var changedTouches :Array<Dynamic> = standardTouch ? event.changedTouches : [event];\n                var bounds = event.target.getBoundingClientRect();\n                lastTouchTime = event.timeStamp;\n\n                switch (event.type) {\n                case \"touchstart\", \"MSPointerDown\", \"pointerdown\":\n                    event.preventDefault();\n                    if (HtmlUtil.SHOULD_HIDE_MOBILE_BROWSER) {\n                        HtmlUtil.hideMobileBrowser();\n                    }\n                    for (touch in changedTouches) {\n                        var x = getX(touch, bounds);\n                        var y = getY(touch, bounds);\n                        var id = Std.int(standardTouch ? touch.identifier : touch.pointerId);\n                        basicTouch.submitDown(id, x, y);\n                    }\n\n                case \"touchmove\", \"MSPointerMove\", \"pointermove\":\n                    event.preventDefault();\n                    for (touch in changedTouches) {\n                        var x = getX(touch, bounds);\n                        var y = getY(touch, bounds);\n                        var id = Std.int(standardTouch ? touch.identifier : touch.pointerId);\n                        basicTouch.submitMove(id, x, y);\n                    }\n\n                case \"touchend\", \"touchcancel\", \"MSPointerUp\", \"pointerup\":\n                    for (touch in changedTouches) {\n                        var x = getX(touch, bounds);\n                        var y = getY(touch, bounds);\n                        var id = Std.int(standardTouch ? touch.identifier : touch.pointerId);\n                        basicTouch.submitUp(id, x, y);\n                    }\n                }\n            };\n\n            if (standardTouch) {\n                canvas.addEventListener(\"touchstart\", onTouch, false);\n                canvas.addEventListener(\"touchmove\", onTouch, false);\n                canvas.addEventListener(\"touchend\", onTouch, false);\n                canvas.addEventListener(\"touchcancel\", onTouch, false);\n            } else {\n                canvas.addEventListener(\"MSPointerDown\", onTouch, false);\n                canvas.addEventListener(\"MSPointerMove\", onTouch, false);\n                canvas.addEventListener(\"MSPointerUp\", onTouch, false);\n            }\n\n        } else {\n            _touch = new DummyTouch();\n        }\n\n        // Handle uncaught errors\n        var oldErrorHandler = (untyped Browser.window).onerror;\n        (untyped Browser.window).onerror = function (message :String, url :String, line :Int) {\n            System.uncaughtError.emit(message);\n            return (oldErrorHandler != null) ? oldErrorHandler(message, url, line) : false;\n        };\n\n        // Handle visibility changes if the browser supports them\n        // http://www.w3.org/TR/page-visibility/\n        var hiddenApi = HtmlUtil.loadExtension(\"hidden\", Browser.document);\n        if (hiddenApi.value != null) {\n            var onVisibilityChanged = function (_) {\n                System.hidden._ = Reflect.field(Browser.document, hiddenApi.field);\n            };\n            onVisibilityChanged(null); // Update now\n            Browser.document.addEventListener(hiddenApi.prefix + \"visibilitychange\",\n                onVisibilityChanged, false);\n        } else {\n            // Adds some lock screen support for iOS, possibly other devices that don't support the\n            // page visibility api.\n            var onPageTransitionChange = function (event) {\n                System.hidden._ = (event.type == \"pagehide\");\n            };\n            Browser.window.addEventListener(\"pageshow\", onPageTransitionChange, false);\n            Browser.window.addEventListener(\"pagehide\", onPageTransitionChange, false);\n        }\n\n        // Skip the next frame when coming back from being hidden\n        System.hidden.changed.connect(function (hidden,_) {\n            if (!hidden) {\n                _skipFrame = true;\n            }\n        });\n        _skipFrame = false;\n\n        _lastUpdate = HtmlUtil.now();\n\n        // Use requestAnimationFrame if available, otherwise a 60 FPS setInterval\n        // https://developer.mozilla.org/en/DOM/window.mozRequestAnimationFrame\n        var requestAnimationFrame = HtmlUtil.loadExtension(\"requestAnimationFrame\").value;\n        if (requestAnimationFrame != null) {\n            // Use the high resolution, monotonic timer if available\n            // http://www.w3.org/TR/hr-time/\n            var performance :Performance = Browser.window.performance;\n            var hasPerfNow = (performance != null) && HtmlUtil.polyfill(\"now\", performance);\n\n            if (hasPerfNow) {\n                // performance.now is relative to navigationStart, rather than a timestamp\n                _lastUpdate = performance.now();\n            } else {\n                Log.warn(\"No monotonic timer support, falling back to the system date\");\n            }\n\n            var updateFrame = null;\n            updateFrame = function (now :Float) {\n                update(hasPerfNow ? performance.now() : now);\n                requestAnimationFrame(updateFrame, canvas);\n            };\n            requestAnimationFrame(updateFrame, canvas);\n\n        } else {\n            Log.warn(\"No requestAnimationFrame support, falling back to setInterval\");\n            Browser.window.setInterval(function () {\n                update(HtmlUtil.now());\n            }, 16); // ~60 FPS\n        }\n\n#if debug\n        new DebugLogic(this);\n#if html\n        _catapult = HtmlCatapultClient.canUse() ? new HtmlCatapultClient() : null;\n#end\n#end\n        Log.info(\"Initialized HTML platform\", [\"renderer\", _renderer.type]);\n    }\n\n    public function loadAssetPack (manifest :Manifest) :Promise<AssetPack>\n    {\n        return new HtmlAssetPackLoader(this, manifest).promise;\n    }\n\n    public function getStage () :StageSystem\n    {\n        return _stage;\n    }\n\n    public function getStorage () :StorageSystem\n    {\n        if (_storage == null) {\n            // Safely access localStorage (browsers may throw an error on direct access)\n            // http://dev.w3.org/html5/webstorage/#dom-localstorage\n            var localStorage = Browser.getLocalStorage();\n            if (localStorage != null) {\n                _storage = new HtmlStorage(localStorage);\n            } else {\n                Log.warn(\"localStorage is unavailable, falling back to unpersisted storage\");\n                _storage = new DummyStorage();\n            }\n        }\n        return _storage;\n    }\n\n    public function getLocale () :String\n    {\n        // https://developer.mozilla.org/en-US/docs/DOM/window.navigator.language\n        var locale = Browser.navigator.language;\n        if (locale == null) {\n            // IE uses the non-standard userLanguage (or browserLanguage or systemLanguage, but\n            // userLanguage seems to match String's locale-aware methods)\n            locale = (untyped Browser.navigator).userLanguage;\n        }\n        return locale;\n    }\n\n    public function createLogHandler (tag :String) :LogHandler\n    {\n#if (debug || flambe_keep_logs)\n        if (HtmlLogHandler.isSupported()) {\n            return new HtmlLogHandler(tag);\n        }\n#end\n        return null;\n    }\n\n    public function getTime () :Float\n    {\n        return HtmlUtil.now() / 1000;\n    }\n\n    public function getCatapultClient ()\n    {\n        return _catapult;\n    }\n\n    private function update (now :Float)\n    {\n        var dt = (now-_lastUpdate) / 1000;\n        _lastUpdate = now;\n\n        if (System.hidden._) {\n            return; // Prevent updates while hidden\n        }\n        if (_skipFrame) {\n            _skipFrame = false;\n            return;\n        }\n\n        mainLoop.update(dt);\n        mainLoop.render(_renderer);\n    }\n\n    public function getPointer () :PointerSystem\n    {\n        return _pointer;\n    }\n\n    public function getMouse () :MouseSystem\n    {\n        return _mouse;\n    }\n\n    public function getTouch () :TouchSystem\n    {\n        return _touch;\n    }\n\n    public function getKeyboard () :KeyboardSystem\n    {\n        if (_keyboard == null) {\n            _keyboard = new BasicKeyboard();\n            var onKey = function (event :KeyboardEvent) {\n                switch (event.type) {\n                case \"keydown\":\n                    if (_keyboard.submitDown(event.keyCode)) {\n                        event.preventDefault();\n                    }\n                case \"keyup\":\n                    _keyboard.submitUp(event.keyCode);\n                }\n            };\n            _canvas.addEventListener(\"keydown\", onKey, false);\n            _canvas.addEventListener(\"keyup\", onKey, false);\n        }\n        return _keyboard;\n    }\n\n    public function getWeb () :WebSystem\n    {\n        if (_web == null) {\n            _web = new HtmlWeb(_container);\n        }\n        return _web;\n    }\n\n    public function getExternal () :ExternalSystem\n    {\n        if (_external == null) {\n            _external = new HtmlExternal();\n        }\n        return _external;\n    }\n\n    public function getMotion () :MotionSystem\n    {\n        if (_motion == null) {\n            _motion = new HtmlMotion();\n        }\n        return _motion;\n    }\n\n    public function getRenderer () :InternalRenderer<Dynamic>\n    {\n        return _renderer;\n    }\n\n    private function getX (event :Dynamic, bounds :Dynamic) :Float\n    {\n        return (event.clientX - bounds.left)*_stage.width/bounds.width;\n    }\n\n    private function getY (event :Dynamic, bounds :Dynamic) :Float\n    {\n        return (event.clientY - bounds.top)*_stage.height/bounds.height;\n    }\n\n    private function createRenderer (canvas :CanvasElement) :InternalRenderer<Dynamic>\n    {\n#if !flambe_disable_webgl\n\n#if firefox\n        // WebGL is buggy in Firefox OS 1.1, so blacklist it there\n        // https://developer.mozilla.org/en-US/docs/Gecko_user_agent_string_reference#Firefox_OS\n        var majorVersion = ~/\\bFirefox\\/(\\d+)/;\n        if (!majorVersion.match(Browser.navigator.userAgent) || Std.parseInt(majorVersion.matched(1)) >= 26)\n#end\n        try {\n            var gl = canvas.getContextWebGL(cast {\n#if !flambe_transparent\n                alpha: false,\n#end\n                depth: false,\n                // http://blog.tojicode.com/2013/12/failifmajorperformancecaveat-with-great.html\n                failIfMajorPerformanceCaveat: true,\n            });\n            if (gl != null) {\n#if !flambe_disable_canvas\n                // TODO(bruno): Remove this check once failIfMajorPerformanceCaveat becomes\n                // prevalent\n                if (HtmlUtil.detectSlowDriver(gl)) {\n                    Log.warn(\"Detected a slow WebGL driver, falling back to canvas\");\n                } else\n#end\n                return new WebGLRenderer(_stage, gl);\n            }\n        } catch (_ :Dynamic) {\n            // Getting the WebGL context blows up on some (headless?) systems\n        }\n#end\n\n#if !flambe_disable_canvas\n        // No WebGL, fall back to canvas\n        return new CanvasRenderer(canvas);\n#end\n\n#if (flambe_disable_webgl && flambe_disable_canvas)\n#error \"Build with either flambe_disable_webgl or flambe_disable_canvas, not both!\"\n#end\n        Log.error(\"No renderer available!\");\n        return null;\n    }\n\n    // Statically initialized subsystems\n    private var _mouse :HtmlMouse;\n    private var _pointer :BasicPointer;\n    private var _renderer :InternalRenderer<Dynamic>;\n    private var _stage :HtmlStage;\n    private var _touch :TouchSystem;\n\n    // Lazily initialized subsystems\n    private var _external :ExternalSystem;\n    private var _keyboard :BasicKeyboard;\n    private var _motion :MotionSystem;\n    private var _storage :StorageSystem;\n    private var _web :WebSystem;\n\n    private var _canvas :CanvasElement;\n    private var _container :Element;\n\n    private var _lastUpdate :Float;\n    private var _skipFrame :Bool;\n\n    private var _catapult :HtmlCatapultClient;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\nimport flambe.util.Signal2;\n\n/**\n * Wraps a single value, notifying listeners when the value changes.\n */\n#if !js\n@:generic // Generate typed templates on static targets\n#end\nclass Value<A>\n{\n    /**\n     * The wrapped value, setting this to a different value will fire the `changed` signal.\n     */\n    public var _ (get, set) :A;\n\n    /**\n     * Emitted when the value has changed. The first listener parameter is the new current value,\n     * the second parameter is the old previous value.\n     */\n    public var changed (get, null) :Signal2<A,A>;\n\n    public function new (value :A, ?listener :Listener2<A,A>)\n    {\n        _value = value;\n        _changed = (listener != null) ? new Signal2(listener) : null;\n    }\n\n    /**\n     * Immediately calls a listener with the current value, and again whenever the value changes.\n     * @returns A handle that can be disposed to stop watching for changes.\n     */\n    public function watch (listener :Listener2<A,A>) :Disposable\n    {\n        listener(_value, _value);\n        return changed.connect(listener);\n    }\n\n    inline private function get__ () :A\n    {\n        return _value;\n    }\n\n    private function set__ (newValue :A) :A\n    {\n        var oldValue = _value;\n        if (newValue != oldValue) {\n            _value = newValue;\n            if (_changed != null) {\n                _changed.emit(newValue, oldValue);\n            }\n        }\n        return newValue;\n    }\n\n    private function get_changed ()\n    {\n        if (_changed == null) {\n            _changed = new Signal2();\n        }\n        return _changed;\n    }\n\n    #if debug @:keep #end public function toString () :String\n    {\n        return \"\"+_value;\n    }\n\n    private var _value :A;\n    private var _changed :Signal2<A,A>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\n/**\n * Represents a connected signal listener.\n */\nclass SignalConnection\n    implements Disposable\n{\n    /**\n     * True if the listener will remain connected after being used.\n     */\n    public var stayInList (default, null) :Bool;\n\n    @:allow(flambe) function new (signal :SignalBase, listener :Dynamic)\n    {\n        _signal = signal;\n        _listener = listener;\n        stayInList = true;\n    }\n\n    /**\n     * Tells the connection to dispose itself after being used once.\n     * @returns This instance, for chaining.\n     */\n    public function once ()\n    {\n        stayInList = false;\n        return this;\n    }\n\n    /**\n     * Disconnects the listener from the signal.\n     */\n    public function dispose ()\n    {\n        if (_signal != null) {\n            _signal.disconnect(this);\n            _signal = null;\n        }\n    }\n\n    @:allow(flambe) var _next :SignalConnection = null;\n\n    @:allow(flambe) var _listener :Dynamic;\n    private var _signal :SignalBase;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\nclass SignalBase\n{\n    private function new (listener :Dynamic)\n    {\n        _head = (listener != null) ? new SignalConnection(this, listener) : null;\n        _deferredTasks = null;\n    }\n\n    /**\n     * Whether this signal has at least one listener.\n     */\n    inline public function hasListeners () :Bool\n    {\n        return _head != null;\n    }\n\n    private function connectImpl (listener :Dynamic, prioritize :Bool) :SignalConnection\n    {\n        var conn = new SignalConnection(this, listener);\n        if (dispatching()) {\n            defer(function () {\n                listAdd(conn, prioritize);\n            });\n        } else {\n            listAdd(conn, prioritize);\n        }\n        return conn;\n    }\n\n    @:allow(flambe) function disconnect (conn :SignalConnection)\n    {\n        if (dispatching()) {\n            defer(function () {\n                listRemove(conn);\n            });\n        } else {\n            listRemove(conn);\n        }\n    }\n\n    private function defer (fn :Void->Void)\n    {\n        var tail = null, p = _deferredTasks;\n        while (p != null) {\n            tail = p;\n            p = p.next;\n        }\n\n        var task = new Task(fn);\n        if (tail != null) {\n            tail.next = task;\n        } else {\n            _deferredTasks = task;\n        }\n    }\n\n    private function willEmit () :SignalConnection\n    {\n        // Should never happen, since the public emit methods will defer, but just in case...\n        Assert.that(!dispatching());\n\n        var snapshot = _head;\n        _head = DISPATCHING_SENTINEL;\n        return snapshot;\n    }\n\n    private function didEmit (head :SignalConnection)\n    {\n        _head = head;\n\n        var snapshot = _deferredTasks;\n        _deferredTasks = null;\n        while (snapshot != null) {\n            snapshot.fn();\n            snapshot = snapshot.next;\n        }\n    }\n\n    private function listAdd (conn :SignalConnection, prioritize :Bool)\n    {\n        if (prioritize) {\n            // Prepend it to the beginning of the list\n            conn._next = _head;\n            _head = conn;\n        } else {\n            // Append it to the end of the list\n            var tail = null, p = _head;\n            while (p != null) {\n                tail = p;\n                p = p._next;\n            }\n            if (tail != null) {\n                tail._next = conn;\n            } else {\n                _head = conn;\n            }\n        }\n    }\n\n    private function listRemove (conn :SignalConnection)\n    {\n        var prev :SignalConnection = null, p = _head;\n        while (p != null) {\n            if (p == conn) {\n                // Splice out p\n                var next = p._next;\n                if (prev == null) {\n                    _head = next;\n                } else {\n                    prev._next = next;\n                }\n                return;\n            }\n            prev = p;\n            p = p._next;\n        }\n    }\n\n    inline private function dispatching () :Bool\n    {\n        return _head == DISPATCHING_SENTINEL;\n    }\n\n    private static var DISPATCHING_SENTINEL = new SignalConnection(null, null);\n\n    private var _head :SignalConnection;\n    private var _deferredTasks :Task;\n}\n\nprivate class Task\n{\n    public var fn :Void->Void;\n    public var next :Task = null;\n\n    public function new (fn :Void->Void)\n    {\n        this.fn = fn;\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\n/**\n * An alias for Signal2 listeners.\n */\ntypedef Listener2<A,B> = A -> B -> Void;\n\n/**\n * A two-argument signal. See Signal0 and Signal1 for different arities.\n */\nclass Signal2<A,B> extends SignalBase\n{\n    /**\n     * @param listener An optional listener to immediately connect to the signal.\n     */\n    public function new (?listener :Listener2<A,B>)\n    {\n        super(listener);\n    }\n\n    /**\n     * Connects a listener to this signal.\n     * @param prioritize True if this listener should fire before others.\n     * @returns A SignalConnection, that can be disposed to remove the listener.\n     */\n    public function connect (listener :Listener2<A,B>, prioritize :Bool = false) :SignalConnection\n    {\n        return connectImpl(listener, prioritize);\n    }\n\n    /**\n     * Emit the signal, notifying each connected listener.\n     */\n    public function emit (arg1 :A, arg2 :B)\n    {\n        if (dispatching()) {\n            defer(function () {\n                emitImpl(arg1, arg2);\n            });\n        } else {\n            emitImpl(arg1, arg2);\n        }\n    }\n\n    private function emitImpl (arg1 :A, arg2 :B)\n    {\n        var head = willEmit();\n        var p = head;\n        while (p != null) {\n            p._listener(arg1, arg2);\n            if (!p.stayInList) {\n                p.dispose();\n            }\n            p = p._next;\n        }\n        didEmit(head);\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\n/**\n * An alias for Signal1 listeners.\n */\ntypedef Listener1<A> = A -> Void;\n\n/**\n * A one-argument signal. See Signal0 and Signal2 for different arities.\n */\nclass Signal1<A> extends SignalBase\n{\n    /**\n     * @param listener An optional listener to immediately connect to the signal.\n     */\n    public function new (?listener :Listener1<A>)\n    {\n        super(listener);\n    }\n\n    /**\n     * Connects a listener to this signal.\n     * @param prioritize True if this listener should fire before others.\n     * @returns A SignalConnection, that can be disposed to remove the listener.\n     */\n    public function connect (listener :Listener1<A>, prioritize :Bool = false) :SignalConnection\n    {\n        return connectImpl(listener, prioritize);\n    }\n\n    /**\n     * Emit the signal, notifying each connected listener.\n     */\n    public function emit (arg1 :A)\n    {\n        if (dispatching()) {\n            defer(function () {\n                emitImpl(arg1);\n            });\n        } else {\n            emitImpl(arg1);\n        }\n    }\n\n    private function emitImpl (arg1 :A)\n    {\n        var head = willEmit();\n        var p = head;\n        while (p != null) {\n            p._listener(arg1);\n            if (!p.stayInList) {\n                p.dispose();\n            }\n            p = p._next;\n        }\n        didEmit(head);\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.animation;\n\nimport flambe.animation.Binding;\nimport flambe.animation.Ease;\nimport flambe.util.Signal2;\nimport flambe.util.Value;\n\n/**\n * A Float value that may be animated over time.\n */\nclass AnimatedFloat extends Value<Float>\n{\n    /**\n     * The behavior that is currently animating the value, or null if the value is not being\n     * animated.\n     */\n    public var behavior (get, set) :Behavior;\n\n    public function new (value :Float, ?listener :Listener2<Float,Float>)\n    {\n        super(value, listener);\n    }\n\n    override private function set__ (value :Float) :Float\n    {\n        _behavior = null;\n        return super.set__(value);\n    }\n\n    public function update (dt :Float)\n    {\n        if (_behavior != null) {\n            super.set__(_behavior.update(dt));\n            if (_behavior.isComplete()) {\n                _behavior = null;\n            }\n        }\n    }\n\n    /**\n     * Animates between the two given values.\n     *\n     * @param from The initial value.\n     * @param to The target value.\n     * @param seconds The animation duration, in seconds.\n     * @param easing The easing function to use, defaults to `Ease.linear`.\n     */\n    public function animate (from :Float, to :Float, seconds :Float, ?easing :EaseFunction)\n    {\n        set__(from);\n        animateTo(to, seconds, easing);\n    }\n\n    /**\n     * Animates between the current value and the given value.\n     *\n     * @param to The target value.\n     * @param seconds The animation duration, in seconds.\n     * @param easing The easing function to use, defaults to `Ease.linear`.\n     */\n    public function animateTo (to :Float, seconds :Float, ?easing :EaseFunction)\n    {\n        behavior = new Tween(_value, to, seconds, easing);\n    }\n\n    /**\n     * Animates the current value by the given delta.\n     *\n     * @param by The delta added to the current value to get the target value.\n     * @param seconds The animation duration, in seconds.\n     * @param easing The easing function to use, defaults to `Ease.linear`.\n     */\n    public function animateBy (by :Float, seconds :Float, ?easing :EaseFunction)\n    {\n        behavior = new Tween(_value, _value + by, seconds, easing);\n    }\n\n    inline public function bindTo (to :Value<Float>, ?fn :BindingFunction)\n    {\n        behavior = new Binding(to, fn);\n    }\n\n    private function set_behavior (behavior :Behavior) :Behavior\n    {\n        _behavior = behavior;\n        update(0);\n        return behavior;\n    }\n\n    inline private function get_behavior () :Behavior\n    {\n        return _behavior;\n    }\n\n    private var _behavior :Behavior = null;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe;\n\nimport flambe.animation.AnimatedFloat;\nimport flambe.asset.AssetPack;\nimport flambe.asset.Manifest;\nimport flambe.display.Texture;\nimport flambe.platform.Platform;\nimport flambe.subsystem.ExternalSystem; // IDEA doesn't support wildcard imports\nimport flambe.subsystem.KeyboardSystem;\nimport flambe.subsystem.MotionSystem;\nimport flambe.subsystem.MouseSystem;\nimport flambe.subsystem.PointerSystem;\nimport flambe.subsystem.RendererSystem;\nimport flambe.subsystem.StageSystem;\nimport flambe.subsystem.StorageSystem;\nimport flambe.subsystem.TouchSystem;\nimport flambe.subsystem.WebSystem;\nimport flambe.util.Assert;\nimport flambe.util.Logger;\nimport flambe.util.Promise;\nimport flambe.util.Signal1;\nimport flambe.util.Value;\n\n/**\n * Provides access to all the different subsystems implemented on each platform.\n */\nclass System\n{\n    /**\n     * The entity at the root of the hierarchy.\n     */\n    public static var root (default, null) :Entity = new Entity();\n\n    /**\n     * The Stage subsystem, for controlling the display viewport.\n     */\n    public static var stage (get, null) :StageSystem;\n\n    /**\n     * The Storage subsystem, for persisting values.\n     */\n    public static var storage (get, null) :StorageSystem;\n\n    /**\n     * The Pointer subsystem, for unified mouse/touch events.\n     */\n    public static var pointer (get, null) :PointerSystem;\n\n    /**\n     * The Mouse subsystem, for direct access to the mouse.\n     */\n    public static var mouse (get, null) :MouseSystem;\n\n    /**\n     * The Touch subsystem, for direct access to the multi-touch.\n     */\n    public static var touch (get, null) :TouchSystem;\n\n    /**\n     * The Keyboard subsystem, for keyboard events.\n     */\n    public static var keyboard (get, null) :KeyboardSystem;\n\n    /**\n     * The Web subsystem, for using the device's web browser.\n     */\n    public static var web (get, null) :WebSystem;\n\n    /**\n     * The External subsystem, for interaction with external code.\n     */\n    public static var external (get, null) :ExternalSystem;\n\n    /**\n     * The Motion subsystem, for events from the device's motion sensors.\n     */\n    public static var motion (get, null) :MotionSystem;\n\n    /**\n     * The Renderer subsystem, for creating textures and accessing the GPU.\n     */\n    public static var renderer (get, null) :RendererSystem<\n#if flash\n        flash.display.BitmapData\n#elseif js\n        js.html.Element\n#end\n    >;\n\n    // TODO(bruno): Subsystems for gamepads, haptic, geolocation, video, textInput\n\n    /**\n     * Gets the RFC 4646 language tag of the environment. For example, \"en-US\", \"pt\", or null if the\n     * locale is unknown.\n     */\n    public static var locale (get, null) :String;\n\n    /**\n     * Emitted when an uncaught exception occurs, if the platform supports it.\n     */\n    public static var uncaughtError (default, null) :Signal1<String> = new Signal1<String>();\n\n    /**\n     * True when the app is not currently visible, such as when minimized or placed in a background\n     * browser tab. While hidden, frame updates may be paused or throttled.\n     */\n    public static var hidden (default, null) :Value<Bool> = new Value<Bool>(false);\n\n    /**\n     * Gets the current clock time, in <b>seconds</b> since January 1, 1970. Depending on the\n     * platform, this may be slightly more efficient than Date.now().getTime().\n     */\n    public static var time (get, null) :Float;\n\n    /**\n     * The global volume applied to all sounds, defaults to 1.\n     */\n    public static var volume (default, null) :AnimatedFloat = new AnimatedFloat(1);\n\n    /**\n     * Starts up Flambe, this should usually be the first thing a game does.\n     */\n    public static function init ()\n    {\n        if (!_calledInit) {\n            _platform.init();\n            _calledInit = true;\n        }\n    }\n\n    /**\n     * Request to load an asset pack described by the given manifest.\n     */\n    inline public static function loadAssetPack (manifest :Manifest) :Promise<AssetPack>\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.loadAssetPack(manifest);\n    }\n\n    /**\n     * Creates a Logger for printing debug messages. In Flash, this uses the native trace()\n     * function. In JS, logging goes to the console object. Logging is stripped from non-debug\n     * builds.\n     */\n    inline public static function createLogger (tag :String) :Logger\n    {\n        // No need to assertCalledInit here, this should be callable from static initializers\n        return new Logger(_platform.createLogHandler(tag));\n    }\n\n    inline private static function get_time () :Float\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getTime();\n    }\n\n    inline private static function get_stage () :StageSystem\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getStage();\n    }\n\n    inline private static function get_storage () :StorageSystem\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getStorage();\n    }\n\n    inline private static function get_pointer () :PointerSystem\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getPointer();\n    }\n\n    inline private static function get_mouse () :MouseSystem\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getMouse();\n    }\n\n    inline private static function get_touch () :TouchSystem\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getTouch();\n    }\n\n    inline private static function get_keyboard () :KeyboardSystem\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getKeyboard();\n    }\n\n    inline private static function get_web () :WebSystem\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getWeb();\n    }\n\n    inline private static function get_external () :ExternalSystem\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getExternal();\n    }\n\n    inline private static function get_locale () :String\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getLocale();\n    }\n\n    inline static function get_motion () :MotionSystem\n    {\n        #if debug assertCalledInit(); #end\n        return _platform.getMotion();\n    }\n\n    inline static function get_renderer () // inferred return type\n    {\n        #if debug assertCalledInit(); #end\n        return cast _platform.getRenderer();\n    }\n\n    private static function assertCalledInit ()\n    {\n        Assert.that(_calledInit, \"You must call System.init() first\");\n    }\n\n    private static var _platform :Platform =\n#if flash\n        flambe.platform.flash.FlashPlatform.instance;\n#elseif (html || firefox)\n        flambe.platform.html.HtmlPlatform.instance;\n#else\n        null;\n#end\n\n    private static var _calledInit = false;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\nusing flambe.util.Strings;\n\n/**\n * Represents the severity of a log message.\n */\nenum LogLevel {\n    /** General helpful information. */\n    Info;\n\n    /** An unexpected but recoverable problem. */\n    Warn;\n\n    /** A fatal, unrecoverable problem. */\n    Error;\n}\n\ninterface LogHandler\n{\n    function log (level :LogLevel, message :String) :Void;\n}\n\n/**\n * A logging system, for printing formatted debug messages. Logging is stripped from release builds,\n * unless the `-D flambe_keep_logs` compiler flag is used.\n *\n * ```haxe\n * var log = System.createLogger(\"mygame\");\n * log.info(\"Player logged in\", [\"name\", \"Joe\", \"level\", 24]);\n * // Logs \"INFO mygame: Player logged in [name=Joe, level=24]\"\n * ```\n *\n * See `PackageLog` for a handy way to setup logging across a whole project.\n */\nclass Logger\n{\n    /**\n     * @param handler The handler that logs will be sent to for printing.\n     */\n    public function new (handler :LogHandler)\n    {\n        _handler = handler;\n    }\n\n#if (debug || flambe_keep_logs)\n    /**\n     * Logs a message at the `Info` severity level.\n     *\n     * @param text The message to log.\n     * @param fields Extra information to be formatted with `Strings.withFields`.\n     */\n    public function info (?text :String, ?fields :Array<Dynamic>)\n    {\n        log(Info, text, fields);\n    }\n\n    /**\n     * Logs a message at the `Warn` severity level.\n     *\n     * @param text The message to log.\n     * @param fields Extra information to be formatted with `Strings.withFields`.\n     */\n    public function warn (?text :String, ?fields :Array<Dynamic>)\n    {\n        log(Warn, text, fields);\n    }\n\n    /**\n     * Logs a message at the `Error` severity level.\n     *\n     * @param text The message to log.\n     * @param fields Extra information to be formatted with `Strings.withFields`.\n     */\n    public function error (?text :String, ?fields :Array<Dynamic>)\n    {\n        log(Error, text, fields);\n    }\n\n    /**\n     * Logs a message at the given severity level.\n     *\n     * @param level The severity of the log message.\n     * @param text The message to log.\n     * @param fields Extra information to be formatted with `Strings.withFields`.\n     */\n    public function log (level :LogLevel, ?text :String, ?fields :Array<Dynamic>)\n    {\n        if (_handler == null) {\n            return; // No handler, carry on quietly\n        }\n        if (text == null) {\n            text = \"\";\n        }\n        if (fields != null) {\n            text = text.withFields(fields);\n        }\n        _handler.log(level, text);\n    }\n\n#else\n    // In release builds, logging calls are stripped out\n    inline public function info (?text :String, ?fields :Array<Dynamic>) {}\n    inline public function warn (?text :String, ?fields :Array<Dynamic>) {}\n    inline public function error (?text :String, ?fields :Array<Dynamic>) {}\n    inline public function log (level :LogLevel, ?text :String, ?fields :Array<Dynamic>) {}\n#end\n\n    private var _handler :LogHandler;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\n#if macro\nimport haxe.macro.Context;\nimport haxe.macro.Expr;\nimport haxe.macro.Type;\n\nimport flambe.util.Logger;\n\n#else\n\n/**\n * Classes that extend PackageLog will have static logging methods generated for them. The methods\n * correspond to the methods in `Logger`.\n *\n * Creating a class that extends PackageLog at the base of your project is a convenient way to\n * include logging across a whole codebase. The package name is used as the log tag.\n *\n * ```haxe\n * // In src/foobar/Log.hx\n * class Log extends PackageLog {}\n *\n * // In src/foobar/something/deeper/Widget.hx\n * // (Importing foobar.Log is not needed, as Haxe automatically imports classes in parent directories)\n * Log.info(\"Hello world\"); // Logs \"foobar: Hello world\"\n * ```\n */\n@:autoBuild(flambe.util.PackageLog.build())\n#end\nclass PackageLog\n{\n#if macro\n    public static function build () :Array<Field>\n    {\n        var pos = Context.currentPos();\n        var cl = Context.getLocalClass().get();\n\n        var tag = Context.makeExpr(cl.pack.join(\".\"), pos);\n        var logger = Context.defined(\"flambe-server\")\n            ? macro flambe.server.Node.createLogger($tag)\n            : macro flambe.System.createLogger($tag);\n\n        return Macros.buildFields(macro {\n            var public__static__logger :flambe.util.Logger = $logger;\n\n            function inline__public__static__info (?text :String, ?args :Array<Dynamic>) {\n                logger.info(text, args);\n            }\n\n            function inline__public__static__warn (?text :String, ?args :Array<Dynamic>) {\n                logger.warn(text, args);\n            }\n\n            function inline__public__static__error (?text :String, ?args :Array<Dynamic>) {\n                logger.error(text, args);\n            }\n\n            function inline__public__static__log (level :flambe.util.Logger.LogLevel,\n                    ?text :String, ?args :Array<Dynamic>) {\n                logger.log(level, text, args);\n            }\n        }).concat(Context.getBuildFields());\n    }\n#end\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe;\n\nimport flambe.animation.AnimatedFloat;\n\n/**\n * Adjusts the update speed of an entity (and its components and children). Can be used for slow\n * motion and fast forward effects.\n */\nclass SpeedAdjuster extends Component\n{\n    /**\n     * The scale that time should pass for the owning entity and its children. Values lower than\n     * 1.0 will play slower than realtime, and values higher than 1.0 will play faster. When the\n     * scale is 0, the entity is basically paused.\n     */\n    public var scale (default, null) :AnimatedFloat;\n\n    public function new (scale :Float = 1)\n    {\n        this.scale = new AnimatedFloat(scale);\n    }\n\n    // Note that this may be called by MainLoop before onStarted!\n    override public function onUpdate (dt :Float)\n    {\n        // Ensure this component is immune to its own time scaling\n        if (_realDt > 0) {\n            dt = _realDt;\n            _realDt = 0;\n        }\n\n        scale.update(dt);\n    }\n\n    @:allow(flambe) var _realDt :Float = 0;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport haxe.macro.Expr;\nimport haxe.macro.Context;\nimport haxe.macro.Type;\n\nimport flambe.util.Macros;\n\nusing Lambda;\nusing flambe.util.Iterables;\n\nclass ComponentBuilder\n{\n    public static function build () :Array<Field>\n    {\n        var pos = Context.currentPos();\n        var cl = Context.getLocalClass().get();\n\n        var name = Context.makeExpr(getComponentName(cl), pos);\n        var componentType = TPath({pack: cl.pack, name: cl.name, params: []});\n\n        var fields = Macros.buildFields(macro {\n            #if doc @:noDoc #end\n            var public__static__inline__NAME = $name;\n        });\n\n        // Only override get_name if this component directly extends a @:componentBase and creates a\n        // new namespace\n        if (extendsComponentBase(cl)) {\n            fields = fields.concat(Macros.buildFields(macro {\n                function override__private__get_name () :String {\n                    return $name;\n                }\n            }));\n        }\n\n        return fields.concat(Context.getBuildFields());\n    }\n\n    private static function getComponentName (cl :ClassType) :String\n    {\n        // Traverse up to the last non-component base\n        while (true) {\n            if (extendsComponentBase(cl)) {\n                break;\n            }\n            cl = cl.superClass.t.get();\n        }\n\n        // Look up the ID, otherwise generate one\n        var fullName = cl.pack.concat([cl.name]).join(\".\");\n        var name = _nameCache.get(fullName);\n        if (name == null) {\n            name = cl.name + \"_\" + _nextId;\n            _nameCache.set(fullName, name);\n            ++_nextId;\n        }\n\n        return name;\n    }\n\n    private static function extendsComponentBase (cl :ClassType)\n    {\n        var superClass = cl.superClass.t.get();\n        return superClass.meta.has(\":componentBase\");\n    }\n\n    private static var _nameCache = new Map<String,String>();\n    private static var _nextId = 0;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.asset;\n\nusing flambe.util.Strings;\n\n/** Specifies all supported asset formats across all Flambe platforms. */\nenum AssetFormat\n{\n    // Images\n    WEBP; JXR; PNG; JPG; GIF;\n\n    // Compressed textures\n    DDS; PVR; PKM;\n\n    // Audio\n    MP3; M4A; OPUS; OGG; WAV;\n\n    // Raw text/data\n    Data;\n}\n\n/**\n * Defines an asset that will be loaded.\n */\nclass AssetEntry\n{\n    /**\n     * The name of this asset.\n     */\n    public var name (default, null) :String;\n\n    /**\n     * The URL or file path this asset will be loaded from. Will be appended to `Manifest.localBase`\n     * or `Manifest.remoteBase` to get the actual URL to load from.\n     */\n    public var url (default, null) :String;\n\n    /**\n     * The format this asset will be loaded as.\n     */\n    public var format (default, null) :AssetFormat;\n\n    /**\n     * The size of this asset in bytes, or 0 if unknown.\n     */\n    public var bytes (default, null) :Int;\n\n    public function new (name :String, url :String, format :AssetFormat, bytes :Int)\n    {\n        this.name = name;\n        this.url = url;\n        this.format = format;\n        this.bytes = bytes;\n    }\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nimport js.html.Storage;\nimport js.html.XMLHttpRequest;\n\nclass Browser {\n\t/** The global window object. */\n\tpublic static var window(get, never):js.html.Window;\n\tinline static function get_window() return untyped __js__(\"window\");\n\n\t/** Shortcut to Window.document. */\n\tpublic static var document(get, never):js.html.HTMLDocument;\n\tinline static function get_document() return untyped __js__(\"window.document\");\n\n\t/** Shortcut to Window.location. */\n\tpublic static var location(get, never):js.html.Location;\n\tinline static function get_location() return untyped __js__(\"window.location\");\n\n\t/** Shortcut to Window.navigator. */\n\tpublic static var navigator(get, never):js.html.Navigator;\n\tinline static function get_navigator() return untyped __js__(\"window.navigator\");\n\n\t/** Shortcut to Window.console. */\n\tpublic static var console(get, never):js.html.Console;\n\tinline static function get_console() return untyped __js__(\"window.console\");\n\n\t/**\n\t * True if a window object exists, false otherwise.\n\t *\n\t * This can be used to check if the code is being executed in a non-browser\n\t * environment such as node.js.\n\t */\n\tpublic static var supported(get, never):Bool;\n\tinline static function get_supported() return untyped __typeof__(window) != \"undefined\";\n\n\t/**\n\t * Safely gets the browser's local storage, or returns null if localStorage is unsupported or\n\t * disabled.\n\t */\n\tpublic static function getLocalStorage() : Storage\n\t{\n\t\ttry {\n\t\t\tvar s = window.localStorage;\n\t\t\ts.getItem(\"\");\n\t\t\treturn s;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Safely gets the browser's session storage, or returns null if sessionStorage is unsupported\n\t * or disabled.\n\t */\n\tpublic static function getSessionStorage() : Storage\n\t{\n\t\ttry {\n\t\t\tvar s = window.sessionStorage;\n\t\t\ts.getItem(\"\");\n\t\t\treturn s;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Creates an XMLHttpRequest, with a fallback to ActiveXObject for ancient versions of Internet\n\t * Explorer.\n\t */\n\tpublic static function createXMLHttpRequest() : XMLHttpRequest\n\t{\n\t\tif( untyped __js__(\"typeof XMLHttpRequest\") != \"undefined\" ) {\n\t\t\treturn new XMLHttpRequest();\n\t\t}\n\t\tif( untyped __js__(\"typeof ActiveXObject\") != \"undefined\" ) {\n\t\t\treturn untyped __new__(\"ActiveXObject\",\"Microsoft.XMLHTTP\");\n\t\t}\n\t\tthrow \"Unable to create XMLHttpRequest object.\";\n\t}\n\n\t/**\n\t\tDisplay an alert message box containing the given message. See also `Window.alert()`.\n\t**/\n\tpublic static function alert( v : Dynamic ) {\n\t\t@:privateAccess window.alert(Boot.__string_rec(v,\"\"));\n\t}\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.asset;\n\nimport haxe.rtti.Meta;\n\nimport flambe.asset.AssetEntry;\nimport flambe.util.Assert;\n\nusing StringTools;\nusing flambe.util.Strings;\n\n/**\n * An asset manifest contains all the information needed to load an asset pack. A manifest is\n * usually created with `Manifest.fromAssets(\"directory\")`, but manifests can also be assembled\n * programmatically.\n */\nclass Manifest\n{\n    /**\n     * A base path on the current domain to load this manifest's assets from, or null.\n     */\n    public var localBase (get, set) :String;\n\n    /**\n     * A base URL on another domain to load this manifest's assets from, or null. May be used to\n     * load assets from a CDN, in browsers that support cross-domain requests. If not supported or\n     * unset, will fallback to using localBase.\n     */\n    public var remoteBase (get, set) :String;\n\n    public function new ()\n    {\n        _entries = [];\n    }\n\n    /**\n     * Gets the manifest of a pack in the asset directory, that was processed at build-time.\n     * @param packName The folder name in your assets/ directory.\n     * @param required When true and this pack was not found, throw an error. Otherwise null is\n     *   returned.\n     */\n    public static function fromAssets (packName :String, required :Bool = true) :Manifest\n    {\n        var packData :Array<Dynamic> = Reflect.field(Meta.getType(Manifest).assets[0], packName);\n        if (packData == null) {\n            if (required) {\n                throw \"Missing asset pack\".withFields([\"name\", packName]);\n            }\n            return null;\n        }\n\n        var manifest = new Manifest();\n        manifest.localBase = \"assets\";\n\n        for (asset in packData) {\n            var name = asset.name;\n            var path = packName + \"/\" + name + \"?v=\" + asset.md5;\n\n            var format = inferFormat(name);\n            if (format != Data) {\n                // If this an asset that not all platforms may support, trim the extension from\n                // the name. We'll only load one of the assets if this creates a name collision.\n                name = name.removeFileExtension();\n            }\n\n            manifest.add(name, path, asset.bytes, format);\n        }\n\n        return manifest;\n    }\n\n    /**\n     * Tries to find a pack suffixed with the closest available variant of the locale. For example,\n     * fromAssetsLocalized(\"foo\", \"pt-BR\") will first try to load foo_pt-BR, then foo_pt, then just\n     * foo.\n     * @param packName The folder name in your assets/ directory.\n     * @param locale An RFC 4646 language tag, or null to use the system language.\n     * @param required When true and this pack was not found, throw an error. Otherwise null is\n     *   returned.\n     */\n    public static function fromAssetsLocalized (\n        packName :String, locale :String = null, required :Bool = true) :Manifest\n    {\n        if (locale == null) {\n            locale = System.locale;\n        }\n\n        if (locale != null) {\n            var parts = locale.split(\"-\");\n            while (parts.length > 0) {\n                var manifest = fromAssets(packName + \"_\" + parts.join(\"-\"), false);\n                if (manifest != null) {\n                    return manifest;\n                }\n                parts.pop();\n            }\n        }\n        return fromAssets(packName, required);\n    }\n\n    /**\n     * Returns true if the given named pack was included in the asset directory at build-time.\n     */\n    public static function exists (packName :String) :Bool\n    {\n        return Reflect.hasField(Meta.getType(Manifest).assets[0], packName);\n    }\n\n    /**\n     * Adds an asset entry to this manifest.\n     * @param name The name of the asset.\n     * @param url The URL this asset will be downloaded from.\n     * @param bytes The size in bytes.\n     * @param format Optionally specified content format, by default infer it from the URL.\n     */\n    public function add (name :String, url :String, bytes :Int = 0, ?format :AssetFormat) :AssetEntry\n    {\n        if (format == null) {\n            format = inferFormat(url);\n        }\n\n        var entry = new AssetEntry(name, url, format, bytes);\n        _entries.push(entry);\n        return entry;\n    }\n\n    /**\n     * Iterates over all the assets defined in this manifest.\n     */\n    inline public function iterator () :Iterator<AssetEntry>\n    {\n        return _entries.iterator();\n    }\n\n    /**\n     * Creates a copy of this manifest.\n     */\n    public function clone () :Manifest\n    {\n        var copy = new Manifest();\n        copy.localBase = localBase;\n        copy.remoteBase = remoteBase;\n        copy._entries = _entries.copy();\n        return copy;\n    }\n\n    /**\n     * Get the full URL to load an asset from. Will prepend localBase or remoteBase depending on\n     * cross-domain support.\n     */\n    public function getFullURL (entry :AssetEntry) :String\n    {\n        var basePath = (remoteBase != null && _supportsCrossOrigin) ? remoteBase : localBase;\n        return (basePath != null) ? basePath.joinPath(entry.url) : entry.url;\n    }\n\n    private function get_localBase () :String\n    {\n        return _localBase;\n    }\n\n    private function set_localBase (localBase :String) :String\n    {\n        if (localBase != null) {\n            Assert.that(!localBase.startsWith(\"http://\") && !localBase.startsWith(\"https://\"),\n                \"localBase must be a path on the same domain, NOT starting with http(s)://\");\n        }\n        return _localBase = localBase;\n    }\n\n    private function get_remoteBase () :String\n    {\n        return _remoteBase;\n    }\n\n    private function set_remoteBase (remoteBase :String) :String\n    {\n        if (remoteBase != null) {\n            Assert.that(remoteBase.startsWith(\"http://\") || remoteBase.startsWith(\"https://\"),\n                \"remoteBase must be on a remote domain, starting with http(s)://\");\n        }\n        return _remoteBase = remoteBase;\n    }\n\n    private static function inferFormat (url :String) :AssetFormat\n    {\n        var extension = url.getUrlExtension();\n        if (extension != null) {\n            switch (extension.toLowerCase()) {\n                case \"gif\": return GIF;\n                case \"jpg\", \"jpeg\": return JPG;\n                case \"jxr\", \"wdp\": return JXR;\n                case \"png\": return PNG;\n                case \"webp\": return WEBP;\n\n                case \"dds\": return DDS;\n                case \"pvr\": return PVR;\n                case \"pkm\": return PKM;\n\n                case \"m4a\": return M4A;\n                case \"mp3\": return MP3;\n                case \"ogg\": return OGG;\n                case \"opus\": return OPUS;\n                case \"wav\": return WAV;\n            }\n        } else {\n            Log.warn(\"No file extension for asset, it will be loaded as data\", [\"url\", url]);\n        }\n        return Data;\n    }\n\n    // Whether the environment fully supports loading assets from another domain\n    private static var _supportsCrossOrigin :Bool = (function () {\n        var detected =\n#if html\n        (function () {\n            // CORS in the stock Android browser is buggy. If your game is contained in an iframe, XHR\n            // will work the first time. If the response had an Expires header, on subsequent page loads\n            // instead of retrieving it from the cache, it will fail with error code 0.\n            // http://stackoverflow.com/questions/6090816/android-cors-requests-work-only-once\n            if (js.Browser.navigator.userAgent.indexOf(\"Linux; U; Android\") >= 0) {\n                return false;\n            }\n\n            var xhr :Dynamic = untyped __new__(\"XMLHttpRequest\");\n            return (xhr.withCredentials != null);\n        })();\n#else\n            true; // Assumes you have a valid crossdomain.xml\n#end\n        if (!detected) {\n            Log.warn(\"This browser does not support cross-domain asset loading, any Manifest.remoteBase setting will be ignored.\");\n        }\n        return detected;\n    })();\n\n    private var _entries :Array<AssetEntry>;\n\n    private var _localBase :String = null;\n    private var _remoteBase :String = null;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.math;\n\n/**\n * A 2D point or vector.\n */\nclass Point\n{\n    public var x :Float;\n    public var y :Float;\n\n    public function new (x :Float = 0, y :Float = 0)\n    {\n        this.x = x;\n        this.y = y;\n    }\n\n    /**\n     * Re-assign the coordinates of this point.\n     */\n    public function set (x :Float, y :Float)\n    {\n        this.x = x;\n        this.y = y;\n    }\n\n    /**\n     * Normalize this vector, so that its new magnitude is 1.\n     */\n    public function normalize ()\n    {\n        var m = magnitude();\n        x /= m;\n        y /= m;\n    }\n\n    /**\n     * The dot product of two vectors.\n     */\n    public function dot (x :Float, y :Float) :Float\n    {\n        return this.x*x + this.y*y;\n    }\n\n    /**\n     * Scales a vector's magnitude by a given value.\n     */\n    public function multiply (n :Float)\n    {\n        x *= n;\n        y *= n;\n    }\n\n    /**\n     * The magnitude (length) of this vector.\n     */\n    public function magnitude () :Float\n    {\n        return Math.sqrt(x*x + y*y);\n    }\n\n    /**\n     * The distance between this point and another point.\n     */\n    public function distanceTo (x :Float, y :Float) :Float\n    {\n        return Math.sqrt(distanceToSquared(x, y));\n    }\n\n    /**\n     * The squared distance between this point and another point. This is a faster operation than\n     * distanceTo.\n     */\n    public function distanceToSquared (x :Float, y :Float) :Float\n    {\n        var dx = this.x-x;\n        var dy = this.y-y;\n        return dx*dx + dy*dy;\n    }\n\n    /**\n     * Creates a copy of this point.\n     */\n    public function clone (?result :Point) :Point\n    {\n        if (result == null) {\n            return new Point(x, y);\n        }\n        result.set(x, y);\n        return result;\n    }\n\n    public function equals (other :Point) :Bool\n    {\n        return x == other.x && y == other.y;\n    }\n\n    #if debug @:keep #end public function toString () :String\n    {\n        return \"(\" + x + \",\" + y + \")\";\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.display;\n\nimport flambe.animation.AnimatedFloat;\nimport flambe.display.Sprite;\nimport flambe.input.PointerEvent;\nimport flambe.math.FMath;\nimport flambe.math.Matrix;\nimport flambe.math.Point;\nimport flambe.math.Rectangle;\nimport flambe.scene.Director;\nimport flambe.util.Signal1;\nimport flambe.util.SignalConnection;\nimport flambe.util.Value;\n\nusing flambe.util.BitSets;\n\nclass Sprite extends Component\n{\n    /**\n     * X position, in pixels.\n     */\n    public var x (default, null) :AnimatedFloat;\n\n    /**\n     * Y position, in pixels.\n     */\n    public var y (default, null) :AnimatedFloat;\n\n    /**\n     * Rotation angle, in degrees.\n     */\n    public var rotation (default, null) :AnimatedFloat;\n\n    /**\n     * Horizontal scale factor.\n     */\n    public var scaleX (default, null) :AnimatedFloat;\n\n    /**\n     * Vertical scale factor.\n     */\n    public var scaleY (default, null) :AnimatedFloat;\n\n    /**\n     * The X position of this sprite's anchor point. Local transformations are applied relative to\n     * this point.\n     */\n    public var anchorX (default, null) :AnimatedFloat;\n\n    /**\n     * The Y position of this sprite's anchor point. Local transformations are applied relative to\n     * this point.\n     */\n    public var anchorY (default, null) :AnimatedFloat;\n\n    /**\n     * The alpha (opacity) of this sprite, between 0 (invisible) and 1 (fully opaque).\n     */\n    public var alpha (default, null) :AnimatedFloat;\n\n    /**\n     * The blend mode used to draw this sprite, or null to use its parent's blend mode.\n     */\n    public var blendMode :BlendMode = null;\n\n    /**\n     * The scissor rectangle used for clipping/masking, in the local coordinate system. The scissor\n     * rectangle affects both rendering and hit testing, and applies to this sprite and all\n     * children. Rectangles with negative width or height are OK.\n     *\n     * __WARNING__: When using scissor testing, this sprite (and its parents) must not be rotated.\n     * The scissor rectangle must be axis-aligned when converted to screen coordinates.\n     */\n    public var scissor :Rectangle = null;\n\n    /**\n     * Whether this sprite should be drawn. Invisible sprites do not receive pointer events.\n     */\n    public var visible (get, set) :Bool;\n\n    /**\n     * Whether this sprite's position will be rounded to the nearest whole pixel when rendering, for\n     * crisper images. Defaults to true. This can be disabled for smoother animation, at the risk of\n     * fuzziness when an image lies on a subpixel.\n     */\n    public var pixelSnapping (get, set) :Bool;\n\n    /**\n     * Emitted when the pointer is pressed down over this sprite.\n     */\n    public var pointerDown (get, null) :Signal1<PointerEvent>;\n\n    /**\n     * Emitted when the pointer is moved over this sprite.\n     */\n    public var pointerMove (get, null) :Signal1<PointerEvent>;\n\n    /**\n     * Emitted when the pointer is raised over this sprite.\n     */\n    public var pointerUp (get, null) :Signal1<PointerEvent>;\n\n    /**\n     * Emitted when the pointer is moved inside of this sprite.\n     */\n    public var pointerIn (get, null) :Signal1<PointerEvent>;\n\n    /**\n     * Emitted when the pointer is moved outside of this sprite. If the pointer is a touch, also\n     * emitted when the touch is lifted from this sprite.\n     */\n    public var pointerOut (get, null) :Signal1<PointerEvent>;\n\n    /**\n     * Whether this sprite or any children should receive pointer events. Defaults to true.\n     */\n    public var pointerEnabled (get, set) :Bool;\n\n    public function new ()\n    {\n        _flags = _flags.add(VISIBLE | POINTER_ENABLED | VIEW_MATRIX_DIRTY | PIXEL_SNAPPING);\n        _localMatrix = new Matrix();\n\n        var dirtyMatrix = function (_,_) {\n            _flags = _flags.add(LOCAL_MATRIX_DIRTY | VIEW_MATRIX_DIRTY);\n        };\n        x = new AnimatedFloat(0, dirtyMatrix);\n        y = new AnimatedFloat(0, dirtyMatrix);\n        rotation = new AnimatedFloat(0, dirtyMatrix);\n        scaleX = new AnimatedFloat(1, dirtyMatrix);\n        scaleY = new AnimatedFloat(1, dirtyMatrix);\n        anchorX = new AnimatedFloat(0, dirtyMatrix);\n        anchorY = new AnimatedFloat(0, dirtyMatrix);\n\n        alpha = new AnimatedFloat(1);\n    }\n\n    /**\n     * Search for a sprite in the entity hierarchy lying under the given point, in local\n     * coordinates. Ignores sprites that are invisible or not pointerEnabled during traversal.\n     * Returns null if neither the entity or its children contain a sprite under the given point.\n     */\n    public static function hitTest (entity :Entity, x :Float, y :Float) :Sprite\n    {\n        var sprite = entity.get(Sprite);\n        if (sprite != null) {\n            if (!sprite._flags.containsAll(VISIBLE | POINTER_ENABLED)) {\n                return null; // Prune invisible or non-interactive subtrees\n            }\n            if (sprite.getLocalMatrix().inverseTransform(x, y, _scratchPoint)) {\n                x = _scratchPoint.x;\n                y = _scratchPoint.y;\n            }\n\n            var scissor = sprite.scissor;\n            if (scissor != null && !scissor.contains(x, y)) {\n                return null; // Prune if outside the scissor rectangle\n            }\n        }\n\n        // Hit test all children, front to back\n        var result = hitTestBackwards(entity.firstChild, x, y);\n        if (result != null) {\n            return result;\n        }\n\n        // Finally, if we got this far, hit test the actual sprite\n        return (sprite != null && sprite.containsLocal(x, y)) ? sprite : null;\n    }\n\n    /**\n     * Calculate the bounding box of an entity hierarchy. Returns the smallest rectangle in local\n     * coordinates that fully encloses all child sprites.\n     */\n    public static function getBounds (entity :Entity, ?result :Rectangle) :Rectangle\n    {\n        if (result == null) {\n            result = new Rectangle();\n        }\n\n        // The width and height of this rectangle are hijacked to store the bottom right corner\n        result.set(FMath.FLOAT_MAX, FMath.FLOAT_MAX, FMath.FLOAT_MIN, FMath.FLOAT_MIN);\n        getBoundsImpl(entity, null, result);\n\n        // Convert back to a true width and height\n        result.width -= result.x;\n        result.height -= result.y;\n        return result;\n    }\n\n    /**\n     * Renders an entity hierarchy to the given Graphics.\n     */\n    public static function render (entity :Entity, g :Graphics)\n    {\n        // Render this entity's sprite\n        var sprite = entity.get(Sprite);\n        if (sprite != null) {\n            var alpha = sprite.alpha._;\n            if (!sprite.visible || alpha <= 0) {\n                return; // Prune traversal, this sprite and all children are invisible\n            }\n\n            g.save();\n            if (alpha < 1) {\n                g.multiplyAlpha(alpha);\n            }\n            if (sprite.blendMode != null) {\n                g.setBlendMode(sprite.blendMode);\n            }\n            var matrix = sprite.getLocalMatrix();\n\n            var m02 = matrix.m02;\n            var m12 = matrix.m12;\n            if (sprite.pixelSnapping) {\n                // Snap the translation to the nearest whole pixel\n                m02 = Math.round(m02);\n                m12 = Math.round(m12);\n            }\n            g.transform(matrix.m00, matrix.m10, matrix.m01, matrix.m11, m02, m12);\n\n            var scissor = sprite.scissor;\n            if (scissor != null) {\n                g.applyScissor(scissor.x, scissor.y, scissor.width, scissor.height);\n            }\n\n            sprite.draw(g);\n        }\n\n        // Render any partially occluded director scenes\n        var director = entity.get(Director);\n        if (director != null) {\n            var scenes = director.occludedScenes;\n            for (scene in scenes) {\n                render(scene, g);\n            }\n        }\n\n        // Render all children\n        var p = entity.firstChild;\n        while (p != null) {\n            var next = p.next;\n            render(p, g);\n            p = next;\n        }\n\n        // If save() was called, unwind it\n        if (sprite != null) {\n            g.restore();\n        }\n    }\n\n    /**\n     * The \"natural\" width of this sprite, without any transformations being applied. Used for hit\n     * testing. This does not consider child sprites, use Sprite.getBounds for that.\n     */\n    public function getNaturalWidth () :Float\n    {\n        return 0;\n    }\n\n    /**\n     * The \"natural\" height of this sprite, without any transformations being applied. Used for hit\n     * testing. This does not consider child sprites, use Sprite.getBounds for that.\n     */\n    public function getNaturalHeight () :Float\n    {\n        return 0;\n    }\n\n    /**\n     * Returns true if the given point (in viewport/stage coordinates) lies inside this sprite.\n     */\n    public function contains (viewX :Float, viewY :Float) :Bool\n    {\n        return getViewMatrix().inverseTransform(viewX, viewY, _scratchPoint) &&\n            containsLocal(_scratchPoint.x, _scratchPoint.y);\n    }\n\n    /**\n     * Returns true if the given point (in local coordinates) lies inside this sprite.\n     */\n    public function containsLocal (localX :Float, localY :Float) :Bool\n    {\n        return localX >= 0 && localX < getNaturalWidth()\n            && localY >= 0 && localY < getNaturalHeight();\n    }\n\n    /**\n     * Returns the local transformation matrix, relative to the parent. This matrix may be modified\n     * to position the sprite, but any changes will be invalidated when the x, y, scaleX, scaleY,\n     * rotation, anchorX, or anchorY properties are updated.\n     */\n    public function getLocalMatrix () :Matrix\n    {\n        if (_flags.contains(LOCAL_MATRIX_DIRTY)) {\n            _flags = _flags.remove(LOCAL_MATRIX_DIRTY);\n\n            _localMatrix.compose(x._, y._, scaleX._, scaleY._, FMath.toRadians(rotation._));\n            _localMatrix.translate(-anchorX._, -anchorY._);\n        }\n        return _localMatrix;\n    }\n\n    /**\n     * Returns the view transformation matrix, relative to the root. Do NOT modify this matrix.\n     */\n    public function getViewMatrix () :Matrix\n    {\n        if (isViewMatrixDirty()) {\n            var parentSprite = getParentSprite();\n            _viewMatrix = (parentSprite != null)\n                ? Matrix.multiply(parentSprite.getViewMatrix(), getLocalMatrix(), _viewMatrix)\n                : getLocalMatrix().clone(_viewMatrix);\n\n            _flags = _flags.remove(VIEW_MATRIX_DIRTY);\n            if (parentSprite != null) {\n                _parentViewMatrixUpdateCount = parentSprite._viewMatrixUpdateCount;\n            }\n            ++_viewMatrixUpdateCount;\n        }\n        return _viewMatrix;\n    }\n\n    /**\n     * Chainable convenience method to set the anchor position.\n     * @returns This instance, for chaining.\n     */\n    public function setAnchor (x :Float, y :Float) :Sprite\n    {\n        anchorX._ = x;\n        anchorY._ = y;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to center the anchor using the natural width and height.\n     * @returns This instance, for chaining.\n     */\n    public function centerAnchor () :Sprite\n    {\n        anchorX._ = getNaturalWidth()/2;\n        anchorY._ = getNaturalHeight()/2;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to set the position.\n     * @returns This instance, for chaining.\n     */\n    public function setXY (x :Float, y :Float) :Sprite\n    {\n        this.x._ = x;\n        this.y._ = y;\n        return this;\n    }\n\t\n    /**\n     * Chainable convenience method to set the alpha.\n     * @returns This instance, for chaining.\n     */\n    public function setAlpha (alpha :Float) :Sprite\n    {\n        this.alpha._ = alpha;\n        return this;\n    }\n\t\n    /**\n     * Chainable convenience method to set the rotation.\n     * @returns This instance, for chaining.\n     */\n    public function setRotation (rotation :Float) :Sprite\n    {\n        this.rotation._ = rotation;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to uniformly set the scale.\n     * @returns This instance, for chaining.\n     */\n    public function setScale (scale :Float) :Sprite\n    {\n        scaleX._ = scale;\n        scaleY._ = scale;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to set the scale.\n     * @returns This instance, for chaining.\n     */\n    public function setScaleXY (scaleX :Float, scaleY :Float) :Sprite\n    {\n        this.scaleX._ = scaleX;\n        this.scaleY._ = scaleY;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to set the blendMode.\n     * @returns This instance, for chaining.\n     */\n    public function setBlendMode (blendMode :BlendMode) :Sprite\n    {\n        this.blendMode = blendMode;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to set pointerEnabled to false.\n     * @returns This instance, for chaining.\n     */\n    public function disablePointer () :Sprite\n    {\n        pointerEnabled = false;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to set pixelSnapping to false.\n     * @returns This instance, for chaining.\n     */\n    public function disablePixelSnapping () :Sprite\n    {\n        pixelSnapping = false;\n        return this;\n    }\n\n    override public function onAdded ()\n    {\n        if (_flags.contains(HOVERING)) {\n            connectHover();\n        }\n    }\n\n    override public function onRemoved ()\n    {\n        if (_hoverConnection != null) {\n            _hoverConnection.dispose();\n            _hoverConnection = null;\n        }\n    }\n\n    override public function onUpdate (dt :Float)\n    {\n        x.update(dt);\n        y.update(dt);\n        rotation.update(dt);\n        scaleX.update(dt);\n        scaleY.update(dt);\n        alpha.update(dt);\n        anchorX.update(dt);\n        anchorY.update(dt);\n    }\n\n    /**\n     * Draws this sprite to the given Graphics.\n     */\n    public function draw (g :Graphics)\n    {\n        // See subclasses\n    }\n\n    private function isViewMatrixDirty () :Bool\n    {\n        if (_flags.contains(VIEW_MATRIX_DIRTY)) {\n            return true;\n        }\n        var parentSprite = getParentSprite();\n        if (parentSprite == null) {\n            return false;\n        }\n        return _parentViewMatrixUpdateCount != parentSprite._viewMatrixUpdateCount\n            || parentSprite.isViewMatrixDirty();\n    }\n\n    private function getParentSprite () :Sprite\n    {\n        if (owner == null) {\n            return null;\n        }\n        var entity = owner.parent;\n        while (entity != null) {\n            var sprite = entity.get(Sprite);\n            if (sprite != null) {\n                return sprite;\n            }\n            entity = entity.parent;\n        }\n        return null;\n    }\n\n    private function get_pointerDown () :Signal1<PointerEvent>\n    {\n        if (_pointerDown == null) {\n            _pointerDown = new Signal1();\n        }\n        return _pointerDown;\n    }\n\n    private function get_pointerMove () :Signal1<PointerEvent>\n    {\n        if (_pointerMove == null) {\n            _pointerMove = new Signal1();\n        }\n        return _pointerMove;\n    }\n\n    private function get_pointerUp () :Signal1<PointerEvent>\n    {\n        if (_pointerUp == null) {\n            _pointerUp = new Signal1();\n        }\n        return _pointerUp;\n    }\n\n    private function get_pointerIn () :Signal1<PointerEvent>\n    {\n        if (_pointerIn == null) {\n            _pointerIn = new Signal1();\n        }\n        return _pointerIn;\n    }\n\n    private function get_pointerOut () :Signal1<PointerEvent>\n    {\n        if (_pointerOut == null) {\n            _pointerOut = new Signal1();\n        }\n        return _pointerOut;\n    }\n\n    private function connectHover ()\n    {\n        if (_hoverConnection != null) {\n            return;\n        }\n        _hoverConnection = System.pointer.move.connect(function (event) {\n            // Return early if this sprite was in the event chain\n            var hit = event.hit;\n            while (hit != null) {\n                if (hit == this) {\n                    return;\n                }\n                hit = hit.getParentSprite();\n            }\n\n            // This sprite is not under the pointer\n            if (_pointerOut != null && _flags.contains(HOVERING)) {\n                _pointerOut.emit(event);\n            }\n            _flags = _flags.remove(HOVERING);\n            _hoverConnection.dispose();\n            _hoverConnection = null;\n        });\n    }\n\n    inline private function get_visible () :Bool\n    {\n        return _flags.contains(VISIBLE);\n    }\n\n    private function set_visible (visible :Bool) :Bool\n    {\n        _flags = _flags.set(VISIBLE, visible);\n        return visible;\n    }\n\n    inline private function get_pointerEnabled () :Bool\n    {\n        return _flags.contains(POINTER_ENABLED);\n    }\n\n    private function set_pointerEnabled (pointerEnabled :Bool) :Bool\n    {\n        _flags = _flags.set(POINTER_ENABLED, pointerEnabled);\n        return pointerEnabled;\n    }\n\n    inline private function get_pixelSnapping () :Bool\n    {\n        return _flags.contains(PIXEL_SNAPPING);\n    }\n\n    private function set_pixelSnapping (pixelSnapping :Bool) :Bool\n    {\n        _flags = _flags.set(PIXEL_SNAPPING, pixelSnapping);\n        return pixelSnapping;\n    }\n\n    @:allow(flambe) function onPointerDown (event :PointerEvent)\n    {\n        onHover(event);\n        if (_pointerDown != null) {\n            _pointerDown.emit(event);\n        }\n    }\n\n    @:allow(flambe) function onPointerMove (event :PointerEvent)\n    {\n        onHover(event);\n        if (_pointerMove != null) {\n            _pointerMove.emit(event);\n        }\n    }\n\n    private function onHover (event :PointerEvent)\n    {\n        if (_flags.contains(HOVERING)) {\n            return; // Already hovering\n        }\n        _flags = _flags.add(HOVERING);\n\n        // Notify listeners and connect the hover-out listener\n        if ((_pointerIn != null || _pointerOut != null)) {\n            if (_pointerIn != null) {\n                _pointerIn.emit(event);\n            }\n            connectHover();\n        }\n    }\n\n    @:allow(flambe) function onPointerUp (event :PointerEvent)\n    {\n        switch (event.source) {\n        case Touch(point):\n            if (_pointerOut != null && _flags.contains(HOVERING)) {\n                _pointerOut.emit(event);\n            }\n            _flags = _flags.remove(HOVERING);\n            if (_hoverConnection != null) {\n                _hoverConnection.dispose();\n                _hoverConnection = null;\n            }\n        default:\n        }\n\n        if (_pointerUp != null) {\n            _pointerUp.emit(event);\n        }\n    }\n\n    private static function hitTestBackwards (entity :Entity, x :Float, y :Float) :Sprite\n    {\n        if (entity != null) {\n            var result = hitTestBackwards(entity.next, x, y);\n            return (result != null) ? result : hitTest(entity, x, y);\n        }\n        return null;\n    }\n\n    private static function getBoundsImpl (entity :Entity, matrix :Matrix, result :Rectangle)\n    {\n        var sprite = entity.get(Sprite);\n        if (sprite != null) {\n            matrix = (matrix != null)\n                ? Matrix.multiply(matrix, sprite.getLocalMatrix()) // Allocation!\n                : sprite.getLocalMatrix();\n\n            var x1 = 0.0, y1 = 0.0;\n            var x2 = sprite.getNaturalWidth(), y2 = sprite.getNaturalHeight();\n\n            // Intersecting scissor rectangles are too tricky for bounds calculation, ignore it for\n            // now...\n            // var scissor = sprite.scissor;\n            // if (scissor != null) {\n            //     x1 = FMath.max(x1, scissor.x);\n            //     y1 = FMath.max(y1, scissor.y);\n            //     x2 = FMath.min(x2, scissor.x + scissor.width);\n            //     y2 = FMath.min(y2, scissor.y + scissor.height);\n            // }\n\n            // Extend the rectangle out to fit this sprite\n            if (x2 > x1 && y2 > y1) {\n                extendRect(matrix, x1, y1, result);\n                extendRect(matrix, x2, y1, result);\n                extendRect(matrix, x2, y2, result);\n                extendRect(matrix, x1, y2, result);\n            }\n        }\n\n        // Recurse into partially occluded director scenes\n        var director = entity.get(Director);\n        if (director != null) {\n            var scenes = director.occludedScenes;\n            var ii = 0, ll = scenes.length;\n            while (ii < ll) {\n                getBoundsImpl(scenes[ii], matrix, result);\n                ++ii;\n            }\n        }\n\n        // Recurse into all children\n        var p = entity.firstChild;\n        while (p != null) {\n            var next = p.next;\n            getBoundsImpl(p, matrix, result);\n            p = next;\n        }\n    }\n\n    private static function extendRect (matrix :Matrix, x :Float, y :Float, rect :Rectangle)\n    {\n        var p = matrix.transform(x, y, _scratchPoint);\n        x = p.x;\n        y = p.y;\n\n        // The width and height of the rectangle are treated like the bottom right point, rather\n        // than a true width and height offset\n        if (x < rect.x) rect.x = x;\n        if (y < rect.y) rect.y = y;\n        if (x > rect.width) rect.width = x;\n        if (y > rect.height) rect.height = y;\n    }\n\n    private static var _scratchPoint = new Point();\n\n    // Component flags\n    private static inline var VISIBLE = Component.NEXT_FLAG << 0;\n    private static inline var POINTER_ENABLED = Component.NEXT_FLAG << 1;\n    private static inline var LOCAL_MATRIX_DIRTY = Component.NEXT_FLAG << 2;\n    private static inline var VIEW_MATRIX_DIRTY = Component.NEXT_FLAG << 3;\n    private static inline var PIXEL_SNAPPING = Component.NEXT_FLAG << 4;\n    private static inline var HOVERING = Component.NEXT_FLAG << 5;\n    private static inline var NEXT_FLAG = Component.NEXT_FLAG << 6; // Must be last!\n\n    private var _localMatrix :Matrix;\n\n    private var _viewMatrix :Matrix = null;\n    private var _viewMatrixUpdateCount :Int = 0;\n    private var _parentViewMatrixUpdateCount :Int = 0;\n\n    private var _pointerDown :Signal1<PointerEvent>;\n    private var _pointerMove :Signal1<PointerEvent>;\n    private var _pointerUp :Signal1<PointerEvent>;\n\n    private var _pointerIn :Signal1<PointerEvent>;\n    private var _pointerOut :Signal1<PointerEvent>;\n    private var _hoverConnection :SignalConnection;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.display;\n\nimport flambe.animation.AnimatedFloat;\nimport flambe.util.Value;\n\n/**\n * A sprite that displays a rectangle filled with a given color.\n */\nclass FillSprite extends Sprite\n{\n    public var color :Int;\n    public var width (default, null) :AnimatedFloat;\n    public var height (default, null) :AnimatedFloat;\n\n    public function new (color :Int, width :Float, height :Float)\n    {\n        super();\n        this.color = color;\n        this.width = new AnimatedFloat(width);\n        this.height = new AnimatedFloat(height);\n    }\n\n    override public function draw (g :Graphics)\n    {\n        g.fillRect(color, 0, 0, width._, height._);\n    }\n\n    override public function getNaturalWidth () :Float\n    {\n        return width._;\n    }\n\n    override public function getNaturalHeight () :Float\n    {\n        return height._;\n    }\n\n    /**\n     * Chainable convenience method to set the width and height.\n     * @returns This instance, for chaining.\n     */\n    public function setSize (width :Float, height :Float) :FillSprite\n    {\n        this.width._ = width;\n        this.height._ = height;\n        return this;\n    }\n\n    override public function onUpdate (dt :Float)\n    {\n        super.onUpdate(dt);\n        width.update(dt);\n        height.update(dt);\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.display;\n\nimport flambe.asset.AssetPack;\nimport flambe.asset.File;\nimport flambe.math.FMath;\nimport flambe.math.Rectangle;\nimport flambe.util.Value;\n\nusing StringTools;\nusing flambe.util.Strings;\n\n/**\n * A bitmap font, created in any tool that exports the BMFont format, such as the original BMFont\n * editor, Hiero, or Glyph Designer.\n */\nclass Font\n{\n    /**\n     * The name that was used to load this font.\n     */\n    public var name (default, null) :String;\n\n    /**\n     * The size of this font, in pixels.\n     */\n    public var size (default, null) :Float;\n\n    /**\n     * The vertical distance between each line of text in this font, in pixels.\n     */\n    public var lineHeight (default, null) :Float;\n\n    /**\n     * Parses a font using files in an asset pack.\n     * @param name The path to the font within the asset pack, excluding the .fnt suffix.\n     */\n    public function new (pack :AssetPack, name :String)\n    {\n        this.name = name;\n        _pack = pack;\n        _file = pack.getFile(name+\".fnt\");\n\n        reload();\n#if debug\n        _lastReloadCount = _file.reloadCount._;\n#end\n    }\n\n    /**\n     * Disposes the source .fnt File used to create this Font. This can free up some memory, if you\n     * don't intend to recreate this Font later from the same AssetPack.\n     *\n     * @returns This instance, for chaining.\n     */\n    public function disposeFiles () :Font\n    {\n        _file.dispose();\n        return this;\n    }\n\n    /**\n     * Splits text into multiple lines that fit into a given width when displayed using this font.\n     */\n    public function splitLines (text :String, maxWidth :Float) :Array<String>\n    {\n        var glyphs = getGlyphs(text);\n        var line = \"\";\n        var lines = [];\n        var x = 0;\n        var ii = 0;\n        var ll = glyphs.length;\n        var lastSpaceIdx = -1;\n\n        while (ii < ll) {\n            var glyph = glyphs[ii];\n            if (x + glyph.width > maxWidth) {\n                // Ran off the edge, add a line\n                x = 0;\n                var space = line.lastIndexOf(\" \");\n                if (space >= 0) {\n                    // Backtrack to the beginning of the last word\n                    lines.push(line.substr(0, space));\n                    ii = lastSpaceIdx + 1;\n                } else {\n                    lines.push(line);\n                }\n                line = \"\";\n\n            } else {\n                if (glyph.charCode == \" \".code) {\n                    lastSpaceIdx = ii;\n                }\n                line += String.fromCharCode(glyph.charCode);\n                x += glyph.xAdvance;\n                ++ii;\n                if (ii != ll) {\n                    var nextGlyph = glyphs[ii];\n                    x += glyph.getKerning(nextGlyph.charCode);\n                }\n            }\n        }\n        lines.push(line);\n\n        return lines;\n    }\n\n    /**\n     * Get the list of Glyphs that make up a string. Characters without glyphs in this font will be\n     * missing from the list.\n     */\n    public function getGlyphs (text :String) :Array<Glyph>\n    {\n        var list = [];\n        for (ii in 0...text.length) {\n            var charCode = text.fastCodeAt(ii);\n            var glyph = _glyphs.get(charCode);\n            if (glyph != null) {\n                list.push(glyph);\n            } else {\n                Log.warn(\"Requested a missing character from font\",\n                    [\"font\", name, \"charCode\", charCode]);\n            }\n        }\n        return list;\n    }\n\n    public function layoutText (text :String, ?align :TextAlign, wrapWidth :Float = 0,\n        letterSpacing :Float = 0, lineSpacing :Float = 0) :TextLayout\n    {\n        if (align == null) {\n            align = Left;\n        }\n        return new TextLayout(this, text, align, wrapWidth, letterSpacing, lineSpacing);\n    }\n\n    /**\n     * Get the Glyph for a given character code.\n     */\n    inline public function getGlyph (charCode :Int) :Glyph\n    {\n        return _glyphs.get(charCode);\n    }\n\n#if debug\n    @:allow(flambe) function checkReload () :Int\n    {\n        // If the .fnt file was reloaded since the last check, reload the font\n        var reloadCount = _file.reloadCount._;\n        if (_lastReloadCount != reloadCount) {\n            _lastReloadCount = reloadCount;\n            reload();\n        }\n        return reloadCount;\n    }\n#end\n\n    private function reload ()\n    {\n        _glyphs = new Map();\n        _glyphs.set(NEWLINE.charCode, NEWLINE);\n\n        var parser = new ConfigParser(_file.toString());\n        var pages = new Map<Int,Texture>();\n\n        // The basename of the font's path, where we'll find the textures\n        var idx = name.lastIndexOf(\"/\");\n        var basePath = (idx >= 0) ? name.substr(0, idx+1) : \"\";\n\n        // BMFont spec: http://www.angelcode.com/products/bmfont/doc/file_format.html\n        for (keyword in parser.keywords()) {\n            switch (keyword) {\n            case \"info\":\n                for (pair in parser.pairs()) {\n                    switch (pair.key) {\n                    case \"size\":\n                        size = pair.getInt();\n                    }\n                }\n\n            case \"common\":\n                for (pair in parser.pairs()) {\n                    switch (pair.key) {\n                    case \"lineHeight\":\n                        lineHeight = pair.getInt();\n                    }\n                }\n\n            case \"page\":\n                var pageId :Int = 0;\n                var file :String = null;\n                for (pair in parser.pairs()) {\n                    switch (pair.key) {\n                    case \"id\":\n                        pageId = pair.getInt();\n                    case \"file\":\n                        file = pair.getString();\n                    }\n                }\n                pages.set(pageId, _pack.getTexture(basePath + file.removeFileExtension()));\n\n            case \"char\":\n                var glyph = null;\n                for (pair in parser.pairs()) {\n                    switch (pair.key) {\n                    case \"id\":\n                        glyph = new Glyph(pair.getInt());\n                    case \"x\":\n                        glyph.x = pair.getInt();\n                    case \"y\":\n                        glyph.y = pair.getInt();\n                    case \"width\":\n                        glyph.width = pair.getInt();\n                    case \"height\":\n                        glyph.height = pair.getInt();\n                    case \"page\":\n                        glyph.page = pages.get(pair.getInt());\n                    case \"xoffset\":\n                        glyph.xOffset = pair.getInt();\n                    case \"yoffset\":\n                        glyph.yOffset = pair.getInt();\n                    case \"xadvance\":\n                        glyph.xAdvance = pair.getInt();\n                    }\n                }\n                _glyphs.set(glyph.charCode, glyph);\n\n            case \"kerning\":\n                var first :Glyph = null;\n                var second = 0, amount = 0;\n                for (pair in parser.pairs()) {\n                    switch (pair.key) {\n                    case \"first\":\n                        first = _glyphs.get(pair.getInt());\n                    case \"second\":\n                        second = pair.getInt();\n                    case \"amount\":\n                        amount = pair.getInt();\n                    }\n                }\n                if (first != null && amount != 0) {\n                    first.setKerning(second, amount);\n                }\n            }\n        }\n    }\n\n    // A special glyph to handle the newline character, which is not included in most fonts\n    private static var NEWLINE = new Glyph('\\n'.code);\n\n    private var _pack :AssetPack;\n    private var _file :File;\n    private var _glyphs :Map<Int,Glyph>;\n\n#if debug\n    // Used to track live-reloading updates. A signal listener can't be used here, because we can't\n    // guarantee it'll be properly disposed\n    private var _lastReloadCount :Int;\n#end\n}\n\n/**\n * Represents a single glyph in a bitmap font.\n */\nclass Glyph\n{\n    /**\n     * This glyph's ASCII character code.\n     */\n    public var charCode (default, null) :Int;\n\n    // Location and dimensions of this glyph on the sprite sheet\n    public var x :Int = 0;\n    public var y :Int = 0;\n    public var width :Int = 0;\n    public var height :Int = 0;\n\n    /**\n     * The atlas that contains this glyph.\n     */\n    public var page :Texture = null;\n\n    public var xOffset :Int = 0;\n    public var yOffset :Int = 0;\n\n    public var xAdvance :Int = 0;\n\n    @:allow(flambe) function new (charCode :Int)\n    {\n        this.charCode = charCode;\n    }\n\n    /**\n     * Draws this glyph to a Graphics surface.\n     */\n    public function draw (g :Graphics, destX :Float, destY :Float)\n    {\n        // Avoid drawing whitespace\n        if (width > 0) {\n            g.drawSubTexture(page, destX + xOffset, destY + yOffset, x, y, width, height);\n        }\n    }\n\n    public function getKerning (nextCharCode :Int) :Int\n    {\n        return (_kernings != null) ? Std.int(_kernings.get(nextCharCode)) : 0;\n    }\n\n    @:allow(flambe) function setKerning (nextCharCode :Int, amount :Int)\n    {\n        if (_kernings == null) {\n            _kernings = new Map();\n        }\n        _kernings.set(nextCharCode, amount);\n    }\n\n    private var _kernings :Map<Int,Int> = null;\n}\n\nenum TextAlign\n{\n    Left;\n    Center;\n    Right;\n}\n\n/**\n * Measures and lays out a block of text, handling word wrapping, alignment and newline characters.\n */\nclass TextLayout\n{\n    /** The bounding box that contains this text. */\n    public var bounds (default, null) :Rectangle;\n\n    /** The number of lines in this text. */\n    public var lines (default, null) :Int = 0;\n\n    @:allow(flambe) function new (font :Font, text :String, align :TextAlign, wrapWidth :Float,\n        letterSpacing :Float, lineSpacing :Float)\n    {\n        _font = font;\n        _glyphs = [];\n        _offsets = [];\n        _lineOffset = Math.round(font.lineHeight + lineSpacing);\n\n        bounds = new Rectangle();\n        var lineWidths = [];\n\n        var ll = text.length;\n        for (ii in 0...ll) {\n            var charCode = text.fastCodeAt(ii);\n            var glyph = font.getGlyph(charCode);\n            if (glyph != null) {\n                _glyphs.push(glyph);\n            } else {\n                Log.warn(\"Requested a missing character from font\",\n                    [\"font\", font.name, \"charCode\", charCode]);\n            }\n        }\n\n        var lastSpaceIdx = -1;\n        var lineWidth = 0.0;\n        var lineHeight = 0.0;\n        var newline = font.getGlyph(\"\\n\".code);\n\n        var addLine = function () {\n            bounds.width = FMath.max(bounds.width, lineWidth);\n            bounds.height += lineHeight;\n\n            lineWidths[lines] = lineWidth;\n            lineWidth = 0;\n            lineHeight = 0;\n            ++lines;\n        };\n\n        var ii = 0;\n        while (ii < _glyphs.length) {\n            var glyph = _glyphs[ii];\n            _offsets[ii] = Math.round(lineWidth);\n\n            var wordWrap = wrapWidth > 0 && lineWidth + glyph.width > wrapWidth;\n            if (wordWrap || glyph == newline) {\n                // Wrap using the last word divider\n                if (wordWrap) {\n                    if (lastSpaceIdx >= 0) {\n                        _glyphs[lastSpaceIdx] = newline;\n                        lineWidth = _offsets[lastSpaceIdx];\n                        ii = lastSpaceIdx;\n                    } else {\n                        _glyphs.insert(ii, newline);\n                    }\n                }\n                lastSpaceIdx = -1;\n\n                lineHeight = _lineOffset;\n                addLine();\n\n            } else {\n                if (glyph.charCode == \" \".code) {\n                    lastSpaceIdx = ii;\n                }\n                lineWidth += glyph.xAdvance + letterSpacing;\n                lineHeight = FMath.max(lineHeight, glyph.height + glyph.yOffset);\n\n                // Handle kerning with the next glyph\n                if (ii+1 < _glyphs.length) {\n                    var nextGlyph = _glyphs[ii+1];\n                    lineWidth += glyph.getKerning(nextGlyph.charCode);\n                }\n            }\n\n            ++ii;\n        }\n\n        // Handle the remaining lineWidth/Height\n        addLine();\n\n        var lineY = 0.0;\n        var alignOffset = getAlignOffset(align, lineWidths[0], wrapWidth);\n\n        var top = FMath.FLOAT_MAX;\n        var bottom = FMath.FLOAT_MIN;\n\n        // Pack bounds\n        var line = 0;\n        var ii = 0;\n        var ll = _glyphs.length;\n        while (ii < ll) {\n            var glyph = _glyphs[ii];\n\n            if (glyph.charCode == \"\\n\".code) {\n                lineY += _lineOffset;\n                ++line;\n                alignOffset = getAlignOffset(align, lineWidths[line], wrapWidth);\n            }\n            _offsets[ii] += alignOffset;\n\n            var glyphY = lineY + glyph.yOffset;\n            top = FMath.min(top, glyphY);\n            bottom = FMath.max(bottom, glyphY + glyph.height);\n\n            ++ii;\n        }\n\n        bounds.x = getAlignOffset(align, bounds.width, wrapWidth);\n        bounds.y = top;\n        bounds.height = bottom - top;\n    }\n\n    /** Draws this text to a Graphics. */\n    public function draw (g :Graphics)\n    {\n        var y = 0.0;\n        var ii = 0;\n        var ll = _glyphs.length;\n\n        while (ii < ll) {\n            var glyph = _glyphs[ii];\n            if (glyph.charCode == \"\\n\".code) {\n                y += _lineOffset;\n            } else {\n                var x = _offsets[ii];\n                glyph.draw(g, x, y);\n            }\n            ++ii;\n        }\n    }\n\n    private static function getAlignOffset (align :TextAlign,\n        lineWidth :Float, totalWidth :Float) :Float\n    {\n        switch (align) {\n            case Left: return 0;\n            case Right: return totalWidth - lineWidth;\n            case Center: return Math.round((totalWidth-lineWidth) / 2);\n        }\n    }\n\n    private var _font :Font;\n    private var _glyphs :Array<Glyph>;\n    private var _offsets :Array<Float>;\n    private var _lineOffset :Float;\n}\n\nprivate class ConfigParser\n{\n    public function new (config :String)\n    {\n        _configText = config;\n        _keywordPattern = ~/([A-Za-z]+)(.*)/;\n        _pairPattern = ~/([A-Za-z]+)=(\"[^\"]*\"|[^\\s]+)/;\n    }\n\n    public function keywords () :Iterator<String>\n    {\n        var text = _configText;\n        return {\n            next: function () {\n                text = advance(text, _keywordPattern);\n                _pairText = _keywordPattern.matched(2);\n                return _keywordPattern.matched(1);\n            },\n            hasNext: function () {\n                return _keywordPattern.match(text);\n            }\n        };\n    }\n\n    public function pairs () :Iterator<ConfigPair>\n    {\n        var text = _pairText;\n        return {\n            next: function () {\n                text = advance(text, _pairPattern);\n                return new ConfigPair(_pairPattern.matched(1), _pairPattern.matched(2));\n            },\n            hasNext: function () {\n                return _pairPattern.match(text);\n            }\n        };\n    }\n\n    private static function advance (text :String, expr :EReg)\n    {\n        var m = expr.matchedPos();\n        return text.substr(m.pos + m.len, text.length);\n    }\n\n    // The entire config file contents\n    private var _configText :String;\n\n    // The line currently being processed\n    private var _pairText :String;\n\n    private var _keywordPattern :EReg;\n    private var _pairPattern :EReg;\n}\n\nprivate class ConfigPair\n{\n    public var key (default, null) :String;\n\n    public function new (key :String, value :String)\n    {\n        this.key = key;\n        _value = value;\n    }\n\n    public function getInt () :Int\n    {\n        return Std.parseInt(_value);\n    }\n\n    public function getString () :String\n    {\n        if (_value.fastCodeAt(0) != \"\\\"\".code) {\n            return null;\n        }\n        return _value.substr(1, _value.length-2);\n    }\n\n    private var _value :String;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.display;\n\n/**\n * A fixed-size sprite that displays a single texture.\n */\nclass ImageSprite extends Sprite\n{\n    /**\n     * The texture being displayed, or null if none.\n     */\n    public var texture :Texture;\n\n    public function new (texture :Texture)\n    {\n        super();\n        this.texture = texture;\n    }\n\n    override public function draw (g :Graphics)\n    {\n        if (texture != null) {\n            g.drawTexture(texture, 0, 0);\n        }\n    }\n\n    override public function getNaturalWidth () :Float\n    {\n        return (texture != null) ? texture.width : 0;\n    }\n\n    override public function getNaturalHeight () :Float\n    {\n        return (texture != null) ? texture.height : 0;\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.display;\n\nimport flambe.animation.AnimatedFloat;\nimport flambe.display.Font;\nimport flambe.math.FMath;\n\nusing flambe.util.BitSets;\n\n/**\n * A sprite that displays a line of text using a bitmap font.\n */\nclass TextSprite extends Sprite\n{\n    /** The text being displayed. Can contain contain newline characters (\\n) for multiline text. */\n    public var text (get, set) :String;\n\n    /** The font used to display the text. */\n    public var font (get, set) :Font;\n\n    /**\n     * The maximum available width of this text before word wrapping to a new line. Defaults to 0\n     * (no word wrapping).\n     */\n    public var wrapWidth (default, null) :AnimatedFloat;\n\n    /**\n     * Additional horizontal space to apply between letters, in pixels. Defaults to 0. Positive\n     * values make text look \"looser\", negative values look \"tighter\".\n     */\n    public var letterSpacing (default, null) :AnimatedFloat;\n\n    /**\n     * Additional vertical space to apply between lines, in pixels. Defaults to 0. Positive values\n     * make lines look \"looser\", negative values look \"tighter\".\n     */\n    public var lineSpacing (default, null) :AnimatedFloat;\n\n    /**\n     * The horizontal text alignment, for multiline text. Left by default.\n     */\n    public var align (get, set) :TextAlign;\n\n    public function new (font :Font, ?text :String = \"\")\n    {\n        super();\n        _font = font;\n        _text = text;\n        _align = Left;\n        _flags = _flags.add(TEXT_DIRTY);\n\n        var dirtyText = function (_,_) {\n            _flags = _flags.add(TEXT_DIRTY);\n        };\n        wrapWidth = new AnimatedFloat(0, dirtyText);\n        letterSpacing = new AnimatedFloat(0, dirtyText);\n        lineSpacing = new AnimatedFloat(0, dirtyText);\n    }\n\n    override public function draw (g :Graphics)\n    {\n        updateLayout();\n\n#if flambe_debug_text\n        // Draw the bounding boxes for debugging\n        g.fillRect(0xff0000, 0, 0, getNaturalWidth(), getNaturalHeight());\n        g.fillRect(0x00ff00, _layout.bounds.x, _layout.bounds.y, _layout.bounds.width, _layout.bounds.height);\n#end\n\n        _layout.draw(g);\n    }\n\n    override public function getNaturalWidth () :Float\n    {\n        updateLayout();\n        return (wrapWidth._ > 0) ? wrapWidth._ : _layout.bounds.width;\n    }\n\n    override public function getNaturalHeight () :Float\n    {\n        updateLayout();\n        var paddedHeight = _layout.lines * (_font.lineHeight+lineSpacing._);\n        var boundsHeight = _layout.bounds.height;\n        return FMath.max(paddedHeight, boundsHeight);\n    }\n\n    override public function containsLocal (localX :Float, localY :Float) :Bool\n    {\n        updateLayout();\n        return _layout.bounds.contains(localX, localY);\n    }\n\n    /**\n     * Chainable convenience method to set the wrap width.\n     * @returns This instance, for chaining.\n     */\n    public function setWrapWidth (wrapWidth :Float) :TextSprite\n    {\n        this.wrapWidth._ = wrapWidth;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to set the letter spacing.\n     * @returns This instance, for chaining.\n     */\n    public function setLetterSpacing (letterSpacing :Float) :TextSprite\n    {\n        this.letterSpacing._ = letterSpacing;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to set the line spacing.\n     * @returns This instance, for chaining.\n     */\n    public function setLineSpacing (lineSpacing :Float) :TextSprite\n    {\n        this.lineSpacing._ = lineSpacing;\n        return this;\n    }\n\n    /**\n     * Chainable convenience method to set the text alignment.\n     * @returns This instance, for chaining.\n     */\n    public function setAlign (align :TextAlign) :TextSprite\n    {\n        this.align = align;\n        return this;\n    }\n\n    inline private function get_text () :String\n    {\n        return _text;\n    }\n\n    private function set_text (text :String) :String\n    {\n        if (text != _text) {\n            _text = text;\n            _flags = _flags.add(TEXT_DIRTY);\n        }\n        return text;\n    }\n\n    inline private function get_font () :Font\n    {\n        return _font;\n    }\n\n    private function set_font (font :Font) :Font\n    {\n        if (font != _font) {\n            _font = font;\n            _flags = _flags.add(TEXT_DIRTY);\n        }\n        return font;\n    }\n\n    inline private function get_align () :TextAlign\n    {\n        return _align;\n    }\n\n    private function set_align (align :TextAlign) :TextAlign\n    {\n        if (align != _align) {\n            _align = align;\n            _flags = _flags.add(TEXT_DIRTY);\n        }\n        return align;\n    }\n\n    private function updateLayout ()\n    {\n#if debug\n        var reloadCount = _font.checkReload();\n        if (reloadCount != _lastReloadCount) {\n            _lastReloadCount = reloadCount;\n            _flags = _flags.add(TEXT_DIRTY);\n        }\n#end\n\n        // Recreate the layout if necessary\n        if (_flags.contains(TEXT_DIRTY)) {\n            _flags = _flags.remove(TEXT_DIRTY);\n            _layout = font.layoutText(_text, _align, wrapWidth._, letterSpacing._, lineSpacing._);\n        }\n    }\n\n    override public function onUpdate (dt :Float)\n    {\n        super.onUpdate(dt);\n        wrapWidth.update(dt);\n        letterSpacing.update(dt);\n        lineSpacing.update(dt);\n    }\n\n    // Component flags\n    private static inline var TEXT_DIRTY = Sprite.NEXT_FLAG << 0;\n    private static inline var NEXT_FLAG = Sprite.NEXT_FLAG << 1; // Must be last!\n\n    private var _font :Font;\n    private var _text :String;\n    private var _align :TextAlign;\n\n    private var _layout :TextLayout = null;\n\n#if debug\n    private var _lastReloadCount :Int = -1;\n#end\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.input;\n\n/**\n * Represents an event coming from a physical key press.\n *\n * _NOTE_: For performance reasons, KeyboardEvent instances are reused by Flambe. Use `clone()` to\n * retain a reference to an event.\n */\nclass KeyboardEvent\n{\n    /**\n     * The key that caused this event.\n     */\n    public var key (default, null) :Key;\n\n    /**\n     * An incrementing ID unique to every dispatched key event.\n     */\n    public var id (default, null) :Int;\n\n    @:allow(flambe) function new ()\n    {\n        init(0, null);\n    }\n\n    /**\n     * Creates a copy of this event.\n     */\n    public function clone () :KeyboardEvent\n    {\n        var event = new KeyboardEvent();\n        event.init(id, key);\n        return event;\n    }\n\n    @:allow(flambe) function init (id :Int, key :Key)\n    {\n        this.id = id;\n        this.key = key;\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.input;\n\n/**\n * Represents an event coming from a mouse.\n *\n * _NOTE_: For performance reasons, MouseEvent instances are reused by Flambe. Use `clone()` to\n * retain a reference to an event.\n */\nclass MouseEvent\n{\n    /**\n     * The X position of the mouse, in view (stage) coordinates.\n     */\n    public var viewX (default, null) :Float;\n\n    /**\n     * The Y position of the mouse, in view (stage) coordinates.\n     */\n    public var viewY (default, null) :Float;\n\n    /**\n     * The mouse button that caused this event, or null for movement events.\n     */\n    public var button (default, null) :MouseButton;\n\n    /**\n     * An incrementing ID unique to every dispatched mouse event.\n     */\n    public var id (default, null) :Int;\n\n    @:allow(flambe) function new ()\n    {\n        init(0, 0, 0, null);\n    }\n\n    /**\n     * Creates a copy of this event.\n     */\n    public function clone () :MouseEvent\n    {\n        var event = new MouseEvent();\n        event.init(id, viewX, viewY, button);\n        return event;\n    }\n\n    @:allow(flambe) function init (id :Int, viewX :Float, viewY :Float, button :MouseButton)\n    {\n        this.id = id;\n        this.viewX = viewX;\n        this.viewY = viewY;\n        this.button = button;\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.input;\n\nimport flambe.display.Sprite;\n\nenum EventSource\n{\n    Mouse (event :MouseEvent);\n    Touch (point :TouchPoint);\n}\n\n/**\n * Represents an event coming from a pointing device, such as a mouse or finger.\n *\n * _NOTE_: For performance reasons, PointerEvent instances are reused by Flambe. Use `clone()` to\n * retain a reference to an event.\n */\nclass PointerEvent\n{\n    /**\n     * The X position of the pointing device, in view (stage) coordinates.\n     */\n    public var viewX (default, null) :Float;\n\n    /**\n     * The Y position of the pointing device, in view (stage) coordinates.\n     */\n    public var viewY (default, null) :Float;\n\n    /**\n     * The deepest sprite lying under the pointer that caused the event, if any. The hit sprite does\n     * not necessarily have a pointer event listener connected to it. This event starts at the hit\n     * sprite, and propagates upwards to its parents.\n     */\n    public var hit (default, null) :Sprite;\n\n    /**\n     * The source that this event originated from. This can be used to determine if the event came\n     * from a mouse or a touch.\n     */\n    public var source (default, null) :EventSource;\n\n    /**\n     * An incrementing ID unique to every dispatched pointer event.\n     */\n    public var id (default, null) :Int;\n\n    @:allow(flambe) function new ()\n    {\n        init(0, 0, 0, null, null);\n    }\n\n    /**\n     * Prevents this PointerEvent from propagating up to parent sprites and the top-level Pointer\n     * signal. Other listeners for this event on the current sprite will still fire.\n     */\n    inline public function stopPropagation ()\n    {\n        _stopped = true;\n    }\n\n    /**\n     * Creates a copy of this event.\n     */\n    public function clone () :PointerEvent\n    {\n        // Ensure the source gets deep copied too\n        var sourceCopy = null;\n        switch (source) {\n            case Mouse(event): sourceCopy = Mouse(event.clone());\n            default: sourceCopy = source;\n        }\n\n        var event = new PointerEvent();\n        event.init(id, viewX, viewY, hit, sourceCopy);\n        return event;\n    }\n\n    @:allow(flambe) function init (\n        id :Int, viewX :Float, viewY :Float, hit :Sprite, source :EventSource)\n    {\n        this.id = id;\n        this.viewX = viewX;\n        this.viewY = viewY;\n        this.hit = hit;\n        this.source = source;\n        _stopped = false;\n    }\n\n    @:allow(flambe) var _stopped :Bool;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.input;\n\nimport flambe.input.PointerEvent;\n\n/**\n * Represents a touch screen contact point, such as a finger. It is possible to retain a reference\n * to a TouchPoint, and track changes to it over time.\n */\nclass TouchPoint\n{\n    /**\n     * The X position of the touch, in view (stage) coordinates. This value is modified when the\n     * point moves.\n     */\n    public var viewX (default, null) :Float;\n\n    /**\n     * The Y position of the touch, in view (stage) coordinates. This value is modified when the\n     * point moves.\n     */\n    public var viewY (default, null) :Float;\n\n    /**\n     * An identifier unique to this touch.\n     */\n    public var id (default, null) :Int;\n\n    @:allow(flambe) function new (id :Int)\n    {\n        this.id = id;\n        _source = Touch(this);\n    }\n\n    @:allow(flambe) function init (viewX :Float, viewY :Float)\n    {\n        this.viewX = viewX;\n        this.viewY = viewY;\n    }\n\n    // Cached to avoid lots of allocation\n    @:allow(flambe) var _source :EventSource;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.math;\n\n/**\n * Some handy math functions, and inlinable constants.\n */\nclass FMath\n{\n    public static inline var E = 2.718281828459045;\n    public static inline var LN2 = 0.6931471805599453;\n    public static inline var LN10 = 2.302585092994046;\n    public static inline var LOG2E = 1.4426950408889634;\n    public static inline var LOG10E = 0.43429448190325176;\n    public static inline var PI = 3.141592653589793;\n    public static inline var SQRT1_2 = 0.7071067811865476;\n    public static inline var SQRT2 = 1.4142135623730951;\n\n    // Haxe doesn't specify the size of an int or float, in practice it's 32 bits\n    /** The lowest integer value in Flash and JS. */\n    public static inline var INT_MIN :Int = -2147483648;\n\n    /** The highest integer value in Flash and JS. */\n    public static inline var INT_MAX :Int = 2147483647;\n\n    /** The lowest float value in Flash and JS. */\n    public static inline var FLOAT_MIN = -1.79769313486231e+308;\n\n    /** The highest float value in Flash and JS. */\n    public static inline var FLOAT_MAX = 1.79769313486231e+308;\n\n    /** Converts an angle in degrees to radians. */\n    inline public static function toRadians (degrees :Float) :Float\n    {\n        return degrees * PI/180;\n    }\n\n    /** Converts an angle in radians to degrees. */\n    inline public static function toDegrees (radians :Float) :Float\n    {\n        return radians * 180/PI;\n    }\n\n    #if !js @:generic #end\n    inline public static function max<T:Float> (a :T, b :T) :T\n    {\n        return (a > b) ? a : b;\n    }\n\n    #if !js @:generic #end\n    inline public static function min<T:Float> (a :T, b :T) :T\n    {\n        return (a < b) ? a : b;\n    }\n\n    #if !js @:generic #end\n    public static function clamp<T:Float> (value :T, min :T, max :T) :T\n    {\n        return if (value < min) min\n            else if (value > max) max\n            else value;\n    }\n\n    public static function sign (value :Float) :Int\n    {\n        return if (value < 0) -1\n            else if (value > 0) 1\n            else 0;\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.math;\n\n/**\n * A 2D transform matrix.\n *\n * ```\n * [ m00 m01 m02 ]\n * [ m10 m11 m12 ]\n * [  0   0   1  ]\n * ```\n */\nclass Matrix\n{\n    public var m00 :Float;\n    public var m10 :Float;\n    public var m01 :Float;\n    public var m11 :Float;\n    public var m02 :Float;\n    public var m12 :Float;\n\n    public function new ()\n    {\n        identity();\n    }\n\n    public function set (m00 :Float, m10 :Float, m01 :Float, m11 :Float, m02 :Float, m12 :Float)\n    {\n        this.m00 = m00; this.m01 = m01; this.m02 = m02;\n        this.m10 = m10; this.m11 = m11; this.m12 = m12;\n    }\n\n    /**\n     * Sets this matrix to the identity matrix.\n     */\n    public function identity ()\n    {\n        set(1, 0, 0, 1, 0, 0);\n    }\n\n    /**\n     * Set this matrix to a translation, scale, and rotation, in that order.\n     */\n    public function compose (x :Float, y :Float, scaleX :Float, scaleY :Float, rotation :Float)\n    {\n        var sin = Math.sin(rotation);\n        var cos = Math.cos(rotation);\n        set(cos*scaleX, sin*scaleX, -sin*scaleY, cos*scaleY, x, y);\n    }\n\n    public function translate (x :Float, y :Float)\n    {\n        m02 += m00*x + m01*y;\n        m12 += m11*y + m10*x;\n    }\n\n    public function scale (x :Float, y :Float)\n    {\n        m00 *= x;\n        m10 *= x;\n        m01 *= y;\n        m11 *= y;\n    }\n\n    public function rotate (rotation :Float)\n    {\n        var sin = Math.sin(rotation);\n        var cos = Math.cos(rotation);\n\n        var t00 = m00*cos + m01*sin;\n        var t01 = -m00*sin + m01*cos;\n        m00 = t00;\n        m01 = t01;\n\n        var t10 = m11*sin + m10*cos;\n        var t11 = m11*cos - m10*sin;\n        m10 = t10;\n        m11 = t11;\n    }\n\n    /** @return Whether the matrix was inverted. */\n    public function invert () :Bool\n    {\n        var det = determinant();\n        if (det == 0) {\n            return false;\n        }\n        set(m11/det, -m01/det, -m10/det, m00/det,\n            (m01*m12 - m11*m02) / det,\n            (m10*m02 - m00*m12) / det);\n        return true;\n    }\n\n    public function transform (x :Float, y :Float, ?result :Point) :Point\n    {\n        if (result == null) {\n            result = new Point();\n        }\n        result.x = x*m00 + y*m01 + m02;\n        result.y = x*m10 + y*m11 + m12;\n        return result;\n    }\n\n    public function transformArray (points :ArrayAccess<Float>, length :Int,\n        result :ArrayAccess<Float>)\n    {\n        var ii = 0;\n        while (ii < length) {\n            var x = points[ii], y = points[ii+1];\n            result[ii++] = x*m00 + y*m01 + m02;\n            result[ii++] = x*m10 + y*m11 + m12;\n        }\n    }\n\n    /**\n     * Calculate the determinant of this matrix.\n     */\n    public function determinant () :Float\n    {\n        return m00*m11 - m01*m10;\n    }\n\n    /**\n     * Transforms a point by the inverse of this matrix, or return false if this matrix is not\n     * invertible.\n     */\n    public function inverseTransform (x :Float, y :Float, result :Point) :Bool\n    {\n        var det = determinant();\n        if (det == 0) {\n            return false;\n        }\n        x -= m02;\n        y -= m12;\n        result.x = (x*m11 - y*m01) / det;\n        result.y = (y*m00 - x*m10) / det;\n        return true;\n    }\n\n    /**\n     * Multiply two matrices and return the result.\n     */\n    public static function multiply (lhs :Matrix, rhs :Matrix, ?result :Matrix) :Matrix\n    {\n        if (result == null) {\n            result = new Matrix();\n        }\n\n        // First row\n        var a = lhs.m00*rhs.m00 + lhs.m01*rhs.m10;\n        var b = lhs.m00*rhs.m01 + lhs.m01*rhs.m11;\n        var c = lhs.m00*rhs.m02 + lhs.m01*rhs.m12 + lhs.m02;\n        result.m00 = a;\n        result.m01 = b;\n        result.m02 = c;\n\n        // Second row\n        a = lhs.m10*rhs.m00 + lhs.m11*rhs.m10;\n        b = lhs.m10*rhs.m01 + lhs.m11*rhs.m11;\n        c = lhs.m10*rhs.m02 + lhs.m11*rhs.m12 + lhs.m12;\n        result.m10 = a;\n        result.m11 = b;\n        result.m12 = c;\n\n        return result;\n    }\n\n    /**\n     * Creates a copy of this matrix.\n     */\n    public function clone (?result :Matrix) :Matrix\n    {\n        if (result == null) {\n            result = new Matrix();\n        }\n        result.set(m00, m10, m01, m11, m02, m12);\n        return result;\n    }\n\n    #if debug @:keep #end public function toString () :String\n    {\n        return m00 + \" \" + m01 + \" \" + m02 + \" \\\\ \" +\n            m10 + \" \" + m11 + \" \" + m12;\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.math;\n\n/**\n * A 2D rectangle.\n */\nclass Rectangle\n{\n    public var x :Float;\n    public var y :Float;\n    public var width :Float;\n    public var height :Float;\n\n    /** The X-coordinate of the left side of the rectangle. */\n    public var left (get, null) :Float;\n\n    /** The X-coordinate of the right side of the rectangle. */\n    public var right (get, null) :Float;\n\n    /** The Y-coordinate of the top side of the rectangle. */\n    public var top (get, null) :Float;\n\n    /** The Y-coordinate of the bottom side of the rectangle. */\n    public var bottom (get, null) :Float;\n\n    /** The X-coordinate of the center of the rectangle. */\n    public var centerX (get, null) :Float;\n\n    /** The Y-coordinate of the center of the rectangle. */\n    public var centerY (get, null) :Float;\n\n    public function new (x :Float = 0, y :Float = 0, width :Float = 0, height :Float = 0)\n    {\n        set(x, y, width, height);\n    }\n\n    public function set (x :Float, y :Float, width :Float, height :Float)\n    {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n\n    /**\n     * Returns true if this rectangle contains the given point.\n     */\n    public function contains (x :Float, y :Float) :Bool\n    {\n        // A little more complicated than usual due to proper handling of negative widths/heights\n\n        x -= this.x;\n        if (width >= 0) {\n            if (x < 0 || x > width) {\n                return false;\n            }\n        } else if (x > 0 || x < width) {\n            return false;\n        }\n\n        y -= this.y;\n        if (height >= 0) {\n            if (y < 0 || y > height) {\n                return false;\n            }\n        } else if (y > 0 || y < height) {\n            return false;\n        }\n\n        return true;\n    }\n\n    /**\n     * Returns whether this rectangle intersects another rectangle.\n     *\n     * @param rect The other rectangle to check for intersection.\n     * @param result If supplied and the rectangles intersect, will be set to the calculated\n     *   intersection rectangle.\n     */\n    public function intersects (rect :Rectangle, ?result: Rectangle) :Bool\n    {\n        var left = FMath.max(this.left, rect.left);\n        var right = FMath.min(this.right, rect.right);\n        if (left > right) {\n            return false;\n        }\n\n        var top = FMath.max(this.top, rect.top);\n        var bottom = FMath.min(this.bottom, rect.bottom);\n        if (top > bottom) {\n            return false;\n        }\n\n        if (result != null) {\n            result.set(left, top, right-left, bottom-top);\n        }\n        return true;\n    }\n\n    /**\n     * Creates a copy of this rectangle.\n     */\n    public function clone (?result :Rectangle) :Rectangle\n    {\n        if (result == null) {\n            result = new Rectangle();\n        }\n        result.set(x, y, width, height);\n        return result;\n    }\n\n    public function equals (other :Rectangle) :Bool\n    {\n        return x == other.x && y == other.y && width == other.width && height == other.height;\n    }\n\n    #if debug @:keep #end public function toString () :String\n    {\n        return \"(\" + x + \",\" + y + \" \" + width + \"x\" + height + \")\";\n    }\n\n    inline private function get_left () :Float\n    {\n        return x;\n    }\n\n    inline private function get_top () :Float\n    {\n        return y;\n    }\n\n    private function get_right () :Float\n    {\n        return x + width;\n    }\n\n    private function get_bottom () :Float\n    {\n        return y + height;\n    }\n\n    private function get_centerX () :Float\n    {\n        return x + width/2;\n    }\n\n    private function get_centerY () :Float\n    {\n        return y + height/2;\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.asset.Asset;\nimport flambe.util.Assert;\nimport flambe.util.Value;\n\nclass BasicAsset<A/*:BasicAsset<A>*/>\n    implements Asset\n{\n    public var reloadCount (get, null) :Value<Int>;\n\n    public function new ()\n    {\n    }\n\n    inline public function assertNotDisposed ()\n    {\n        Assert.that(!_disposed, \"Asset cannot be used after being disposed\");\n    }\n\n    @:final public function reload (asset :A)\n    {\n        dispose();\n        _disposed = false;\n        copyFrom(asset);\n        ++reloadCount._;\n    }\n\n    @:final public function dispose ()\n    {\n        if (!_disposed) {\n            _disposed = true;\n            onDisposed();\n        }\n    }\n\n    /** Fully copy the content from another asset type, for reloading. */\n    private function copyFrom (asset :A)\n    {\n        Assert.fail(); // See subclasses\n    }\n\n    /** Handle disposing. */\n    private function onDisposed ()\n    {\n        Assert.fail(); // See subclasses\n    }\n\n    // Overridden in subclasses!\n    private function get_reloadCount () :Value<Int>\n    {\n        if (_reloadCount == null) {\n            _reloadCount = new Value<Int>(0);\n        }\n        return _reloadCount;\n    }\n\n    private var _disposed :Bool = false;\n    private var _reloadCount :Value<Int> = null;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.asset.AssetEntry;\nimport flambe.asset.AssetPack;\nimport flambe.asset.File;\nimport flambe.asset.Manifest;\nimport flambe.display.Texture;\nimport flambe.sound.Sound;\nimport flambe.util.Assert;\nimport flambe.util.Promise;\n\nusing Lambda;\nusing flambe.util.Arrays;\nusing flambe.util.Strings;\n\nclass BasicAssetPackLoader\n{\n    public var promise (default, null) :Promise<AssetPack>;\n    public var manifest (default, null) :Manifest;\n\n    public function new (platform :Platform, manifest :Manifest)\n    {\n        this.manifest = manifest;\n        _platform = platform;\n        promise = new Promise();\n        _bytesLoaded = new Map();\n        _pack = new BasicAssetPack(manifest, this);\n\n        var entries = manifest.array();\n        if (entries.length == 0) {\n            // There's nothing to load, just send them an empty pack\n            handleSuccess();\n\n        } else {\n            var groups = new Map<String,Array<AssetEntry>>();\n\n            // Group assets by name\n            for (entry in entries) {\n                var group = groups.get(entry.name);\n                if (group == null) {\n                    group = [];\n                    groups.set(entry.name, group);\n                }\n                group.push(entry);\n            }\n\n            // Load the most suitable asset from each group\n            _assetsRemaining = groups.count();\n            for (group in groups) {\n                pickBestEntry(group, function (bestEntry :AssetEntry) {\n                    if (bestEntry != null) {\n                        var url = manifest.getFullURL(bestEntry);\n                        try {\n                            loadEntry(url, bestEntry);\n                        } catch (error :Dynamic) {\n                            handleError(bestEntry, \"Unexpected error: \" + error);\n                        }\n                        promise.total += bestEntry.bytes;\n\n                    } else {\n                        var badEntry = group[0];\n                        if (isAudio(badEntry.format)) {\n                            // Deal with missing audio files and bad browser support\n                            Log.warn(\"Could not find a supported audio format to load\", [\"name\", badEntry.name]);\n                            handleLoad(badEntry, DummySound.getInstance());\n                        } else {\n                            handleError(badEntry, \"Could not find a supported format to load\");\n                        }\n                    }\n                });\n            }\n        }\n\n#if debug\n        var catapult = _platform.getCatapultClient();\n        if (catapult != null) {\n            catapult.add(this);\n        }\n#end\n    }\n\n    /** Reload any asset that matches this URL (ignoring the ?v= query param). */\n    public function reload (url :String)\n    {\n        // Find the AssetEntry that matches this url\n        var baseUrl = removeUrlParams(url);\n        var foundEntry = null;\n        for (entry in manifest) {\n            if (baseUrl == removeUrlParams(entry.url)) {\n                foundEntry = entry;\n                break;\n            }\n        }\n\n        // If the entry was found in this manifest, and is a supported format\n        if (foundEntry != null) {\n            getAssetFormats(function (formats :Array<AssetFormat>) {\n                if (formats.indexOf(foundEntry.format) >= 0) {\n                    // Dummy up a new AssetEntry based on the previous one, and reload it\n                    var entry = new AssetEntry(foundEntry.name, url, foundEntry.format, 0);\n                    loadEntry(manifest.getFullURL(entry), entry);\n                }\n            });\n        }\n    }\n\n    /** Called when this loader's AssetPack is disposed. */\n    public function onDisposed ()\n    {\n#if debug\n        var catapult = _platform.getCatapultClient();\n        if (catapult != null) {\n            catapult.remove(this);\n        }\n#end\n    }\n\n    private static function removeUrlParams (url :String) :String\n    {\n        var query = url.indexOf(\"?\");\n        return (query > 0) ? url.substr(0, query) : url;\n    }\n\n    /**\n     * Out of a list of asset entries with the same name, select the one best supported by this\n     * environment, or null if none of them are supported.\n     */\n    private function pickBestEntry (entries :Array<AssetEntry>, fn :AssetEntry -> Void)\n    {\n        var onFormatsAvailable = function (formats :Array<AssetFormat>) {\n            for (format in formats) {\n                for (entry in entries) {\n                    if (entry.format == format) {\n                        fn(entry);\n                        return;\n                    }\n                }\n            }\n            fn(null); // This asset is not supported, we're boned\n        };\n\n        getAssetFormats(onFormatsAvailable);\n    }\n\n    private function loadEntry (url :String, entry :AssetEntry)\n    {\n        Assert.fail(); // See subclasses\n    }\n\n    /** Gets the list of asset formats the environment supports, ordered by preference. */\n    private function getAssetFormats (fn :Array<AssetFormat> -> Void)\n    {\n        Assert.fail(); // See subclasses\n    }\n\n    private function handleLoad<A/*:BasicAsset<A>*/> (entry :AssetEntry, asset :A)\n    {\n        if (_pack.disposed) {\n            return; // Pack was disposed earlier, forget about it\n        }\n\n        // Ensure this asset has been fully progressed\n        handleProgress(entry, entry.bytes);\n\n        var map :Map<String,Dynamic>;\n        switch (entry.format) {\n        case WEBP, JXR, PNG, JPG, GIF, DDS, PVR, PKM:\n            map = _pack.textures;\n        case MP3, M4A, OPUS, OGG, WAV:\n            map = _pack.sounds;\n        case Data:\n            map = _pack.files;\n        }\n\n#if debug // Allow some methods to get stripped in release builds, which don't allow reloading\n        var oldAsset :BasicAsset<A> = cast map.get(entry.name);\n        if (oldAsset != null) {\n            Log.info(\"Reloaded asset\", [\"url\", entry.url]);\n            oldAsset.reload(asset);\n\n        } else {\n#end\n            map.set(entry.name, asset);\n            _assetsRemaining -= 1;\n            if (_assetsRemaining == 0) {\n                handleSuccess();\n            }\n#if debug\n        }\n#end\n    }\n\n    private function handleProgress (entry :AssetEntry, bytesLoaded :Int)\n    {\n        _bytesLoaded.set(entry.name, bytesLoaded);\n\n        var bytesTotal = 0;\n        for (bytes in _bytesLoaded) {\n            bytesTotal += bytes;\n        }\n        promise.progress = bytesTotal;\n    }\n\n    private function handleSuccess ()\n    {\n        promise.result = _pack;\n    }\n\n    private function handleError (entry :AssetEntry, message :String)\n    {\n        Log.warn(\"Error loading asset pack\", [\"error\", message, \"url\", entry.url]);\n        promise.error.emit(message.withFields([\"url\", entry.url]));\n    }\n\n    private function handleTextureError (entry :AssetEntry)\n    {\n        handleError(entry, \"Failed to create texture. Is the GPU context unavailable?\");\n    }\n\n    private static function isAudio (format :AssetFormat) :Bool\n    {\n        switch (format) {\n            case MP3, M4A, OPUS, OGG, WAV: return true;\n            default: return false;\n        }\n    }\n\n    private var _platform :Platform;\n\n    // How many assets are still loading\n    private var _assetsRemaining :Int;\n\n    // How many bytes of each asset have been loaded\n    private var _bytesLoaded :Map<String,Int>;\n\n    private var _pack :BasicAssetPack;\n}\n\n// A simple AssetPack backed by a Map\nprivate class BasicAssetPack\n    implements AssetPack\n{\n    public var manifest (get, null) :Manifest;\n    public var loader (default, null) :BasicAssetPackLoader;\n\n    public var textures :Map<String,Texture>;\n    public var sounds :Map<String,Sound>;\n    public var files :Map<String,File>;\n\n    public var disposed :Bool = false;\n\n    public function new (manifest :Manifest, loader :BasicAssetPackLoader)\n    {\n        _manifest = manifest;\n        this.loader = loader;\n\n        textures = new Map();\n        sounds = new Map();\n        files = new Map();\n    }\n\n    public function getTexture (name :String, required :Bool = true) :Texture\n    {\n        assertNotDisposed();\n#if debug\n        warnOnExtension(name);\n#end\n        var texture = textures.get(name);\n        if (texture == null && required) {\n            throw \"Missing texture\".withFields([\"name\", name]);\n        }\n        return texture;\n    }\n\n    public function getSound (name :String, required :Bool = true) :Sound\n    {\n        assertNotDisposed();\n#if debug\n        warnOnExtension(name);\n#end\n        var sound = sounds.get(name);\n        if (sound == null && required) {\n            throw \"Missing sound\".withFields([\"name\", name]);\n        }\n        return sound;\n    }\n\n    public function getFile (name :String, required :Bool = true) :File\n    {\n        assertNotDisposed();\n\n        var file = files.get(name);\n        if (file == null && required) {\n            throw \"Missing file\".withFields([\"name\", name]);\n        }\n        return file;\n    }\n\n    // Dispose all assets contained in this pack\n    public function dispose ()\n    {\n        if (!disposed) {\n            disposed = true;\n\n            for (texture in textures) {\n                texture.dispose();\n            }\n            textures = null;\n\n            for (sound in sounds) {\n                sound.dispose();\n            }\n            sounds = null;\n\n            for (file in files) {\n                file.dispose();\n            }\n            files = null;\n\n            loader.onDisposed();\n        }\n    }\n\n    inline private function get_manifest () :Manifest\n    {\n        return _manifest;\n    }\n\n    inline private function assertNotDisposed ()\n    {\n        Assert.that(!disposed, \"AssetPack cannot be used after being disposed\");\n    }\n\n    private static function warnOnExtension (path :String)\n    {\n        var ext = path.getFileExtension();\n        if (ext != null && ext.length == 3) {\n            Log.warn(\"Requested asset \\\"\" + path + \"\\\" should not have a file extension,\" +\n                \" did you mean \\\"\" + path.removeFileExtension() + \"\\\"?\");\n        }\n    }\n\n    private var _manifest :Manifest;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.asset.File;\n\nclass BasicFile extends BasicAsset<BasicFile>\n    implements File\n{\n    public function new (content :String)\n    {\n        super();\n        _content = content;\n    }\n\n    public function toString ()\n    {\n        assertNotDisposed();\n\n        return _content;\n    }\n\n    override private function copyFrom (that :BasicFile)\n    {\n        this._content = that._content;\n    }\n\n    override private function onDisposed ()\n    {\n        _content = null;\n    }\n\n    private var _content :String;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.input.Key;\nimport flambe.input.KeyboardEvent;\nimport flambe.subsystem.KeyboardSystem;\nimport flambe.util.Signal0;\nimport flambe.util.Signal1;\n\nusing flambe.platform.KeyCodes;\n\nclass BasicKeyboard\n    implements KeyboardSystem\n{\n    public var supported (get, null) :Bool;\n\n    public var down (default, null) :Signal1<KeyboardEvent>;\n    public var up (default, null) :Signal1<KeyboardEvent>;\n    public var backButton (default, null) :Signal0;\n\n    public function new ()\n    {\n        down = new Signal1();\n        up = new Signal1();\n        backButton = new Signal0();\n        _keyStates = new Map();\n    }\n\n    public function get_supported () :Bool\n    {\n        return true;\n    }\n\n    public function isDown (key :Key) :Bool\n    {\n        return isCodeDown(key.toKeyCode());\n    }\n\n    inline private function isCodeDown (keyCode :Int) :Bool\n    {\n        return _keyStates.exists(keyCode);\n    }\n\n    /**\n     * Called by the platform to handle a down event.\n     * @return Whether default action should be prevented.\n     */\n    public function submitDown (keyCode :Int) :Bool\n    {\n        if (keyCode == KeyCodes.BACK) {\n            if (backButton.hasListeners()) {\n                backButton.emit();\n                return true;\n            }\n            return false; // No preventDefault\n        }\n\n        if (!isCodeDown(keyCode)) {\n            _keyStates.set(keyCode, true);\n            _sharedEvent.init(_sharedEvent.id+1, keyCode.toKey());\n            down.emit(_sharedEvent);\n        }\n        return true;\n    }\n\n    /**\n     * Called by the platform to handle an up event.\n     */\n    public function submitUp (keyCode :Int)\n    {\n        if (isCodeDown(keyCode)) {\n            _keyStates.remove(keyCode);\n            _sharedEvent.init(_sharedEvent.id+1, keyCode.toKey());\n            up.emit(_sharedEvent);\n        }\n    }\n\n    private static var _sharedEvent = new KeyboardEvent();\n\n    private var _keyStates :Map<Int,Bool>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.input.MouseButton;\nimport flambe.input.MouseCursor;\nimport flambe.input.MouseEvent;\nimport flambe.input.PointerEvent;\nimport flambe.subsystem.MouseSystem;\nimport flambe.util.Signal1;\n\nusing flambe.platform.MouseCodes;\n\nclass BasicMouse\n    implements MouseSystem\n{\n    public var supported (get, null) :Bool;\n\n    public var down (default, null) :Signal1<MouseEvent>;\n    public var move (default, null) :Signal1<MouseEvent>;\n    public var up (default, null) :Signal1<MouseEvent>;\n    public var scroll (default, null) :Signal1<Float>;\n\n    public var x (get, null) :Float;\n    public var y (get, null) :Float;\n    public var cursor (get, set) :MouseCursor;\n\n    public function new (pointer :BasicPointer)\n    {\n        _pointer = pointer;\n        _source = Mouse(_sharedEvent);\n\n        down = new Signal1();\n        move = new Signal1();\n        up = new Signal1();\n        scroll = new Signal1();\n        _x = 0;\n        _y = 0;\n        _cursor = Default;\n        _buttonStates = new Map();\n    }\n\n    public function get_supported () :Bool\n    {\n        return true;\n    }\n\n    public function get_x () :Float\n    {\n        return _x;\n    }\n\n    public function get_y () :Float\n    {\n        return _y;\n    }\n\n    public function get_cursor () :MouseCursor\n    {\n        return _cursor;\n    }\n\n    public function set_cursor (cursor :MouseCursor) :MouseCursor\n    {\n        // See subclasses for implementation\n        return _cursor = cursor;\n    }\n\n    public function isDown (button :MouseButton) :Bool\n    {\n        return isCodeDown(button.toButtonCode());\n    }\n\n    public function submitDown (viewX :Float, viewY :Float, buttonCode :Int)\n    {\n        if (!isCodeDown(buttonCode)) {\n            _buttonStates.set(buttonCode, true);\n\n            // Init the MouseEvent, and let the Pointer system handle it before emitting our signal\n            prepare(viewX, viewY, buttonCode.toButton());\n            _pointer.submitDown(viewX, viewY, _source);\n            down.emit(_sharedEvent);\n        }\n    }\n\n    public function submitMove (viewX :Float, viewY :Float)\n    {\n        prepare(viewX, viewY, null);\n        _pointer.submitMove(viewX, viewY, _source);\n        move.emit(_sharedEvent);\n    }\n\n    public function submitUp (viewX :Float, viewY :Float, buttonCode :Int)\n    {\n        if (isCodeDown(buttonCode)) {\n            _buttonStates.remove(buttonCode);\n\n            prepare(viewX, viewY, buttonCode.toButton());\n            _pointer.submitUp(viewX, viewY, _source);\n            up.emit(_sharedEvent);\n        }\n    }\n\n    // Returns true if the scroll signal was handled\n    public function submitScroll (viewX :Float, viewY :Float, velocity :Float) :Bool\n    {\n        _x = viewX;\n        _y = viewY;\n        if (!scroll.hasListeners()) {\n            return false;\n        }\n        scroll.emit(velocity);\n        return true;\n    }\n\n    inline private function isCodeDown (buttonCode :Int) :Bool\n    {\n        return _buttonStates.exists(buttonCode);\n    }\n\n    private function prepare (viewX :Float, viewY :Float, button :MouseButton)\n    {\n        _x = viewX;\n        _y = viewY;\n        _sharedEvent.init(_sharedEvent.id+1, viewX, viewY, button);\n    }\n\n    private static var _sharedEvent = new MouseEvent();\n\n    private var _pointer :BasicPointer;\n    private var _source :EventSource;\n\n    private var _x :Float;\n    private var _y :Float;\n    private var _cursor :MouseCursor;\n    private var _buttonStates :Map<Int,Bool>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.display.Sprite;\nimport flambe.input.PointerEvent;\nimport flambe.math.Point;\nimport flambe.scene.Director;\nimport flambe.subsystem.PointerSystem;\nimport flambe.util.Signal1;\n\nusing Lambda;\n\nclass BasicPointer\n    implements PointerSystem\n{\n    public var supported (get, null) :Bool;\n\n    public var down (default, null) :Signal1<PointerEvent>;\n    public var move (default, null) :Signal1<PointerEvent>;\n    public var up (default, null) :Signal1<PointerEvent>;\n\n    public var x (get, null) :Float;\n    public var y (get, null) :Float;\n\n    public function new (x :Float = 0, y :Float = 0, isDown :Bool = false)\n    {\n        down = new Signal1();\n        move = new Signal1();\n        up = new Signal1();\n        _x = x;\n        _y = y;\n        _isDown = isDown;\n    }\n\n    public function get_supported () :Bool\n    {\n        return true;\n    }\n\n    public function get_x () :Float\n    {\n        return _x;\n    }\n\n    public function get_y () :Float\n    {\n        return _y;\n    }\n\n    public function isDown () :Bool\n    {\n        return _isDown;\n    }\n\n    /**\n     * Called by the platform to handle a down event.\n     */\n    public function submitDown (viewX :Float, viewY :Float, source :EventSource)\n    {\n        if (_isDown) {\n            return; // Ignore repeat down events\n        }\n        // Ensure a move event is sent first\n        submitMove(viewX, viewY, source);\n        _isDown = true;\n\n        // Take a snapshot of the entire event bubbling chain\n        var chain = [];\n        var hit = Sprite.hitTest(System.root, viewX, viewY);\n        if (hit != null) {\n            var entity = hit.owner;\n            do {\n                var sprite = entity.get(Sprite);\n                if (sprite != null) {\n                    chain.push(sprite);\n                }\n                entity = entity.parent;\n            } while (entity != null);\n        }\n\n        // Finally, emit the event up the chain\n        prepare(viewX, viewY, hit, source);\n        for (sprite in chain) {\n            sprite.onPointerDown(_sharedEvent);\n            if (_sharedEvent._stopped) {\n                return;\n            }\n        }\n        down.emit(_sharedEvent);\n    }\n\n    /**\n     * Called by the platform to handle a move event.\n     */\n    public function submitMove (viewX :Float, viewY :Float, source :EventSource)\n    {\n        if (viewX == _x && viewY == _y) {\n            return; // Ignore repeated duplicate move events\n        }\n\n        // Take a snapshot of the entire event bubbling chain\n        var chain = [];\n        var hit = Sprite.hitTest(System.root, viewX, viewY);\n        if (hit != null) {\n            var entity = hit.owner;\n            do {\n                var sprite = entity.get(Sprite);\n                if (sprite != null) {\n                    chain.push(sprite);\n                }\n                entity = entity.parent;\n            } while (entity != null);\n        }\n\n        // Finally, emit the event up the chain\n        prepare(viewX, viewY, hit, source);\n        for (sprite in chain) {\n            sprite.onPointerMove(_sharedEvent);\n            if (_sharedEvent._stopped) {\n                return;\n            }\n        }\n        move.emit(_sharedEvent);\n    }\n\n    /**\n     * Called by the platform to handle an up event.\n     */\n    public function submitUp (viewX :Float, viewY :Float, source :EventSource)\n    {\n        if (!_isDown) {\n            return; // Ignore repeat up events\n        }\n        // Ensure a move event is sent first\n        submitMove(viewX, viewY, source);\n        _isDown = false;\n\n        // Take a snapshot of the entire event bubbling chain\n        var chain = [];\n        var hit = Sprite.hitTest(System.root, viewX, viewY);\n        if (hit != null) {\n            var entity = hit.owner;\n            do {\n                var sprite = entity.get(Sprite);\n                if (sprite != null) {\n                    chain.push(sprite);\n                }\n                entity = entity.parent;\n            } while (entity != null);\n        }\n\n        // Finally, emit the event up the chain\n        prepare(viewX, viewY, hit, source);\n        for (sprite in chain) {\n            sprite.onPointerUp(_sharedEvent);\n            if (_sharedEvent._stopped) {\n                return;\n            }\n        }\n        up.emit(_sharedEvent);\n    }\n\n    private function prepare (viewX :Float, viewY :Float, hit :Sprite, source :EventSource)\n    {\n        _x = viewX;\n        _y = viewY;\n        _sharedEvent.init(_sharedEvent.id+1, viewX, viewY, hit, source);\n    }\n\n    private static var _sharedEvent = new PointerEvent();\n    private static var _scratchPoint = new Point();\n\n    private var _x :Float;\n    private var _y :Float;\n    private var _isDown :Bool;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport haxe.io.Bytes;\n\nimport flambe.display.Graphics;\nimport flambe.display.SubTexture;\nimport flambe.display.Texture;\nimport flambe.util.Assert;\nimport flambe.util.Value;\n\n#if !js\n@:generic // for performance reasons\n#end\nclass BasicTexture<R:(TextureRoot,BasicAsset<R>)> extends BasicAsset<BasicTexture<R>>\n    implements SubTexture\n{\n    public var graphics (get, null) :Graphics;\n\n    public var parent (get, null) :Texture;\n\n    // The texture bounds\n    public var x (get, null) :Int;\n    public var y (get, null) :Int;\n    public var width (get, null) :Int;\n    public var height (get, null) :Int;\n\n    public var root (default, null) :R;\n\n    // The global position of this texture from the root\n    public var rootX (default, null) :Int = 0;\n    public var rootY (default, null) :Int = 0;\n\n    private function new (root :R, width :Int, height :Int)\n    {\n        super();\n        this.root = root;\n        _width = width;\n        _height = height;\n    }\n\n    public function readPixels (x :Int, y :Int, width :Int, height :Int) :Bytes\n    {\n        return root.readPixels(rootX+x, rootY+y, width, height);\n    }\n\n    public function writePixels (pixels :Bytes, x :Int, y :Int, sourceW :Int, sourceH :Int)\n    {\n        root.writePixels(pixels, rootX+x, rootY+y, sourceW, sourceH);\n    }\n\n    public function subTexture (x :Int, y :Int, width :Int, height :Int) :SubTexture\n    {\n        var sub :BasicTexture<R> = cast root.createTexture(width, height);\n        sub._parent = this;\n        sub._x = x;\n        sub._y = y;\n        sub.rootX = rootX + x;\n        sub.rootY = rootY + y;\n        return sub;\n    }\n\n    public function split (tilesWide :Int, tilesHigh :Int = 1) :Array<SubTexture>\n    {\n        var tiles = [];\n        var tileWidth = Std.int(_width / tilesWide);\n        var tileHeight = Std.int(_height / tilesHigh);\n        for (y in 0...tilesHigh) {\n            for (x in 0...tilesWide) {\n                tiles.push(subTexture(x*tileWidth, y*tileHeight, tileWidth, tileHeight));\n            }\n        }\n        return tiles;\n    }\n\n    // FIXME(bruno): Different textures that share the same root also share the same Graphics. This\n    // is an unfortunate limitation imposed by Canvas2D only allowing one context per canvas. We'll\n    // need to document this caveat somewhere, or change this API to workaround.\n    private function get_graphics () :Graphics\n    {\n        return root.getGraphics();\n    }\n\n    override private function copyFrom (that :BasicTexture<R>)\n    {\n        this.root._disposed = false;\n        this.root.copyFrom(that.root);\n\n        this._width = that._width;\n        this._height = that._height;\n\n        // We don't support mutability on the position, since it invalidates the rootX/Y of child\n        // subTextures. This assert should never fail with the asset reloader.\n        Assert.that(\n            this.rootX == that.rootX &&\n            this.rootY == that.rootY &&\n            this._x == that._x &&\n            this._y == that._y);\n    }\n\n    override private function onDisposed ()\n    {\n        // Since subtextures shouldn't be able to accidently dispose their parents and siblings,\n        // only dispose the root if this is the top-most subtexture.\n        if (_parent == null) {\n            root.dispose();\n        }\n    }\n\n    override private function get_reloadCount () :Value<Int>\n    {\n        // Delegate to the root, so that root reloads get propogated to all subtextures\n        return root.reloadCount;\n    }\n\n    inline private function get_parent () :Texture\n    {\n        return _parent;\n    }\n\n    inline private function get_x () :Int\n    {\n        return _x;\n    }\n\n    inline private function get_y () :Int\n    {\n        return _y;\n    }\n\n    inline private function get_width () :Int\n    {\n        return _width;\n    }\n\n    inline private function get_height () :Int\n    {\n        return _height;\n    }\n\n    private var _parent :BasicTexture<R> = null;\n\n    private var _x :Int = 0;\n    private var _y :Int = 0;\n    private var _width :Int;\n    private var _height :Int;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.input.TouchPoint;\nimport flambe.subsystem.TouchSystem;\nimport flambe.util.Signal1;\n\nclass BasicTouch\n    implements TouchSystem\n{\n    public var supported (get, null) :Bool;\n    public var maxPoints (get, null) :Int;\n    public var points (get, null) :Array<TouchPoint>;\n\n    public var down (default, null) :Signal1<TouchPoint>;\n    public var move (default, null) :Signal1<TouchPoint>;\n    public var up (default, null) :Signal1<TouchPoint>;\n\n    public function new (pointer :BasicPointer, maxPoints :Int = 4)\n    {\n        _pointer = pointer;\n        _maxPoints = maxPoints;\n        _pointMap = new Map();\n        _points = [];\n\n        down = new Signal1();\n        move = new Signal1();\n        up = new Signal1();\n    }\n\n    public function get_supported () :Bool\n    {\n        return true;\n    }\n\n    public function get_maxPoints () :Int\n    {\n        return _maxPoints;\n    }\n\n    public function get_points () :Array<TouchPoint>\n    {\n        return _points.copy();\n    }\n\n    public function submitDown (id :Int, viewX :Float, viewY :Float)\n    {\n        if (!_pointMap.exists(id)) {\n            var point = new TouchPoint(id);\n            point.init(viewX, viewY);\n            _pointMap.set(id, point);\n            _points.push(point);\n\n            if (_pointerTouch == null) {\n                // Make this touch point the tracked pointer\n                _pointerTouch = point;\n                _pointer.submitDown(viewX, viewY, point._source);\n            }\n            down.emit(point);\n        }\n    }\n\n    public function submitMove (id :Int, viewX :Float, viewY :Float)\n    {\n        var point = _pointMap.get(id);\n        if (point != null) {\n            point.init(viewX, viewY);\n\n            if (_pointerTouch == point) {\n                _pointer.submitMove(viewX, viewY, point._source);\n            }\n            move.emit(point);\n        }\n    }\n\n    public function submitUp (id :Int, viewX :Float, viewY :Float)\n    {\n        var point = _pointMap.get(id);\n        if (point != null) {\n            point.init(viewX, viewY);\n            _pointMap.remove(id);\n            _points.remove(point);\n\n            if (_pointerTouch == point) {\n                _pointerTouch = null;\n                _pointer.submitUp(viewX, viewY, point._source);\n            }\n            up.emit(point);\n        }\n    }\n\n    private var _pointer :BasicPointer;\n    private var _pointerTouch :TouchPoint;\n\n    private var _maxPoints :Int;\n    private var _pointMap :Map<Int,TouchPoint>;\n    private var _points :Array<TouchPoint>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport haxe.Json;\n\nimport flambe.util.Assert;\n\nusing StringTools;\n\n/** Handles communication with the Catapult server run by `flambe serve`, for live reloading. */\nclass CatapultClient\n{\n    private function new ()\n    {\n        _loaders = [];\n    }\n\n    public function add (loader :BasicAssetPackLoader)\n    {\n#if !flambe_disable_reloading\n        // Only care about packs loaded from the assets directory\n        if (loader.manifest.localBase == \"assets\") {\n            _loaders.push(loader);\n        }\n#end\n    }\n\n    public function remove (loader :BasicAssetPackLoader)\n    {\n        _loaders.remove(loader);\n    }\n\n    private function onError (cause :String)\n    {\n        Log.warn(\"Unable to connect to Catapult\", [\"cause\", cause]);\n    }\n\n    private function onMessage (message :String)\n    {\n        var message = Json.parse(message);\n        switch (message.type) {\n        case \"file_changed\":\n            var url = message.name + \"?v=\" + message.md5;\n            url = url.replace(\"\\\\\", \"/\"); // Handle backslash paths in Windows\n            for (loader in _loaders) {\n                loader.reload(url);\n            }\n        case \"restart\":\n            onRestart();\n        }\n    }\n\n    private function onRestart ()\n    {\n        Assert.fail(); // See subclasses\n    }\n\n    private var _loaders :Array<BasicAssetPackLoader>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\n/**\n * Internal helper for shared debug logic across all platforms.\n */\nclass DebugLogic\n{\n    public function new (platform :Platform)\n    {\n        _platform = platform;\n\n        platform.getKeyboard().down.connect(function (event) {\n            if (event.key == O && platform.getKeyboard().isDown(Control)) {\n                if (toggleOverdrawGraphics()) {\n                    Log.info(\"Enabled overdraw visualizer, press Ctrl-O again to disable\");\n                }\n            }\n        });\n    }\n\n    /**\n     * Toggles the overdraw debug renderer.\n     * @return Whether the overdraw renderer was enabled.\n     */\n    public function toggleOverdrawGraphics () :Bool\n    {\n        var renderer = _platform.getRenderer();\n\n        if (_savedGraphics != null) {\n            renderer.graphics = _savedGraphics;\n            _savedGraphics = null;\n\n        } else if (renderer.graphics != null) {\n            _savedGraphics = renderer.graphics;\n            renderer.graphics = new OverdrawGraphics(_savedGraphics);\n            return true;\n        }\n\n        return false;\n    }\n\n    private var _platform :Platform;\n\n    /** The normal Graphics saved by toggleOverdrawGraphics so it can restored. */\n    private var _savedGraphics :InternalGraphics;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.animation.AnimatedFloat;\nimport flambe.sound.Playback;\nimport flambe.sound.Sound;\nimport flambe.util.Value;\n\n/**\n * An empty sound used in environments that don't support audio.\n */\nclass DummySound extends BasicAsset<DummySound>\n    implements Sound\n{\n    public var duration (get, null) :Float;\n\n    public function new ()\n    {\n        super();\n        _playback = new DummyPlayback(this);\n    }\n\n    public function play (volume :Float = 1.0) :Playback\n    {\n        return _playback;\n    }\n\n    public function loop (volume :Float = 1.0) :Playback\n    {\n        return _playback;\n    }\n\n    public function get_duration () :Float\n    {\n        return 0;\n    }\n\n    override private function copyFrom (asset :DummySound)\n    {\n        // Nothing at all\n    }\n\n    override private function onDisposed ()\n    {\n        // Nothing at all\n    }\n\n    public static function getInstance () :DummySound\n    {\n        if (_instance == null) {\n            _instance = new DummySound();\n        }\n        return _instance;\n    }\n\n    private static var _instance :DummySound;\n\n    private var _playback :DummyPlayback;\n}\n\n// This should be immutable too\nclass DummyPlayback\n    implements Playback\n{\n    public var volume (default, null) :AnimatedFloat;\n    public var paused (get, set) :Bool;\n    public var complete (get, null) :Value<Bool>;\n    public var position (get, null) :Float;\n    public var sound (get, null) :Sound;\n\n    public function new (sound :Sound)\n    {\n        _sound = sound;\n        this.volume = new AnimatedFloat(0); // A little quirky? All DummyPlaybacks share the same volume\n        _complete = new Value<Bool>(true);\n    }\n\n    public function get_sound () :Sound\n    {\n        return _sound;\n    }\n\n    public function get_paused () :Bool\n    {\n        return true;\n    }\n\n    public function set_paused (paused :Bool) :Bool\n    {\n        return true;\n    }\n\n    public function get_complete () :Value<Bool>\n    {\n        return _complete;\n    }\n\n    public function get_position () :Float\n    {\n        return 0;\n    }\n\n    public function dispose ()\n    {\n        // Nothing\n    }\n\n    private var _sound :Sound;\n\n    private var _complete :Value<Bool>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.input.TouchPoint;\nimport flambe.subsystem.TouchSystem;\nimport flambe.util.Signal1;\n\nclass DummyTouch\n    implements TouchSystem\n{\n    public var supported (get, null) :Bool;\n    public var maxPoints (get, null) :Int;\n    public var points (get, null) :Array<TouchPoint>;\n\n    public var down (default, null) :Signal1<TouchPoint>;\n    public var move (default, null) :Signal1<TouchPoint>;\n    public var up (default, null) :Signal1<TouchPoint>;\n\n    public function new ()\n    {\n        down = new Signal1();\n        move = new Signal1();\n        up = new Signal1();\n    }\n\n    public function get_supported () :Bool\n    {\n        return false;\n    }\n\n    public function get_maxPoints () :Int\n    {\n        return 0;\n    }\n\n    public function get_points () :Array<TouchPoint>\n    {\n        return [];\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.util.Disposable;\n\n#if flash\nimport flash.events.IEventDispatcher;\nimport flash.events.Event;\n#else\nimport js.html.EventTarget in IEventDispatcher;\nimport js.html.Event;\n#end\n\nprivate typedef Listener = Dynamic -> Void;\n\n/**\n * Manages a group of event listeners. When the group is disposed, all listeners are removed.\n */\nclass EventGroup\n    implements Disposable\n{\n    public function new ()\n    {\n        _entries = [];\n    }\n\n    /** Register a listener with this group. */\n    public function addListener (dispatcher :IEventDispatcher, type :String, listener :Listener)\n    {\n        dispatcher.addEventListener(type, listener, false);\n        _entries.push(new Entry(dispatcher, type, listener));\n    }\n\n    /** Register a listener with this group, all listeners are removed when it's fired. */\n    public function addDisposingListener (\n        dispatcher :IEventDispatcher, type :String, listener :Listener)\n    {\n        addListener(dispatcher, type, function (event :Event) {\n            dispose();\n            listener(event);\n        });\n    }\n\n    /** Detach all listeners registered with this group. */\n    public function dispose ()\n    {\n        for (entry in _entries) {\n            entry.dispatcher.removeEventListener(entry.type, entry.listener, false);\n        }\n        _entries = [];\n    }\n\n    private var _entries :Array<Entry>;\n}\n\nprivate class Entry\n{\n    public var dispatcher :IEventDispatcher;\n    public var type :String;\n    public var listener :Listener;\n\n    public function new (dispatcher, type, listener)\n    {\n        this.dispatcher = dispatcher;\n        this.type = type;\n        this.listener = listener;\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.input.Key;\n\n/**\n * Key codes emitted by Flash and JS.\n */\nclass KeyCodes\n{\n    public static inline var A = 65;\n    public static inline var B = 66;\n    public static inline var C = 67;\n    public static inline var D = 68;\n    public static inline var E = 69;\n    public static inline var F = 70;\n    public static inline var G = 71;\n    public static inline var H = 72;\n    public static inline var I = 73;\n    public static inline var J = 74;\n    public static inline var K = 75;\n    public static inline var L = 76;\n    public static inline var M = 77;\n    public static inline var N = 78;\n    public static inline var O = 79;\n    public static inline var P = 80;\n    public static inline var Q = 81;\n    public static inline var R = 82;\n    public static inline var S = 83;\n    public static inline var T = 84;\n    public static inline var U = 85;\n    public static inline var V = 86;\n    public static inline var W = 87;\n    public static inline var X = 88;\n    public static inline var Y = 89;\n    public static inline var Z = 90;\n\n    public static inline var NUMBER_0 = 48;\n    public static inline var NUMBER_1 = 49;\n    public static inline var NUMBER_2 = 50;\n    public static inline var NUMBER_3 = 51;\n    public static inline var NUMBER_4 = 52;\n    public static inline var NUMBER_5 = 53;\n    public static inline var NUMBER_6 = 54;\n    public static inline var NUMBER_7 = 55;\n    public static inline var NUMBER_8 = 56;\n    public static inline var NUMBER_9 = 57;\n\n    public static inline var NUMPAD_0 = 96;\n    public static inline var NUMPAD_1 = 97;\n    public static inline var NUMPAD_2 = 98;\n    public static inline var NUMPAD_3 = 99;\n    public static inline var NUMPAD_4 = 100;\n    public static inline var NUMPAD_5 = 101;\n    public static inline var NUMPAD_6 = 102;\n    public static inline var NUMPAD_7 = 103;\n    public static inline var NUMPAD_8 = 104;\n    public static inline var NUMPAD_9 = 105;\n\n    public static inline var NUMPAD_ADD = 107;\n    public static inline var NUMPAD_DECIMAL = 110;\n    public static inline var NUMPAD_DIVIDE = 111;\n    public static inline var NUMPAD_ENTER = 108;\n    public static inline var NUMPAD_MULTIPLY = 106;\n    public static inline var NUMPAD_SUBTRACT = 109;\n\n    public static inline var F1 = 112;\n    public static inline var F2 = 113;\n    public static inline var F3 = 114;\n    public static inline var F4 = 115;\n    public static inline var F5 = 116;\n    public static inline var F6 = 117;\n    public static inline var F7 = 118;\n    public static inline var F8 = 119;\n    public static inline var F9 = 120;\n    public static inline var F10 = 121;\n    public static inline var F11 = 122;\n    public static inline var F12 = 123;\n    public static inline var F13 = 124;\n    public static inline var F14 = 125;\n    public static inline var F15 = 126;\n\n    public static inline var LEFT = 37;\n    public static inline var UP = 38;\n    public static inline var RIGHT = 39;\n    public static inline var DOWN = 40;\n\n    public static inline var ALT = 18;\n    public static inline var BACKQUOTE = 192;\n    public static inline var BACKSLASH = 220;\n    public static inline var BACKSPACE = 8;\n    public static inline var CAPS_LOCK = 20;\n    public static inline var COMMA = 188;\n    public static inline var COMMAND = 15;\n    public static inline var CONTROL = 17;\n    public static inline var DELETE = 46;\n    public static inline var END = 35;\n    public static inline var ENTER = 13;\n    public static inline var EQUALS = 187;\n    public static inline var ESCAPE = 27;\n    public static inline var HOME = 36;\n    public static inline var INSERT = 45;\n    public static inline var LEFT_BRACKET = 219;\n    public static inline var MINUS = 189;\n    public static inline var PAGE_DOWN = 34;\n    public static inline var PAGE_UP = 33;\n    public static inline var PERIOD = 190;\n    public static inline var QUOTE = 222;\n    public static inline var RIGHT_BRACKET = 221;\n    public static inline var SEMICOLON = 186;\n    public static inline var SHIFT = 16;\n    public static inline var SLASH = 191;\n    public static inline var SPACE = 32;\n    public static inline var TAB = 9;\n\n    // Android keys (AIR only)\n    public static inline var BACK = 0x01000016;\n    public static inline var MENU = 0x01000012;\n    public static inline var SEARCH = 0x0100001f;\n\n    public static function toKey (keyCode :Int) :Key\n    {\n        switch (keyCode) {\n            case A: return Key.A;\n            case B: return Key.B;\n            case C: return Key.C;\n            case D: return Key.D;\n            case E: return Key.E;\n            case F: return Key.F;\n            case G: return Key.G;\n            case H: return Key.H;\n            case I: return Key.I;\n            case J: return Key.J;\n            case K: return Key.K;\n            case L: return Key.L;\n            case M: return Key.M;\n            case N: return Key.N;\n            case O: return Key.O;\n            case P: return Key.P;\n            case Q: return Key.Q;\n            case R: return Key.R;\n            case S: return Key.S;\n            case T: return Key.T;\n            case U: return Key.U;\n            case V: return Key.V;\n            case W: return Key.W;\n            case X: return Key.X;\n            case Y: return Key.Y;\n            case Z: return Key.Z;\n\n            case NUMBER_0: return Key.Number0;\n            case NUMBER_1: return Key.Number1;\n            case NUMBER_2: return Key.Number2;\n            case NUMBER_3: return Key.Number3;\n            case NUMBER_4: return Key.Number4;\n            case NUMBER_5: return Key.Number5;\n            case NUMBER_6: return Key.Number6;\n            case NUMBER_7: return Key.Number7;\n            case NUMBER_8: return Key.Number8;\n            case NUMBER_9: return Key.Number9;\n\n            case NUMPAD_0: return Key.Numpad0;\n            case NUMPAD_1: return Key.Numpad1;\n            case NUMPAD_2: return Key.Numpad2;\n            case NUMPAD_3: return Key.Numpad3;\n            case NUMPAD_4: return Key.Numpad4;\n            case NUMPAD_5: return Key.Numpad5;\n            case NUMPAD_6: return Key.Numpad6;\n            case NUMPAD_7: return Key.Numpad7;\n            case NUMPAD_8: return Key.Numpad8;\n            case NUMPAD_9: return Key.Numpad9;\n\n            case NUMPAD_ADD: return Key.NumpadAdd;\n            case NUMPAD_DECIMAL: return Key.NumpadDecimal;\n            case NUMPAD_DIVIDE: return Key.NumpadDivide;\n            case NUMPAD_ENTER: return Key.NumpadEnter;\n            case NUMPAD_MULTIPLY: return Key.NumpadMultiply;\n            case NUMPAD_SUBTRACT: return Key.NumpadSubtract;\n\n            case F1: return Key.F1;\n            case F2: return Key.F2;\n            case F3: return Key.F3;\n            case F4: return Key.F4;\n            case F5: return Key.F5;\n            case F6: return Key.F6;\n            case F7: return Key.F7;\n            case F8: return Key.F8;\n            case F9: return Key.F9;\n            case F10: return Key.F10;\n            case F11: return Key.F11;\n            case F12: return Key.F12;\n\n            case LEFT: return Key.Left;\n            case UP: return Key.Up;\n            case RIGHT: return Key.Right;\n            case DOWN: return Key.Down;\n\n            case ALT: return Key.Alt;\n            case BACKQUOTE: return Key.Backquote;\n            case BACKSLASH: return Key.Backslash;\n            case BACKSPACE: return Key.Backspace;\n            case CAPS_LOCK: return Key.CapsLock;\n            case COMMA: return Key.Comma;\n            case COMMAND: return Key.Command;\n            case CONTROL: return Key.Control;\n            case DELETE: return Key.Delete;\n            case END: return Key.End;\n            case ENTER: return Key.Enter;\n            case EQUALS: return Key.Equals;\n            case ESCAPE: return Key.Escape;\n            case HOME: return Key.Home;\n            case INSERT: return Key.Insert;\n            case LEFT_BRACKET: return Key.LeftBracket;\n            case MINUS: return Key.Minus;\n            case PAGE_DOWN: return Key.PageDown;\n            case PAGE_UP: return Key.PageUp;\n            case PERIOD: return Key.Period;\n            case QUOTE: return Key.Quote;\n            case RIGHT_BRACKET: return Key.RightBracket;\n            case SEMICOLON: return Key.Semicolon;\n            case SHIFT: return Key.Shift;\n            case SLASH: return Key.Slash;\n            case SPACE: return Key.Space;\n            case TAB: return Key.Tab;\n\n            case MENU: return Key.Menu;\n            case SEARCH: return Key.Search;\n        }\n\n        return Unknown(keyCode);\n    }\n\n    public static function toKeyCode (key :Key) :Int\n    {\n        switch (key) {\n            case Key.A: return A;\n            case Key.B: return B;\n            case Key.C: return C;\n            case Key.D: return D;\n            case Key.E: return E;\n            case Key.F: return F;\n            case Key.G: return G;\n            case Key.H: return H;\n            case Key.I: return I;\n            case Key.J: return J;\n            case Key.K: return K;\n            case Key.L: return L;\n            case Key.M: return M;\n            case Key.N: return N;\n            case Key.O: return O;\n            case Key.P: return P;\n            case Key.Q: return Q;\n            case Key.R: return R;\n            case Key.S: return S;\n            case Key.T: return T;\n            case Key.U: return U;\n            case Key.V: return V;\n            case Key.W: return W;\n            case Key.X: return X;\n            case Key.Y: return Y;\n            case Key.Z: return Z;\n\n            case Key.Number0: return NUMBER_0;\n            case Key.Number1: return NUMBER_1;\n            case Key.Number2: return NUMBER_2;\n            case Key.Number3: return NUMBER_3;\n            case Key.Number4: return NUMBER_4;\n            case Key.Number5: return NUMBER_5;\n            case Key.Number6: return NUMBER_6;\n            case Key.Number7: return NUMBER_7;\n            case Key.Number8: return NUMBER_8;\n            case Key.Number9: return NUMBER_9;\n\n            case Key.Numpad0: return NUMPAD_0;\n            case Key.Numpad1: return NUMPAD_1;\n            case Key.Numpad2: return NUMPAD_2;\n            case Key.Numpad3: return NUMPAD_3;\n            case Key.Numpad4: return NUMPAD_4;\n            case Key.Numpad5: return NUMPAD_5;\n            case Key.Numpad6: return NUMPAD_6;\n            case Key.Numpad7: return NUMPAD_7;\n            case Key.Numpad8: return NUMPAD_8;\n            case Key.Numpad9: return NUMPAD_9;\n\n            case Key.NumpadAdd: return NUMPAD_ADD;\n            case Key.NumpadDecimal: return NUMPAD_DECIMAL;\n            case Key.NumpadDivide: return NUMPAD_DIVIDE;\n            case Key.NumpadEnter: return NUMPAD_ENTER;\n            case Key.NumpadMultiply: return NUMPAD_MULTIPLY;\n            case Key.NumpadSubtract: return NUMPAD_SUBTRACT;\n\n            case Key.F1: return F1;\n            case Key.F2: return F2;\n            case Key.F3: return F3;\n            case Key.F4: return F4;\n            case Key.F5: return F5;\n            case Key.F6: return F6;\n            case Key.F7: return F7;\n            case Key.F8: return F8;\n            case Key.F9: return F9;\n            case Key.F10: return F10;\n            case Key.F11: return F11;\n            case Key.F12: return F12;\n            case Key.F13: return F13;\n            case Key.F14: return F14;\n            case Key.F15: return F15;\n\n            case Key.Left: return LEFT;\n            case Key.Up: return UP;\n            case Key.Right: return RIGHT;\n            case Key.Down: return DOWN;\n\n            case Key.Alt: return ALT;\n            case Key.Backquote: return BACKQUOTE;\n            case Key.Backslash: return BACKSLASH;\n            case Key.Backspace: return BACKSPACE;\n            case Key.CapsLock: return CAPS_LOCK;\n            case Key.Comma: return COMMA;\n            case Key.Command: return COMMAND;\n            case Key.Control: return CONTROL;\n            case Key.Delete: return DELETE;\n            case Key.End: return END;\n            case Key.Enter: return ENTER;\n            case Key.Equals: return EQUALS;\n            case Key.Escape: return ESCAPE;\n            case Key.Home: return HOME;\n            case Key.Insert: return INSERT;\n            case Key.LeftBracket: return LEFT_BRACKET;\n            case Key.Minus: return MINUS;\n            case Key.PageDown: return PAGE_DOWN;\n            case Key.PageUp: return PAGE_UP;\n            case Key.Period: return PERIOD;\n            case Key.Quote: return QUOTE;\n            case Key.RightBracket: return RIGHT_BRACKET;\n            case Key.Semicolon: return SEMICOLON;\n            case Key.Shift: return SHIFT;\n            case Key.Slash: return SLASH;\n            case Key.Space: return SPACE;\n            case Key.Tab: return TAB;\n\n            case Key.Menu: return MENU;\n            case Key.Search: return SEARCH;\n\n            case Key.Unknown(keyCode): return keyCode;\n        }\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.Component;\nimport flambe.Entity;\nimport flambe.System;\nimport flambe.display.Graphics;\nimport flambe.display.Sprite;\nimport flambe.scene.Director;\n\nusing Lambda;\nusing flambe.util.Arrays;\nusing flambe.util.BitSets;\n\n/**\n * Updates all components and renders.\n */\nclass MainLoop\n{\n    public function new ()\n    {\n        _tickables = [];\n    }\n\n    public function update (dt :Float)\n    {\n        if (dt <= 0) {\n            // This can happen on platforms that don't have monotonic timestamps and are prone to\n            // system clock adjustment\n            Log.warn(\"Zero or negative time elapsed since the last frame!\", [\"dt\", dt]);\n            return;\n        }\n        if (dt > 1) {\n            // Clamp deltaTime to a reasonable limit. Games tend not to cope well with huge\n            // deltaTimes. Platforms should skip the next frame after unpausing to prevent sending\n            // huge deltaTimes, but not all environments support detecting an unpause\n            dt = 1;\n        }\n\n        // First update any tickables, folding away nulls\n        var ii = 0;\n        while (ii < _tickables.length) {\n            var t = _tickables[ii];\n            if (t == null || t.update(dt)) {\n                _tickables.splice(ii, 1);\n            } else {\n                ++ii;\n            }\n        }\n\n        System.volume.update(dt);\n\n        updateEntity(System.root, dt);\n    }\n\n    public function render<A> (renderer :InternalRenderer<A>)\n    {\n        var graphics = renderer.graphics;\n        if (graphics != null) {\n            renderer.willRender();\n            Sprite.render(System.root, graphics);\n            renderer.didRender();\n        }\n    }\n\n    public function addTickable (t :Tickable)\n    {\n        _tickables.push(t);\n    }\n\n    public function removeTickable (t :Tickable)\n    {\n        var idx = _tickables.indexOf(t);\n        if (idx >= 0) {\n            // Actual removals only happen in update()\n            _tickables[idx] = null;\n        }\n    }\n\n    private static function updateEntity (entity :Entity, dt :Float)\n    {\n        // Handle update speed adjustment\n        var speed = entity.get(SpeedAdjuster);\n        if (speed != null) {\n            speed._realDt = dt;\n\n            dt *= speed.scale._;\n            if (dt <= 0) {\n                // This entity is paused, avoid descending into children. But do update the speed\n                // adjuster (so it can still be animated)\n                speed.onUpdate(dt);\n                return;\n            }\n        }\n\n        // Update components\n        var p = entity.firstComponent;\n        while (p != null) {\n            var next = p.next;\n            if (!p._flags.contains(Component.STARTED)) {\n                p._flags = p._flags.add(Component.STARTED);\n                p.onStart();\n            }\n            p.onUpdate(dt);\n            p = next;\n        }\n\n        // Update children\n        var p = entity.firstChild;\n        while (p != null) {\n            var next = p.next;\n            updateEntity(p, dt);\n            p = next;\n        }\n    }\n\n    private var _tickables :Array<Tickable>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nclass MathUtil\n{\n    /**\n     * Returns the smallest power of two >= n.\n     */\n    public static function nextPowerOfTwo (n :Int) :Int\n    {\n        var p = 1;\n        while (p < n) {\n            p <<= 1;\n        }\n        return p;\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.input.MouseButton;\n\n/**\n * Mouse button codes used internally.\n */\nclass MouseCodes\n{\n    public static inline var LEFT = 0;\n    public static inline var MIDDLE = 1;\n    public static inline var RIGHT = 2;\n\n    public static function toButton (buttonCode :Int) :MouseButton\n    {\n        switch (buttonCode) {\n            case LEFT: return Left;\n            case MIDDLE: return Middle;\n            case RIGHT: return Right;\n        }\n\n        return Unknown(buttonCode);\n    }\n\n    public static function toButtonCode (button :MouseButton) :Int\n    {\n        switch (button) {\n            case Left: return LEFT;\n            case Middle: return MIDDLE;\n            case Right: return RIGHT;\n\n            case Unknown(buttonCode): return buttonCode;\n        }\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport flambe.display.BlendMode;\nimport flambe.display.Texture;\n\nclass OverdrawGraphics\n    implements InternalGraphics\n{\n    public function new (impl :InternalGraphics)\n    {\n        _impl = impl;\n    }\n\n    public function save ()\n    {\n        _impl.save();\n    }\n\n    public function translate (x :Float, y :Float)\n    {\n        _impl.translate(x, y);\n    }\n\n    public function scale (x :Float, y :Float)\n    {\n        _impl.scale(x, y);\n    }\n\n    public function rotate (rotation :Float)\n    {\n        _impl.rotate(rotation);\n    }\n\n    public function transform (m00 :Float, m10 :Float, m01 :Float, m11 :Float, m02 :Float, m12 :Float)\n    {\n        _impl.transform(m00, m10, m01, m11, m02, m12);\n    }\n\n    public function multiplyAlpha (factor :Float)\n    {\n        // Ignore\n    }\n\n    public function setAlpha (alpha :Float)\n    {\n        // Ignore\n    }\n\n    public function setBlendMode (blendMode :BlendMode)\n    {\n        // Ignore\n    }\n\n    public function applyScissor (x :Float, y :Float, width :Float, height :Float)\n    {\n        _impl.applyScissor(x, y, width, height);\n    }\n\n    public function restore ()\n    {\n        _impl.restore();\n    }\n\n    public function drawTexture (texture :Texture, destX :Float, destY :Float)\n    {\n        drawRegion(destX, destY, texture.width, texture.height);\n    }\n\n    public function drawSubTexture (texture :Texture, destX :Float, destY :Float,\n        sourceX :Float, sourceY :Float, sourceW :Float, sourceH :Float)\n    {\n        drawRegion(destX, destY, sourceW, sourceH);\n    }\n\n    public function drawPattern (texture :Texture, destX :Float, destY :Float, width :Float, height :Float)\n    {\n        drawRegion(destX, destY, width, height);\n    }\n\n    public function fillRect (color :Int, x :Float, y :Float, width :Float, height :Float)\n    {\n        drawRegion(x, y, width, height);\n    }\n\n    public function willRender ()\n    {\n        _impl.willRender();\n        _impl.save();\n        _impl.setBlendMode(Add);\n    }\n\n    public function didRender ()\n    {\n        _impl.restore();\n        _impl.didRender();\n    }\n\n    public function onResize (width :Int, height :Int)\n    {\n        _impl.onResize(width, height);\n    }\n\n    /** Draws an overdraw region rectangle. */\n    private function drawRegion (x :Float, y :Float, width :Float, height :Float)\n    {\n        _impl.fillRect(0x101008, x, y, width, height);\n    }\n\n    private var _impl :InternalGraphics;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.Browser;\nimport js.html.*;\n\nimport flambe.display.BlendMode;\nimport flambe.display.Graphics;\nimport flambe.display.Texture;\nimport flambe.math.FMath;\n\n// TODO(bruno): Remove pixel snapping once most browsers get canvas acceleration.\nclass CanvasGraphics\n    implements InternalGraphics\n{\n    public function new (canvas :CanvasElement, alpha :Bool)\n    {\n        _canvasCtx = (untyped canvas).getContext(\"2d\", {alpha: alpha});\n    }\n\n    public function save ()\n    {\n        _canvasCtx.save();\n    }\n\n    public function translate (x :Float, y :Float)\n    {\n        _canvasCtx.translate(Std.int(x), Std.int(y));\n    }\n\n    public function scale (x :Float, y :Float)\n    {\n        _canvasCtx.scale(x, y);\n    }\n\n    public function rotate (rotation :Float)\n    {\n        _canvasCtx.rotate(FMath.toRadians(rotation));\n    }\n\n    public function transform (m00 :Float, m10 :Float, m01 :Float, m11 :Float, m02 :Float, m12 :Float)\n    {\n        _canvasCtx.transform(m00, m10, m01, m11, m02, m12);\n    }\n\n    public function restore ()\n    {\n        _canvasCtx.restore();\n    }\n\n    public function drawTexture (texture :Texture, destX :Float, destY :Float)\n    {\n        drawSubTexture(texture, destX, destY, 0, 0, texture.width, texture.height);\n    }\n\n    public function drawSubTexture (texture :Texture, destX :Float, destY :Float,\n        sourceX :Float, sourceY :Float, sourceW :Float, sourceH :Float)\n    {\n        if (_firstDraw) {\n            _firstDraw = false;\n            _canvasCtx.globalCompositeOperation = \"copy\";\n            drawSubTexture(texture, destX, destY, sourceX, sourceY, sourceW, sourceH);\n            _canvasCtx.globalCompositeOperation = \"source-over\";\n            return;\n        }\n\n        var texture :CanvasTexture = cast texture;\n        var root = texture.root;\n        root.assertNotDisposed();\n\n        _canvasCtx.drawImage(root.image,\n            Std.int(texture.rootX+sourceX), Std.int(texture.rootY+sourceY),\n            Std.int(sourceW), Std.int(sourceH),\n            Std.int(destX), Std.int(destY), Std.int(sourceW), Std.int(sourceH));\n    }\n\n    public function drawPattern (texture :Texture, x :Float, y :Float, width :Float, height :Float)\n    {\n        if (_firstDraw) {\n            _firstDraw = false;\n            _canvasCtx.globalCompositeOperation = \"copy\";\n            drawPattern(texture, x, y, width, height);\n            _canvasCtx.globalCompositeOperation = \"source-over\";\n            return;\n        }\n\n        var texture :CanvasTexture = cast texture;\n        var root = texture.root;\n        root.assertNotDisposed();\n\n        _canvasCtx.fillStyle = texture.getPattern();\n        _canvasCtx.fillRect(Std.int(x), Std.int(y), Std.int(width), Std.int(height));\n    }\n\n    public function fillRect (color :Int, x :Float, y :Float, width :Float, height :Float)\n    {\n        if (_firstDraw) {\n            _firstDraw = false;\n            _canvasCtx.globalCompositeOperation = \"copy\";\n            fillRect(color, x, y, width, height);\n            _canvasCtx.globalCompositeOperation = \"source-over\";\n            return;\n        }\n\n        // Convert color into a hex string in the form of #RRGGBB\n        var hex = untyped (0xffffff & color).toString(16);\n        while (hex.length < 6) {\n            hex = \"0\"+hex;\n        }\n        _canvasCtx.fillStyle = \"#\"+hex;\n        _canvasCtx.fillRect(Std.int(x), Std.int(y), Std.int(width), Std.int(height));\n    }\n\n    public function multiplyAlpha (factor :Float)\n    {\n        _canvasCtx.globalAlpha *= factor;\n    }\n\n    public function setAlpha (alpha :Float)\n    {\n        _canvasCtx.globalAlpha = alpha;\n    }\n\n    public function setBlendMode (blendMode :BlendMode)\n    {\n        var op;\n        switch (blendMode) {\n            case Normal: op = \"source-over\";\n            case Add: op = \"lighter\";\n            case Multiply: op = \"multiply\";\n            case Screen: op = \"screen\";\n            case Mask: op = \"destination-in\";\n            case Copy: op = \"copy\";\n        };\n        _canvasCtx.globalCompositeOperation = op;\n    }\n\n    public function applyScissor (x :Float, y :Float, width :Float, height :Float)\n    {\n        _canvasCtx.beginPath();\n        _canvasCtx.rect(Std.int(x), Std.int(y), Std.int(width), Std.int(height));\n        _canvasCtx.clip();\n    }\n\n    public function willRender ()\n    {\n        // Disable blending for the first draw call. This squeezes a bit of performance out of games\n        // that have a single large background sprite, especially on older devices\n        _firstDraw = true;\n    }\n\n    public function didRender ()\n    {\n        // Nothing at all\n    }\n\n    public function onResize (width :Int, height :Int)\n    {\n        // Nothing at all\n    }\n\n    private var _canvasCtx :CanvasRenderingContext2D;\n    private var _firstDraw :Bool = false;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.Browser;\nimport js.html.*;\n\nimport haxe.io.Bytes;\n\nimport flambe.asset.AssetEntry;\nimport flambe.subsystem.RendererSystem;\nimport flambe.util.Assert;\nimport flambe.util.Value;\n\nclass CanvasRenderer\n    implements InternalRenderer<Dynamic>\n{\n    public var type (get, null) :RendererType;\n    public var maxTextureSize (get, null) :Int;\n    public var hasGPU (get, null) :Value<Bool>;\n\n    public var graphics :InternalGraphics;\n\n    public function new (canvas :CanvasElement)\n    {\n        graphics = new CanvasGraphics(canvas, #if flambe_transparent true #else false #end);\n        _hasGPU = new Value<Bool>(true);\n    }\n\n    inline private function get_type () :RendererType\n    {\n        return Canvas;\n    }\n\n    private function get_maxTextureSize () :Int\n    {\n        // Canvases larger than 1024 prevent hardware acceleration in iOS\n        // TODO(bruno): Return 2048 on non-iOS browsers?\n        return 1024;\n    }\n\n    inline private function get_hasGPU () :Value<Bool>\n    {\n        return _hasGPU;\n    }\n\n    public function createTextureFromImage (image :Dynamic) :CanvasTexture\n    {\n        var root = new CanvasTextureRoot(CANVAS_TEXTURES ? HtmlUtil.createCanvas(image) : image);\n        return root.createTexture(root.width, root.height);\n    }\n\n    public function createTexture (width :Int, height :Int) :CanvasTexture\n    {\n        var root = new CanvasTextureRoot(HtmlUtil.createEmptyCanvas(width, height));\n        return root.createTexture(width, height);\n    }\n\n    public function getCompressedTextureFormats () :Array<AssetFormat>\n    {\n        return [];\n    }\n\n    public function createCompressedTexture (format :AssetFormat, data :Bytes) :CanvasTexture\n    {\n        Assert.fail(); // Unsupported\n        return null;\n    }\n\n    public function willRender ()\n    {\n        graphics.willRender();\n    }\n\n    public function didRender ()\n    {\n        graphics.didRender();\n    }\n\n    public function getName () :String\n    {\n        return \"Canvas\";\n    }\n\n    /** If true, blit loaded images to a canvas and use that as the texture. */\n    private static var CANVAS_TEXTURES :Bool = (function () {\n        // On iOS, canvas textures are way faster\n        // http://jsperf.com/drawimage-vs-canvaspattern/8\n        var pattern = ~/(iPhone|iPod|iPad)/;\n        return pattern.match(Browser.window.navigator.userAgent);\n    })();\n\n    private var _hasGPU :Value<Bool>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.html.*;\n\nclass CanvasTexture extends BasicTexture<CanvasTextureRoot>\n{\n    public function new (root :CanvasTextureRoot, width :Int, height :Int)\n    {\n        super(root, width, height);\n    }\n\n    public function getPattern () :CanvasPattern\n    {\n        if (_rootUpdateCount != root.updateCount || _pattern == null) {\n            _rootUpdateCount = root.updateCount;\n            _pattern = root.createPattern(rootX, rootY, width, height);\n        }\n        return _pattern;\n    }\n\n    private var _pattern :CanvasPattern = null;\n    private var _rootUpdateCount :Int = 0;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.Browser;\nimport js.html.*;\n\nimport haxe.io.Bytes;\nimport haxe.io.BytesData;\n\nimport flambe.display.Graphics;\nimport flambe.display.Texture;\n\nclass CanvasTextureRoot extends BasicAsset<CanvasTextureRoot>\n    implements TextureRoot\n{\n    public var width (default, null) :Int;\n    public var height (default, null) :Int;\n\n    // The Image (or sometimes Canvas) used for most draw calls\n    public var image (default, null) :Dynamic;\n\n    public var updateCount :Int = 0;\n\n    public function new (image :Dynamic)\n    {\n        super();\n        this.image = image;\n        width = image.width;\n        height = image.height;\n    }\n\n    public function createTexture (width :Int, height :Int) :CanvasTexture\n    {\n        return new CanvasTexture(this, width, height);\n    }\n\n    public function readPixels (x :Int, y :Int, width :Int, height :Int) :Bytes\n    {\n        assertNotDisposed();\n\n        //var data :Array<Int> = cast getContext2d().getImageData(x, y, width, height).data;\n        //return Bytes.ofData(data);\n\t\treturn Bytes.ofData(cast getContext2d().getImageData(x, y, width, height).data);\n    }\n\n    public function writePixels (pixels :Bytes, x :Int, y :Int, sourceW :Int, sourceH :Int)\n    {\n        assertNotDisposed();\n\n        var ctx2d = getContext2d();\n        var imageData = ctx2d.createImageData(sourceW, sourceH);\n        var data :Dynamic = imageData.data;\n        if (data.set != null) {\n            // Data is a Uint8ClampedArray, copy it in one swoop\n            data.set(pixels.getData());\n        } else {\n            // Data is a normal array, copy it manually\n            var size = 4*sourceW*sourceH;\n            for (ii in 0...size) {\n                data[ii] = pixels.get(ii);\n            }\n        }\n\n        // Draw the pixels, and invalidate our contents\n        ctx2d.putImageData(imageData, x, y);\n        dirtyContents();\n    }\n\n    // Invalidates the cached patterns of all textures using this root\n    inline public function dirtyContents ()\n    {\n        ++updateCount;\n    }\n\n    public function getGraphics () :CanvasGraphics\n    {\n        assertNotDisposed();\n\n        if (_graphics == null) {\n            getContext2d(); // Force conversion\n            _graphics = new InternalGraphics(this);\n        }\n        return _graphics;\n    }\n\n    public function createPattern (x :Int, y :Int, width :Int, height :Int) :CanvasPattern\n    {\n        var ctx2d = getContext2d();\n        var source = image;\n        if (x != 0 || y != 0 || width != this.width || height != this.height) {\n            // Create a temporary canvas if the size doesn't match this root\n            source = HtmlUtil.createEmptyCanvas(width, height);\n            var crop = source.getContext2d();\n            crop.globalCompositeOperation = \"copy\";\n            crop.drawImage(image, -x, -y);\n        }\n        return ctx2d.createPattern(source, \"repeat\");\n    }\n\n    private function getContext2d () :CanvasRenderingContext2D\n    {\n        // Convert the image to a canvas when necessary. Why not have the image be a canvas to\n        // begin with, you ask? Some browsers (notably Android 4) render canvases a LOT slower\n        // than image elements, so we avoid using a canvas unless absolutely necessary. One day\n        // when Android's browser joins the modern age, this can be simplified.\n        // http://jsperf.com/canvas-drawimage\n        if (!Std.is(image, CanvasElement)) {\n            image = HtmlUtil.createCanvas(image);\n        }\n        var canvas :CanvasElement = cast image;\n        return canvas.getContext2d();\n    }\n\n    override private function copyFrom (that :CanvasTextureRoot)\n    {\n        this.image = that.image;\n        this._graphics = that._graphics;\n        dirtyContents();\n    }\n\n    override private function onDisposed ()\n    {\n        image = null;\n        _graphics = null;\n    }\n\n    private var _graphics :CanvasGraphics = null;\n}\n\n// A Graphics that invalidates its texture's cached pattern after every draw call\nprivate class InternalGraphics extends CanvasGraphics\n{\n    public function new (renderTarget :CanvasTextureRoot)\n    {\n        super(renderTarget.image, true);\n        _renderTarget = renderTarget;\n    }\n\n    override public function drawTexture (texture :Texture, x :Float, y :Float)\n    {\n        super.drawTexture(texture, x, y);\n        _renderTarget.dirtyContents();\n    }\n\n    override public function drawSubTexture (texture :Texture, destX :Float, destY :Float,\n        sourceX :Float, sourceY :Float, sourceW :Float, sourceH :Float)\n    {\n        super.drawSubTexture(texture, destX, destY, sourceX, sourceY, sourceW, sourceH);\n        _renderTarget.dirtyContents();\n    }\n\n    override public function drawPattern (texture :Texture, x :Float, y :Float,\n        width :Float, height :Float)\n    {\n        super.drawPattern(texture, x, y, width, height);\n        _renderTarget.dirtyContents();\n    }\n\n    override public function fillRect (color :Int, x :Float, y :Float, width :Float, height :Float)\n    {\n        super.fillRect(color, x, y, width, height);\n        _renderTarget.dirtyContents();\n    }\n\n    private var _renderTarget :CanvasTextureRoot;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.Browser;\nimport js.html.*;\n\nimport haxe.Http;\n\nimport flambe.asset.AssetEntry;\nimport flambe.asset.Manifest;\nimport flambe.util.Assert;\nimport flambe.util.Promise;\nimport flambe.util.Signal0;\nimport flambe.util.Signal1;\n\nclass HtmlAssetPackLoader extends BasicAssetPackLoader\n{\n    public function new (platform :HtmlPlatform, manifest :Manifest)\n    {\n        super(platform, manifest);\n    }\n\n    override private function loadEntry (url :String, entry :AssetEntry)\n    {\n        switch (entry.format) {\n        case WEBP, JXR, PNG, JPG, GIF:\n            var image = Browser.document.createImageElement();\n            var events = new EventGroup();\n\n            events.addDisposingListener(image, \"load\", function (_) {\n#if debug\n                if (image.width > 1024 || image.height > 1024) {\n                    Log.warn(\"Images larger than 1024px on a side will prevent GPU acceleration\" +\n                        \" on some platforms (iOS)\", [\"url\", url,\n                        \"width\", image.width, \"height\", image.height]);\n                }\n#end\n                if (supportsBlob()) {\n                    // Reclaim memory previously allocated by createObjectURL\n                    _URL.revokeObjectURL(image.src);\n                }\n\n                var texture = _platform.getRenderer().createTextureFromImage(image);\n                if (texture != null) {\n                    handleLoad(entry, texture);\n                } else {\n                    handleTextureError(entry);\n                }\n            });\n            events.addDisposingListener(image, \"error\", function (_) {\n                handleError(entry, \"Failed to load image\");\n            });\n\n            // If this browser supports Blob, load the image data over XHR to benefit from progress\n            // events, otherwise just set the src directly\n            if (supportsBlob()) {\n                downloadBlob(url, entry, function (blob) {\n                    image.src = _URL.createObjectURL(blob);\n                });\n            } else {\n                image.src = url;\n            }\n\n        case DDS, PVR, PKM:\n            downloadArrayBuffer(url, entry, function (buffer) {\n                // FIXME(bruno): Convert buffer to a Bytes and pass it along\n                var texture = _platform.getRenderer().createCompressedTexture(entry.format, null);\n                if (texture != null) {\n                    handleLoad(entry, texture);\n                } else {\n                    handleTextureError(entry);\n                }\n            });\n\n        case MP3, M4A, OPUS, OGG, WAV:\n            // If we made it this far, we definitely support audio and can play this asset\n            if (WebAudioSound.supported) {\n                downloadArrayBuffer(url, entry, function (buffer) {\n                    WebAudioSound.ctx.decodeAudioData(buffer, function (decoded) {\n                        handleLoad(entry, new WebAudioSound(decoded));\n                    }, function () {\n                        // Happens in iOS 6 beta for some sounds that should be able to play. It\n                        // seems that monochannel audio will always fail, try converting to stereo.\n                        // Since this happens unpredictably, continue with a DummySound rather than\n                        // rejecting the entire asset pack.\n                        Log.warn(\"Couldn't decode Web Audio, ignoring this asset\", [\"url\", url]);\n                        handleLoad(entry, DummySound.getInstance());\n                    });\n                });\n\n            } else {\n                var audio = Browser.document.createAudioElement();\n                audio.preload = \"auto\"; // Hint that we want to preload the entire file\n\n                // Maintain a hard reference to the audio during loading to prevent GC on some\n                // browsers\n                var ref = ++_mediaRefCount;\n                if (_mediaElements == null) {\n                    _mediaElements = new Map<Int,Dynamic>();\n                }\n                _mediaElements.set(ref, audio);\n\n                var events = new EventGroup();\n                events.addDisposingListener(audio, \"canplaythrough\", function (_) {\n                    _mediaElements.remove(ref);\n                    handleLoad(entry, new HtmlSound(audio));\n                });\n                events.addDisposingListener(audio, \"error\", function (_) {\n                    _mediaElements.remove(ref);\n                    var code = audio.error.code;\n                    if (code == 3 || code == 4) {\n                        // If the song successfully downloaded but this browser can't play it for\n                        // some reason (MEDIA_ERR_DECODE or MEDIA_ERR_SRC_NOT_SUPPORTED), warn and\n                        // press on with an empty sound.\n                        Log.warn(\"Couldn't decode HTML5 audio, ignoring this asset\",\n                            [\"url\", url, \"code\", code]);\n                        handleLoad(entry, DummySound.getInstance());\n                    } else {\n                        handleError(entry, \"Failed to load audio: \" + audio.error.code);\n                    }\n                });\n                events.addListener(audio, \"progress\", function (_) {\n                    if (audio.buffered.length > 0 && audio.duration > 0) {\n                        // Estimate the bytes downloaded based on the available time range\n                        var progress = audio.buffered.end(0) / audio.duration;\n                        handleProgress(entry, Std.int(progress*entry.bytes));\n                    }\n                });\n\n                audio.src = url;\n                audio.load();\n            }\n\n        case Data:\n            downloadText(url, entry, function (text) {\n                handleLoad(entry, new BasicFile(text));\n            });\n        }\n    }\n\n    override private function getAssetFormats (fn :Array<AssetFormat> -> Void)\n    {\n        if (_supportedFormats == null) {\n            _supportedFormats = new Promise();\n            detectImageFormats(function (imageFormats) {\n                _supportedFormats.result = _platform.getRenderer().getCompressedTextureFormats()\n                    .concat(imageFormats).concat(detectAudioFormats()).concat([Data]);\n            });\n        }\n        _supportedFormats.get(fn);\n    }\n\n    inline private function downloadArrayBuffer (url :String, entry :AssetEntry, onLoad :ArrayBuffer -> Void)\n    {\n        download(url, entry, \"arraybuffer\", onLoad);\n    }\n\n    inline private function downloadBlob (url :String, entry :AssetEntry, onLoad :Blob -> Void)\n    {\n        download(url, entry, \"blob\", onLoad);\n    }\n\n    inline private function downloadText (url :String, entry :AssetEntry, onLoad :String -> Void)\n    {\n        download(url, entry, \"text\", onLoad);\n    }\n\n    private function download (url :String, entry :AssetEntry, responseType :String, onLoad :Dynamic -> Void)\n    {\n        var xhr :XMLHttpRequest = null;\n        var start = null;\n\n        var intervalId = 0;\n        var hasInterval = false;\n        var clearRetryInterval = function () {\n            if (hasInterval) {\n                hasInterval = false;\n                Browser.window.clearInterval(intervalId);\n            }\n        };\n\n        var retries = XHR_RETRIES;\n        var maybeRetry = function () {\n            // Returns true if the download was retried\n            --retries;\n            if (retries >= 0) {\n                Log.warn(\"Retrying asset download\", [\"url\", entry.url]);\n                start();\n                return true;\n            }\n            return false;\n        };\n\n        start = function () {\n            clearRetryInterval();\n\n            if (xhr != null) {\n                xhr.abort();\n            }\n            xhr = new XMLHttpRequest();\n            xhr.open(\"GET\", url, true);\n            untyped xhr.responseType = responseType;\n\n            var lastProgress = 0.0;\n            xhr.onprogress = function (event :ProgressEvent) {\n                // When the first progress event comes in, start detecting stalled downloads\n                if (!hasInterval) {\n                    hasInterval = true;\n                    intervalId = Browser.window.setInterval(function () {\n                        // If the download isn't finished, and enough time has passed since the last\n                        // progress event, consider it stalled and attempt to retry\n                        if (xhr.readyState != XMLHttpRequest.DONE && HtmlUtil.now() - lastProgress > XHR_TIMEOUT) {\n                            if (!maybeRetry()) {\n                                clearRetryInterval();\n                                handleError(entry, \"Download stalled\");\n                            }\n                        }\n                    }, 1000);\n                }\n\n                lastProgress = HtmlUtil.now();\n                handleProgress(entry, event.loaded);\n            };\n\n            xhr.onerror = function (_) {\n                if (xhr.status != 0 || !maybeRetry()) {\n                    clearRetryInterval();\n                    handleError(entry, \"HTTP error \" + xhr.status);\n                }\n            };\n\n            xhr.onload = function (_) {\n                var response :Dynamic = xhr.response;\n                if (response == null) {\n                    // Hack for IE9, which doesn't have xhr.response, only responseText\n                    response = xhr.responseText;\n                }\n                clearRetryInterval();\n                onLoad(response);\n            };\n\n            xhr.send();\n        };\n\n        start();\n    }\n\n    private static function detectImageFormats (fn :Array<AssetFormat> -> Void)\n    {\n        var formats = [PNG, JPG, GIF];\n\n        var formatTests = 2;\n        var checkRemaining = function () {\n            // Called when an image test completes\n            --formatTests;\n            if (formatTests == 0) {\n                fn(formats);\n            }\n        };\n\n        // Detect WebP-lossless support (and assume that lossy works where lossless does)\n        // https://github.com/Modernizr/Modernizr/blob/master/feature-detects/img/webp-lossless.js\n        var webp = Browser.document.createImageElement();\n        webp.onload = webp.onerror = function (_) {\n            if (webp.width == 1) {\n                formats.unshift(WEBP);\n            }\n            checkRemaining();\n        };\n        webp.src = \"data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==\";\n\n        // Detect JPEG XR support\n        var jxr = Browser.document.createImageElement();\n        jxr.onload = jxr.onerror = function (_) {\n            if (jxr.width == 1) {\n                formats.unshift(JXR);\n            }\n            checkRemaining();\n        };\n        // The smallest JXR I could generate (where pixel.tif is a 1x1 black image)\n        // ./jpegxr pixel.tif -c -o pixel.jxr -f YOnly -q 255 -b DCONLY -a 0 -w\n        jxr.src = \"data:image/vnd.ms-photo;base64,SUm8AQgAAAAFAAG8AQAQAAAASgAAAIC8BAABAAAAAQAAAIG8BAABAAAAAQAAAMC8BAABAAAAWgAAAMG8BAABAAAAHwAAAAAAAAAkw91vA07+S7GFPXd2jckNV01QSE9UTwAZAYBxAAAAABP/gAAEb/8AAQAAAQAAAA==\";\n    }\n\n    private static function detectAudioFormats () :Array<AssetFormat>\n    {\n        // Detect basic support for HTML5 audio\n        var audio = Browser.document.createAudioElement();\n        if (audio == null || audio.canPlayType == null) {\n            Log.warn(\"Audio is not supported at all in this browser!\");\n            return [];\n        }\n\n        // Reject browsers that claim to support audio, but are too buggy or incomplete\n#if flambe_html_audio_fix\n        var blacklist = ~/\\b(iPhone|iPod|iPad|Windows Phone)\\b/;\n#else\n        var blacklist = ~/\\b(iPhone|iPod|iPad|Android|Windows Phone)\\b/;\n#end\n        var userAgent = Browser.navigator.userAgent;\n        if (!WebAudioSound.supported && blacklist.match(userAgent)) {\n            Log.warn(\"HTML5 audio is blacklisted for this browser\", [\"userAgent\", userAgent]);\n            return [];\n        }\n\n        // Select what formats the browser supports\n        var types = [\n            { format: M4A,  mimeType: \"audio/mp4; codecs=mp4a\" },\n            { format: MP3,  mimeType: \"audio/mpeg\" },\n            { format: OPUS, mimeType: \"audio/ogg; codecs=opus\" },\n            { format: OGG,  mimeType: \"audio/ogg; codecs=vorbis\" },\n            { format: WAV,  mimeType: \"audio/wav\" },\n        ];\n#if flambe_disable_firefox_mp3\n        // Temporary hack to disable Firefox MP3 loading. This will no longer be necessary after\n        // Firefox 28: https://bugzilla.mozilla.org/show_bug.cgi?id=967007\n        if (userAgent.indexOf(\"Gecko/\") >= 0) {\n            types.splice(1, 1);\n        }\n#end\n        var result = [];\n        for (type in types) {\n            // IE9's canPlayType() will throw an error in some rare cases:\n            // https://github.com/Modernizr/Modernizr/issues/224\n            var canPlayType = \"\";\n            try canPlayType = audio.canPlayType(type.mimeType)\n            catch (_ :Dynamic) {}\n\n            if (canPlayType != \"\") {\n                result.push(type.format);\n            }\n        }\n        return result;\n    }\n\n    private static function supportsBlob () :Bool\n    {\n        // Checks for XHR Blob responseType support\n        // http://html5test.com/compare/feature/communication-xmlhttprequest2.response-blob/communication-websocket.binary.html\n        if (_detectBlobSupport) {\n            _detectBlobSupport = false;\n\n            // Blobs on Amazon Silk are buggy: https://github.com/aduros/flambe/issues/194\n            if (~/\\bSilk\\b/.match(Browser.navigator.userAgent)) {\n                return false;\n            }\n\n            if ((untyped Browser.window).Blob == null) {\n                return false; // No Blob constructor\n            }\n\n            var xhr = new XMLHttpRequest();\n            // Hack for IE, which throws an InvalidStateError upon setting the responseType when\n            // in the UNSENT state, despite the spec being clear about only throwing in LOADING\n            // or DONE: http://www.w3.org/TR/XMLHttpRequest2/#dom-xmlhttprequest-responsetype\n            //\n            // Forcing it into the OPENED state does the trick, and doesn't actually send the\n            // request so it's all good.\n            xhr.open(\"GET\", \".\", true);\n\n            if (untyped xhr.responseType != \"\") {\n                return false; // No responseType supported at all\n            }\n            untyped xhr.responseType = \"blob\";\n            if (untyped xhr.responseType != \"blob\") {\n                return false; // Blob responseType not supported\n            }\n\n            _URL = HtmlUtil.loadExtension(\"URL\").value;\n        }\n        return _URL != null && _URL.createObjectURL != null;\n    }\n\n    private static inline var XHR_TIMEOUT = 5000;\n    private static inline var XHR_RETRIES = 3;\n\n    private static var _supportedFormats :Promise<Array<AssetFormat>> = null;\n\n    /**\n     * Media elements get GCed during loading in Chrome and IE9. The spec is clear that elements\n     * shouldn't be GCed while playing, but vague about GCing while loading. So, maintain a hard\n     * reference to all media elements being loaded to prevent GC.\n     */\n    private static var _mediaElements :Map<Int,Dynamic>;\n    private static var _mediaRefCount = 0;\n\n    private static var _detectBlobSupport = true;\n    private static var _URL :Dynamic = null;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.Browser;\nimport js.html.*;\n\nclass HtmlCatapultClient extends CatapultClient\n{\n    public static function canUse () :Bool\n    {\n        return Reflect.hasField(Browser.window, \"WebSocket\");\n    }\n\n    public function new ()\n    {\n        super();\n\n        _socket = new WebSocket(\"ws://\" + Browser.location.host);\n        _socket.onerror = function (event) {\n            onError(\"unknown\");\n        };\n        _socket.onopen = function (event) {\n            Log.info(\"Catapult connected\");\n        };\n        _socket.onmessage = function (event :MessageEvent) {\n            onMessage(event.data);\n        };\n    }\n\n    override private function onRestart ()\n    {\n        Browser.window.top.location.reload();\n    }\n\n    private var _socket :WebSocket;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport flambe.util.Logger;\n\nclass HtmlLogHandler\n    implements LogHandler\n{\n    public static function isSupported () :Bool\n    {\n        return untyped __js__(\"typeof console\") == \"object\" && __js__(\"console\").info != null;\n    }\n\n    public function new (tag :String)\n    {\n        _tagPrefix = tag + \": \";\n    }\n\n    public function log (level :LogLevel, message :String)\n    {\n        message = _tagPrefix + message;\n\n        switch (level) {\n        case Info:\n            (untyped __js__(\"console\")).info(message);\n        case Warn:\n            (untyped __js__(\"console\")).warn(message);\n        case Error:\n            (untyped __js__(\"console\")).error(message);\n        }\n    }\n\n    private var _tagPrefix :String;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport flambe.input.MouseCursor;\n\nclass HtmlMouse extends BasicMouse\n{\n    public function new (pointer :BasicPointer, canvas :Dynamic)\n    {\n        super(pointer);\n        _canvas = canvas;\n    }\n\n    override public function set_cursor (cursor :MouseCursor) :MouseCursor\n    {\n        var name;\n        switch (cursor) {\n            case Default: name = \"\"; // inherit\n            case Button: name = \"pointer\";\n            case None: name = \"none\";\n        }\n        _canvas.style.cursor = name;\n\n        return super.set_cursor(cursor);\n    }\n\n    private var _canvas :Dynamic;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.Browser;\n\nimport flambe.animation.AnimatedFloat;\nimport flambe.platform.Tickable;\nimport flambe.sound.Playback;\nimport flambe.sound.Sound;\nimport flambe.util.Disposable;\nimport flambe.util.Value;\n\nclass HtmlSound extends BasicAsset<HtmlSound>\n    implements Sound\n{\n    public var duration (get, null) :Float;\n    public var audioElement :Dynamic; // TODO(bruno): Use typed audio element extern\n\n    public function new (audioElement :Dynamic)\n    {\n        super();\n        this.audioElement = audioElement;\n    }\n\n    public function play (volume :Float = 1.0) :Playback\n    {\n        assertNotDisposed();\n\n        return new HtmlPlayback(this, volume, false);\n    }\n\n    public function loop (volume :Float = 1.0) :Playback\n    {\n        assertNotDisposed();\n\n        return new HtmlPlayback(this, volume, true);\n    }\n\n    public function get_duration () :Float\n    {\n        assertNotDisposed();\n\n        return audioElement.duration;\n    }\n\n    override private function copyFrom (that :HtmlSound)\n    {\n        this.audioElement = that.audioElement;\n    }\n\n    override private function onDisposed ()\n    {\n        audioElement = null;\n    }\n}\n\nprivate class HtmlPlayback\n    implements Playback\n    implements Tickable\n{\n    public var volume (default, null) :AnimatedFloat;\n    public var paused (get, set) :Bool;\n    public var complete (get, null) :Value<Bool>;\n    public var position (get, null) :Float;\n    public var sound (get, null) :Sound;\n\n    public function new (sound :HtmlSound, volume :Float, loop :Bool)\n    {\n        _sound = sound;\n        _tickableAdded = false;\n\n        // Create a copy of the original sound's element. Note that cloneNode() doesn't work in IE\n        _clonedElement = Browser.document.createAudioElement();\n        _clonedElement.loop = loop;\n        _clonedElement.src = sound.audioElement.src;\n\n        this.volume = new AnimatedFloat(volume, function (_,_) updateVolume());\n        updateVolume();\n        _complete = new Value<Bool>(false);\n\n        playAudio();\n\n        // Don't start playing until visible\n        if (System.hidden._) {\n            paused = true;\n        }\n    }\n\n    public function get_sound () :Sound\n    {\n        return _sound;\n    }\n\n    inline public function get_paused () :Bool\n    {\n        return _clonedElement.paused;\n    }\n\n    public function set_paused (paused :Bool) :Bool\n    {\n        if (_clonedElement.paused != paused) {\n            if (paused) {\n                _clonedElement.pause();\n            } else {\n                playAudio();\n            }\n        }\n        return paused;\n    }\n\n    public function get_complete () :Value<Bool>\n    {\n        return _complete;\n    }\n\n    public function get_position () :Float\n    {\n        return _clonedElement.currentTime;\n    }\n\n    public function update (dt :Float) :Bool\n    {\n        volume.update(dt);\n        _complete._ = _clonedElement.ended;\n\n        if (_complete._ || paused) {\n            // Allow complete or paused sounds to be garbage collected\n            _tickableAdded = false;\n\n            // Release System references\n            _volumeBinding.dispose();\n            _hideBinding.dispose();\n\n            return true;\n        }\n        return false;\n    }\n\n    public function dispose ()\n    {\n        paused = true;\n        _complete._ = true;\n    }\n\n    private function playAudio ()\n    {\n        #if flambe_html_audio_fix\n        // Only allow looping audio to play\n        // Assumes background music loops\n        if (!_clonedElement.loop) {\n            return;\n        }\n\n        // Only allow one background music\n        if (HtmlPlatform.instance.musicPlaying) {\n            return;\n        }\n        HtmlPlatform.instance.musicPlaying = true;\n        #end\n\n        _clonedElement.play();\n\n        if (!_tickableAdded) {\n            HtmlPlatform.instance.mainLoop.addTickable(this);\n            _tickableAdded = true;\n\n            // Claim System references\n            _volumeBinding = System.volume.changed.connect(function(_,_) updateVolume());\n            _hideBinding = System.hidden.changed.connect(function(hidden,_) {\n                if (hidden) {\n                    _wasPaused = get_paused();\n                    this.paused = true;\n                } else {\n                    this.paused = _wasPaused;\n                }\n            });\n        }\n    }\n\n    private function updateVolume ()\n    {\n        _clonedElement.volume = System.volume._ * volume._;\n    }\n\n    private var _sound :HtmlSound;\n    private var _clonedElement :Dynamic;\n    private var _volumeBinding :Disposable;\n    private var _tickableAdded :Bool;\n    private var _hideBinding :Disposable;\n    private var _wasPaused :Bool;\n\n    private var _complete :Value<Bool>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.Browser;\nimport js.html.*;\n\nimport flambe.display.Orientation;\nimport flambe.subsystem.StageSystem;\nimport flambe.util.Signal0;\nimport flambe.util.Value;\n\nclass HtmlStage\n    implements StageSystem\n{\n    public var width (get, null) :Int;\n    public var height (get, null) :Int;\n    public var orientation (default, null) :Value<Orientation>;\n    public var fullscreen (default, null) :Value<Bool>;\n    public var fullscreenSupported (get, null) :Bool;\n\n    public var resize (default, null) :Signal0;\n\n    public var scaleFactor (default, null) :Float;\n\n    public function new (canvas :CanvasElement)\n    {\n        _canvas = canvas;\n        resize = new Signal0();\n\n#if flambe_disable_html_retina\n        scaleFactor = 1;\n#else\n        // If the DPI is being scaled by the browser, reverse it so that one canvas pixel equals\n        // one screen pixel\n        scaleFactor = computeScaleFactor();\n        if (scaleFactor != 1) {\n            Log.info(\"Reversing device DPI scaling\", [\"scaleFactor\", scaleFactor]);\n            HtmlUtil.setVendorStyle(_canvas, \"transform-origin\", \"top left\");\n            HtmlUtil.setVendorStyle(_canvas, \"transform\", \"scale(\" + (1/scaleFactor) + \")\");\n        }\n#end\n\n#if !flambe_disable_autoresize\n        if (HtmlUtil.SHOULD_HIDE_MOBILE_BROWSER) {\n            Browser.window.addEventListener(\"orientationchange\", function (_) {\n                // Wait for the orientation change to finish... sigh\n                HtmlUtil.callLater(hideMobileBrowser, 200);\n            }, false);\n            hideMobileBrowser();\n        }\n\n        Browser.window.addEventListener(\"resize\", onWindowResize, false);\n        onWindowResize(null);\n#end\n\n        orientation = new Value<Orientation>(null);\n        if ((untyped Browser.window).orientation != null) {\n            Browser.window.addEventListener(\"orientationchange\", onOrientationChange, false);\n            onOrientationChange(null);\n        }\n\n        fullscreen = new Value<Bool>(false);\n        HtmlUtil.addVendorListener(Browser.document, \"fullscreenchange\", function (_) {\n            updateFullscreen();\n        }, false);\n#if debug\n        HtmlUtil.addVendorListener(Browser.document, \"fullscreenerror\", function (_) {\n            // No useful error message since the event provides no reason. See the error conditions\n            // at http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html#dom-element-requestfullscreen\n            Log.warn(\"Error when requesting fullscreen\");\n        }, false);\n#end\n        updateFullscreen();\n    }\n\n    public function get_width () :Int\n    {\n        return _canvas.width;\n    }\n\n    public function get_height () :Int\n    {\n        return _canvas.height;\n    }\n\n    public function get_fullscreenSupported () :Bool\n    {\n        return HtmlUtil.loadFirstExtension(\n            [\"fullscreenEnabled\", \"fullScreenEnabled\"], Browser.document).value == true;\n    }\n\n    public function lockOrientation (orient :Orientation)\n    {\n        var lockOrientation = HtmlUtil.loadExtension(\"lockOrientation\", Browser.window.screen).value;\n        if (lockOrientation != null) {\n            var htmlOrient = switch (orient) {\n                case Portrait: \"portrait\";\n                case Landscape: \"landscape\";\n            };\n            var allowed = Reflect.callMethod(Browser.window.screen, lockOrientation, [htmlOrient]);\n            if (!allowed) {\n                Log.warn(\"The request to lockOrientation() was refused by the browser\");\n            }\n        }\n    }\n\n    public function unlockOrientation ()\n    {\n        var unlockOrientation = HtmlUtil.loadExtension(\"unlockOrientation\", Browser.window.screen).value;\n        if (unlockOrientation != null) {\n            Reflect.callMethod(Browser.window.screen, unlockOrientation, []);\n        }\n    }\n\n    public function requestResize (width :Int, height :Int)\n    {\n        if (resizeCanvas(width, height)) {\n            // Fit the container to the requested canvas size\n            var container = _canvas.parentElement;\n            container.style.width = width + \"px\";\n            container.style.height = height + \"px\";\n        }\n    }\n\n    public function requestFullscreen (enable :Bool = true)\n    {\n        if (enable) {\n            var documentElement = Browser.document.documentElement;\n            var requestFullscreen = HtmlUtil.loadFirstExtension(\n               [\"requestFullscreen\", \"requestFullScreen\"], documentElement).value;\n            if (requestFullscreen != null) {\n                Reflect.callMethod(documentElement, requestFullscreen, []);\n            }\n\n        } else {\n            var cancelFullscreen = HtmlUtil.loadFirstExtension(\n                [\"cancelFullscreen\", \"cancelFullScreen\"], Browser.document).value;\n            if (cancelFullscreen != null) {\n                Reflect.callMethod(Browser.document, cancelFullscreen, []);\n            }\n        }\n    }\n\n    private function onWindowResize (_)\n    {\n        // Resize the canvas to match its container's bounds\n        var container = _canvas.parentElement;\n        var rect = container.getBoundingClientRect();\n        resizeCanvas(rect.width, rect.height);\n    }\n\n    private function resizeCanvas (width :Float, height :Float) :Bool\n    {\n        // Take device scaling into account...\n        var scaledWidth = scaleFactor*width;\n        var scaledHeight = scaleFactor*height;\n\n        if (_canvas.width == scaledWidth && _canvas.height == scaledHeight) {\n            return false;\n        }\n\n        _canvas.width = Std.int(scaledWidth);\n        _canvas.height = Std.int(scaledHeight);\n        resize.emit();\n        return true;\n    }\n\n    // Voodoo hacks required to move the address bar out of the way on Android and iOS\n    private function hideMobileBrowser ()\n    {\n        // The maximum size of the part of the browser that can be scrolled away\n        var mobileAddressBar = 100;\n\n        var htmlStyle = Browser.document.documentElement.style;\n\n        // Force the page to be tall enough to scroll\n        htmlStyle.height = (Browser.window.innerHeight + mobileAddressBar) + \"px\";\n        htmlStyle.width = Browser.window.innerWidth + \"px\";\n        htmlStyle.overflow = \"visible\"; // Need to have overflow to scroll...\n\n        HtmlUtil.callLater(function () {\n            // Scroll the address bar away\n            HtmlUtil.hideMobileBrowser();\n\n            HtmlUtil.callLater(function () {\n                // Fit the page to the new screen size\n                htmlStyle.height = Browser.window.innerHeight + \"px\";\n\n                onWindowResize(null);\n            }, 100);\n        });\n    }\n\n    private function onOrientationChange (_)\n    {\n        var value = HtmlUtil.orientation((untyped Browser.window).orientation);\n        orientation._ = value;\n    }\n\n    private function updateFullscreen ()\n    {\n        var state :Dynamic = HtmlUtil.loadFirstExtension(\n            [\"fullscreen\", \"fullScreen\", \"isFullScreen\"], Browser.document).value;\n        fullscreen._ = (state == true); // state will be null if fullscreen not supported\n    }\n\n    private static function computeScaleFactor () :Float\n    {\n        // Based on \"Delivering Web Content on High Resolution Displays\"\n        // https://developer.apple.com/videos/wwdc/2012/?id=602\n\n        var devicePixelRatio = Browser.window.devicePixelRatio;\n        if (devicePixelRatio == null) {\n            devicePixelRatio = 1;\n        }\n\n        // Take into account any behind-the-scenes scaling of canvas elements\n        var canvas = Browser.document.createCanvasElement();\n        var ctx = canvas.getContext2d();\n        var backingStorePixelRatio = HtmlUtil.loadExtension(\"backingStorePixelRatio\", ctx).value;\n        if (backingStorePixelRatio == null) {\n            backingStorePixelRatio = 1;\n        }\n\n        // Calculate the scale, but bail early if this would cause the canvas to be larger than some\n        // magic threshold. This was added to disable the retina display on the iPad 3, as\n        // performance plummets there when scaling such a huge canvas\n        var scale = devicePixelRatio / backingStorePixelRatio;\n        var screenWidth = Browser.window.screen.width;\n        var screenHeight = Browser.window.screen.height;\n        if (scale*screenWidth > 1136 || scale*screenHeight > 1136) {\n            return 1;\n        }\n        return scale;\n    }\n\n    private var _canvas :CanvasElement;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.Browser;\nimport js.html.*;\nimport js.html.webgl.RenderingContext;\n\nimport flambe.display.Orientation;\n\nclass HtmlUtil\n{\n    public static var VENDOR_PREFIXES = [\"webkit\", \"moz\", \"ms\", \"o\", \"khtml\"];\n\n    /**\n     * Whether the annoying scrolling address bar in some iOS and Android browsers may be hidden.\n     */\n    public static var SHOULD_HIDE_MOBILE_BROWSER =\n#if !flambe_disable_hide_mobile_browser\n        Browser.window.top == Browser.window &&\n        ~/Mobile(\\/.*)? Safari/.match(Browser.navigator.userAgent);\n#else\n        false;\n#end\n\n    public static function callLater (func :Void -> Void, delay :Int = 0)\n    {\n        Browser.window.setTimeout(func, delay);\n    }\n\n    public static function hideMobileBrowser ()\n    {\n        Browser.window.scrollTo(1, 0);\n    }\n\n    // Load a prefixed vendor extension\n    public static function loadExtension (\n        name :String, ?obj :Dynamic) :{ prefix :String, field :String, value :Dynamic }\n    {\n        if (obj == null) {\n            obj = Browser.window;\n        }\n\n        // Try to load it as is\n        var extension = Reflect.field(obj, name);\n        if (extension != null) {\n            return {prefix: \"\", field: name, value: extension};\n        }\n\n        // Look through common vendor prefixes\n        var capitalized = name.charAt(0).toUpperCase() + name.substr(1);\n        for (prefix in VENDOR_PREFIXES) {\n            var field = prefix + capitalized;\n            var extension = Reflect.field(obj, field);\n            if (extension != null) {\n                return {prefix: prefix, field: field, value: extension};\n            }\n        }\n\n        // Not found\n        return {prefix: null, field: null, value: null};\n    }\n\n    public static function loadFirstExtension (\n        names :Array<String>, ?obj :Dynamic) :{ prefix :String, field :String, value :Dynamic }\n    {\n        for (name in names) {\n            var extension = loadExtension(name, obj);\n            if (extension.field != null) {\n                return extension;\n            }\n        }\n\n        // Not found\n        return {prefix: null, field: null, value: null};\n    }\n\n    // Loads a vendor extension and jams it into the supplied object\n    public static function polyfill (name :String, ?obj :Dynamic) :Bool\n    {\n        if (obj == null) {\n            obj = Browser.window;\n        }\n\n        var value = loadExtension(name, obj).value;\n        if (value == null) {\n            return false;\n        }\n        Reflect.setField(obj, name, value);\n        return true;\n    }\n\n    public static function setVendorStyle (element :Dynamic, name :String, value :String)\n    {\n        var style = element.style;\n        for (prefix in VENDOR_PREFIXES) {\n            style.setProperty(\"-\" + prefix + \"-\" + name, value);\n        }\n        style.setProperty(name, value);\n    }\n\n    public static function addVendorListener (dispatcher :EventTarget, type :String,\n        listener :Dynamic -> Void, useCapture :Bool)\n    {\n        for (prefix in VENDOR_PREFIXES) {\n            dispatcher.addEventListener(prefix + type, listener, useCapture);\n        }\n        dispatcher.addEventListener(type, listener, useCapture);\n    }\n\n    /**\n     * Get a Flambe orientation from a window.orientation angle.\n     */\n    public static function orientation (angle :Int) :Orientation\n    {\n        switch (angle) {\n            case -90, 90: return Landscape;\n            default: return Portrait;\n        }\n    }\n\n    /** Gets the current time in milliseconds since the Unix epoch. */\n    inline public static function now () :Float\n    {\n        // Same thing as Date.now().getTime(), but avoids creating a Date object\n        return (untyped Date).now();\n    }\n\n    public static function createEmptyCanvas (width :Int, height :Int) :CanvasElement\n    {\n        var canvas = Browser.document.createCanvasElement();\n        canvas.width = width;\n        canvas.height = height;\n        return canvas;\n    }\n\n    public static function createCanvas (source :CanvasElement) :CanvasElement\n    {\n        var canvas = createEmptyCanvas(source.width, source.height);\n\n        var ctx = canvas.getContext2d();\n        ctx.save();\n        ctx.globalCompositeOperation = \"copy\";\n        ctx.drawImage(source, 0, 0);\n        ctx.restore();\n\n        return canvas;\n    }\n\n    public static function detectSlowDriver (gl :RenderingContext) :Bool\n    {\n        // Try to detect SwiftShader. There will be some false positives here, but falling back to\n        // canvas in those cases is better than using WebGL on a software driver.\n        // http://stackoverflow.com/questions/10456491/detect-swiftshader-webgl-renderer-in-chrome-18\n        //\n        // TODO(bruno): Use http://www.khronos.org/registry/webgl/extensions/WEBGL_debug_renderer_info/\n\n        var windows = (Browser.navigator.platform.indexOf(\"Win\") >= 0);\n        if (windows) {\n            var chrome = ((untyped Browser.window).chrome != null);\n            if (chrome) {\n                for (ext in gl.getSupportedExtensions()) {\n                    if (ext.indexOf(\"WEBGL_compressed_texture\") >= 0) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n        }\n        return false;\n    }\n\n    public static function fixAndroidMath ()\n    {\n        // Some versions of V8 on ARM (like the one in the stock Android 4 browser) are affected by\n        // this nasty bug: https://code.google.com/p/v8/issues/detail?id=2234\n        //\n        // So, hack around it. This doesn't affect Android 2. Hopefully 5 will use an updated V8\n        // with the real fix.\n\n        if (Browser.navigator.userAgent.indexOf(\"Linux; U; Android 4\") >= 0) {\n            Log.warn(\"Monkey patching around Android sin/cos bug\");\n            var sin = Math.sin, cos = Math.cos;\n            (untyped Math).sin = function (x) {\n                return (x == 0) ? 0 : sin(x);\n            };\n            (untyped Math).cos = function (x) {\n                return (x == 0) ? 1 : cos(x);\n            }\n        }\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport flambe.animation.AnimatedFloat;\nimport flambe.platform.Tickable;\nimport flambe.sound.Playback;\nimport flambe.sound.Sound;\nimport flambe.util.Disposable;\nimport flambe.util.Value;\n\nclass WebAudioSound extends BasicAsset<WebAudioSound>\n    implements Sound\n{\n    public static var supported (get, null) :Bool;\n\n    /**\n     * The shared AudioContext.\n     */\n    public static var ctx :Dynamic = null;\n\n    /**\n     * The shared gain node for global system volume.\n     */\n    public static var gain :Dynamic;\n\n    public var duration (get, null) :Float;\n\n    public var buffer :Dynamic;\n\n    public function new (buffer :Dynamic)\n    {\n        super();\n        this.buffer = buffer;\n    }\n\n    public function play (volume :Float = 1.0) :Playback\n    {\n        assertNotDisposed();\n\n        return new WebAudioPlayback(this, volume, false);\n    }\n\n    public function loop (volume :Float = 1.0) :Playback\n    {\n        assertNotDisposed();\n\n        return new WebAudioPlayback(this, volume, true);\n    }\n\n    public function get_duration () :Float\n    {\n        assertNotDisposed();\n\n        return buffer.duration;\n    }\n\n    override private function copyFrom (that :WebAudioSound)\n    {\n        this.buffer = that.buffer;\n    }\n\n    override private function onDisposed ()\n    {\n        buffer = null;\n    }\n\n    private static function get_supported () :Bool\n    {\n        if (_detectSupport) {\n            _detectSupport = false;\n\n            var AudioContext = HtmlUtil.loadExtension(\"AudioContext\").value;\n            if (AudioContext != null) {\n                ctx = untyped __new__(AudioContext);\n                gain = createGain();\n                gain.connect(ctx.destination);\n\n                System.volume.watch(function(volume, _) {\n                    gain.gain.value = volume;\n                });\n            }\n        }\n\n        return ctx != null;\n    }\n\n    public static function createGain () :Dynamic\n    {\n        // Fall back to createGainNode used in iOS Safari\n        // https://developer.mozilla.org/en-US/docs/Web_Audio_API/Porting_webkitAudioContext_code_to_standards_based_AudioContext\n        return (ctx.createGain != null) ? ctx.createGain() : ctx.createGainNode();\n    }\n\n    public static function start (node :Dynamic, time :Float)\n    {\n        // Fall back to noteOn used in iOS Safari\n        if (node.start != null) {\n            node.start(time);\n        } else {\n            node.noteOn(time);\n        }\n    }\n\n    private static var _detectSupport = true;\n}\n\nprivate class WebAudioPlayback\n    implements Playback\n    implements Tickable\n{\n    public var volume (default, null) :AnimatedFloat;\n    public var paused (get, set) :Bool;\n    public var complete (get, null) :Value<Bool>;\n    public var position (get, null) :Float;\n    public var sound (get, null) :Sound;\n\n    public function new (sound :WebAudioSound, volume :Float, loop :Bool)\n    {\n        _sound = sound;\n        _head = WebAudioSound.gain;\n        _complete = new Value<Bool>(false);\n\n        _sourceNode = WebAudioSound.ctx.createBufferSource();\n        _sourceNode.buffer = sound.buffer;\n        _sourceNode.loop = loop;\n        _sourceNode.onended = function () _complete._ = true; // Not supported on iOS!\n        WebAudioSound.start(_sourceNode, 0);\n        playAudio();\n\n        this.volume = new AnimatedFloat(volume, function (v, _) {\n            setVolume(v);\n        });\n        if (volume != 1) {\n            setVolume(volume);\n        }\n\n        // Don't start playing until visible\n        if (System.hidden._) {\n            paused = true;\n        }\n    }\n\n    public function get_sound () :Sound\n    {\n        return _sound;\n    }\n\n    inline public function get_paused () :Bool\n    {\n        return _pausedAt >= 0;\n    }\n\n    public function set_paused (paused :Bool) :Bool\n    {\n        if (paused != get_paused()) {\n            if (paused) {\n                _sourceNode.disconnect();\n                _pausedAt = position;\n            } else {\n                playAudio();\n            }\n        }\n        return paused;\n    }\n\n    inline public function get_complete () :Value<Bool>\n    {\n        return _complete;\n    }\n\n    public function get_position () :Float\n    {\n        // Web Audio sure doesn't make this simple...\n        if (_complete._) {\n            return _sound.duration;\n\n        } else if (paused) {\n            return _pausedAt;\n\n        } else {\n            var elapsed = WebAudioSound.ctx.currentTime - _startedAt;\n            return elapsed % _sound.duration;\n        }\n    }\n\n    public function update (dt :Float) :Bool\n    {\n        volume.update(dt);\n\n        // playbackState is used in old browsers that don't support onended (iOS)\n        if (_sourceNode.playbackState == 3 /* FINISHED_STATE */) {\n            _complete._ = true;\n        }\n\n        if (_complete._ || paused) {\n            // Allow complete or paused sounds to be garbage collected\n            _tickableAdded = false;\n\n            // Release System references\n            _hideBinding.dispose();\n\n            return true;\n        }\n        return false;\n    }\n\n    public function dispose ()\n    {\n        paused = true;\n        _complete._ = true;\n    }\n\n    private function setVolume (volume :Float)\n    {\n        if (_gainNode == null) {\n            _gainNode = WebAudioSound.createGain();\n            insertNode(_gainNode);\n        }\n        _gainNode.gain.value = volume;\n    }\n\n    private function insertNode (head :Dynamic)\n    {\n        if (!paused) {\n            _sourceNode.disconnect();\n            _sourceNode.connect(head);\n        }\n        head.connect(_head);\n        _head = head;\n    }\n\n    private function playAudio ()\n    {\n        _sourceNode.connect(_head);\n        _startedAt = WebAudioSound.ctx.currentTime;\n        _pausedAt = -1;\n\n        if (!_tickableAdded) {\n            HtmlPlatform.instance.mainLoop.addTickable(this);\n            _tickableAdded = true;\n\n            // Claim System references\n            _hideBinding = System.hidden.changed.connect(function(hidden,_) {\n                if (hidden) {\n                    _wasPaused = get_paused();\n                    this.paused = true;\n                } else {\n                    this.paused = _wasPaused;\n                }\n            });\n        }\n    }\n\n    private var _sound :WebAudioSound;\n\n    private var _pausedAt :Float;\n    private var _startedAt :Float;\n    private var _wasPaused :Bool;\n\n    private var _sourceNode :Dynamic;\n    private var _gainNode :Dynamic;\n\n    // The first node of the output chain, not including the source node\n    private var _head :Dynamic;\n\n    private var _hideBinding :Disposable;\n    private var _tickableAdded :Bool;\n\n    private var _complete :Value<Bool>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.html.*;\nimport js.html.webgl.*;\nimport js.html.webgl.RenderingContext;\n\nimport flambe.display.BlendMode;\nimport flambe.math.Rectangle;\nimport flambe.platform.shader.DrawPatternGL;\nimport flambe.platform.shader.DrawTextureGL;\nimport flambe.platform.shader.FillRectGL;\nimport flambe.platform.shader.ShaderGL;\n\n/**\n * Batches up geometry to glDrawElements and avoids redundant state changes. All GL state changes\n * MUST go through the batcher.\n */\nclass WebGLBatcher\n{\n    public var data (default, null) :Float32Array;\n\n    public function new (gl :RenderingContext)\n    {\n        _gl = gl;\n\n        gl.clearColor(0, 0, 0, 0);\n        gl.enable(GL.BLEND);\n        gl.pixelStorei(GL.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 1);\n\n        _vertexBuffer = gl.createBuffer();\n        gl.bindBuffer(GL.ARRAY_BUFFER, _vertexBuffer);\n\n        _quadIndexBuffer = gl.createBuffer();\n        gl.bindBuffer(GL.ELEMENT_ARRAY_BUFFER, _quadIndexBuffer);\n\n        _drawTextureShader = new DrawTextureGL(gl);\n        _drawPatternShader = new DrawPatternGL(gl);\n        _fillRectShader = new FillRectGL(gl);\n\n        resize(16);\n    }\n\n    public function resizeBackbuffer (width :Int, height :Int)\n    {\n        _gl.viewport(0, 0, width, height);\n        _backbufferWidth = width;\n        _backbufferHeight = height;\n    }\n\n    public function willRender ()\n    {\n#if flambe_transparent\n        _gl.clear(GL.COLOR_BUFFER_BIT);\n#end\n    }\n\n    public function didRender ()\n    {\n        flush();\n    }\n\n    /** Safely bind a texture. */\n    public function bindTexture (texture :Texture)\n    {\n        flush();\n        _lastTexture = null;\n        _currentTexture = null;\n\n        _gl.bindTexture(GL.TEXTURE_2D, texture);\n    }\n\n    /** Safely delete a texture. */\n    public function deleteTexture (texture :WebGLTextureRoot)\n    {\n        // If we have unflushed quads that use this texture, flush them now\n        if (_lastTexture != null && _lastTexture.root == texture) {\n            flush();\n            _lastTexture = null;\n            _currentTexture = null;\n        }\n\n        _gl.deleteTexture(texture.nativeTexture);\n    }\n\n    /** Safely bind a framebuffer. */\n    public function bindFramebuffer (texture :WebGLTextureRoot)\n    {\n        if (texture != _lastRenderTarget) {\n            flush();\n            bindRenderTarget(texture);\n        }\n    }\n\n    /** Safely delete a framebuffer. */\n    public function deleteFramebuffer (texture :WebGLTextureRoot)\n    {\n        // If we have unflushed quads that render to this texture, flush them now\n        if (texture == _lastRenderTarget) {\n            flush();\n            _lastRenderTarget = null;\n            _currentRenderTarget = null;\n        }\n\n        _gl.deleteFramebuffer(texture.framebuffer);\n    }\n\n    public function prepareDrawTexture (renderTarget :WebGLTextureRoot,\n        blendMode :BlendMode, scissor :Rectangle, texture :WebGLTexture) :Int\n    {\n        if (texture != _lastTexture) {\n            flush();\n            _lastTexture = texture;\n        }\n        return prepareQuad(5, renderTarget, blendMode, scissor, _drawTextureShader);\n    }\n\n    public function prepareDrawPattern (renderTarget :WebGLTextureRoot,\n        blendMode :BlendMode, scissor :Rectangle, texture :WebGLTexture) :Int\n    {\n        if (texture != _lastTexture) {\n            flush();\n            _lastTexture = texture;\n        }\n        return prepareQuad(5, renderTarget, blendMode, scissor, _drawPatternShader);\n    }\n\n    public function prepareFillRect (renderTarget :WebGLTextureRoot,\n        blendMode :BlendMode, scissor :Rectangle) :Int\n    {\n        return prepareQuad(6, renderTarget, blendMode, scissor, _fillRectShader);\n    }\n\n    private function prepareQuad (elementsPerVertex :Int, renderTarget :WebGLTextureRoot,\n        blendMode :BlendMode, scissor :Rectangle, shader :ShaderGL) :Int\n    {\n        if (renderTarget != _lastRenderTarget) {\n            flush();\n            _lastRenderTarget = renderTarget;\n        }\n        if (blendMode != _lastBlendMode) {\n            flush();\n            _lastBlendMode = blendMode;\n        }\n        if (shader != _lastShader) {\n            flush();\n            _lastShader = shader;\n        }\n\n        // Handle changes to the scissor rectangle\n        if (scissor != null || _lastScissor != null) {\n            if (scissor == null || _lastScissor == null || !_lastScissor.equals(scissor)) {\n                flush();\n                _lastScissor = (scissor != null) ? scissor.clone(_lastScissor) : null;\n                _pendingSetScissor = true;\n            }\n        }\n\n        if (_quads >= _maxQuads) {\n            resize(2*_maxQuads);\n        }\n        ++_quads;\n\n        var offset = _dataOffset;\n        _dataOffset += 4*elementsPerVertex;\n        return offset;\n    }\n\n    private function flush ()\n    {\n        if (_quads < 1) {\n            return;\n        }\n\n        if (_lastRenderTarget != _currentRenderTarget) {\n            bindRenderTarget(_lastRenderTarget);\n        }\n\n        if (_lastBlendMode != _currentBlendMode) {\n            switch (_lastBlendMode) {\n                case Normal: _gl.blendFunc(GL.ONE, GL.ONE_MINUS_SRC_ALPHA);\n                case Add: _gl.blendFunc(GL.ONE, GL.ONE);\n                case Multiply: _gl.blendFunc(GL.DST_COLOR, GL.ONE_MINUS_SRC_ALPHA);\n                case Screen: _gl.blendFunc(GL.ONE, GL.ONE_MINUS_SRC_COLOR);\n                case Mask: _gl.blendFunc(GL.ZERO, GL.SRC_ALPHA);\n                case Copy: _gl.blendFunc(GL.ONE, GL.ZERO); // TODO(bruno): Disable blending entirely?\n            }\n            _currentBlendMode = _lastBlendMode;\n        }\n\n        if (_pendingSetScissor) {\n            if (_lastScissor != null) {\n                _gl.enable(GL.SCISSOR_TEST);\n                _gl.scissor(Std.int(_lastScissor.x), Std.int(_lastScissor.y),\n                    Std.int(_lastScissor.width), Std.int(_lastScissor.height));\n            } else {\n                _gl.disable(GL.SCISSOR_TEST);\n            }\n            _pendingSetScissor = false;\n        }\n\n        if (_lastTexture != _currentTexture) {\n            _gl.bindTexture(GL.TEXTURE_2D, _lastTexture.root.nativeTexture);\n            _currentTexture = _lastTexture;\n        }\n\n        if (_lastShader != _currentShader) {\n            _lastShader.useProgram();\n            _lastShader.prepare();\n            _currentShader = _lastShader;\n        }\n\n        if (_lastShader == _drawPatternShader) {\n            var texture = _lastTexture;\n            var root = texture.root;\n            _drawPatternShader.setRegion(\n                texture.rootX / root.width,\n                texture.rootY / root.height,\n                texture.width / root.width,\n                texture.height / root.height);\n        }\n\n        // _gl.bufferSubData(GL.ARRAY_BUFFER, 0, data.subarray(0, _dataOffset));\n        _gl.bufferData(GL.ARRAY_BUFFER, data.subarray(0, _dataOffset), GL.STREAM_DRAW);\n        _gl.drawElements(GL.TRIANGLES, 6*_quads, GL.UNSIGNED_SHORT, 0);\n\n        _quads = 0;\n        _dataOffset = 0;\n    }\n\n    private function resize (maxQuads :Int)\n    {\n        flush();\n        if (maxQuads > MAX_BATCH_QUADS) {\n            return; // That's big enough, return right after the flush\n        }\n\n        _maxQuads = maxQuads;\n\n        // Set the new vertex buffer size\n        data = new Float32Array(maxQuads*4*MAX_ELEMENTS_PER_VERTEX);\n        _gl.bufferData(GL.ARRAY_BUFFER,\n            data.length*Float32Array.BYTES_PER_ELEMENT, GL.STREAM_DRAW);\n\n        var indices = new Uint16Array(6*maxQuads);\n        for (ii in 0...maxQuads) {\n            indices[ii*6 + 0] = ii*4 + 0;\n            indices[ii*6 + 1] = ii*4 + 1;\n            indices[ii*6 + 2] = ii*4 + 2;\n            indices[ii*6 + 3] = ii*4 + 2;\n            indices[ii*6 + 4] = ii*4 + 3;\n            indices[ii*6 + 5] = ii*4 + 0;\n        }\n        _gl.bufferData(GL.ELEMENT_ARRAY_BUFFER, indices, GL.STATIC_DRAW);\n    }\n\n    private function bindRenderTarget (texture :WebGLTextureRoot)\n    {\n        // Bind the texture framebuffer, or the original backbuffer\n        if (texture != null) {\n            _gl.bindFramebuffer(GL.FRAMEBUFFER, texture.framebuffer);\n            _gl.viewport(0, 0, texture.width, texture.height);\n        } else {\n            _gl.bindFramebuffer(GL.FRAMEBUFFER, null);\n            _gl.viewport(0, 0, _backbufferWidth, _backbufferHeight);\n        }\n        _currentRenderTarget = texture;\n        _lastRenderTarget = texture;\n    }\n\n    private static inline var MAX_ELEMENTS_PER_VERTEX = 6;\n    private static inline var MAX_BATCH_QUADS = 1024;\n\n    private var _gl :RenderingContext;\n\n    // Used to keep track of context changes requiring a flush\n    private var _lastBlendMode :BlendMode = null;\n    private var _lastRenderTarget :WebGLTextureRoot = null;\n    private var _lastShader :ShaderGL = null;\n    private var _lastTexture :WebGLTexture = null;\n    private var _lastScissor :Rectangle = null;\n\n    // Used to avoid redundant GL calls\n    private var _currentBlendMode :BlendMode = null;\n    private var _currentShader :ShaderGL = null;\n    private var _currentTexture :WebGLTexture = null;\n    private var _currentRenderTarget :WebGLTextureRoot = null;\n    private var _pendingSetScissor :Bool = false;\n\n    private var _vertexBuffer :Buffer;\n    private var _quadIndexBuffer :Buffer;\n\n    private var _drawTextureShader :DrawTextureGL;\n    private var _drawPatternShader :DrawPatternGL;\n    private var _fillRectShader :FillRectGL;\n\n    private var _quads :Int = 0;\n    private var _maxQuads :Int = 0;\n    private var _dataOffset :Int = 0;\n\n    private var _backbufferWidth :Int = 0;\n    private var _backbufferHeight :Int = 0;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.html.*;\nimport js.html.webgl.*;\n\nimport flambe.display.BlendMode;\nimport flambe.display.Graphics;\nimport flambe.display.Texture;\nimport flambe.math.FMath;\nimport flambe.math.Matrix;\nimport flambe.math.Rectangle;\nimport flambe.util.Assert;\n\nclass WebGLGraphics\n    implements InternalGraphics\n{\n    public function new (batcher :WebGLBatcher, renderTarget :WebGLTextureRoot)\n    {\n        // Initialize this here to prevent blowing up during static init on browsers without typed\n        // array support\n        if (_scratchQuadArray == null) {\n            _scratchQuadArray = new Float32Array(8);\n        }\n\n        _batcher = batcher;\n        _renderTarget = renderTarget;\n    }\n\n    public function save ()\n    {\n        var current = _stateList;\n        var state = _stateList.next;\n\n        if (state == null) {\n            // Grow the list\n            state = new DrawingState();\n            state.prev = current;\n            current.next = state;\n        }\n\n        current.matrix.clone(state.matrix);\n        state.alpha = current.alpha;\n        state.blendMode = current.blendMode;\n        state.scissor = (current.scissor != null) ? current.scissor.clone(state.scissor) : null;\n        _stateList = state;\n    }\n\n    public function translate (x :Float, y :Float)\n    {\n        var matrix = getTopState().matrix;\n        matrix.m02 += matrix.m00*x + matrix.m01*y;\n        matrix.m12 += matrix.m10*x + matrix.m11*y;\n    }\n\n    public function scale (x :Float, y :Float)\n    {\n        var matrix = getTopState().matrix;\n        matrix.m00 *= x;\n        matrix.m10 *= x;\n        matrix.m01 *= y;\n        matrix.m11 *= y;\n    }\n\n    public function rotate (rotation :Float)\n    {\n        var matrix = getTopState().matrix;\n        rotation = FMath.toRadians(rotation);\n        var sin = Math.sin(rotation);\n        var cos = Math.cos(rotation);\n        var m00 = matrix.m00;\n        var m10 = matrix.m10;\n        var m01 = matrix.m01;\n        var m11 = matrix.m11;\n\n        matrix.m00 = m00*cos + m01*sin;\n        matrix.m10 = m10*cos + m11*sin;\n        matrix.m01 = m01*cos - m00*sin;\n        matrix.m11 = m11*cos - m10*sin;\n    }\n\n    public function transform (m00 :Float, m10 :Float, m01 :Float, m11 :Float, m02 :Float, m12 :Float)\n    {\n        var state = getTopState();\n        _scratchMatrix.set(m00, m10, m01, m11, m02, m12);\n        Matrix.multiply(state.matrix, _scratchMatrix, state.matrix);\n    }\n\n    public function restore ()\n    {\n        Assert.that(_stateList.prev != null, \"Can't restore without a previous save\");\n        _stateList = _stateList.prev;\n    }\n\n    public function drawTexture (texture :Texture, x :Float, y :Float)\n    {\n        drawSubTexture(texture, x, y, 0, 0, texture.width, texture.height);\n    }\n\n    public function drawSubTexture (texture :Texture, destX :Float, destY :Float,\n        sourceX :Float, sourceY :Float, sourceW :Float, sourceH :Float)\n    {\n        var state = getTopState();\n        var texture :WebGLTexture = cast texture;\n        var root = texture.root;\n        root.assertNotDisposed();\n\n        var pos = transformQuad(destX, destY, sourceW, sourceH);\n        var rootWidth = root.width;\n        var rootHeight = root.height;\n        var u1 = (texture.rootX+sourceX) / rootWidth;\n        var v1 = (texture.rootY+sourceY) / rootHeight;\n        var u2 = u1 + sourceW/rootWidth;\n        var v2 = v1 + sourceH/rootHeight;\n        var alpha = state.alpha;\n\n        var offset = _batcher.prepareDrawTexture(_renderTarget, state.blendMode, state.scissor, texture);\n        var data = _batcher.data;\n\n        data[  offset] = pos[0];\n        data[++offset] = pos[1];\n        data[++offset] = u1;\n        data[++offset] = v1;\n        data[++offset] = alpha;\n\n        data[++offset] = pos[2];\n        data[++offset] = pos[3];\n        data[++offset] = u2;\n        data[++offset] = v1;\n        data[++offset] = alpha;\n\n        data[++offset] = pos[4];\n        data[++offset] = pos[5];\n        data[++offset] = u2;\n        data[++offset] = v2;\n        data[++offset] = alpha;\n\n        data[++offset] = pos[6];\n        data[++offset] = pos[7];\n        data[++offset] = u1;\n        data[++offset] = v2;\n        data[++offset] = alpha;\n    }\n\n    public function drawPattern (texture :Texture, x :Float, y :Float, width :Float, height :Float)\n    {\n        var state = getTopState();\n        var texture :WebGLTexture = cast texture;\n        var root = texture.root;\n        root.assertNotDisposed();\n\n        var pos = transformQuad(x, y, width, height);\n        var u2 = width / root.width;\n        var v2 = height / root.height;\n        var alpha = state.alpha;\n\n        var offset = _batcher.prepareDrawPattern(_renderTarget, state.blendMode, state.scissor, texture);\n        var data = _batcher.data;\n\n        data[  offset] = pos[0];\n        data[++offset] = pos[1];\n        data[++offset] = 0;\n        data[++offset] = 0;\n        data[++offset] = alpha;\n\n        data[++offset] = pos[2];\n        data[++offset] = pos[3];\n        data[++offset] = u2;\n        data[++offset] = 0;\n        data[++offset] = alpha;\n\n        data[++offset] = pos[4];\n        data[++offset] = pos[5];\n        data[++offset] = u2;\n        data[++offset] = v2;\n        data[++offset] = alpha;\n\n        data[++offset] = pos[6];\n        data[++offset] = pos[7];\n        data[++offset] = 0;\n        data[++offset] = v2;\n        data[++offset] = alpha;\n    }\n\n    public function fillRect (color :Int, x :Float, y :Float, width :Float, height :Float)\n    {\n        var state = getTopState();\n\n        var pos = transformQuad(x, y, width, height);\n        var r = (color & 0xff0000) / 0xff0000;\n        var g = (color & 0x00ff00) / 0x00ff00;\n        var b = (color & 0x0000ff) / 0x0000ff;\n        var a = state.alpha;\n\n        var offset = _batcher.prepareFillRect(_renderTarget, state.blendMode, state.scissor);\n        var data = _batcher.data;\n\n        data[  offset] = pos[0];\n        data[++offset] = pos[1];\n        data[++offset] = r;\n        data[++offset] = g;\n        data[++offset] = b;\n        data[++offset] = a;\n\n        data[++offset] = pos[2];\n        data[++offset] = pos[3];\n        data[++offset] = r;\n        data[++offset] = g;\n        data[++offset] = b;\n        data[++offset] = a;\n\n        data[++offset] = pos[4];\n        data[++offset] = pos[5];\n        data[++offset] = r;\n        data[++offset] = g;\n        data[++offset] = b;\n        data[++offset] = a;\n\n        data[++offset] = pos[6];\n        data[++offset] = pos[7];\n        data[++offset] = r;\n        data[++offset] = g;\n        data[++offset] = b;\n        data[++offset] = a;\n    }\n\n    public function multiplyAlpha (factor :Float)\n    {\n        getTopState().alpha *= factor;\n    }\n\n    public function setAlpha (alpha :Float)\n    {\n        getTopState().alpha = alpha;\n    }\n\n    public function setBlendMode (blendMode :BlendMode)\n    {\n        getTopState().blendMode = blendMode;\n    }\n\n    public function applyScissor (x :Float, y :Float, width :Float, height :Float)\n    {\n        var state = getTopState();\n        var rect = _scratchQuadArray;\n        rect[0] = x;\n        rect[1] = y;\n        rect[2] = x + width;\n        rect[3] = y + height;\n\n        state.matrix.transformArray(cast rect, 4, cast rect);\n        _inverseProjection.transformArray(cast rect, 4, cast rect);\n\n        x = rect[0];\n        y = rect[1];\n        width = rect[2] - x;\n        height = rect[3] - y;\n\n        // Handle negative rectangles\n        if (width < 0) {\n            x += width;\n            width = -width;\n        }\n        if (height < 0) {\n            y += height;\n            height = -height;\n        }\n\n        state.applyScissor(x, y, width, height);\n    }\n\n    public function willRender ()\n    {\n        _batcher.willRender();\n    }\n\n    public function didRender ()\n    {\n        _batcher.didRender();\n    }\n\n    public function onResize (width :Int, height :Int)\n    {\n        _stateList = new DrawingState();\n\n        // Framebuffers need to be vertically flipped\n        var flip = (_renderTarget != null) ? -1 : 1;\n        _stateList.matrix.set(2/width, 0, 0, flip * -2/height, -1, flip);\n\n        // May be used to transform back into screen coordinates\n        _inverseProjection = new Matrix();\n        _inverseProjection.set(2/width, 0, 0, 2/height, -1, -1);\n        _inverseProjection.invert();\n    }\n\n    inline private function getTopState () :DrawingState\n    {\n        return _stateList;\n    }\n\n    private function transformQuad (x :Float, y :Float, width :Float, height :Float) :Float32Array\n    {\n        var x2 = x + width;\n        var y2 = y + height;\n        var pos = _scratchQuadArray;\n\n        pos[0] = x;\n        pos[1] = y;\n\n        pos[2] = x2;\n        pos[3] = y;\n\n        pos[4] = x2;\n        pos[5] = y2;\n\n        pos[6] = x;\n        pos[7] = y2;\n\n        getTopState().matrix.transformArray(cast pos, 8, cast pos);\n        return pos;\n    }\n\n    private static var _scratchMatrix = new Matrix();\n    private static var _scratchQuadArray :Float32Array = null;\n\n    private var _batcher :WebGLBatcher;\n    private var _renderTarget :WebGLTextureRoot;\n\n    private var _inverseProjection :Matrix = null;\n    private var _stateList :DrawingState = null;\n}\n\nprivate class DrawingState\n{\n    public var matrix :Matrix;\n    public var alpha :Float;\n    public var blendMode :BlendMode;\n    public var scissor :Rectangle = null;\n\n    public var prev :DrawingState = null;\n    public var next :DrawingState = null;\n\n    public function new ()\n    {\n        matrix = new Matrix();\n        alpha = 1;\n        blendMode = Normal;\n    }\n\n    public function applyScissor (x :Float, y :Float, width :Float, height :Float)\n    {\n        if (scissor != null) {\n            // Intersection with the previous scissor rectangle\n            var x1 = FMath.max(scissor.x, x);\n            var y1 = FMath.max(scissor.y, y);\n            var x2 = FMath.min(scissor.x + scissor.width, x + width);\n            var y2 = FMath.min(scissor.y + scissor.height, y + height);\n            x = x1;\n            y = y1;\n            width = x2 - x1;\n            height = y2 - y1;\n        } else {\n            scissor = new Rectangle();\n        }\n        scissor.set(Math.round(x), Math.round(y), Math.round(width), Math.round(height));\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.html.webgl.*;\n\nimport haxe.io.Bytes;\n\nimport flambe.asset.AssetEntry;\nimport flambe.subsystem.RendererSystem;\nimport flambe.util.Assert;\nimport flambe.util.Value;\n\nclass WebGLRenderer\n    implements InternalRenderer<Dynamic>\n{\n    public var type (get, null) :RendererType;\n    public var maxTextureSize (get, null) :Int;\n    public var hasGPU (get, null) :Value<Bool>;\n\n    public var graphics :InternalGraphics;\n\n    public var gl (default, null) :RenderingContext;\n    public var batcher (default, null) :WebGLBatcher;\n\n    public function new (stage :HtmlStage, gl :RenderingContext)\n    {\n        _hasGPU = new Value<Bool>(true);\n        this.gl = gl;\n\n        // Handle GL context loss\n        gl.canvas.addEventListener(\"webglcontextlost\", function (event) {\n            event.preventDefault();\n            Log.warn(\"WebGL context lost\");\n            _hasGPU._ = false;\n        }, false);\n        gl.canvas.addEventListener(\"webglcontextrestore\", function (event) {\n            Log.warn(\"WebGL context restored\");\n            init();\n            _hasGPU._ = true;\n        }, false);\n\n        stage.resize.connect(onResize);\n        init();\n    }\n\n    inline private function get_type () :RendererType\n    {\n        return WebGL;\n    }\n\n    private function get_maxTextureSize () :Int\n    {\n        return gl.getParameter(GL.MAX_TEXTURE_SIZE);\n    }\n\n    inline private function get_hasGPU () :Value<Bool>\n    {\n        return _hasGPU;\n    }\n\n    public function createTextureFromImage (image :Dynamic) :WebGLTexture\n    {\n        if (gl.isContextLost()) {\n            return null;\n        }\n        var root = new WebGLTextureRoot(this, image.width, image.height);\n        root.uploadImageData(image);\n        return root.createTexture(image.width, image.height);\n    }\n\n    public function createTexture (width :Int, height :Int) :WebGLTexture\n    {\n        if (gl.isContextLost()) {\n            return null;\n        }\n        var root = new WebGLTextureRoot(this, width, height);\n        root.clear();\n        return root.createTexture(width, height);\n    }\n\n    public function getCompressedTextureFormats () :Array<AssetFormat>\n    {\n        // TODO(bruno): Detect supported texture extensions\n        return [];\n    }\n\n    public function createCompressedTexture (format :AssetFormat, data :Bytes) :WebGLTexture\n    {\n        if (gl.isContextLost()) {\n            return null;\n        }\n        Assert.fail(); // Unsupported\n        return null;\n    }\n\n    public function willRender ()\n    {\n        graphics.willRender();\n    }\n\n    public function didRender ()\n    {\n        graphics.didRender();\n    }\n\n    private function onResize ()\n    {\n        var width = gl.canvas.width, height = gl.canvas.height;\n        batcher.resizeBackbuffer(width, height);\n        graphics.onResize(width, height);\n    }\n\n    private function init ()\n    {\n        batcher = new WebGLBatcher(gl);\n        graphics = new WebGLGraphics(batcher, null);\n        onResize();\n    }\n\n    private var _hasGPU :Value<Bool>;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nclass WebGLTexture extends BasicTexture<WebGLTextureRoot>\n{\n    public function new (root :WebGLTextureRoot, width :Int, height :Int)\n    {\n        super(root, width, height);\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.html;\n\nimport js.html.CanvasElement;\nimport js.html.Uint8Array;\nimport js.html.webgl.*;\n\nimport haxe.io.Bytes;\n\nimport flambe.math.FMath;\nimport flambe.platform.MathUtil;\n\nclass WebGLTextureRoot extends BasicAsset<WebGLTextureRoot>\n    implements TextureRoot\n{\n    // The power of two dimensions of the texture\n    public var width (default, null) :Int;\n    public var height (default, null) :Int;\n\n    public var nativeTexture (default, null) :js.html.webgl.Texture;\n    public var framebuffer :Framebuffer = null;\n\n    public function new (renderer :WebGLRenderer, width :Int, height :Int)\n    {\n        super();\n        _renderer = renderer;\n        // 1 px textures cause weird DrawPattern sampling on some drivers\n        this.width = FMath.max(2, MathUtil.nextPowerOfTwo(width));\n        this.height = FMath.max(2, MathUtil.nextPowerOfTwo(height));\n\n        var gl = renderer.gl;\n        nativeTexture = gl.createTexture();\n        renderer.batcher.bindTexture(nativeTexture);\n        gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_WRAP_S, GL.CLAMP_TO_EDGE);\n        gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_WRAP_T, GL.CLAMP_TO_EDGE);\n        gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_MAG_FILTER, GL.LINEAR);\n    #if flambe_webgl_enable_mipmapping\n        gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_MIN_FILTER, GL.LINEAR_MIPMAP_NEAREST);\n    #elseif flambe_webgl_enable_linear\n        gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_MIN_FILTER, GL.LINEAR);\n    #else\n        gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_MIN_FILTER, GL.NEAREST);\n    #end\n    }\n\n    public function createTexture (width :Int, height :Int) :WebGLTexture\n    {\n        return new WebGLTexture(this, width, height);\n    }\n\n    public function uploadImageData (image :Dynamic)\n    {\n        assertNotDisposed();\n\n        if (width != image.width || height != image.height) {\n            // Resize up to the next power of two, padding with transparent black\n            var resized = HtmlUtil.createEmptyCanvas(width, height);\n            resized.getContext2d().drawImage(image, 0, 0);\n            drawBorder(resized, image.width, image.height);\n            image = resized;\n        }\n\n        _renderer.batcher.bindTexture(nativeTexture);\n        var gl = _renderer.gl;\n        gl.texImage2D(GL.TEXTURE_2D, 0, GL.RGBA, GL.RGBA, GL.UNSIGNED_BYTE, image);\n    #if flambe_webgl_enable_mipmapping\n        gl.generateMipmap(GL.TEXTURE_2D);\n    #end\n    }\n\n    public function clear ()\n    {\n        assertNotDisposed();\n\n        _renderer.batcher.bindTexture(nativeTexture);\n        var gl = _renderer.gl;\n        gl.texImage2D(GL.TEXTURE_2D, 0, GL.RGBA, width, height, 0, GL.RGBA, GL.UNSIGNED_BYTE, null);\n    #if flambe_webgl_enable_mipmapping\n        gl.generateMipmap(GL.TEXTURE_2D);\n    #end\n    }\n\n    public function readPixels (x :Int, y :Int, width :Int, height :Int) :Bytes\n    {\n        assertNotDisposed();\n\n        getGraphics(); // Ensure we have a framebuffer\n        _renderer.batcher.bindFramebuffer(this);\n\n        var pixels = new Uint8Array(4*width*height);\n        var gl = _renderer.gl;\n        gl.readPixels(x, y, width, height, GL.RGBA, GL.UNSIGNED_BYTE, pixels);\n\n        // Undo alpha premultiplication. This is lossy!\n        var ii = 0, ll = pixels.length;\n        while (ii < ll) {\n            var invAlpha = 255 / pixels[ii+3];\n            pixels[ii] = cast pixels[ii] * invAlpha;\n            ++ii;\n            pixels[ii] = cast pixels[ii] * invAlpha;\n            ++ii;\n            pixels[ii] = cast pixels[ii] * invAlpha;\n            ii += 2; // Advance to next pixel\n        }\n\n        return Bytes.ofData(cast pixels);\n    }\n\n    public function writePixels (pixels :Bytes, x :Int, y :Int, sourceW :Int, sourceH :Int)\n    {\n        assertNotDisposed();\n\n        _renderer.batcher.bindTexture(nativeTexture);\n\n        // Can't update a texture used by a bound framebuffer apparently\n        _renderer.batcher.bindFramebuffer(null);\n\n        var gl = _renderer.gl;\n        // TODO(bruno): Avoid the redundant Uint8Array copy\n        gl.texSubImage2D(GL.TEXTURE_2D, 0, x, y, sourceW, sourceH,\n            GL.RGBA, GL.UNSIGNED_BYTE, new Uint8Array(pixels.getData()));\n    }\n\n    public function getGraphics () :WebGLGraphics\n    {\n        assertNotDisposed();\n\n        if (_graphics == null) {\n            _graphics = new WebGLGraphics(_renderer.batcher, this);\n            _graphics.onResize(width, height);\n\n            var gl = _renderer.gl;\n            framebuffer = gl.createFramebuffer();\n            _renderer.batcher.bindFramebuffer(this);\n            gl.framebufferTexture2D(GL.FRAMEBUFFER, GL.COLOR_ATTACHMENT0,\n                GL.TEXTURE_2D, nativeTexture, 0);\n        }\n        return _graphics;\n    }\n\n    override private function copyFrom (that :WebGLTextureRoot)\n    {\n        this.nativeTexture = that.nativeTexture;\n        this.framebuffer = that.framebuffer;\n        this.width = that.width;\n        this.height = that.height;\n        this._graphics = that._graphics;\n    }\n\n    override private function onDisposed ()\n    {\n        var batcher = _renderer.batcher;\n        batcher.deleteTexture(this);\n        if (framebuffer != null) {\n            batcher.deleteFramebuffer(this);\n        }\n\n        nativeTexture = null;\n        framebuffer = null;\n        _graphics = null;\n    }\n\n    /**\n     * Extends the right and bottom edge pixels of a bitmap. This is to prevent artifacts caused by\n     * sampling the outer transparency when the edge pixels are sampled.\n     */\n    private static function drawBorder (canvas :CanvasElement, width :Int, height :Int)\n    {\n        var ctx = canvas.getContext2d();\n\n        // Right edge\n        ctx.drawImage(canvas, width-1, 0, 1, height, width, 0, 1, height);\n\n        // Bottom edge\n        ctx.drawImage(canvas, 0, height-1, width, 1, 0, height, width, 1);\n\n        // Is a one pixel border enough?\n    }\n\n    private var _renderer :WebGLRenderer;\n    private var _graphics :WebGLGraphics = null;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.shader;\n\nimport js.html.*;\nimport js.html.webgl.*;\nimport js.html.webgl.RenderingContext;\n\nimport flambe.util.Assert;\n\n/**\n * Since there's no HxSL GLSL compiler (yet?), all GL shaders extend this.\n */\nclass ShaderGL\n{\n    public function new (gl :RenderingContext, vertSource :String, fragSource :String)\n    {\n        // Prepend the required precision rigamarole\n        fragSource = [\n            \"#ifdef GL_ES\",\n                \"precision mediump float;\",\n            \"#endif\",\n        ].join(\"\\n\") + \"\\n\" + fragSource;\n\n        _gl = gl;\n        _program = gl.createProgram();\n        gl.attachShader(_program, createShader(gl, GL.VERTEX_SHADER, vertSource));\n        gl.attachShader(_program, createShader(gl, GL.FRAGMENT_SHADER, fragSource));\n        gl.linkProgram(_program);\n        gl.useProgram(_program);\n\n#if debug\n        if (!gl.getProgramParameter(_program, GL.LINK_STATUS)) {\n            Log.error(\"Error linking shader program\", [\"log\", gl.getProgramInfoLog(_program)]);\n        }\n#end\n    }\n\n    public function useProgram ()\n    {\n        _gl.useProgram(_program);\n    }\n\n    public function prepare ()\n    {\n        Assert.fail(\"abstract\");\n    }\n\n    private function getAttribLocation (name :String) :Int\n    {\n        var loc = _gl.getAttribLocation(_program, name);\n        Assert.that(loc >= 0, \"Missing attribute\", [\"name\", name]);\n        return loc;\n    }\n\n    private function getUniformLocation (name :String) :UniformLocation\n    {\n        var loc = _gl.getUniformLocation(_program, name);\n        Assert.that(loc != null, \"Missing uniform\", [\"name\", name]);\n        return loc;\n    }\n\n    private static function createShader (gl :RenderingContext, type :Int, source :String) :Shader\n    {\n        var shader = gl.createShader(type);\n        gl.shaderSource(shader, source);\n        gl.compileShader(shader);\n\n#if debug\n        if (!gl.getShaderParameter(shader, GL.COMPILE_STATUS)) {\n            var typeName = (type == GL.VERTEX_SHADER) ? \"vertex\" : \"fragment\";\n            Log.error(\"Error compiling \" + typeName + \" shader\", [\n                \"log\", gl.getShaderInfoLog(shader)]);\n        }\n#end\n        return shader;\n    }\n\n    private var _gl :RenderingContext;\n    private var _program :Program;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.shader;\n\nimport js.html.*;\nimport js.html.webgl.*;\nimport js.html.webgl.RenderingContext;\n\nimport flambe.platform.html.WebGLTexture;\n\nclass DrawPatternGL extends ShaderGL\n{\n    public function new (gl :RenderingContext)\n    {\n        super(gl,\n        [ // Vertex shader\n            \"attribute highp vec2 a_pos;\",\n            \"attribute mediump vec2 a_uv;\",\n            \"attribute lowp float a_alpha;\",\n\n            \"varying mediump vec2 v_uv;\",\n            \"varying lowp float v_alpha;\",\n\n            \"void main (void) {\",\n                \"v_uv = a_uv;\",\n                \"v_alpha = a_alpha;\",\n                \"gl_Position = vec4(a_pos, 0, 1);\",\n            \"}\",\n        ].join(\"\\n\"),\n\n        [ // Fragment shader\n            \"varying mediump vec2 v_uv;\",\n            \"varying lowp float v_alpha;\",\n\n            \"uniform lowp sampler2D u_texture;\",\n            \"uniform mediump vec4 u_region;\",\n\n            \"void main (void) {\",\n                \"gl_FragColor = texture2D(u_texture, u_region.xy + mod(v_uv, u_region.zw)) * v_alpha;\",\n            \"}\",\n        ].join(\"\\n\"));\n\n        a_pos = getAttribLocation(\"a_pos\");\n        a_uv = getAttribLocation(\"a_uv\");\n        a_alpha = getAttribLocation(\"a_alpha\");\n\n        u_texture = getUniformLocation(\"u_texture\");\n        u_region = getUniformLocation(\"u_region\");\n        setTexture(0);\n    }\n\n    public function setTexture (unit :Int)\n    {\n        _gl.uniform1i(u_texture, unit);\n    }\n\n    public function setRegion (x :Float, y :Float, width :Float, height :Float)\n    {\n        _gl.uniform4f(u_region, x, y, width, height);\n    }\n\n    override public function prepare ()\n    {\n        _gl.enableVertexAttribArray(a_pos);\n        _gl.enableVertexAttribArray(a_uv);\n        _gl.enableVertexAttribArray(a_alpha);\n\n        var bytesPerFloat = Float32Array.BYTES_PER_ELEMENT;\n        var stride = 5*bytesPerFloat;\n        _gl.vertexAttribPointer(a_pos, 2, GL.FLOAT, false, stride, 0*bytesPerFloat);\n        _gl.vertexAttribPointer(a_uv, 2, GL.FLOAT, false, stride, 2*bytesPerFloat);\n        _gl.vertexAttribPointer(a_alpha, 1, GL.FLOAT, false, stride, 4*bytesPerFloat);\n    }\n\n    private var a_pos :Int;\n    private var a_uv :Int;\n    private var a_alpha :Int;\n\n    private var u_texture :UniformLocation;\n    private var u_region :UniformLocation;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.shader;\n\nimport js.html.*;\nimport js.html.webgl.*;\nimport js.html.webgl.RenderingContext;\n\nimport flambe.platform.html.WebGLTexture;\n\nclass DrawTextureGL extends ShaderGL\n{\n    public function new (gl :RenderingContext)\n    {\n        super(gl,\n        [ // Vertex shader\n            \"attribute highp vec2 a_pos;\",\n            \"attribute mediump vec2 a_uv;\",\n            \"attribute lowp float a_alpha;\",\n\n            \"varying mediump vec2 v_uv;\",\n            \"varying lowp float v_alpha;\",\n\n            \"void main (void) {\",\n                \"v_uv = a_uv;\",\n                \"v_alpha = a_alpha;\",\n                \"gl_Position = vec4(a_pos, 0, 1);\",\n            \"}\",\n        ].join(\"\\n\"),\n\n        [ // Fragment shader\n            \"varying mediump vec2 v_uv;\",\n            \"varying lowp float v_alpha;\",\n\n            \"uniform lowp sampler2D u_texture;\",\n\n            \"void main (void) {\",\n                \"gl_FragColor = texture2D(u_texture, v_uv) * v_alpha;\",\n            \"}\",\n        ].join(\"\\n\"));\n\n        a_pos = getAttribLocation(\"a_pos\");\n        a_uv = getAttribLocation(\"a_uv\");\n        a_alpha = getAttribLocation(\"a_alpha\");\n\n        u_texture = getUniformLocation(\"u_texture\");\n        setTexture(0);\n    }\n\n    public function setTexture (unit :Int)\n    {\n        _gl.uniform1i(u_texture, unit);\n    }\n\n    override public function prepare ()\n    {\n        _gl.enableVertexAttribArray(a_pos);\n        _gl.enableVertexAttribArray(a_uv);\n        _gl.enableVertexAttribArray(a_alpha);\n\n        var bytesPerFloat = Float32Array.BYTES_PER_ELEMENT;\n        var stride = 5*bytesPerFloat;\n        _gl.vertexAttribPointer(a_pos, 2, GL.FLOAT, false, stride, 0*bytesPerFloat);\n        _gl.vertexAttribPointer(a_uv, 2, GL.FLOAT, false, stride, 2*bytesPerFloat);\n        _gl.vertexAttribPointer(a_alpha, 1, GL.FLOAT, false, stride, 4*bytesPerFloat);\n    }\n\n    private var a_pos :Int;\n    private var a_uv :Int;\n    private var a_alpha :Int;\n\n    private var u_texture :UniformLocation;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform.shader;\n\nimport js.html.*;\nimport js.html.webgl.*;\nimport js.html.webgl.RenderingContext;\n\nclass FillRectGL extends ShaderGL\n{\n    public function new (gl :RenderingContext)\n    {\n        super(gl,\n        [ // Vertex shader\n            \"attribute highp vec2 a_pos;\",\n            \"attribute lowp vec3 a_rgb;\",\n            \"attribute lowp float a_alpha;\",\n\n            \"varying lowp vec4 v_color;\",\n\n            \"void main (void) {\",\n                \"v_color = vec4(a_rgb*a_alpha, a_alpha);\",\n                \"gl_Position = vec4(a_pos, 0, 1);\",\n            \"}\",\n        ].join(\"\\n\"),\n\n        [ // Fragment shader\n            \"varying lowp vec4 v_color;\",\n\n            \"void main (void) {\",\n                \"gl_FragColor = v_color;\",\n            \"}\",\n        ].join(\"\\n\"));\n\n        a_pos = getAttribLocation(\"a_pos\");\n        a_rgb = getAttribLocation(\"a_rgb\");\n        a_alpha = getAttribLocation(\"a_alpha\");\n    }\n\n    override public function prepare ()\n    {\n        _gl.enableVertexAttribArray(a_pos);\n        _gl.enableVertexAttribArray(a_rgb);\n        _gl.enableVertexAttribArray(a_alpha);\n\n        var bytesPerFloat = Float32Array.BYTES_PER_ELEMENT;\n        var stride = 6*bytesPerFloat;\n        _gl.vertexAttribPointer(a_pos, 2, GL.FLOAT, false, stride, 0*bytesPerFloat);\n        _gl.vertexAttribPointer(a_rgb, 3, GL.FLOAT, false, stride, 2*bytesPerFloat);\n        _gl.vertexAttribPointer(a_alpha, 1, GL.FLOAT, false, stride, 5*bytesPerFloat);\n    }\n\n    private var a_pos :Int;\n    private var a_rgb :Int;\n    private var a_alpha :Int;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.scene;\n\nimport flambe.Component;\n\n/**\n * Manages a stack of scenes. Only the front-most scene receives game updates.\n */\n// TODO(bruno): Major robustness cleanup and testing needed here\nclass Director extends Component\n{\n    /** The front-most scene. */\n    public var topScene (get, null) :Entity;\n\n    /** The complete list of scenes managed by this director, from back to front. */\n    public var scenes (default, null) :Array<Entity>;\n\n    /**\n     * The scenes that are partially occluded by a transparent or transitioning scene, from back to\n     * front. These scenes are not updated, but they're still drawn.\n     */\n    public var occludedScenes (default, null) :Array<Entity>;\n\n    /** Whether the director is currently transitioning between scenes. */\n    public var transitioning (get, null) :Bool;\n\n    /** The ideal width of the director's scenes. Used by some transitions. */\n    public var width (get, null) :Float;\n\n    /** The ideal height of the director's scenes. Used by some transitions. */\n    public var height (get, null) :Float;\n\n    public function new ()\n    {\n        scenes = [];\n        occludedScenes = [];\n        _root = new Entity();\n    }\n\n    /**\n     * Sets the ideal size of the scenes in this director. By default, the size is the full stage\n     * width and height. This size is used by some transitions, such as SlideTransition.\n     */\n    public function setSize (width :Float, height :Float) :Director\n    {\n        _width = width;\n        _height = height;\n        return this;\n    }\n\n    public function pushScene (scene :Entity, ?transition :Transition)\n    {\n        completeTransition();\n\n        var oldTop = get_topScene();\n        if (oldTop != null) {\n            playTransition(oldTop, scene, transition, function () {\n                hide(oldTop);\n            });\n        } else {\n            add(scene);\n            invalidateVisibility();\n        }\n    }\n\n    public function popScene (?transition :Transition)\n    {\n        completeTransition();\n\n        var oldTop = get_topScene();\n        if (oldTop != null) {\n            scenes.pop(); // Pop oldTop\n            var newTop = get_topScene();\n            if (newTop != null) {\n                playTransition(oldTop, newTop, transition, function () {\n                    hideAndDispose(oldTop);\n                });\n            } else {\n                hideAndDispose(oldTop);\n                invalidateVisibility();\n            }\n        }\n    }\n\n    /**\n     * Pops the scene stack until the given entity is the top scene, or adds the scene if the stack\n     * becomes empty while popping.\n     */\n    public function unwindToScene (scene :Entity, ?transition :Transition)\n    {\n        completeTransition();\n\n        var oldTop = get_topScene();\n        if (oldTop != null) {\n            if (oldTop == scene) {\n                return; // We're already there\n            }\n\n            scenes.pop(); // Pop oldTop\n            while (scenes.length > 0 && scenes[scenes.length-1] != scene) {\n                scenes.pop().dispose(); // Don't emit a hide, just dispose them\n            }\n\n            playTransition(oldTop, scene, transition, function () {\n                hideAndDispose(oldTop);\n            });\n\n        } else {\n            pushScene(scene, transition);\n        }\n    }\n\n    override public function onAdded ()\n    {\n        owner.addChild(_root);\n    }\n\n    override public function onRemoved ()\n    {\n        completeTransition();\n\n        for (scene in scenes) {\n            scene.dispose();\n        }\n        scenes = [];\n        occludedScenes = [];\n\n        _root.dispose();\n    }\n\n    override public function onUpdate (dt :Float)\n    {\n        if (_transitor != null && _transitor.update(dt)) {\n            completeTransition();\n        }\n    }\n\n    private function get_topScene () :Entity\n    {\n        var ll = scenes.length;\n        return (ll > 0) ? scenes[ll-1] : null;\n    }\n\n    inline private function get_transitioning () :Bool\n    {\n        return _transitor != null;\n    }\n\n    private function add (scene :Entity)\n    {\n        var oldTop = get_topScene();\n        if (oldTop != null) {\n            _root.removeChild(oldTop);\n        }\n\n        scenes.remove(scene);\n        scenes.push(scene);\n        _root.addChild(scene);\n    }\n\n    private function hide (scene :Entity)\n    {\n        var events = scene.get(Scene);\n        if (events != null) {\n            events.hidden.emit();\n        }\n    }\n\n    private function hideAndDispose (scene :Entity)\n    {\n        hide(scene);\n        scene.dispose();\n    }\n\n    private function show (scene :Entity)\n    {\n        var events = scene.get(Scene);\n        if (events != null) {\n            events.shown.emit();\n        }\n    }\n\n    private function invalidateVisibility ()\n    {\n        // Find the last index of an opaque scene, or 0\n        var ii = scenes.length;\n        while (ii > 0) {\n            var scene = scenes[--ii];\n            var comp = scene.get(Scene);\n            if (comp == null || comp.opaque) {\n                break;\n            }\n        }\n\n        // All visible scenes up to, but not including, the top scene\n        occludedScenes = (scenes.length > 0) ? scenes.slice(ii, scenes.length-1) : [];\n\n        // Notify the new top scene that it's being shown\n        var scene = get_topScene();\n        if (scene != null) {\n            show(scene);\n        }\n    }\n\n    // Notes:\n    // - Any method that modifies the scene stack should immediately call completeTransition.\n    private function completeTransition ()\n    {\n        if (_transitor != null) {\n            _transitor.complete();\n            _transitor = null;\n\n            invalidateVisibility();\n        }\n    }\n\n    private function playTransition (from :Entity, to :Entity,\n        transition :Transition, onComplete :Void->Void)\n    {\n        completeTransition();\n        add(to);\n\n        if (transition != null) {\n            occludedScenes.push(from);\n\n            _transitor = new Transitor(from, to, transition, onComplete);\n            _transitor.init(this);\n        } else {\n            onComplete();\n            invalidateVisibility();\n        }\n    }\n\n    private function get_width () :Float\n    {\n        return (_width < 0) ? System.stage.width : _width;\n    }\n\n    private function get_height () :Float\n    {\n        return (_height < 0) ? System.stage.height : _height;\n    }\n\n    /** The container for the current scene. */\n    private var _root :Entity;\n\n    private var _transitor :Transitor = null;\n    private var _width :Float = -1;\n    private var _height :Float = -1;\n}\n\nprivate class Transitor\n{\n    public function new (from :Entity, to :Entity, transition :Transition, onComplete :Void->Void)\n    {\n        _from = from;\n        _to = to;\n        _transition = transition;\n        _onComplete = onComplete;\n    }\n\n    public function init (director :Director)\n    {\n        _transition.init(director, _from, _to);\n    }\n\n    public function update (dt :Float) :Bool\n    {\n        return _transition.update(dt);\n    }\n\n    public function complete ()\n    {\n        _transition.complete();\n        _onComplete();\n    }\n\n    private var _from :Entity;\n    private var _to :Entity;\n    private var _transition :Transition;\n\n    private var _onComplete :Void->Void;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.scene;\n\n/**\n * A transition between two scenes.\n */\nclass Transition\n{\n    /**\n     * Called by the Director to start the transition.\n     * @param director The director that requested the transition.\n     * @param from The old scene being transitioned from.\n     * @param to The new scene being transitioned to.\n     */\n    public function init (director :Director, from :Entity, to :Entity)\n    {\n        _director = director;\n        _from = from;\n        _to = to;\n    }\n\n    /**\n     * Called by the Director to update the transition.\n     * @returns True if the transition is complete.\n     */\n    public function update (dt :Float) :Bool\n    {\n        // See subclasses\n        return true;\n    }\n\n    /**\n     * Completes the transition. Note that the Director may call this at any time to fast-forward\n     * the transition.\n     */\n    public function complete ()\n    {\n        // See subclasses\n    }\n\n    private var _director :Director;\n    private var _from :Entity;\n    private var _to :Entity;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\nusing flambe.util.Strings;\n\n/**\n * Simple runtime assertions. A failed assertion throws an error, which should NOT be caught and\n * handled. Assertions are stripped from release builds, unless the -D flambe_keep_asserts compiler\n * flag is used.\n */\nclass Assert\n{\n#if (debug || flambe_keep_asserts)\n    /**\n     * Asserts that a condition is true.\n     * @param message If this assertion fails, the message to include in the thrown error.\n     * @param fields Optional fields to be formatted with the message, see Strings.withFields.\n     */\n    public static function that (condition :Bool, ?message :String, ?fields :Array<Dynamic>)\n    {\n        if (!condition) {\n            fail(message, fields);\n        }\n    }\n\n    /**\n     * Immediately fails an assertion. Same as Assert.that(false).\n     * @param message The message to include in the thrown error.\n     * @param fields Optional fields to be formatted with the message, see Strings.withFields.\n     */\n    public static function fail (?message :String, ?fields :Array<Dynamic>)\n    {\n        var error = \"Assertion failed!\";\n        if (message != null) {\n            error += \" \" + message;\n        }\n        if (fields != null) {\n            error = error.withFields(fields);\n        }\n        throw error;\n    }\n\n#else\n    // In release builds, assertions are stripped out\n    inline public static function that (condition :Bool, ?message :String, ?fields :Array<Dynamic>) {}\n    inline public static function fail (?message :String, ?fields :Array<Dynamic>) {}\n#end\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\n/**\n * Utility mixins for bit sets. Designed to be imported with 'using' to supplement regular Ints with\n * bitset functions.\n */\nclass BitSets\n{\n    /**\n     * Adds all the bits included in the mask, and returns the new bitset.\n     */\n    inline public static function add (bits :Int, mask :Int) :Int\n    {\n        return bits | mask;\n    }\n\n    /**\n     * Removes all the bits included in the mask, and returns the new bitset.\n     */\n    inline public static function remove (bits :Int, mask :Int) :Int\n    {\n        return bits & ~mask;\n    }\n\n    /**\n     * Toggles all the bits included in the mask, and returns the new bitset.\n     */\n    inline public static function toggle (bits :Int, mask :Int) :Int\n    {\n        return bits ^ mask;\n    }\n\n    /**\n     * Returns true if the bitset contains ANY of the bits in the given mask.\n     */\n    inline public static function contains (bits :Int, mask :Int) :Bool\n    {\n        return bits & mask != 0;\n    }\n\n    /**\n     * Returns true if the bitset contains ALL of the bits in the given mask.\n     */\n    inline public static function containsAll (bits :Int, mask :Int) :Bool\n    {\n        return bits & mask == mask;\n    }\n\n    /**\n     * Either adds or removes all the bits included in the mask, and returns the new bitset.\n     */\n    public static function set (bits :Int, mask :Int, enabled :Bool) :Int\n    {\n        return enabled ? add(bits, mask) : remove(bits, mask);\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\n/**\n * Represents a value that isn't ready yet, but may become available in the future.\n */\nclass Promise<A>\n{\n    /**\n     * The end result fulfilled by the promise. When accessing, throws an error if the result is not\n     * yet available. Read hasResult to check availability first, or use get(). When setting, throws\n     * an error if the result was already previously assigned.\n     */\n    public var result (get, set) :A;\n\n    /**\n     * Whether the result is available yet.\n     */\n    public var hasResult (default, null) :Bool;\n\n    /**\n     * Emitted when the promise is fulfilled and the result has become available.\n     */\n    public var success (default, null) :Signal1<A>;\n\n    /**\n     * An error message emitted if there was a problem during loading.\n     */\n    public var error (default, null) :Signal1<String>;\n\n    /**\n     * May be emitted during loading when the progress or total counts have been updated.\n     */\n    public var progressChanged (default, null) :Signal0;\n\n    /**\n     * Context on how close this promise is to being fulfilled. For file IO, these are in bytes.\n     */\n    public var progress (get, set) :Float;\n    public var total (get, set) :Float;\n\n    public function new ()\n    {\n        success = new Signal1();\n        error = new Signal1();\n        progressChanged = new Signal0();\n        hasResult = false;\n        _progress = 0;\n        _total = 0;\n    }\n\n    private function get_result () :A\n    {\n        if (!hasResult) {\n            throw \"Promise result not yet available\";\n        }\n        return _result;\n    }\n\n    private function set_result (result :A) :A\n    {\n        if (hasResult) {\n            throw \"Promise result already assigned\";\n        }\n\n        _result = result;\n        hasResult = true;\n        success.emit(result);\n        return result;\n    }\n\n    /**\n     * Passes the result to the callback now if the result is available, otherwise calls it later.\n     * @returns If the callback was not called yet, a handle that can be disposed to cancel the\n     * request.\n     */\n    public function get (fn :A -> Void) :Disposable\n    {\n        if (hasResult) {\n            fn(_result);\n            return null;\n        }\n        return success.connect(fn).once();\n    }\n\n    inline private function get_progress () :Float\n    {\n        return _progress;\n    }\n\n    private function set_progress (progress :Float) :Float\n    {\n        if (_progress != progress) {\n            _progress = progress;\n            progressChanged.emit();\n        }\n        return progress;\n    }\n\n    private function set_total (total :Float) :Float\n    {\n        if (_total != total) {\n            _total = total;\n            progressChanged.emit();\n        }\n        return total;\n    }\n\n    inline private function get_total () :Float\n    {\n        return _total;\n    }\n\n    private var _result :A;\n    private var _progress :Float;\n    private var _total :Float;\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\n/**\n * An alias for Signal0 listeners.\n */\ntypedef Listener0 = Void -> Void;\n\n/**\n * A zero-argument signal. See Signal1 and Signal2 for different arities.\n */\nclass Signal0 extends SignalBase\n{\n    /**\n     * @param listener An optional listener to immediately connect to the signal.\n     */\n    public function new (?listener :Listener0)\n    {\n        super(listener);\n    }\n\n    /**\n     * Connects a listener to this signal.\n     * @param prioritize True if this listener should fire before others.\n     * @returns A SignalConnection, that can be disposed to remove the listener.\n     */\n    public function connect (listener :Listener0, prioritize :Bool = false) :SignalConnection\n    {\n        return connectImpl(listener, prioritize);\n    }\n\n    /**\n     * Emit the signal, notifying each connected listener.\n     */\n    public function emit ()\n    {\n        if (dispatching()) {\n            defer(function () {\n                emitImpl();\n            });\n        } else {\n            emitImpl();\n        }\n    }\n\n    private function emitImpl ()\n    {\n        var head = willEmit();\n        var p = head;\n        while (p != null) {\n            p._listener();\n            if (!p.stayInList) {\n                p.dispose();\n            }\n            p = p._next;\n        }\n        didEmit(head);\n    }\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.util;\n\nusing StringTools;\n\n/**\n * Utility mixins for Strings. Designed to be imported with 'using'.\n */\nclass Strings\n{\n    /**\n     * Gets the extension of a file name, or null if there is no extension.\n     */\n    public static function getFileExtension (fileName :String) :String\n    {\n        var dot = fileName.lastIndexOf(\".\");\n        return (dot > 0) ? fileName.substr(dot+1) : null;\n    }\n\n    /**\n     * Returns a file name without its extension.\n     */\n    public static function removeFileExtension (fileName :String) :String\n    {\n        var dot = fileName.lastIndexOf(\".\");\n        return (dot > 0) ? fileName.substr(0, dot) : fileName;\n    }\n\n    /**\n     * Gets the extension of a full path or URL, with special handling for '/' and '?' characters.\n     * Returns null if there is no extension.\n     */\n    public static function getUrlExtension (url :String) :String\n    {\n        var question = url.lastIndexOf(\"?\");\n        if (question >= 0) {\n            url = url.substr(0, question);\n        }\n        var slash = url.lastIndexOf(\"/\");\n        if (slash >= 0) {\n            url = url.substr(slash+1);\n        }\n        return getFileExtension(url);\n    }\n\n    /**\n     * Joins two strings with a path separator.\n     */\n    public static function joinPath (base :String, relative :String) :String\n    {\n        if (base.length > 0 && base.fastCodeAt(base.length-1) != \"/\".code) {\n            base += \"/\"; // Ensure base ends with a trailing slash\n        }\n        return base + relative;\n    }\n\n    public static function hashCode (str :String) :Int\n    {\n        var code = 0;\n        if (str != null) {\n            for (ii in 0...str.length) {\n                code = Std.int(31*code + str.fastCodeAt(ii));\n            }\n        }\n        return code;\n    }\n\n    /**\n     * Substitute all \"{n}\" tokens with the corresponding values.\n     *\n     * ```haxe\n     * \"{1} sat on a {0}\".substitute([\"wall\", \"Humpty Dumpty\"]);\n     * // returns \"Humpty Dumpty sat on a wall\"\n     * ```\n     */\n    public static function substitute (str :String, values :Array<Dynamic>) :String\n    {\n        // FIXME(bruno): If your {0} replacement has a {1} in it, then that'll get replaced next\n        // iteration\n        for (ii in 0...values.length) {\n            str = str.replace(\"{\" + ii + \"}\", values[ii]);\n        }\n        return str;\n    }\n\n    /**\n     * Format a message with named parameters into a standard format for logging and errors.\n     *\n     * ```haxe\n     * \"Wobbles were frobulated\".withFields([\"count\", 5, \"silly\", true]);\n     * // returns \"Wobbles were frobulated [count=5, silly=true]\"\n     * ```\n     *\n     * @param fields The field names and values to be formatted. Must have an even length.\n     */\n    public static function withFields (message :String, fields :Array<Dynamic>) :String\n    {\n        var ll = fields.length;\n        if (ll > 0) {\n            message += (message.length > 0) ? \" [\" : \"[\";\n            var ii = 0;\n            while (ii < ll) {\n                if (ii > 0) {\n                    message += \", \";\n                }\n                var name = fields[ii];\n                var value :Dynamic = fields[ii + 1];\n\n                // Replace throwables with their stack trace\n#if flash\n                if (Std.is(value, flash.errors.Error)) {\n                    var stack :String = cast(value, flash.errors.Error).getStackTrace();\n                    if (stack != null) {\n                        value = stack;\n                    }\n                }\n#elseif js\n                if (Std.is(value, untyped __js__(\"Error\"))) {\n                    var stack :String = value.stack;\n                    if (stack != null) {\n                        value = stack;\n                    }\n                }\n#end\n                message += name + \"=\" + value;\n                ii += 2;\n            }\n            message += \"]\";\n        }\n\n        return message;\n    }\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tElements return by `CallStack` methods.\n**/\nenum StackItem {\n\tCFunction;\n\tModule( m : String );\n\tFilePos( s : Null<StackItem>, file : String, line : Int );\n\tMethod( classname : String, method : String );\n\tLocalFunction( ?v : Int );\n}\n\n/**\n\tGet informations about the call stack.\n**/\nclass CallStack {\n\t#if js\n\tstatic var lastException:js.Error;\n\n\tstatic function getStack(e:js.Error):Array<StackItem> {\n\t\tif (e == null) return [];\n\t\t// https://code.google.com/p/v8/wiki/JavaScriptStackTraceApi\n\t\tvar oldValue = (untyped Error).prepareStackTrace;\n\t\t(untyped Error).prepareStackTrace = function (error, callsites :Array<Dynamic>) {\n\t\t\tvar stack = [];\n\t\t\tfor (site in callsites) {\n\t\t\t\tif (wrapCallSite != null) site = wrapCallSite(site);\n\t\t\t\tvar method = null;\n\t\t\t\tvar fullName :String = site.getFunctionName();\n\t\t\t\tif (fullName != null) {\n\t\t\t\t\tvar idx = fullName.lastIndexOf(\".\");\n\t\t\t\t\tif (idx >= 0) {\n\t\t\t\t\t\tvar className = fullName.substr(0, idx);\n\t\t\t\t\t\tvar methodName = fullName.substr(idx+1);\n\t\t\t\t\t\tmethod = Method(className, methodName);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstack.push(FilePos(method, site.getFileName(), site.getLineNumber()));\n\t\t\t}\n\t\t\treturn stack;\n\t\t}\n\t\tvar a = makeStack(e.stack);\n\t\t(untyped Error).prepareStackTrace = oldValue;\n\t\treturn a;\n\t}\n\n\t// support for source-map-support module\n\t@:noCompletion\n\tpublic static var wrapCallSite:Dynamic->Dynamic;\n\t#end\n\n\t/**\n\t\tReturn the call stack elements, or an empty array if not available.\n\t**/\n\tpublic static function callStack() : Array<StackItem> {\n\t\t#if neko\n\t\t\tvar a = makeStack(untyped __dollar__callstack());\n\t\t\ta.shift(); // remove Stack.callStack()\n\t\t\treturn a;\n\t\t#elseif flash\n\t\t\tvar a = makeStack( new flash.errors.Error().getStackTrace() );\n\t\t\ta.shift(); // remove Stack.callStack()\n\t\t\treturn a;\n\t\t#elseif php\n\t\t\treturn makeStack(\"%s\");\n\t\t#elseif cpp\n\t\t\tvar s:Array<String> = untyped __global__.__hxcpp_get_call_stack(true);\n\t\t\treturn makeStack(s);\n\t\t#elseif js\n\t\t\ttry {\n\t\t\t\tthrow new js.Error();\n\t\t\t} catch( e : Dynamic ) {\n\t\t\t\tvar a = getStack(e);\n\t\t\t\ta.shift(); // remove Stack.callStack()\n\t\t\t\treturn a;\n\t\t\t}\n\n\t\t#elseif java\n\t\t\tvar stack = [];\n\t\t\tfor ( el in java.lang.Thread.currentThread().getStackTrace() ) {\n\t\t\t\tvar className = el.getClassName();\n\t\t\t\tvar methodName = el.getMethodName();\n\t\t\t\tvar fileName = el.getFileName();\n\t\t\t\tvar lineNumber = el.getLineNumber();\n\t\t\t\tvar method = Method( className, methodName );\n\t\t\t\tif ( fileName != null || lineNumber >= 0 ) {\n\t\t\t\t\tstack.push( FilePos( method, fileName, lineNumber ) );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstack.push( method );\n\t\t\t\t}\n\t\t\t}\n\t\t\tstack.shift();\n\t\t\tstack.shift();\n\t\t\tstack.pop();\n\t\t\treturn stack;\n\t\t#elseif cs\n\t\t\treturn makeStack(new cs.system.diagnostics.StackTrace(1, true));\n\t\t#elseif python\n\t\t\tvar stack = [];\n\t\t\tvar infos = python.lib.Traceback.extract_stack();\n\t\t\tinfos.pop();\n\t\t\tinfos.reverse();\n\t\t\tfor (elem in infos)\n\t\t\t\tstack.push(FilePos(null, elem._1, elem._2));\n\t\t\treturn stack;\n\t\t#else\n\t\t\treturn []; // Unsupported\n\t\t#end\n\t}\n\n\t/**\n\t\tReturn the exception stack : this is the stack elements between\n\t\tthe place the last exception was thrown and the place it was\n\t\tcaught, or an empty array if not available.\n\t**/\n\t#if cpp @:noStack #end /* Do not mess up the exception stack */\n\tpublic static function exceptionStack() : Array<StackItem> {\n\t\t#if neko\n\t\t\treturn makeStack(untyped __dollar__excstack());\n\t\t#elseif as3\n\t\t\treturn new Array();\n\t\t#elseif flash\n\t\t\tvar err : flash.errors.Error = untyped flash.Boot.lastError;\n\t\t\tif( err == null ) return new Array();\n\t\t\tvar a = makeStack( err.getStackTrace() );\n\t\t\tvar c = callStack();\n\t\t\tvar i = c.length - 1;\n\t\t\twhile( i > 0 ) {\n\t\t\t\tif( Std.string(a[a.length-1]) == Std.string(c[i]) )\n\t\t\t\t\ta.pop();\n\t\t\t\telse\n\t\t\t\t\tbreak;\n\t\t\t\ti--;\n\t\t\t}\n\t\t\treturn a;\n\t\t#elseif php\n\t\t\treturn makeStack(\"%e\");\n\t\t#elseif cpp\n\t\t\tvar s:Array<String> = untyped __global__.__hxcpp_get_exception_stack();\n\t\t\treturn makeStack(s);\n\t\t#elseif java\n\t\t\tvar stack = [];\n\t\t\tfor ( el in java.internal.Exceptions.currentException().getStackTrace() ) {\n\t\t\t\tvar className = el.getClassName();\n\t\t\t\tvar methodName = el.getMethodName();\n\t\t\t\tvar fileName = el.getFileName();\n\t\t\t\tvar lineNumber = el.getLineNumber();\n\t\t\t\tvar method = Method( className, methodName );\n\t\t\t\tif ( fileName != null || lineNumber >= 0 ) {\n\t\t\t\t\tstack.push( FilePos( method, fileName, lineNumber ) );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstack.push( method );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// stack.shift();\n\t\t\tstack.shift();\n\t\t\tstack.pop();\n\t\t\treturn stack;\n\t\t#elseif cs\n\t\t\treturn makeStack(new cs.system.diagnostics.StackTrace(cs.internal.Exceptions.exception, true));\n\t\t#elseif python\n\t\t\tvar stack = [];\n\t\t\tvar exc = python.lib.Sys.exc_info();\n\t\t\tif (exc._3 != null)\n\t\t\t{\n\t\t\t\tvar infos = python.lib.Traceback.extract_tb(exc._3);\n\t\t\t\tinfos.reverse();\n\t\t\t\tfor (elem in infos)\n\t\t\t\t\tstack.push(FilePos(null, elem._1, elem._2));\n\t\t\t}\n\t\t\treturn stack;\n\t\t#elseif js\n\t\t\treturn untyped __define_feature__(\"haxe.CallStack.exceptionStack\", getStack(lastException));\n\t\t#else\n\t\t\treturn []; // Unsupported\n\t\t#end\n\t}\n\n\t/**\n\t\tReturns a representation of the stack as a printable string.\n\t**/\n\tpublic static function toString( stack : Array<StackItem> ) {\n\t\tvar b = new StringBuf();\n\t\tfor( s in stack ) {\n\t\t\tb.add(\"\\nCalled from \");\n\t\t\titemToString(b,s);\n\t\t}\n\t\treturn b.toString();\n\t}\n\n\tprivate static function itemToString( b : StringBuf, s ) {\n\t\tswitch( s ) {\n\t\tcase CFunction:\n\t\t\tb.add(\"a C function\");\n\t\tcase Module(m):\n\t\t\tb.add(\"module \");\n\t\t\tb.add(m);\n\t\tcase FilePos(s,file,line):\n\t\t\tif( s != null ) {\n\t\t\t\titemToString(b,s);\n\t\t\t\tb.add(\" (\");\n\t\t\t}\n\t\t\tb.add(file);\n\t\t\tb.add(\" line \");\n\t\t\tb.add(line);\n\t\t\tif( s != null ) b.add(\")\");\n\t\tcase Method(cname,meth):\n\t\t\tb.add(cname);\n\t\t\tb.add(\".\");\n\t\t\tb.add(meth);\n\t\tcase LocalFunction(n):\n\t\t\tb.add(\"local function #\");\n\t\t\tb.add(n);\n\t\t}\n\t}\n\n\t#if cpp @:noStack #end /* Do not mess up the exception stack */\n\tprivate static function makeStack(s #if cs : cs.system.diagnostics.StackTrace #end) {\n\t\t#if neko\n\t\t\tvar a = new Array();\n\t\t\tvar l = untyped __dollar__asize(s);\n\t\t\tvar i = 0;\n\t\t\twhile( i < l ) {\n\t\t\t\tvar x = s[i++];\n\t\t\t\tif( x == null )\n\t\t\t\t\ta.unshift(CFunction);\n\t\t\t\telse if( untyped __dollar__typeof(x) == __dollar__tstring )\n\t\t\t\t\ta.unshift(Module(new String(x)));\n\t\t\t\telse\n\t\t\t\t\ta.unshift(FilePos(null,new String(untyped x[0]),untyped x[1]));\n\t\t\t}\n\t\t\treturn a;\n\t\t#elseif flash\n\t\t\tvar a = new Array();\n\t\t\tvar r = ~/at ([^\\/]+?)\\$?(\\/[^\\(]+)?\\(\\)(\\[(.*?):([0-9]+)\\])?/;\n\t\t\tvar rlambda = ~/^MethodInfo-([0-9]+)$/g;\n\t\t\twhile( r.match(s) ) {\n\t\t\t\tvar cl = r.matched(1).split(\"::\").join(\".\");\n\t\t\t\tvar meth = r.matched(2);\n\t\t\t\tvar item;\n\t\t\t\tif( meth == null ) {\n\t\t\t\t\tif( rlambda.match(cl) )\n\t\t\t\t\t\titem = LocalFunction(Std.parseInt(rlambda.matched(1)));\n\t\t\t\t\telse\n\t\t\t\t\t\titem = Method(cl,\"new\");\n\t\t\t\t} else\n\t\t\t\t\titem = Method(cl,meth.substr(1));\n\t\t\t\tif( r.matched(3) != null )\n\t\t\t\t\titem = FilePos( item, r.matched(4), Std.parseInt(r.matched(5)) );\n\t\t\t\ta.push(item);\n\t\t\t\ts = r.matchedRight();\n\t\t\t}\n\t\t\treturn a;\n\t\t#elseif php\n\t\t\tif (!untyped __call__(\"isset\", __var__(\"GLOBALS\", s)))\n\t\t\t\treturn [];\n\t\t\tvar a : Array<String> = untyped __var__(\"GLOBALS\", s);\n\t\t\tvar m = [];\n\t\t\tfor( i in 0...a.length - ((s == \"%s\") ? 2 : 0)) {\n\t\t\t\tvar d = a[i].split(\"::\");\n\t\t\t\tm.unshift(Method(d[0],d[1]));\n\t\t\t}\n\t\t\treturn m;\n\t\t#elseif cpp\n\t\t\tvar stack : Array<String> = s;\n\t\t\tvar m = new Array<StackItem>();\n\t\t\tfor(func in stack) {\n\t\t\t\tvar words = func.split(\"::\");\n\t\t\t\tif (words.length==0)\n\t\t\t\t\tm.push(CFunction)\n\t\t\t\telse if (words.length==2)\n\t\t\t\t\tm.push(Method(words[0],words[1]));\n\t\t\t\telse if (words.length==4)\n\t\t\t\t\tm.push(FilePos( Method(words[0],words[1]),words[2],Std.parseInt(words[3])));\n\t\t\t}\n\t\t\treturn m;\n\t\t#elseif js\n\t\t\tif (s == null) {\n\t\t\t\treturn [];\n\t\t\t} else if ((untyped __js__(\"typeof\"))(s) == \"string\") {\n\t\t\t\t// Return the raw lines in browsers that don't support prepareStackTrace\n\t\t\t\tvar stack : Array<String> = s.split(\"\\n\");\n\t\t\t\tif( stack[0] == \"Error\" ) stack.shift();\n\t\t\t\tvar m = [];\n\t\t\t\tvar rie10 = ~/^   at ([A-Za-z0-9_. ]+) \\(([^)]+):([0-9]+):([0-9]+)\\)$/;\n\t\t\t\tfor( line in stack ) {\n\t\t\t\t\tif( rie10.match(line) ) {\n\t\t\t\t\t\tvar path = rie10.matched(1).split(\".\");\n\t\t\t\t\t\tvar meth = path.pop();\n\t\t\t\t\t\tvar file = rie10.matched(2);\n\t\t\t\t\t\tvar line = Std.parseInt(rie10.matched(3));\n\t\t\t\t\t\tm.push(FilePos( meth == \"Anonymous function\" ? LocalFunction() : meth == \"Global code\" ? null : Method(path.join(\".\"),meth), file, line ));\n\t\t\t\t\t} else\n\t\t\t\t\t\tm.push(Module(StringTools.trim(line))); // A little weird, but better than nothing\n\t\t\t\t}\n\t\t\t\treturn m;\n\t\t\t} else {\n\t\t\t\treturn cast s;\n\t\t\t}\n\t\t#elseif cs\n\t\t\tvar stack = [];\n\t\t\tfor (i in 0...s.FrameCount)\n\t\t\t{\n\t\t\t\tvar frame = s.GetFrame(i);\n\t\t\t\tvar m = frame.GetMethod();\n\n\t\t\t\tvar method = StackItem.Method(m.ReflectedType.ToString(), m.Name);\n\n\t\t\t\tvar fileName = frame.GetFileName();\n\t\t\t\tvar lineNumber = frame.GetFileLineNumber();\n\n\t\t\t\tif (fileName != null || lineNumber >= 0)\n\t\t\t\t\tstack.push(FilePos(method, fileName, lineNumber));\n\t\t\t\telse\n\t\t\t\t\tstack.push(method);\n\t\t\t}\n\t\t\treturn stack;\n\t\t#else\n\t\t\treturn null;\n\t\t#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\nusing haxe.Int64;\n\n /**\n\tA cross-platform signed 64-bit integer.\n\tInt64 instances can be created from two 32-bit words using `Int64.make()`.\n **/\n#if flash\n@:notNull\n#end\nabstract Int64(__Int64) from __Int64 to __Int64\n{\n\tprivate inline function new( x : __Int64 )\n\t\tthis = x;\n\n\t/**\n\t\tMakes a copy of `this` Int64.\n\t**/\n\tpublic inline function copy():Int64\n\t\treturn make( high, low );\n\n\t/**\n\t\tConstruct an Int64 from two 32-bit words `high` and `low`.\n\t**/\n\tpublic static inline function make( high:Int32, low:Int32 ) : Int64\n\t\treturn new Int64( new __Int64(high, low) );\n\n\t/**\n\t\tReturns an Int64 with the value of the Int `x`.\n\t\t`x` is sign-extended to fill 64 bits.\n\t**/\n\t@:from public static inline function ofInt( x : Int ) : Int64\n\t\treturn make( x >> 31, x );\n\n\t/**\n\t\tReturns an Int with the value of the Int64 `x`.\n\t\tThrows an exception  if `x` cannot be represented in 32 bits.\n\t**/\n\tpublic static inline function toInt( x : Int64 ) : Int {\n\t\tif( x.high != x.low >> 31 )\n\t\t\tthrow \"Overflow\";\n\n\t\treturn x.low;\n\t}\n\n\t/**\n\t\tReturns whether the value `val` is of type `haxe.Int64`\n\t**/\n\tinline public static function is( val : Dynamic ) : Bool\n\t\treturn Std.is(val,__Int64);\n\n\t/**\n\t\tReturns the high 32-bit word of `x`.\n\t**/\n\t@:deprecated(\"Use high instead\")\n\tpublic static inline function getHigh( x : Int64 ) : Int32\n\t\treturn x.high;\n\n\t/**\n\t\tReturns the low 32-bit word of `x`.\n\t**/\n\t@:deprecated(\"Use low instead\")\n\tpublic static inline function getLow( x : Int64 ) : Int32\n\t\treturn x.low;\n\n\t/**\n\t\tReturns `true` if `x` is less than zero.\n\t**/\n\tpublic static inline function isNeg( x : Int64) : Bool\n\t\treturn x.high < 0;\n\n\t/**\n\t\tReturns `true` if `x` is exactly zero.\n\t**/\n\tpublic static inline function isZero( x : Int64 ) : Bool\n\t\treturn x == 0;\n\n\t/**\n\t\tCompares `a` and `b` in signed mode.\n\t\tReturns a negative value if `a < b`, positive if `a > b`,\n\t\tor 0 if `a == b`.\n\t**/\n\tpublic static inline function compare( a : Int64, b : Int64 ) : Int {\n\t\tvar v = a.high - b.high;\n\t\tv = if( v != 0 ) v else Int32.ucompare(a.low, b.low);\n\t\treturn a.high < 0 ? (b.high < 0 ? v : -1) : (b.high >= 0 ? v : 1);\n\t}\n\n\t/**\n\t\tCompares `a` and `b` in unsigned mode.\n\t\tReturns a negative value if `a < b`, positive if `a > b`,\n\t\tor 0 if `a == b`.\n\t**/\n\tpublic static inline function ucompare( a : Int64, b : Int64 ) : Int {\n\t\tvar v = Int32.ucompare(a.high, b.high);\n\t\treturn if( v != 0 ) v else Int32.ucompare(a.low, b.low);\n\t}\n\n\t/**\n\t\tReturns a signed decimal `String` representation of `x`.\n\t**/\n\tpublic static inline function toStr(x:Int64) : String\n\t\treturn x.toString();\n\n\t#if as3 public #else private #end function toString() : String\n\t{\n\t\tvar i : Int64 = cast this;\n\t\tif ( i == 0 )\n\t\t\treturn \"0\";\n\t\tvar str = \"\";\n\t\tvar neg = false;\n\t\tif( i.isNeg() ) {\n\t\t\tneg = true;\n\t\t\ti = -i;\n\t\t}\n\t\tvar ten : Int64 = 10;\n\t\twhile( i != 0 ) {\n\t\t\tvar r = i.divMod( ten );\n\t\t\tstr = r.modulus.low + str;\n\t\t\ti = r.quotient;\n\t\t}\n\t\tif( neg ) str = \"-\" + str;\n\t\treturn str;\n\t}\n\n\t/**\n\t\tPerforms signed integer divison of `dividend` by `divisor`.\n\t\tReturns `{ quotient : Int64, modulus : Int64 }`.\n\t**/\n\tpublic static function divMod( dividend : Int64, divisor : Int64 ) : { quotient : Int64, modulus : Int64 }\n\t{\n\t\t// Handle special cases of 0 and 1\n\t\tif( divisor.high == 0 )\n\t\t{\n\t\t\tswitch( divisor.low ) {\n\t\t\t\tcase 0: throw \"divide by zero\";\n\t\t\t\tcase 1: return { quotient : dividend.copy(), modulus : 0 };\n\t\t\t}\n\t\t}\n\n\t\tvar divSign = dividend.isNeg() != divisor.isNeg();\n\n\t\tvar modulus = dividend.isNeg() ? -dividend : dividend.copy();\n\t\tdivisor = divisor.isNeg() ? -divisor : divisor;\n\n\t\tvar quotient : Int64 = 0;\n\t\tvar mask : Int64 = 1;\n\n\t\twhile( !divisor.isNeg() ) {\n\t\t\tvar cmp = ucompare( divisor, modulus );\n\t\t\tdivisor <<= 1;\n\t\t\tmask <<= 1;\n\t\t\tif( cmp >= 0 ) break;\n\t\t}\n\n\t\twhile( mask != 0 ) {\n\t\t\tif( ucompare(modulus, divisor) >= 0 ) {\n\t\t\t\tquotient |= mask;\n\t\t\t\tmodulus -= divisor;\n\t\t\t}\n\t\t\tmask >>>= 1;\n\t\t\tdivisor >>>= 1;\n\t\t}\n\n\t\tif( divSign ) quotient = -quotient;\n\t\tif( dividend.isNeg() ) modulus = -modulus;\n\n\t\treturn {\n\t\t\tquotient : quotient,\n\t\t\tmodulus  : modulus\n\t\t};\n\t}\n\n\t/**\n\t\tReturns the negative of `x`.\n\t**/\n\t@:op(-A) public static inline function neg( x : Int64 ) : Int64 {\n\t\tvar high = ~x.high;\n\t\tvar low = -x.low;\n\t\tif( low == 0 )\n\t\t\thigh++;\n\t\treturn make( high, low );\n\t}\n\n\t@:op(++A) private inline function preIncrement() : Int64 {\n\t\tthis.low++;\n\t\tif( this.low == 0 ) this.high++;\n\t\treturn cast this;\n\t}\n\n\t@:op(A++) private inline function postIncrement() : Int64 {\n\t\tvar ret = copy();\n\t\tpreIncrement();\n\t\treturn ret;\n\t}\n\n\t@:op(--A) private inline function preDecrement() : Int64 {\n\t\tif( this.low == 0 ) this.high--;\n\t\tthis.low--;\n\t\treturn cast this;\n\t}\n\n\t@:op(A--) private inline function postDecrement() : Int64 {\n\t\tvar ret = copy();\n\t\tpreDecrement();\n\t\treturn ret;\n\t}\n\n\t/**\n\t\tReturns the sum of `a` and `b`.\n\t**/\n\t@:op(A + B) public static inline function add( a : Int64, b : Int64 ) : Int64 {\n\t\tvar high = a.high + b.high;\n\t\tvar low = a.low + b.low;\n\t\tif( Int32.ucompare( low, a.low ) < 0 ) high++;\n\t\treturn make( high, low );\n\t}\n\n\t@:op(A + B) @:commutative private static inline function addInt( a : Int64, b : Int ) : Int64\n\t\treturn add( a, b );\n\n\t/**\n\t\tReturns `a` minus `b`.\n\t**/\n\t@:op(A - B) public static inline function sub( a : Int64, b : Int64 ) : Int64 {\n\t\tvar high = a.high - b.high;\n\t\tvar low = a.low - b.low;\n\t\tif( Int32.ucompare( a.low, b.low ) < 0 ) high--;\n        return make( high, low );\n\t}\n\n\t@:op(A - B) private static inline function subInt( a : Int64, b : Int ) : Int64\n\t\treturn sub( a, b );\n\n\t@:op(A - B) private static inline function intSub( a : Int, b : Int64 ) : Int64\n\t\treturn sub( a, b );\n\n\t/**\n\t\tReturns the product of `a` and `b`.\n\t**/\n\t@:op(A * B) public static inline function mul( a : Int64, b : Int64 ) : Int64 {\n\t\tvar mask = 0xFFFF;\n\t\tvar al = a.low & mask, ah = a.low >>> 16;\n\t\tvar bl = b.low & mask, bh = b.low >>> 16;\n\t\tvar p00 = al * bl;\n\t\tvar p10 = ah * bl;\n\t\tvar p01 = al * bh;\n\t\tvar p11 = ah * bh;\n\t\tvar low = p00;\n\t\tvar high = p11 + (p01 >>> 16) + (p10 >>> 16);\n\t\tp01 <<= 16;\n\t\tlow += p01;\n\t\tif( Int32.ucompare(low, p01) < 0 ) high++;\n\t\tp10 <<= 16;\n\t\tlow += p10;\n\t\tif( Int32.ucompare(low, p10) < 0 ) high++;\n\t\thigh += a.low * b.high + a.high * b.low;\n\t\treturn make( high, low );\n\t}\n\n\t@:op(A * B) @:commutative private static inline function mulInt( a : Int64, b : Int ) : Int64\n\t\treturn mul( a, b );\n\n\t/**\n\t\tReturns the quotient of `a` divided by `b`.\n\t**/\n\t@:op(A / B) public static inline function div( a : Int64, b : Int64 ) : Int64\n\t\treturn divMod(a, b).quotient;\n\n\t@:op(A / B) private static inline function divInt( a : Int64, b : Int ) : Int64\n\t\treturn div( a, b );\n\n\t@:op(A / B) private static inline function intDiv( a : Int, b : Int64 ) : Int64\n\t\treturn div( a, b ).toInt();\n\n\t/**\n\t\tReturns the modulus of `a` divided by `b`.\n\t**/\n\t@:op(A % B) public static inline function mod( a : Int64, b : Int64 ) : Int64\n\t\treturn divMod(a, b).modulus;\n\n\t@:op(A % B) private static inline function modInt( a : Int64, b : Int ) : Int64\n\t\treturn mod( a, b ).toInt();\n\n\t@:op(A % B) private static inline function intMod( a : Int, b : Int64 ) : Int64\n\t\treturn mod( a, b ).toInt();\n\n\t/**\n\t\tReturns `true` if `a` is equal to `b`.\n\t**/\n\t@:op(A == B) public static inline function eq( a : Int64, b : Int64 ) : Bool\n\t\treturn a.high == b.high && a.low == b.low;\n\n\t@:op(A == B) @:commutative private static inline function eqInt( a : Int64, b : Int ) : Bool\n\t\treturn eq( a, b );\n\n\t/**\n\t\tReturns `true` if `a` is not equal to `b`.\n\t**/\n\t@:op(A != B) public static inline function neq( a : Int64, b : Int64 ) : Bool\n\t\treturn a.high != b.high || a.low != b.low;\n\n\t@:op(A != B) @:commutative private static inline function neqInt( a : Int64, b : Int ) : Bool\n\t\treturn neq(a, b);\n\n\t@:op(A < B) private static inline function lt( a : Int64, b : Int64 ) : Bool\n\t\treturn compare(a, b) < 0;\n\n\t@:op(A < B) private static inline function ltInt( a : Int64, b : Int ) : Bool\n\t\treturn lt(a, b);\n\n\t@:op(A < B) private static inline function intLt( a : Int, b : Int64 ) : Bool\n\t\treturn lt(a, b);\n\n\t@:op(A <= B) private static inline function lte( a : Int64, b : Int64 ) : Bool\n\t\treturn compare(a, b) <= 0;\n\n\t@:op(A <= B) private static inline function lteInt( a : Int64, b : Int ) : Bool\n\t\treturn lte(a, b);\n\n\t@:op(A <= B) private static inline function intLte( a : Int, b : Int64 ) : Bool\n\t\treturn lte(a, b);\n\n\t@:op(A > B) private static inline function gt( a : Int64, b : Int64 ) : Bool\n\t\treturn compare(a, b) > 0;\n\n\t@:op(A > B) private static inline function gtInt( a : Int64, b : Int ) : Bool\n\t\treturn gt(a, b);\n\n\t@:op(A > B) private static inline function intGt( a : Int, b : Int64 ) : Bool\n\t\treturn gt( a, b );\n\n\t@:op(A >= B) private static inline function gte( a : Int64, b : Int64 ) : Bool\n\t\treturn compare(a, b) >= 0;\n\n\t@:op(A >= B) private static inline function gteInt( a : Int64, b : Int ) : Bool\n\t\treturn gte(a, b);\n\n\t@:op(A >= B) private static inline function intGte( a : Int, b : Int64 ) : Bool\n\t\treturn gte(a, b);\n\n\t/**\n\t\tReturns the bitwise NOT of `a`.\n\t**/\n\t@:op(~A) private static inline function complement( a : Int64 ) : Int64\n\t\treturn make( ~a.high, ~a.low );\n\n\t/**\n\t\tReturns the bitwise AND of `a` and `b`.\n\t**/\n\t@:op(A & B) public static inline function and( a : Int64, b : Int64 ) : Int64\n\t\treturn make( a.high & b.high, a.low & b.low );\n\n\t/**\n\t\tReturns the bitwise OR of `a` and `b`.\n\t**/\n\t@:op(A | B) public static inline function or( a : Int64, b : Int64 ) : Int64\n\t\treturn make( a.high | b.high, a.low | b.low );\n\n\t/**\n\t\tReturns the bitwise XOR of `a` and `b`.\n\t**/\n\t@:op(A ^ B) public static inline function xor( a : Int64, b : Int64 ) : Int64\n\t\treturn make( a.high ^ b.high, a.low ^ b.low );\n\n\t/**\n\t\tReturns `a` left-shifted by `b` bits.\n\t**/\n\t@:op(A << B) public static inline function shl( a : Int64, b : Int ) : Int64 {\n\t\tb &= 63;\n\t\treturn if( b == 0 ) a.copy()\n\t\t\telse if( b < 32 ) make( (a.high << b) | (a.low >>> (32-b)), a.low << b)\n\t\t\telse make( a.low << (b-32), 0 );\n\t}\n\n\t/**\n\t\tReturns `a` right-shifted by `b` bits in signed mode.\n\t\t`a` is sign-extended.\n\t**/\n\t@:op(A >> B) public static inline function shr( a : Int64, b : Int) : Int64 {\n\t\tb &= 63;\n\t\treturn if( b == 0 ) a.copy()\n\t\t\telse if( b < 32 ) make( a.high >> b, (a.high << (32-b)) | (a.low >>> b) )\n\t\t\telse make( a.high >> 31, a.high >> (b - 32) );\n\t}\n\n\t/**\n\t\tReturns `a` right-shifted by `b` bits in unsigned mode.\n\t\t`a` is padded with zeroes.\n\t**/\n\t@:op(A >>> B) public static inline function ushr( a : Int64, b : Int ) : Int64 {\n\t\tb &= 63;\n\t\treturn if( b == 0 ) a.copy()\n\t\t\telse if( b < 32 ) make( a.high >>> b, (a.high << (32-b)) | (a.low >>> b) )\n\t\t\telse make( 0, a.high >>> (b - 32) );\n\t}\n\n\tpublic var high(get, never) : Int32;\n\tprivate inline function get_high() return this.high;\n\tprivate inline function set_high(x) return this.high = x;\n\n\tpublic var low(get, never) : Int32;\n\tprivate inline function get_low() return this.low;\n\tprivate inline function set_low(x) return this.low = x;\n}\n\n/**\n  * This typedef will fool @:coreApi into thinking that we are using\n  * the same underlying type, even though it might be different on\n  * specific platforms.\n  */\nprivate typedef __Int64 = ___Int64;\n\nprivate class ___Int64 {\n\tpublic var high : Int32;\n\tpublic var low : Int32;\n\n\tpublic inline function new( high, low ) {\n\t\tthis.high = high;\n\t\tthis.low = low;\n\t}\n\n\t/**\n\t\tWe also define toString here to ensure we always get a pretty string\n\t\twhen tracing or calling Std.string. This tends not to happen when\n\t\ttoString is only in the abstract.\n\t**/\n\tpublic function toString() : String\n\t\treturn Int64.toStr( cast this );\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tLog primarily provides the trace() method, which is invoked upon a call to\n\ttrace() in haxe code.\n**/\nclass Log {\n\n\t/**\n\t\tOutputs `v` in a platform-dependent way.\n\n\t\tThe second parameter `infos` is injected by the compiler and contains\n\t\tinformation about the position where the trace() call was made.\n\n\t\tThis method can be rebound to a custom function:\n\t\t\tvar oldTrace = haxe.Log.trace; // store old function\n\t\t\thaxe.Log.trace = function(v,infos) { // handle trace }\n\t\t\t...\n\t\t\thaxe.Log.trace = oldTrace;\n\n\t\tIf it is bound to null, subsequent calls to trace() will cause an\n\t\texception.\n\t**/\n\tpublic static dynamic function trace( v : Dynamic, ?infos : PosInfos ) : Void {\n\t\t#if flash\n\t\t\t#if (fdb || native_trace)\n\t\t\t\tvar pstr = infos == null ? \"(null)\" : infos.fileName + \":\" + infos.lineNumber;\n\t\t\t\tvar str = flash.Boot.__string_rec(v, \"\");\n\t\t\t\tif( infos != null && infos.customParams != null ) for( v in infos.customParams ) str += \",\" + flash.Boot.__string_rec(v, \"\");\n\t\t\t\tuntyped __global__[\"trace\"](pstr+\": \"+str);\n\t\t\t#else\n\t\t\t\tuntyped flash.Boot.__trace(v,infos);\n\t\t\t#end\n\t\t#elseif neko\n\t\t\tuntyped {\n\t\t\t\t$print(infos.fileName + \":\" + infos.lineNumber + \": \", v);\n\t\t\t\tif( infos.customParams != null ) for( v in infos.customParams ) $print(\",\", v);\n\t\t\t\t$print(\"\\n\");\n\t\t\t}\n\t\t#elseif js\n\t\t\tuntyped js.Boot.__trace(v,infos);\n\t\t#elseif php\n\t\t\tif (infos!=null && infos.customParams!=null) {\n\t\t\t\tvar extra:String = \"\";\n\t\t\t\tfor( v in infos.customParams )\n\t\t\t\t\textra += \",\" + v;\n\t\t\t\tuntyped __call__('_hx_trace', v + extra, infos);\n\t\t\t}\n\t\t\telse\n\t\t\t\tuntyped __call__('_hx_trace', v, infos);\n\t\t#elseif cpp\n\t\t\tif (infos!=null && infos.customParams!=null) {\n\t\t\t\tvar extra:String = \"\";\n\t\t\t\tfor( v in infos.customParams )\n\t\t\t\t\textra += \",\" + v;\n\t\t\t\tuntyped __trace(v + extra,infos);\n\t\t\t}\n\t\t\telse\n\t\t\t\tuntyped __trace(v,infos);\n\t\t#elseif (cs || java)\n\t\t\tvar str:String = null;\n\t\t\tif (infos != null) {\n\t\t\t\tstr = infos.fileName + \":\" + infos.lineNumber + \": \" + v;\n\t\t\t\tif (infos.customParams != null)\n\t\t\t\t{\n\t\t\t\t\tstr += \",\" + infos.customParams.join(\",\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstr = v;\n\t\t\t}\n\t\t\t#if cs\n\t\t\tcs.system.Console.WriteLine(str);\n\t\t\t#elseif java\n\t\t\tuntyped __java__(\"java.lang.System.out.println(str)\");\n\t\t\t#end\n\t\t#elseif (python)\n\t\t\tvar str:String = null;\n\t\t\tif (infos != null) {\n\t\t\t\tstr = infos.fileName + \":\" + Std.string(infos.lineNumber) + \": \" + v;\n\t\t\t\tif (infos.customParams != null) {\n\t\t\t\t\tstr += \",\" + infos.customParams.join(\",\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstr = v;\n\t\t\t}\n\t\t\tpython.Lib.println(str);\n\t\t#end\n\t}\n\n\t#if (flash || js)\n\t/**\n\t\tClears the trace output.\n\t**/\n\tpublic static dynamic function clear() : Void {\n\t\t#if flash\n\t\tuntyped flash.Boot.__clear_trace();\n\t\t#elseif js\n\t\tuntyped js.Boot.__clear_trace();\n\t\t#end\n\t}\n\t#end\n\n\t#if flash\n\t/**\n\t\tSets the color of the trace output to `rgb`.\n\t**/\n\tpublic static dynamic function setColor( rgb : Int ) {\n\t\tuntyped flash.Boot.__set_trace_color(rgb);\n\t}\n\t#end\n\n}\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tResource can be used to access resources that were added through the\n\t-resource file@name command line parameter.\n\n\tDepending on their type they can be obtained as String through\n\tgetString(name), or as binary data through getBytes(name).\n\n\tA list of all available resource names can be obtained from listNames().\n**/\nclass Resource {\n\n\tstatic var content : Array<{ name : String, data : String, str : String }>;\n\n\t/**\n\t\tLists all available resource names. The resource name is the name part\n\t\tof the -resource file@name command line parameter.\n\t**/\n\tpublic static function listNames() : Array<String> {\n\t\treturn [for (x in content) x.name];\n\t}\n\n\t/**\n\t\tRetrieves the resource identified by `name` as a String.\n\n\t\tIf `name` does not match any resource name, null is returned.\n\t**/\n\tpublic static function getString( name : String ) : String {\n\t\tfor( x in content )\n\t\t\tif( x.name == name ) {\n\t\t\t\t#if neko\n\t\t\t\treturn new String(x.data);\n\t\t\t\t#else\n\t\t\t\tif( x.str != null ) return x.str;\n\t\t\t\tvar b : haxe.io.Bytes = haxe.crypto.Base64.decode(x.data);\n\t\t\t\treturn b.toString();\n\t\t\t\t#end\n\t\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t\tRetrieves the resource identified by `name` as an instance of\n\t\thaxe.io.Bytes.\n\n\t\tIf `name` does not match any resource name, null is returned.\n\t**/\n\tpublic static function getBytes( name : String ) : haxe.io.Bytes {\n\t\tfor( x in content )\n\t\t\tif( x.name == name ) {\n\t\t\t\t#if neko\n\t\t\t\treturn haxe.io.Bytes.ofData(cast x.data);\n\t\t\t\t#else\n\t\t\t\tif( x.str != null ) return haxe.io.Bytes.ofString(x.str);\n\t\t\t\treturn haxe.crypto.Base64.decode(x.data);\n\t\t\t\t#end\n\t\t\t}\n\t\treturn null;\n\t}\n\n\tstatic function __init__() {\n\t\t#if neko\n\t\tvar tmp = untyped __resources__();\n\t\tcontent = untyped Array.new1(tmp,__dollar__asize(tmp));\n\t\t#elseif php\n\t\tcontent = null;\n\t\t#elseif as3\n\t\tnull;\n\t\t#else\n\t\tcontent = untyped __resources__();\n\t\t#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tThe Serializer class can be used to encode values and objects into a String,\n\tfrom which the Unserializer class can recreate the original representation.\n\n\tThis class can be used in two ways:\n\n\t- create a new Serializer() instance, call its serialize() method with\n\t\tany argument and finally retrieve the String representation from\n\t\ttoString()\n\t- call Serializer.run() to obtain the serialized representation of a\n\t\tsingle argument\n\n\tSerialization is guaranteed to work for all haxe-defined classes, but may\n\tor may not work for instances of external/native classes.\n\n\tThe specification of the serialization format can be found here:\n\t`http://haxe.org/manual/serialization/format`\n**/\nclass Serializer {\n\n\t/**\n\t\tIf the values you are serializing can contain circular references or\n\t\tobjects repetitions, you should set USE_CACHE to true to prevent\n\t\tinfinite loops.\n\n\t\tThis may also reduce the size of serialization Strings at the expense of\n\t\tperformance.\n\n\t\tThis value can be changed for individual instances of Serializer by\n\t\tsetting their useCache field.\n\t**/\n\tpublic static var USE_CACHE = false;\n\n\t/**\n\t\tUse constructor indexes for enums instead of names.\n\n\t\tThis may reduce the size of serialization Strings, but makes them less\n\t\tsuited for long-term storage: If constructors are removed or added from\n\t\tthe enum, the indices may no longer match.\n\n\t\tThis value can be changed for individual instances of Serializer by\n\t\tsetting their useEnumIndex field.\n\t**/\n\tpublic static var USE_ENUM_INDEX = false;\n\n\tstatic var BASE64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:\";\n\n\tvar buf : StringBuf;\n\tvar cache : Array<Dynamic>;\n\tvar shash : haxe.ds.StringMap<Int>;\n\tvar scount : Int;\n\n\t/**\n\t\tThe individual cache setting for `this` Serializer instance.\n\n\t\tSee USE_CACHE for a complete description.\n\t**/\n\tpublic var useCache : Bool;\n\n\t/**\n\t\tThe individual enum index setting for `this` Serializer instance.\n\n\t\tSee USE_ENUM_INDEX for a complete description.\n\t**/\n\tpublic var useEnumIndex : Bool;\n\n\t/**\n\t\tCreates a new Serializer instance.\n\n\t\tSubsequent calls to `this.serialize` will append values to the\n\t\tinternal buffer of this String. Once complete, the contents can be\n\t\tretrieved through a call to `this.toString`.\n\n\t\tEach Serializer instance maintains its own cache if this.useCache` is\n\t\ttrue.\n\t**/\n\tpublic function new() {\n\t\tbuf = new StringBuf();\n\t\tcache = new Array();\n\t\tuseCache = USE_CACHE;\n\t\tuseEnumIndex = USE_ENUM_INDEX;\n\t\tshash = new haxe.ds.StringMap();\n\t\tscount = 0;\n\t}\n\n\t/**\n\t\tReturn the String representation of `this` Serializer.\n\n\t\tThe exact format specification can be found here:\n\t\thttp://haxe.org/manual/serialization/format\n\t**/\n\tpublic function toString() {\n\t\treturn buf.toString();\n\t}\n\n\t/* prefixes :\n\t\ta : array\n\t\tb : hash\n\t\tc : class\n\t\td : Float\n\t\te : reserved (float exp)\n\t\tf : false\n\t\tg : object end\n\t\th : array/list/hash end\n\t\ti : Int\n\t\tj : enum (by index)\n\t\tk : NaN\n\t\tl : list\n\t\tm : -Inf\n\t\tn : null\n\t\to : object\n\t\tp : +Inf\n\t\tq : haxe.ds.IntMap\n\t\tr : reference\n\t\ts : bytes (base64)\n\t\tt : true\n\t\tu : array nulls\n\t\tv : date\n\t\tw : enum\n\t\tx : exception\n\t\ty : urlencoded string\n\t\tz : zero\n\t\tA : Class<Dynamic>\n\t\tB : Enum<Dynamic>\n\t\tM : haxe.ds.ObjectMap\n\t\tC : custom\n\t*/\n\n\tfunction serializeString( s : String ) {\n\t\tvar x = shash.get(s);\n\t\tif( x != null ) {\n\t\t\tbuf.add(\"R\");\n\t\t\tbuf.add(x);\n\t\t\treturn;\n\t\t}\n\t\tshash.set(s,scount++);\n\t\t#if old_serialize\n\t\t\t// no more support for -D old_serialize due to 'j' reuse\n\t\t\t#if error #end\n\t\t#end\n\t\tbuf.add(\"y\");\n\t\ts = StringTools.urlEncode(s);\n\t\tbuf.add(s.length);\n\t\tbuf.add(\":\");\n\t\tbuf.add(s);\n\t}\n\n\tfunction serializeRef(v) {\n\t\t#if js\n\t\tvar vt = untyped __js__(\"typeof\")(v);\n\t\t#end\n\t\tfor( i in 0...cache.length ) {\n\t\t\t#if js\n\t\t\tvar ci = cache[i];\n\t\t\tif( untyped __js__(\"typeof\")(ci) == vt && ci == v ) {\n\t\t\t#else\n\t\t\tif( cache[i] == v ) {\n\t\t\t#end\n\t\t\t\tbuf.add(\"r\");\n\t\t\t\tbuf.add(i);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tcache.push(v);\n\t\treturn false;\n\t}\n\n\t#if flash\n\t// only the instance variables\n\n\tfunction serializeClassFields(v,c) {\n\t\tvar xml : flash.xml.XML = untyped __global__[\"flash.utils.describeType\"](c);\n\t\tvar vars = xml.factory[0].child(\"variable\");\n\t\tfor( i in 0...vars.length() ) {\n\t\t\tvar f = vars[i].attribute(\"name\").toString();\n\t\t\tif( !v.hasOwnProperty(f) )\n\t\t\t\tcontinue;\n\t\t\tserializeString(f);\n\t\t\tserialize(Reflect.field(v,f));\n\t\t}\n\t\tbuf.add(\"g\");\n\t}\n\t#end\n\n\tfunction serializeFields(v) {\n\t\tfor( f in Reflect.fields(v) ) {\n\t\t\tserializeString(f);\n\t\t\tserialize(Reflect.field(v,f));\n\t\t}\n\t\tbuf.add(\"g\");\n\t}\n\n\t/**\n\t\tSerializes `v`.\n\n\t\tAll haxe-defined values and objects with the exception of functions can\n\t\tbe serialized. Serialization of external/native objects is not\n\t\tguaranteed to work.\n\n\t\tThe values of `this.useCache` and `this.useEnumIndex` may affect\n\t\tserialization output.\n\t**/\n\tpublic function serialize( v : Dynamic ) {\n\t\tswitch( Type.typeof(v) ) {\n\t\tcase TNull:\n\t\t\tbuf.add(\"n\");\n\t\tcase TInt:\n\t\t\tvar v : Int = v;\n\t\t\tif( v == 0 ) {\n\t\t\t\tbuf.add(\"z\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tbuf.add(\"i\");\n\t\t\tbuf.add(v);\n\t\tcase TFloat:\n\t\t\tvar v : Float = v;\n\t\t\tif( Math.isNaN(v) )\n\t\t\t\tbuf.add(\"k\");\n\t\t\telse if( !Math.isFinite(v) )\n\t\t\t\tbuf.add(if( v < 0 ) \"m\" else \"p\");\n\t\t\telse {\n\t\t\t\tbuf.add(\"d\");\n\t\t\t\tbuf.add(v);\n\t\t\t}\n\t\tcase TBool:\n\t\t\tbuf.add(if( v ) \"t\" else \"f\");\n\t\tcase TClass(c):\n\t\t\tif( #if neko untyped c.__is_String #else c == String #end ) {\n\t\t\t\tserializeString(v);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif( useCache && serializeRef(v) )\n\t\t\t\treturn;\n\t\t\tswitch( #if (neko || cs || python) Type.getClassName(c) #else c #end ) {\n\t\t\tcase #if (neko || cs || python) \"Array\" #else cast Array #end:\n\t\t\t\tvar ucount = 0;\n\t\t\t\tbuf.add(\"a\");\n\t\t\t\t#if (flash || python)\n\t\t\t\tvar v : Array<Dynamic> = v;\n\t\t\t\t#end\n\t\t\t\tvar l = #if (neko || flash || php || cs || java || python) v.length #elseif cpp v.__length() #else __getField(v, \"length\") #end;\n\t\t\t\tfor( i in 0...l ) {\n\t\t\t\t\tif( v[i] == null )\n\t\t\t\t\t\tucount++;\n\t\t\t\t\telse {\n\t\t\t\t\t\tif( ucount > 0 ) {\n\t\t\t\t\t\t\tif( ucount == 1 )\n\t\t\t\t\t\t\t\tbuf.add(\"n\");\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tbuf.add(\"u\");\n\t\t\t\t\t\t\t\tbuf.add(ucount);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tucount = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tserialize(v[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( ucount > 0 ) {\n\t\t\t\t\tif( ucount == 1 )\n\t\t\t\t\t\tbuf.add(\"n\");\n\t\t\t\t\telse {\n\t\t\t\t\t\tbuf.add(\"u\");\n\t\t\t\t\t\tbuf.add(ucount);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs || python) \"List\" #else cast List #end:\n\t\t\t\tbuf.add(\"l\");\n\t\t\t\tvar v : List<Dynamic> = v;\n\t\t\t\tfor( i in v )\n\t\t\t\t\tserialize(i);\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs || python) \"Date\" #else cast Date #end:\n\t\t\t\tvar d : Date = v;\n\t\t\t\tbuf.add(\"v\");\n\t\t\t\tbuf.add(d.getTime());\n\t\t\tcase #if (neko || cs || python) \"haxe.ds.StringMap\" #else cast haxe.ds.StringMap #end:\n\t\t\t\tbuf.add(\"b\");\n\t\t\t\tvar v : haxe.ds.StringMap<Dynamic> = v;\n\t\t\t\tfor( k in v.keys() ) {\n\t\t\t\t\tserializeString(k);\n\t\t\t\t\tserialize(v.get(k));\n\t\t\t\t}\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs || python) \"haxe.ds.IntMap\" #else cast haxe.ds.IntMap #end:\n\t\t\t\tbuf.add(\"q\");\n\t\t\t\tvar v : haxe.ds.IntMap<Dynamic> = v;\n\t\t\t\tfor( k in v.keys() ) {\n\t\t\t\t\tbuf.add(\":\");\n\t\t\t\t\tbuf.add(k);\n\t\t\t\t\tserialize(v.get(k));\n\t\t\t\t}\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs || python) \"haxe.ds.ObjectMap\" #else cast haxe.ds.ObjectMap #end:\n\t\t\t\tbuf.add(\"M\");\n\t\t\t\tvar v : haxe.ds.ObjectMap<Dynamic,Dynamic> = v;\n\t\t\t\tfor ( k in v.keys() ) {\n\t\t\t\t\t#if (js || neko)\n\t\t\t\t\tvar id = Reflect.field(k, \"__id__\");\n\t\t\t\t\tReflect.deleteField(k, \"__id__\");\n\t\t\t\t\tserialize(k);\n\t\t\t\t\tReflect.setField(k, \"__id__\", id);\n\t\t\t\t\t#else\n\t\t\t\t\tserialize(k);\n\t\t\t\t\t#end\n\t\t\t\t\tserialize(v.get(k));\n\t\t\t\t}\n\t\t\t\tbuf.add(\"h\");\n\t\t\tcase #if (neko || cs || python) \"haxe.io.Bytes\" #else cast haxe.io.Bytes #end:\n\t\t\t\tvar v : haxe.io.Bytes = v;\n\t\t\t\t#if neko\n\t\t\t\tvar chars = new String(base_encode(v.getData(),untyped BASE64.__s));\n\t\t\t\t#else\n\t\t\t\tvar i = 0;\n\t\t\t\tvar max = v.length - 2;\n\t\t\t\tvar charsBuf = new StringBuf();\n\t\t\t\tvar b64 = BASE64;\n\t\t\t\twhile( i < max ) {\n\t\t\t\t\tvar b1 = v.get(i++);\n\t\t\t\t\tvar b2 = v.get(i++);\n\t\t\t\t\tvar b3 = v.get(i++);\n\n\t\t\t\t\tcharsBuf.add(b64.charAt(b1 >> 2));\n\t\t\t\t\tcharsBuf.add(b64.charAt(((b1 << 4) | (b2 >> 4)) & 63));\n\t\t\t\t\tcharsBuf.add(b64.charAt(((b2 << 2) | (b3 >> 6)) & 63));\n\t\t\t\t\tcharsBuf.add(b64.charAt(b3 & 63));\n\t\t\t\t}\n\t\t\t\tif( i == max ) {\n\t\t\t\t\tvar b1 = v.get(i++);\n\t\t\t\t\tvar b2 = v.get(i++);\n\t\t\t\t\tcharsBuf.add(b64.charAt(b1 >> 2));\n\t\t\t\t\tcharsBuf.add(b64.charAt(((b1 << 4) | (b2 >> 4)) & 63));\n\t\t\t\t\tcharsBuf.add(b64.charAt((b2 << 2) & 63));\n\t\t\t\t} else if( i == max + 1 ) {\n\t\t\t\t\tvar b1 = v.get(i++);\n\t\t\t\t\tcharsBuf.add(b64.charAt(b1 >> 2));\n\t\t\t\t\tcharsBuf.add(b64.charAt((b1 << 4) & 63));\n\t\t\t\t}\n\t\t\t\tvar chars = charsBuf.toString();\n\t\t\t\t#end\n\t\t\t\tbuf.add(\"s\");\n\t\t\t\tbuf.add(chars.length);\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(chars);\n\t\t\tdefault:\n\t\t\t\tif( useCache ) cache.pop();\n\t\t\t\tif( #if flash try v.hxSerialize != null catch( e : Dynamic ) false #elseif (cs || java || python) Reflect.hasField(v, \"hxSerialize\") #else v.hxSerialize != null #end  ) {\n\t\t\t\t\tbuf.add(\"C\");\n\t\t\t\t\tserializeString(Type.getClassName(c));\n\t\t\t\t\tif( useCache ) cache.push(v);\n\t\t\t\t\tv.hxSerialize(this);\n\t\t\t\t\tbuf.add(\"g\");\n\t\t\t\t} else {\n\t\t\t\t\tbuf.add(\"c\");\n\t\t\t\t\tserializeString(Type.getClassName(c));\n\t\t\t\t\tif( useCache ) cache.push(v);\n\t\t\t\t\t#if flash\n\t\t\t\t\tserializeClassFields(v,c);\n\t\t\t\t\t#else\n\t\t\t\t\tserializeFields(v);\n\t\t\t\t\t#end\n\t\t\t\t}\n\t\t\t}\n\t\tcase TObject:\n\t\t\tif (Std.is(v,Class)) {\n\t\t\t\tvar className = Type.getClassName(v);\n\t\t\t\t#if (flash || cpp)\n\t\t\t\t// Currently, Enum and Class are the same for flash and cpp.\n\t\t\t\t//  use resolveEnum to test if it is actually an enum\n\t\t\t\tif (Type.resolveEnum(className)!=null) buf.add(\"B\") else\n\t\t\t\t#end\n\t\t\t\tbuf.add(\"A\");\n\t\t\t\tserializeString(className);\n\t\t\t} else if (Std.is(v,Enum)) {\n\t\t\t\tbuf.add(\"B\");\n\t\t\t\tserializeString(Type.getEnumName(v));\n\t\t\t} else {\n\t\t\t\tif( useCache && serializeRef(v) )\n\t\t\t\t\treturn;\n\t\t\t\tbuf.add(\"o\");\n\t\t\t\tserializeFields(v);\n\t\t\t}\n\t\tcase TEnum(e):\n\t\t\tif( useCache ) {\n\t\t\t\tif( serializeRef(v) )\n\t\t\t\t\treturn;\n\t\t\t\tcache.pop();\n\t\t\t}\n\t\t\tbuf.add(useEnumIndex?\"j\":\"w\");\n\t\t\tserializeString(Type.getEnumName(e));\n\t\t\t#if neko\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(v.index);\n\t\t\t} else\n\t\t\t\tserializeString(new String(v.tag));\n\t\t\tbuf.add(\":\");\n\t\t\tif( v.args == null )\n\t\t\t\tbuf.add(0);\n\t\t\telse {\n\t\t\t\tvar l : Int = untyped __dollar__asize(v.args);\n\t\t\t\tbuf.add(l);\n\t\t\t\tfor( i in 0...l )\n\t\t\t\t\tserialize(v.args[i]);\n\t\t\t}\n\t\t\t#elseif flash\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tvar i : Int = v.index;\n\t\t\t\tbuf.add(i);\n\t\t\t} else\n\t\t\t\tserializeString(v.tag);\n\t\t\tbuf.add(\":\");\n\t\t\tvar pl : Array<Dynamic> = v.params;\n\t\t\tif( pl == null )\n\t\t\t\tbuf.add(0);\n\t\t\telse {\n\t\t\t\tbuf.add(pl.length);\n\t\t\t\tfor( p in pl )\n\t\t\t\t\tserialize(p);\n\t\t\t}\n\t\t\t#elseif cpp\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(v.__Index());\n\t\t\t} else\n\t\t\t\tserializeString(v.__Tag());\n\t\t\tbuf.add(\":\");\n\t\t\tvar pl : Array<Dynamic> = v.__EnumParams();\n\t\t\tif( pl == null )\n\t\t\t\tbuf.add(0);\n\t\t\telse {\n\t\t\t\tbuf.add(pl.length);\n\t\t\t\tfor( p in pl )\n\t\t\t\t\tserialize(p);\n\t\t\t}\n\t\t\t#elseif php\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(v.index);\n\t\t\t} else\n\t\t\t\tserializeString(v.tag);\n\t\t\tbuf.add(\":\");\n\t\t\tvar l : Int = untyped __call__(\"count\", v.params);\n\t\t\tif( l == 0 || v.params == null)\n\t\t\t\tbuf.add(0);\n\t\t\telse {\n\t\t\t\tbuf.add(l);\n\t\t\t\tfor( i in 0...l )\n\t\t\t\t\tserialize(untyped __field__(v, __php__(\"params\"), i));\n\t\t\t}\n\t\t\t#elseif (java || cs || python)\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(Type.enumIndex(v));\n\t\t\t} else\n\t\t\t\tserializeString(Type.enumConstructor(v));\n\t\t\tbuf.add(\":\");\n\t\t\tvar arr:Array<Dynamic> = Type.enumParameters(v);\n\t\t\tif (arr != null)\n\t\t\t{\n\t\t\t\tbuf.add(arr.length);\n\t\t\t\tfor (v in arr)\n\t\t\t\t\tserialize(v);\n\t\t\t} else {\n\t\t\t\tbuf.add(\"0\");\n\t\t\t}\n\n\t\t\t#else\n\t\t\tif( useEnumIndex ) {\n\t\t\t\tbuf.add(\":\");\n\t\t\t\tbuf.add(v[1]);\n\t\t\t} else\n\t\t\t\tserializeString(v[0]);\n\t\t\tbuf.add(\":\");\n\t\t\tvar l = __getField(v, \"length\");\n\t\t\tbuf.add(l - 2);\n\t\t\tfor( i in 2...l )\n\t\t\t\tserialize(v[i]);\n\t\t\t#end\n\t\t\tif( useCache ) cache.push(v);\n\t\tcase TFunction:\n\t\t\tthrow \"Cannot serialize function\";\n\t\tdefault:\n\t\t\t#if neko\n\t\t\tif( untyped (__i32__kind != null && __dollar__iskind(v,__i32__kind)) ) {\n\t\t\t\tbuf.add(\"i\");\n\t\t\t\tbuf.add(v);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t#end\n\t\t\tthrow \"Cannot serialize \"+Std.string(v);\n\t\t}\n\t}\n\n\t@:extern inline function __getField(o:Dynamic, f:String):Dynamic return untyped o[f];\n\n\tpublic function serializeException( e : Dynamic ) {\n\t\tbuf.add(\"x\");\n\t\t#if flash\n\t\tif( untyped __is__(e,__global__[\"Error\"]) ) {\n\t\t\tvar e : flash.errors.Error = e;\n\t\t\tvar s = e.getStackTrace();\n\t\t\tif( s == null )\n\t\t\t\tserialize(e.message);\n\t\t\telse\n\t\t\t\tserialize(s);\n\t\t\treturn;\n\t\t}\n\t\t#end\n\t\tserialize(e);\n\t}\n\n\t/**\n\t\tSerializes `v` and returns the String representation.\n\n\t\tThis is a convenience function for creating a new instance of\n\t\tSerializer, serialize `v` into it and obtain the result through a call\n\t\tto toString().\n\t**/\n\tpublic static function run( v : Dynamic ) {\n\t\tvar s = new Serializer();\n\t\ts.serialize(v);\n\t\treturn s.toString();\n\t}\n\n\t#if neko\n\tstatic var base_encode = neko.Lib.load(\"std\",\"base_encode\",2);\n\t#end\n\n}\n\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tThe Timer class allows you to create asynchronous timers on platforms that\n\tsupport events.\n\n\tThe intended usage is to create an instance of the Timer class with a given\n\tinterval, set its run() method to a custom function to be invoked and\n\teventually call stop() to stop the Timer.\n\n\tNote that a running Timer may or may not prevent the program to exit\n\tautomatically when main() returns.\n\n\tIt is also possible to extend this class and override its run() method in\n\tthe child class.\n**/\nclass Timer {\n\t#if (flash || js || java || python)\n\n\t#if (flash || js)\n\t\tprivate var id : Null<Int>;\n\t#elseif java\n\t\tprivate var timer : java.util.Timer;\n\t\tprivate var task : java.util.TimerTask;\n\t#end\n\n\t/**\n\t\tCreates a new timer that will run every `time_ms` milliseconds.\n\n\t\tAfter creating the Timer instance, it calls `this].run` repeatedly,\n\t\twith delays of `time_ms` milliseconds, until `this.stop` is called.\n\n\t\tThe first invocation occurs after `time_ms` milliseconds, not\n\t\timmediately.\n\n\t\tThe accuracy of this may be platform-dependent.\n\t**/\n\tpublic function new( time_ms : Int ){\n\t\t#if flash\n\t\t\tvar me = this;\n\t\t\tid = untyped __global__[\"flash.utils.setInterval\"](function() { me.run(); },time_ms);\n\t\t#elseif js\n\t\t\tvar me = this;\n\t\t\tid = untyped setInterval(function() me.run(),time_ms);\n\t\t#elseif java\n\t\t\ttimer = new java.util.Timer();\n\t\t\ttimer.scheduleAtFixedRate(task = new TimerTask(this), haxe.Int64.ofInt(time_ms), haxe.Int64.ofInt(time_ms));\n\t\t#end\n\t}\n\n\t/**\n\t\tStops `this` Timer.\n\n\t\tAfter calling this method, no additional invocations of `this.run`\n\t\twill occur.\n\n\t\tIt is not possible to restart `this` Timer once stopped.\n\t**/\n\tpublic function stop() {\n\t\t#if (flash || js)\n\t\t\tif( id == null )\n\t\t\t\treturn;\n\t\t\t#if flash\n\t\t\t\tuntyped __global__[\"flash.utils.clearInterval\"](id);\n\t\t\t#elseif js\n\t\t\t\tuntyped clearInterval(id);\n\t\t\t#end\n\t\t\tid = null;\n\t\t#elseif java\n\t\t\ttimer.cancel();\n\t\t\ttimer = null;\n\t\t\ttask = null;\n\t\t#end\n\t}\n\n\t/**\n\t\tThis method is invoked repeatedly on `this` Timer.\n\n\t\tIt can be overridden in a subclass, or rebound directly to a custom\n\t\tfunction:\n\t\t\tvar timer = new haxe.Timer(1000); // 1000ms delay\n\t\t\ttimer.run = function() { ... }\n\n\t\tOnce bound, it can still be rebound to different functions until `this`\n\t\tTimer is stopped through a call to `this.stop`.\n\t**/\n\tpublic dynamic function run() {\n\n\t}\n\n\t/**\n\t\tInvokes `f` after `time_ms` milliseconds.\n\n\t\tThis is a convenience function for creating a new Timer instance with\n\t\t`time_ms` as argument, binding its run() method to `f` and then stopping\n\t\t`this` Timer upon the first invocation.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function delay( f : Void -> Void, time_ms : Int ) {\n\t\tvar t = new haxe.Timer(time_ms);\n\t\tt.run = function() {\n\t\t\tt.stop();\n\t\t\tf();\n\t\t};\n\t\treturn t;\n\t}\n\n\t#end\n\n\t/**\n\t\tMeasures the time it takes to execute `f`, in seconds with fractions.\n\n\t\tThis is a convenience function for calculating the difference between\n\t\tTimer.stamp() before and after the invocation of `f`.\n\n\t\tThe difference is passed as argument to Log.trace(), with \"s\" appended\n\t\tto denote the unit. The optional `pos` argument is passed through.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function measure<T>( f : Void -> T, ?pos : PosInfos ) : T {\n\t\tvar t0 = stamp();\n\t\tvar r = f();\n\t\tLog.trace((stamp() - t0) + \"s\", pos);\n\t\treturn r;\n\t}\n\n\t/**\n\t\tReturns a timestamp, in seconds with fractions.\n\n\t\tThe value itself might differ depending on platforms, only differences\n\t\tbetween two values make sense.\n\t**/\n\tpublic static function stamp() : Float {\n\t\t#if flash\n\t\t\treturn flash.Lib.getTimer() / 1000;\n\t\t#elseif (neko || php)\n\t\t\treturn Sys.time();\n\t\t#elseif js\n\t\t\treturn Date.now().getTime() / 1000;\n\t\t#elseif cpp\n\t\t\treturn untyped __global__.__time_stamp();\n\t\t#elseif sys\n\t\t\treturn Sys.time();\n\t\t#else\n\t\t\treturn 0;\n\t\t#end\n\t}\n\n}\n\n#if java\n@:nativeGen\nprivate class TimerTask extends java.util.TimerTask {\n\tvar timer:Timer;\n\tpublic function new(timer:Timer):Void {\n\t\tsuper();\n\t\tthis.timer = timer;\n\t}\n\n\t@:overload override public function run():Void {\n\t\ttimer.run();\n\t}\n}\n#end\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n@:noDoc\ntypedef TypeResolver = {\n\tfunction resolveClass( name : String ) : Class<Dynamic>;\n\tfunction resolveEnum( name : String ) : Enum<Dynamic>;\n}\n\n/**\n\tThe Unserializer class is the complement to the Serializer class. It parses\n\ta serialization String and creates objects from the contained data.\n\n\tThis class can be used in two ways:\n\n\t- create a new Unserializer() instance with a given serialization\n\t\tString, then call its unserialize() method until all values are\n\t\textracted\n\t- call Unserializer.run() to unserialize a single value from a given\n\t\tString\n**/\nclass Unserializer {\n\n\t/**\n\t\tThis value can be set to use custom type resolvers.\n\n\t\tA type resolver finds a Class or Enum instance from a given String. By\n\t\tdefault, the haxe Type Api is used.\n\n\t\tA type resolver must provide two methods:\n\n\t\t1. resolveClass(name:String):Class<Dynamic> is called to determine a\n\t\t\t\tClass from a class name\n\t\t2. resolveEnum(name:String):Enum<Dynamic> is called to determine an\n\t\t\t\tEnum from an enum name\n\n\t\tThis value is applied when a new Unserializer instance is created.\n\t\tChanging it afterwards has no effect on previously created instances.\n\t**/\n\tpublic static var DEFAULT_RESOLVER : TypeResolver = Type;\n\n\tstatic var BASE64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:\";\n\n\t#if !neko\n\tstatic var CODES = null;\n\n\tstatic function initCodes() {\n\t\tvar codes =\n\t\t\t#if flash\n\t\t\t\tnew flash.utils.ByteArray();\n\t\t\t#else\n\t\t\t\tnew Array();\n\t\t\t#end\n\t\tfor( i in 0...BASE64.length )\n\t\t\tcodes[StringTools.fastCodeAt(BASE64,i)] = i;\n\t\treturn codes;\n\t}\n\t#end\n\n \tvar buf : String;\n \tvar pos : Int;\n \tvar length : Int;\n \tvar cache : Array<Dynamic>;\n \tvar scache : Array<String>;\n \tvar resolver : TypeResolver;\n \t#if neko\n \tvar upos : Int;\n \t#end\n\n\t/**\n\t\tCreates a new Unserializer instance, with its internal buffer\n\t\tinitialized to `buf`.\n\n\t\tThis does not parse `buf` immediately. It is parsed only when calls to\n\t\t`this.unserialize` are made.\n\n\t\tEach Unserializer instance maintains its own cache.\n\t**/\n \tpublic function new( buf : String ) {\n \t\tthis.buf = buf;\n \t\tlength = buf.length;\n \t\tpos = 0;\n \t\t#if neko\n \t\tupos = 0;\n \t\t#end\n \t\tscache = new Array();\n \t\tcache = new Array();\n\t\tvar r = DEFAULT_RESOLVER;\n\t\tif( r == null ) {\n\t\t\tr = Type;\n\t\t\tDEFAULT_RESOLVER = r;\n\t\t}\n \t\tsetResolver(r);\n \t}\n\n\t/**\n\t\tSets the type resolver of `this` Unserializer instance to `r`.\n\n\t\tIf `r` is null, a special resolver is used which returns null for all\n\t\tinput values.\n\n\t\tSee DEFAULT_RESOLVER for more information on type resolvers.\n\t**/\n \tpublic function setResolver( r ) {\n\t\tif( r == null )\n\t\t\tresolver = {\n\t\t\t\tresolveClass : function(_) { return null; },\n\t\t\t\tresolveEnum : function(_) { return null; }\n\t\t\t};\n\t\telse\n\t\t\tresolver = r;\n\t}\n\n\t/**\n\t\tGets the type resolver of `this` Unserializer instance.\n\n\t\tSee DEFAULT_RESOLVER for more information on type resolvers.\n\t**/\n \tpublic function getResolver() {\n\t\treturn resolver;\n\t}\n\n\tinline function get(p) : Int {\n\t\treturn StringTools.fastCodeAt(buf, p);\n\t}\n\n \tfunction readDigits() {\n \t\tvar k = 0;\n \t\tvar s = false;\n \t\tvar fpos = pos;\n \t\twhile( true ) {\n \t\t\tvar c = get(pos);\n\t\t\tif( StringTools.isEof(c) )\n\t\t\t\tbreak;\n \t\t\tif( c == \"-\".code ) {\n \t\t\t\tif( pos != fpos )\n \t\t\t\t\tbreak;\n \t\t\t\ts = true;\n \t\t\t\tpos++;\n \t\t\t\tcontinue;\n \t\t\t}\n \t\t\tif( c < \"0\".code || c > \"9\".code )\n \t\t\t\tbreak;\n \t\t\tk = k * 10 + (c - \"0\".code);\n \t\t\tpos++;\n \t\t}\n \t\tif( s )\n \t\t\tk *= -1;\n \t\treturn k;\n \t}\n\n\tfunction readFloat() {\n\t\tvar p1 = pos;\n \t\twhile( true ) {\n \t\t\tvar c = get(pos);\n \t\t\t// + - . , 0-9\n \t\t\tif( (c >= 43 && c < 58) || c == \"e\".code || c == \"E\".code )\n \t\t\t\tpos++;\n \t\t\telse\n \t\t\t\tbreak;\n \t\t}\n \t\treturn Std.parseFloat(buf.substr(p1,pos-p1));\n\t}\n\n\tfunction unserializeObject(o) {\n \t\twhile( true ) {\n \t\t\tif( pos >= length )\n \t\t\t\tthrow \"Invalid object\";\n \t\t\tif( get(pos) == \"g\".code )\n \t\t\t\tbreak;\n \t\t\tvar k = unserialize();\n \t\t\tif( !Std.is(k,String) )\n \t\t\t\tthrow \"Invalid object key\";\n \t\t\tvar v = unserialize();\n \t\t\tReflect.setField(o,k,v);\n \t\t}\n \t\tpos++;\n\t}\n\n\tfunction unserializeEnum( edecl, tag ) {\n\t\tif( get(pos++) != \":\".code )\n\t\t\tthrow \"Invalid enum format\";\n\t\tvar nargs = readDigits();\n\t\tif( nargs == 0 )\n\t\t\treturn Type.createEnum(edecl,tag);\n\t\tvar args = new Array();\n\t\twhile( nargs-- > 0 )\n\t\t\targs.push(unserialize());\n\t\treturn Type.createEnum(edecl,tag,args);\n\t}\n\n\t/**\n\t\tUnserializes the next part of `this` Unserializer instance and returns\n\t\tthe according value.\n\n\t\tThis function may call `this.resolver.resolveClass` to determine a\n\t\tClass from a String, and `this.resolver.resolveEnum` to determine an\n\t\tEnum from a String.\n\n\t\tIf `this` Unserializer instance contains no more or invalid data, an\n\t\texception is thrown.\n\n\t\tThis operation may fail on structurally valid data if a type cannot be\n\t\tresolved or if a field cannot be set. This can happen when unserializing\n\t\tStrings that were serialized on a different haxe target, in which the\n\t\tserialization side has to make sure not to include platform-specific\n\t\tdata.\n\n\t\tClasses are created from Type.createEmptyInstance, which means their\n\t\tconstructors are not called.\n\t**/\n \tpublic function unserialize() : Dynamic {\n \t\tswitch( get(pos++) ) {\n \t\tcase \"n\".code:\n \t\t\treturn null;\n \t\tcase \"t\".code:\n \t\t\treturn true;\n \t\tcase \"f\".code:\n \t\t\treturn false;\n \t\tcase \"z\".code:\n \t\t\treturn 0;\n \t\tcase \"i\".code:\n \t\t\treturn readDigits();\n \t\tcase \"d\".code:\n \t\t\treturn readFloat();\n\t\tcase \"y\".code:\n \t\t\tvar len = readDigits();\n \t\t\tif( get(pos++) != \":\".code || length - pos < len )\n \t\t\t\tthrow \"Invalid string length\";\n\t\t\tvar s = buf.substr(pos,len);\n\t\t\tpos += len;\n\t\t\ts = StringTools.urlDecode(s);\n\t\t\tscache.push(s);\n\t\t\treturn s;\n \t\tcase \"k\".code:\n \t\t\treturn Math.NaN;\n \t\tcase \"m\".code:\n \t\t\treturn Math.NEGATIVE_INFINITY;\n \t\tcase \"p\".code:\n \t\t\treturn Math.POSITIVE_INFINITY;\n \t\tcase \"a\".code:\n\t\t\tvar buf = buf;\n \t\t\tvar a = new Array<Dynamic>();\n \t\t\tcache.push(a);\n \t\t\twhile( true ) {\n \t\t\t\tvar c = get(pos);\n \t\t\t\tif( c == \"h\".code ) {\n\t\t\t\t\tpos++;\n \t\t\t\t\tbreak;\n\t\t\t\t}\n \t\t\t\tif( c == \"u\".code ) {\n\t\t\t\t\tpos++;\n \t\t\t\t\tvar n = readDigits();\n \t\t\t\t\ta[a.length+n-1] = null;\n \t\t\t\t} else\n \t\t\t\t\ta.push(unserialize());\n \t\t\t}\n \t\t\treturn a;\n \t\tcase \"o\".code:\n\t \t\tvar o = {};\n\t \t\tcache.push(o);\n\t\t\tunserializeObject(o);\n\t\t\treturn o;\n \t\tcase \"r\".code:\n \t\t\tvar n = readDigits();\n \t\t\tif( n < 0 || n >= cache.length )\n \t\t\t\tthrow \"Invalid reference\";\n \t\t\treturn cache[n];\n \t\tcase \"R\".code:\n\t\t\tvar n = readDigits();\n\t\t\tif( n < 0 || n >= scache.length )\n\t\t\t\tthrow \"Invalid string reference\";\n\t\t\treturn scache[n];\n \t\tcase \"x\".code:\n\t\t\tthrow unserialize();\n\t\tcase \"c\".code:\n\t \t\tvar name = unserialize();\n\t\t\tvar cl = resolver.resolveClass(name);\n\t\t\tif( cl == null )\n\t\t\t\tthrow \"Class not found \" + name;\n\t\t\tvar o = Type.createEmptyInstance(cl);\n\t\t\tcache.push(o);\n\t\t\tunserializeObject(o);\n\t\t\treturn o;\n\t\tcase \"w\".code:\n\t\t\tvar name = unserialize();\n\t\t\tvar edecl = resolver.resolveEnum(name);\n\t\t\tif( edecl == null )\n\t\t\t\tthrow \"Enum not found \" + name;\n\t\t\tvar e = unserializeEnum(edecl, unserialize());\n\t\t\tcache.push(e);\n\t\t\treturn e;\n \t\tcase \"j\".code:\n\t\t\tvar name = unserialize();\n\t\t\tvar edecl = resolver.resolveEnum(name);\n\t\t\tif( edecl == null )\n\t\t\t\tthrow \"Enum not found \" + name;\n\t\t\tpos++; /* skip ':' */\n\t\t\tvar index = readDigits();\n\t\t\tvar tag = Type.getEnumConstructs(edecl)[index];\n\t\t\tif( tag == null )\n\t\t\t\tthrow \"Unknown enum index \"+name+\"@\"+index;\n\t\t\tvar e = unserializeEnum(edecl, tag);\n\t\t\tcache.push(e);\n\t\t\treturn e;\n\t\tcase \"l\".code:\n\t\t\tvar l = new List();\n\t\t\tcache.push(l);\n\t\t\tvar buf = buf;\n\t\t\twhile( get(pos) != \"h\".code )\n\t\t\t\tl.add(unserialize());\n\t\t\tpos++;\n\t\t\treturn l;\n\t\tcase \"b\".code:\n\t\t\tvar h = new haxe.ds.StringMap();\n\t\t\tcache.push(h);\n\t\t\tvar buf = buf;\n\t\t\twhile( get(pos) != \"h\".code ) {\n\t\t\t\tvar s = unserialize();\n\t\t\t\th.set(s,unserialize());\n\t\t\t}\n\t\t\tpos++;\n\t\t\treturn h;\n\t\tcase \"q\".code:\n\t\t\tvar h = new haxe.ds.IntMap();\n\t\t\tcache.push(h);\n\t\t\tvar buf = buf;\n\t\t\tvar c = get(pos++);\n\t\t\twhile( c == \":\".code ) {\n\t\t\t\tvar i = readDigits();\n\t\t\t\th.set(i,unserialize());\n\t\t\t\tc = get(pos++);\n\t\t\t}\n\t\t\tif( c != \"h\".code )\n\t\t\t\tthrow \"Invalid IntMap format\";\n\t\t\treturn h;\n\t\tcase \"M\".code:\n\t\t\tvar h = new haxe.ds.ObjectMap();\n\t\t\tcache.push(h);\n\t\t\tvar buf = buf;\n\t\t\twhile( get(pos) != \"h\".code ) {\n\t\t\t\tvar s = unserialize();\n\t\t\t\th.set(s,unserialize());\n\t\t\t}\n\t\t\tpos++;\n\t\t\treturn h;\n\t\tcase \"v\".code:\n\t\t\tvar d;\n\t\t\tif(\tget(pos) >= '0'.code && get(pos) <= '9'.code &&\n\t\t\t\tget(pos + 1) >= '0'.code && get(pos + 1) <= '9'.code &&\n\t\t\t\tget(pos + 2) >= '0'.code && get(pos + 2) <= '9'.code &&\n\t\t\t\tget(pos + 3) >= '0'.code && get(pos + 3) <= '9'.code &&\n\t\t\t\tget(pos + 4) == '-'.code\n\t\t\t\t) {\n\t\t\t\t// Included for backwards compatibility\n\t\t\t\td = Date.fromString(buf.substr(pos,19));\n\t\t\t\tpos += 19;\n\t\t\t} else\n\t\t\t\td = Date.fromTime(readFloat());\n\t\t\tcache.push(d);\n\t\t\treturn d;\n \t\tcase \"s\".code:\n \t\t\tvar len = readDigits();\n\t\t\tvar buf = buf;\n \t\t\tif( get(pos++) != \":\".code || length - pos < len )\n\t\t\t\tthrow \"Invalid bytes length\";\n\t\t\t#if neko\n\t\t\tvar bytes = haxe.io.Bytes.ofData( base_decode(untyped buf.substr(pos,len).__s,untyped BASE64.__s) );\n\t\t\t#else\n\t\t\tvar codes = CODES;\n\t\t\tif( codes == null ) {\n\t\t\t\tcodes = initCodes();\n\t\t\t\tCODES = codes;\n\t\t\t}\n\t\t\tvar i = pos;\n\t\t\tvar rest = len & 3;\n\t\t\tvar size = (len >> 2) * 3 + ((rest >= 2) ? rest - 1 : 0);\n\t\t\tvar max = i + (len - rest);\n\t\t\tvar bytes = haxe.io.Bytes.alloc(size);\n\t\t\tvar bpos = 0;\n\t\t\twhile( i < max ) {\n\t\t\t\tvar c1 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tvar c2 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tbytes.set(bpos++,(c1 << 2) | (c2 >> 4));\n\t\t\t\tvar c3 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tbytes.set(bpos++,(c2 << 4) | (c3 >> 2));\n\t\t\t\tvar c4 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tbytes.set(bpos++,(c3 << 6) | c4);\n\t\t\t}\n\t\t\tif( rest >= 2 ) {\n\t\t\t\tvar c1 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tvar c2 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\tbytes.set(bpos++,(c1 << 2) | (c2 >> 4));\n\t\t\t\tif( rest == 3 ) {\n\t\t\t\t\tvar c3 = codes[StringTools.fastCodeAt(buf,i++)];\n\t\t\t\t\tbytes.set(bpos++,(c2 << 4) | (c3 >> 2));\n\t\t\t\t}\n\t\t\t}\n \t\t\t#end\n\t\t\tpos += len;\n\t\t\tcache.push(bytes);\n\t\t\treturn bytes;\n\t\tcase \"C\".code:\n\t \t\tvar name = unserialize();\n\t\t\tvar cl = resolver.resolveClass(name);\n\t\t\tif( cl == null )\n\t\t\t\tthrow \"Class not found \" + name;\n\t\t\tvar o : Dynamic = Type.createEmptyInstance(cl);\n\t\t\tcache.push(o);\n\t\t\to.hxUnserialize(this);\n\t\t\tif( get(pos++) != \"g\".code )\n\t\t\t\tthrow \"Invalid custom data\";\n\t\t\treturn o;\n\t\tcase \"A\".code:\n\t\t\tvar name = unserialize();\n\t\t\tvar cl = resolver.resolveClass(name);\n\t\t\tif( cl == null )\n\t\t\t\tthrow \"Class not found \" + name;\n\t\t\treturn cl;\n\t\tcase \"B\".code:\n\t\t\tvar name = unserialize();\n\t\t\tvar e = resolver.resolveEnum(name);\n\t\t\tif( e == null )\n\t\t\t\tthrow \"Enum not found \" + name;\n\t\t\treturn e;\n \t\tdefault:\n \t\t}\n \t\tpos--;\n \t\tthrow (\"Invalid char \"+buf.charAt(pos)+\" at position \"+pos);\n \t}\n\n\t/**\n\t\tUnserializes `v` and returns the according value.\n\n\t\tThis is a convenience function for creating a new instance of\n\t\tUnserializer with `v` as buffer and calling its unserialize() method\n\t\tonce.\n\t**/\n\tpublic static function run( v : String ) : Dynamic {\n\t\treturn new Unserializer(v).unserialize();\n\t}\n\n\t#if neko\n\tstatic var base_decode = neko.Lib.load(\"std\",\"base_decode\",2);\n\t#end\n\n}\n","/*\n * Copyright (C)2005-2014 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.io;\nimport js.html.compat.Uint8Array;\nimport js.html.compat.DataView;\n\n@:coreApi\nclass Bytes {\n\n\tpublic var length(default,null) : Int;\n\tvar b : js.html.Uint8Array;\n\tvar data : js.html.DataView;\n\n\tfunction new(data:BytesData) {\n\t\tthis.length = data.byteLength;\n\t\tthis.b = new js.html.Uint8Array(data);\n\t\tuntyped {\n\t\t\tb.bufferValue = data; // some impl does not return the same instance in .buffer\n\t\t\tdata.hxBytes = this;\n\t\t\tdata.bytes = this.b;\n\t\t}\n\t}\n\n\tpublic inline function get( pos : Int ) : Int {\n\t\treturn b[pos];\n\t}\n\n\tpublic inline function set( pos : Int, v : Int ) : Void {\n\t\tb[pos] = v & 0xFF; // the &0xFF is necessary for js.html.compat support\n\t}\n\n\tpublic function blit( pos : Int, src : Bytes, srcpos : Int, len : Int ) : Void {\n\t\tif( pos < 0 || srcpos < 0 || len < 0 || pos + len > length || srcpos + len > src.length ) throw Error.OutsideBounds;\n\t\tif( srcpos == 0 && len == src.length )\n\t\t\tb.set(src.b,pos);\n\t\telse\n\t\t\tb.set(src.b.subarray(srcpos,srcpos+len),pos);\n\t}\n\n\tpublic function fill( pos : Int, len : Int, value : Int ) : Void {\n\t\tfor( i in 0...len )\n\t\t\tset(pos++, value);\n\t}\n\n\tpublic function sub( pos : Int, len : Int ) : Bytes {\n\t\tif( pos < 0 || len < 0 || pos + len > length ) throw Error.OutsideBounds;\n\t\treturn new Bytes(b.buffer.slice(pos+b.byteOffset,pos+b.byteOffset+len));\n\t}\n\n\tpublic function compare( other : Bytes ) : Int {\n\t\tvar b1 = b;\n\t\tvar b2 = other.b;\n\t\tvar len = (length < other.length) ? length : other.length;\n\t\tfor( i in 0...len )\n\t\t\tif( b1[i] != b2[i] )\n\t\t\t\treturn b1[i] - b2[i];\n\t\treturn length - other.length;\n\t}\n\n\tinline function initData() : Void {\n\t\tif( data == null ) data = new js.html.DataView(b.buffer, b.byteOffset, b.byteLength);\n\t}\n\n\tpublic function getDouble( pos : Int ) : Float {\n\t\tinitData();\n\t\treturn data.getFloat64(pos, true);\n\t}\n\n\tpublic function getFloat( pos : Int ) : Float {\n\t\tinitData();\n\t\treturn data.getFloat32(pos, true);\n\t}\n\n\tpublic function setDouble( pos : Int, v : Float ) : Void {\n\t\tinitData();\n\t\tdata.setFloat64(pos, v, true);\n\t}\n\n\tpublic function setFloat( pos : Int, v : Float ) : Void {\n\t\tinitData();\n\t\tdata.setFloat32(pos, v, true);\n\t}\n\n\tpublic function getUInt16( pos : Int ) : Int {\n\t\tinitData();\n\t\treturn data.getUint16(pos, true);\n\t}\n\n\tpublic function setUInt16( pos : Int, v : Int ) : Void {\n\t\tinitData();\n\t\tdata.setUint16(pos, v, true);\n\t}\n\n\tpublic function getInt32( pos : Int ) : Int {\n\t\tinitData();\n\t\treturn data.getInt32(pos, true);\n\t}\n\n\tpublic function setInt32( pos : Int, v : Int ) : Void {\n\t\tinitData();\n\t\tdata.setInt32(pos, v, true);\n\t}\n\n\tpublic function getInt64( pos : Int ) : haxe.Int64 {\n\t\treturn Int64.make(getInt32(pos + 4),getInt32(pos));\n\t}\n\n\tpublic function setInt64( pos : Int, v : haxe.Int64 ) : Void {\n\t\tsetInt32(pos, v.low);\n\t\tsetInt32(pos + 4, v.high);\n\t}\n\n\tpublic function getString( pos : Int, len : Int ) : String {\n\t\tif( pos < 0 || len < 0 || pos + len > length ) throw Error.OutsideBounds;\n\t\tvar s = \"\";\n\t\tvar b = b;\n\t\tvar fcc = String.fromCharCode;\n\t\tvar i = pos;\n\t\tvar max = pos+len;\n\t\t// utf8-decode and utf16-encode\n\t\twhile( i < max ) {\n\t\t\tvar c = b[i++];\n\t\t\tif( c < 0x80 ) {\n\t\t\t\tif( c == 0 ) break;\n\t\t\t\ts += fcc(c);\n\t\t\t} else if( c < 0xE0 )\n\t\t\t\ts += fcc( ((c & 0x3F) << 6) | (b[i++] & 0x7F) );\n\t\t\telse if( c < 0xF0 ) {\n\t\t\t\tvar c2 = b[i++];\n\t\t\t\ts += fcc( ((c & 0x1F) << 12) | ((c2 & 0x7F) << 6) | (b[i++] & 0x7F) );\n\t\t\t} else {\n\t\t\t\tvar c2 = b[i++];\n\t\t\t\tvar c3 = b[i++];\n\t\t\t\tvar u = ((c & 0x0F) << 18) | ((c2 & 0x7F) << 12) | ((c3 & 0x7F) << 6) | (b[i++] & 0x7F);\n\t\t\t\t// surrogate pair\n\t\t\t\ts += fcc( (u >> 10) + 0xD7C0 );\n\t\t\t\ts += fcc( (u & 0x3FF) | 0xDC00 );\n\t\t\t}\n\t\t}\n\t\treturn s;\n\t}\n\n\t@:deprecated(\"readString is deprecated, use getString instead\")\n\t@:noCompletion\n\tpublic inline function readString(pos:Int, len:Int):String {\n\t\treturn getString(pos, len);\n\t}\n\n\tpublic function toString() : String {\n\t\treturn getString(0,length);\n\t}\n\n\tpublic function toHex() : String {\n\t\tvar s = new StringBuf();\n\t\tvar chars = [];\n\t\tvar str = \"0123456789abcdef\";\n\t\tfor( i in 0...str.length )\n\t\t\tchars.push(str.charCodeAt(i));\n\t\tfor( i in 0...length ) {\n\t\t\tvar c = get(i);\n\t\t\ts.addChar(chars[c >> 4]);\n\t\t\ts.addChar(chars[c & 15]);\n\t\t}\n\t\treturn s.toString();\n\t}\n\n\tpublic inline function getData() : BytesData {\n\t\treturn untyped b.bufferValue;\n\t}\n\n\tpublic static function alloc( length : Int ) : Bytes {\n\t\treturn new Bytes(new BytesData(length));\n\t}\n\n\tpublic static function ofString( s : String ) : Bytes {\n\t\tvar a = new Array();\n\t\t// utf16-decode and utf8-encode\n\t\tvar i = 0;\n\t\twhile( i < s.length ) {\n\t\t\tvar c : Int = StringTools.fastCodeAt(s,i++);\n\t\t\t// surrogate pair\n\t\t\tif( 0xD800 <= c && c <= 0xDBFF )\n\t\t\t    c = (c - 0xD7C0 << 10) | (StringTools.fastCodeAt(s,i++) & 0x3FF);\n\t\t\tif( c <= 0x7F )\n\t\t\t\ta.push(c);\n\t\t\telse if( c <= 0x7FF ) {\n\t\t\t\ta.push( 0xC0 | (c >> 6) );\n\t\t\t\ta.push( 0x80 | (c & 63) );\n\t\t\t} else if( c <= 0xFFFF ) {\n\t\t\t\ta.push( 0xE0 | (c >> 12) );\n\t\t\t\ta.push( 0x80 | ((c >> 6) & 63) );\n\t\t\t\ta.push( 0x80 | (c & 63) );\n\t\t\t} else {\n\t\t\t\ta.push( 0xF0 | (c >> 18) );\n\t\t\t\ta.push( 0x80 | ((c >> 12) & 63) );\n\t\t\t\ta.push( 0x80 | ((c >> 6) & 63) );\n\t\t\t\ta.push( 0x80 | (c & 63) );\n\t\t\t}\n\t\t}\n\t\treturn new Bytes(new js.html.Uint8Array(a).buffer);\n\t}\n\n\tpublic static function ofData( b : BytesData ) : Bytes {\n\t\tvar hb = untyped b.hxBytes;\n\t\tif( hb != null ) return hb;\n\t\treturn new Bytes(b);\n\t}\n\n\tpublic inline static function fastGet( b : BytesData, pos : Int ) : Int {\n\t\t// this requires that we have wrapped it with haxe.io.Bytes beforehand\n\t\treturn untyped b.bytes[pos];\n\t}\n\n}\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.crypto;\n\n/**\n\tAllows to encode/decode String and bytes using Base64 encoding.\n**/\nclass Base64 {\n\n\tpublic static var CHARS(default,null) = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\tpublic static var BYTES(default,null) = haxe.io.Bytes.ofString(CHARS);\n\n\tpublic static function encode( bytes : haxe.io.Bytes, complement = true ) : String {\n\t\tvar str = new BaseCode(BYTES).encodeBytes(bytes).toString();\n\t\tif( complement )\n\t\t\tswitch (bytes.length % 3) {\n\t\t\tcase 1:\n\t\t\t\tstr += \"==\";\n\t\t\tcase 2:\n\t\t\t\tstr += \"=\";\n\t\t\tdefault:\n\t\t\t}\n\t\treturn str;\n\t}\n\n\tpublic static function decode( str : String, complement = true ) : haxe.io.Bytes {\n\t\tif( complement )\n\t\t\twhile( str.charCodeAt(str.length-1) == \"=\".code )\n\t\t\t\tstr = str.substr(0,-1);\n\t\treturn new BaseCode(BYTES).decodeBytes(haxe.io.Bytes.ofString(str));\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.crypto;\n\n/**\n\tAllows to encode/decode String and bytes using a power of two base dictionnary.\n**/\nclass BaseCode {\n\n\tvar base : haxe.io.Bytes;\n\tvar nbits : Int;\n\tvar tbl : Array<Int>;\n\n\tpublic function new( base : haxe.io.Bytes ) {\n\t\tvar len = base.length;\n\t\tvar nbits = 1;\n\t\twhile( len > 1 << nbits )\n\t\t\tnbits++;\n\t\tif( nbits > 8 || len != 1 << nbits )\n\t\t\tthrow \"BaseCode : base length must be a power of two.\";\n\t\tthis.base = base;\n\t\tthis.nbits = nbits;\n\t}\n\n\tpublic function encodeBytes( b : haxe.io.Bytes ) : haxe.io.Bytes {\n\t\t#if (neko && !interp)\n\t\treturn haxe.io.Bytes.ofData( base_encode(b.getData(),base.getData()) );\n\t\t#else\n\t\tvar nbits = this.nbits;\n\t\tvar base = this.base;\n\t\tvar size = Std.int(b.length * 8 / nbits);\n\t\tvar out = haxe.io.Bytes.alloc(size + (((b.length * 8) % nbits == 0) ? 0 : 1) );\n\t\tvar buf = 0;\n\t\tvar curbits = 0;\n\t\tvar mask = (1 << nbits) - 1;\n\t\tvar pin = 0;\n\t\tvar pout = 0;\n\t\twhile( pout < size ) {\n\t\t\twhile( curbits < nbits ) {\n\t\t\t\tcurbits += 8;\n\t\t\t\tbuf <<= 8;\n\t\t\t\tbuf |= b.get(pin++);\n\t\t\t}\n\t\t\tcurbits -= nbits;\n\t\t\tout.set(pout++,base.get((buf >> curbits) & mask));\n\t\t}\n\t\tif( curbits > 0 )\n\t\t\tout.set(pout++,base.get((buf << (nbits - curbits)) & mask));\n\t\treturn out;\n\t\t#end\n\t}\n\n\tfunction initTable() {\n\t\tvar tbl = new Array();\n\t\tfor( i in 0...256 )\n\t\t\ttbl[i] = -1;\n\t\tfor( i in 0...base.length )\n\t\t\ttbl[base.get(i)] = i;\n\t\tthis.tbl = tbl;\n\t}\n\n\tpublic function decodeBytes( b : haxe.io.Bytes ) : haxe.io.Bytes {\n\t\t#if (neko && !interp)\n\t\treturn haxe.io.Bytes.ofData( base_decode(b.getData(),base.getData()) );\n\t\t#else\n\t\tvar nbits = this.nbits;\n\t\tvar base = this.base;\n\t\tif( this.tbl == null ) initTable();\n\t\tvar tbl = this.tbl;\n\t\tvar size = (b.length * nbits) >> 3;\n\t\tvar out = haxe.io.Bytes.alloc(size);\n\t\tvar buf = 0;\n\t\tvar curbits = 0;\n\t\tvar pin = 0;\n\t\tvar pout = 0;\n\t\twhile( pout < size ) {\n\t\t\twhile( curbits < 8 ) {\n\t\t\t\tcurbits += nbits;\n\t\t\t\tbuf <<= nbits;\n\t\t\t\tvar i = tbl[b.get(pin++)];\n\t\t\t\tif( i == -1 )\n\t\t\t\t\tthrow \"BaseCode : invalid encoded char\";\n\t\t\t\tbuf |= i;\n\t\t\t}\n\t\t\tcurbits -= 8;\n\t\t\tout.set(pout++,(buf >> curbits) & 0xFF);\n\t\t}\n\t\treturn out;\n\t\t#end\n\t}\n\n\tpublic function encodeString( s : String ) {\n\t\t#if (neko && !interp)\n\t\treturn neko.NativeString.toString( base_encode(neko.NativeString.ofString(s),base.getData()) );\n\t\t#else\n\t\treturn encodeBytes(haxe.io.Bytes.ofString(s)).toString();\n\t\t#end\n\t}\n\n\tpublic function decodeString( s : String ) {\n\t\t#if (neko && !interp)\n\t\treturn neko.NativeString.toString( base_decode(neko.NativeString.ofString(s),base.getData()) );\n\t\t#else\n\t\treturn decodeBytes(haxe.io.Bytes.ofString(s)).toString();\n\t\t#end\n\t}\n\n\tpublic static function encode( s : String, base : String ) {\n\t\tvar b = new BaseCode(haxe.io.Bytes.ofString(base));\n\t\treturn b.encodeString(s);\n\t}\n\n\tpublic static function decode( s : String, base : String ) {\n\t\tvar b = new BaseCode(haxe.io.Bytes.ofString(base));\n\t\treturn b.decodeString(s);\n\t}\n\n\t#if neko\n\tprivate static var base_encode = neko.Lib.load(\"std\",\"base_encode\",2);\n\tprivate static var base_decode = neko.Lib.load(\"std\",\"base_decode\",2);\n\t#end\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\n#if (flash || cpp)\n@:generic\n#end\nclass GenericCell<T> {\n\tpublic var elt : T;\n\tpublic var next : GenericCell<T>;\n\tpublic function new(elt,next) { this.elt = elt; this.next = next; }\n}\n\n#if cpp\n@:generic\nprivate class GenericStackIterator<T> extends cpp.FastIterator<T> {\n\tpublic var current : GenericCell<T>;\n\toverride public function hasNext():Bool { return current!=null; }\n\toverride public function next():T { var result = current.elt; current = current.next; return result; }\n\n\tpublic function new(head) { current = head; }\n}\n\n#end\n\n/**\n\tA stack of elements.\n\n\tThis class is generic, which means one type is generated for each type\n\tparameter T on static targets. For example:\n\n\t- `new GenericStack<Int>()` generates `GenericStack_Int`\n\t- `new GenericStack<String>()` generates `GenericStack_String`\n\n\tThe generated name is an implementation detail and should not be relied\n\tupon.\n**/\n#if (flash || cpp)\n@:generic\n#end\nclass GenericStack<T> {\n\n\tpublic var head : GenericCell<T>;\n\n\t/**\n\t\tCreates a new empty GenericStack.\n\t**/\n\tpublic function new() {\n\t}\n\n\t/**\n\t\tPushes element `item` onto the stack.\n\t**/\n\tpublic inline function add( item : T ) {\n\t\thead = new GenericCell<T>(item,head);\n\t}\n\n\t/**\n\t\tReturns the topmost stack element without removing it.\n\n\t\tIf the stack is empty, null is returned.\n\t**/\n\tpublic inline function first() : Null<T> {\n\t\treturn if( head == null ) null else head.elt;\n\t}\n\n\t/**\n\t\tReturns the topmost stack element and removes it.\n\n\t\tIf the stack is empty, null is returned.\n\t**/\n\tpublic inline function pop() : Null<T> {\n\t\tvar k = head;\n\t\tif( k== null )\n\t\t\treturn null;\n\t\telse {\n\t\t\thead = k.next;\n\t\t\treturn k.elt;\n\t\t}\n\t}\n\n\t/**\n\t\tTells if the stack is empty.\n\t**/\n\tpublic inline function isEmpty() : Bool {\n\t\treturn (head == null);\n\t}\n\n\t/**\n\t\tRemoves the first element which is equal to `v` according to the `==`\n\t\toperator.\n\n\t\tThis method traverses the stack until it finds a matching element and\n\t\tunlinks it, returning true.\n\n\t\tIf no matching element is found, false is returned.\n\t**/\n\tpublic function remove( v : T ) : Bool {\n\t\tvar prev:GenericCell<T> = null;\n\t\tvar l = head;\n\t\twhile( l != null ) {\n\t\t\tif( l.elt == v ) {\n\t\t\t\tif( prev == null )\n\t\t\t\t\thead = l.next;\n\t\t\t\telse\n\t\t\t\t\tprev.next = l.next;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprev = l;\n\t\t\tl = l.next;\n\t\t}\n\t\treturn (l != null);\n\t}\n\n\t#if cpp\n\n\t/**\n\t\tReturns an iterator over the elements of `this` GenericStack.\n\t**/\n\tpublic function iterator() : Iterator<T> {\n\t\treturn new GenericStackIterator<T>(head);\n\t}\n\n\t#else\n\n\t/**\n\t\tReturns an iterator over the elements of `this` GenericStack.\n\t**/\n\tpublic function iterator() : Iterator<T> {\n\t\tvar l = head;\n\t\treturn {\n\t\t\thasNext : function() {\n\t\t\t\treturn l != null;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\tvar k = l;\n\t\t\t\tl = k.next;\n\t\t\t\treturn k.elt;\n\t\t\t}\n\t\t};\n\t}\n   #end\n\n\t/**\n\t\tReturns a String representation of `this` GenericStack.\n\t**/\n\tpublic function toString() {\n\t\tvar a = new Array();\n\t\tvar l = head;\n\t\twhile( l != null ) {\n\t\t\ta.push(l.elt);\n\t\t\tl = l.next;\n\t\t}\n\t\treturn \"{\"+a.join(\",\")+\"}\";\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\n@:coreApi class IntMap<T> implements haxe.Constraints.IMap<Int,T> {\n\n\tprivate var h : Dynamic;\n\n\tpublic inline function new() : Void {\n\t\th = {};\n\t}\n\n\tpublic inline function set( key : Int, value : T ) : Void {\n\t\tuntyped h[key] = value;\n\t}\n\n\tpublic inline function get( key : Int ) : Null<T> {\n\t\treturn untyped h[key];\n\t}\n\n\tpublic inline function exists( key : Int ) : Bool {\n\t\treturn untyped h.hasOwnProperty(key);\n\t}\n\n\tpublic function remove( key : Int ) : Bool {\n\t\tif( untyped !h.hasOwnProperty(key) ) return false;\n\t\tuntyped  __js__(\"delete\")(h[key]);\n\t\treturn true;\n\t}\n\n\tpublic function keys() : Iterator<Int> {\n\t\tvar a = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\ta.push(key|0);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a.iterator();\n\t}\n\n\tpublic function iterator() : Iterator<T> {\n\t\treturn untyped {\n\t\t\tref : h,\n\t\t\tit : keys(),\n\t\t\thasNext : function() { return __this__.it.hasNext(); },\n\t\t\tnext : function() { var i = __this__.it.next(); return __this__.ref[i]; }\n\t\t};\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar it = keys();\n\t\tfor( i in it ) {\n\t\t\ts.add(i);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(i)));\n\t\t\tif( it.hasNext() )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n}\n","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of h software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and h permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage haxe.ds;\n\n@:coreApi\nclass ObjectMap<K:{ }, V> implements haxe.Constraints.IMap<K,V> {\n\n\tstatic var count = 0;\n\n\tstatic inline function assignId(obj: { } ):Int {\n\t\treturn untyped obj.__id__ = ++count;\n\t}\n\n\tstatic inline function getId(obj: { } ):Int {\n\t\treturn untyped obj.__id__;\n\t}\n\n\tvar h : { };\n\n\tpublic function new() : Void {\n\t\th = { };\n\t\tuntyped h.__keys__ = { };\n\t}\n\n\tpublic function set(key:K, value:V):Void untyped {\n\t\tvar id : Int = untyped key.__id__ || assignId(key);\n\t\th[id] = value;\n\t\th.__keys__[id] = key;\n\t}\n\n\tpublic inline function get(key:K):Null<V> {\n\t\treturn untyped h[getId(key)];\n\t}\n\n\tpublic inline function exists(key:K):Bool {\n\t\treturn untyped h.__keys__[getId(key)] != null;\n\t}\n\n\tpublic function remove( key : K ) : Bool {\n\t\tvar id = getId(key);\n\t\tif ( untyped h.__keys__[id] == null ) return false;\n\t\tuntyped  __js__(\"delete\")(h[id]);\n\t\tuntyped  __js__(\"delete\")(h.__keys__[id]);\n\t\treturn true;\n\t}\n\n\tpublic function keys() : Iterator<K> {\n\t\tvar a = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h.__keys__ ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\ta.push(h.__keys__[key]);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a.iterator();\n\t}\n\n\tpublic function iterator() : Iterator<V> {\n\t\treturn untyped {\n\t\t\tref : h,\n\t\t\tit : keys(),\n\t\t\thasNext : function() { return __this__.it.hasNext(); },\n\t\t\tnext : function() { var i = __this__.it.next(); return __this__.ref[getId(i)]; }\n\t\t};\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar it = keys();\n\t\tfor( i in it ) {\n\t\t\ts.add(Std.string(i));\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(i)));\n\t\t\tif( it.hasNext() )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\nprivate class StringMapIterator<T> {\n\tvar map : StringMap<T>;\n\tvar keys : Array<String>;\n\tvar index : Int;\n\tvar count : Int;\n\tpublic inline function new(map:StringMap<T>, keys:Array<String>) {\n\t\tthis.map = map;\n\t\tthis.keys = keys;\n\t\tthis.index = 0;\n\t\tthis.count = keys.length;\n\t}\n\tpublic inline function hasNext() {\n\t\treturn index < count;\n\t}\n\tpublic inline function next() {\n\t\treturn map.get(keys[index++]);\n\t}\n}\n\n@:coreApi class StringMap<T> implements haxe.Constraints.IMap<String,T> {\n\n\tprivate var h : Dynamic;\n\tprivate var rh : Dynamic;\n\n\tpublic inline function new() : Void {\n\t\th = {};\n\t}\n\n\tinline function isReserved(key:String) : Bool {\n\t\treturn untyped __js__(\"__map_reserved\")[key] != null;\n\t}\n\n\tpublic inline function set( key : String, value : T ) : Void {\n\t\tif( isReserved(key) )\n\t\t\tsetReserved(key, value);\n\t\telse\n\t\t\th[cast key] = value;\n\t}\n\n\tpublic inline function get( key : String ) : Null<T> {\n\t\tif( isReserved(key) )\n\t\t\treturn getReserved(key);\n\t\treturn h[cast key];\n\t}\n\n\tpublic inline function exists( key : String ) : Bool {\n\t\tif( isReserved(key) )\n\t\t\treturn existsReserved(key);\n\t\treturn h.hasOwnProperty(key);\n\t}\n\n\tfunction setReserved( key : String, value : T ) : Void {\n\t\tif( rh == null ) rh = {};\n\t\trh[cast \"$\"+key] = value;\n\t}\n\n\tfunction getReserved( key : String ) : Null<T> {\n\t\treturn rh == null ? null : rh[cast \"$\"+key];\n\t}\n\n\tfunction existsReserved( key : String ) : Bool {\n\t\tif( rh == null ) return false;\n\t\treturn untyped rh.hasOwnProperty(\"$\"+key);\n\t}\n\n\tpublic function remove( key : String ) : Bool {\n\t\tif( isReserved(key) ) {\n\t\t\tkey = \"$\" + key;\n\t\t\tif( rh == null || !rh.hasOwnProperty(key) ) return false;\n\t\t\tuntyped __js__(\"delete\")(rh[key]);\n\t\t\treturn true;\n\t\t} else {\n\t\t\tif( !h.hasOwnProperty(key) )\n\t\t\t\treturn false;\n\t\t\tuntyped __js__(\"delete\")(h[key]);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tpublic function keys() : Iterator<String> {\n\t\treturn arrayKeys().iterator();\n\t}\n\t\n\tfunction arrayKeys() : Array<String> {\n\t\tvar out = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\tout.push(key);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\tif( rh != null ) untyped {\n\t\t\t__js__(\"for( var key in this.rh ) {\");\n\t\t\t\tif( key.charCodeAt(0) == \"$\".code )\n\t\t\t\t\tout.push(key.substr(1));\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn out;\n\t}\n\n\tpublic inline function iterator() : Iterator<T> {\n\t\treturn new StringMapIterator(this, arrayKeys());\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar keys = arrayKeys();\n\t\tfor( i in 0...keys.length ) {\n\t\t\tvar k = keys[i];\n\t\t\ts.add(k);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(k)));\n\t\t\tif( i < keys.length )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n\tstatic function __init__() : Void {\n\t\tuntyped __js__(\"var __map_reserved = {}\");\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.io;\n\nclass BytesBuffer {\n\n\t#if neko\n\tvar b : Dynamic; // neko string buffer\n\t#elseif flash\n\tvar b : flash.utils.ByteArray;\n\t#elseif php\n\tvar b : String;\n\t#elseif cpp\n\tvar b : BytesData;\n\t#elseif cs\n\tvar b : cs.system.io.MemoryStream;\n\t#elseif java\n\tvar b : java.io.ByteArrayOutputStream;\n\t#else\n\tvar b : Array<Int>;\n\t#end\n\n\t/** The length of the buffer in bytes. **/\n\tpublic var length(get,never) : Int;\n\n\tpublic function new() {\n\t\t#if neko\n\t\tb = untyped StringBuf.__make();\n\t\t#elseif flash\n\t\tb = new flash.utils.ByteArray();\n\t\tb.endian = flash.utils.Endian.LITTLE_ENDIAN;\n\t\t#elseif php\n\t\tb = \"\";\n\t\t#elseif cpp\n\t\tb = new BytesData();\n\t\t#elseif cs\n\t\tb = new cs.system.io.MemoryStream();\n\t\t#elseif java\n\t\tb = new java.io.ByteArrayOutputStream();\n\t\t#else\n\t\tb = new Array();\n\t\t#end\n\t}\n\n\tinline function get_length() : Int {\n\t\t#if neko\n\t\treturn untyped __dollar__ssize( StringBuf.__to_string(b) );\n\t\t#elseif cs\n\t\treturn haxe.Int64.toInt( b.Length );\n\t\t#elseif java\n\t\treturn b.size();\n\t\t#else\n\t\treturn b.length;\n\t\t#end\n\t}\n\n\tpublic inline function addByte( byte : Int ) {\n\t\t#if neko\n\t\tuntyped StringBuf.__add_char(b,byte);\n\t\t#elseif flash\n\t\tb.writeByte(byte);\n\t\t#elseif php\n\t\tb += untyped __call__(\"chr\", byte);\n\t\t#elseif cpp\n\t\tb.push(untyped byte);\n\t\t#elseif cs\n\t\tb.WriteByte(cast byte);\n\t\t#elseif java\n\t\tb.write(byte);\n\t\t#else\n\t\tb.push(byte);\n\t\t#end\n\t}\n\n\tpublic inline function add( src : Bytes ) {\n\t\t#if neko\n\t\tuntyped StringBuf.__add(b,src.getData());\n\t\t#elseif flash\n\t\tb.writeBytes(src.getData());\n\t\t#elseif php\n\t\tb += cast src.getData();\n\t\t#elseif cs\n\t\tb.Write(src.getData(), 0, src.length);\n\t\t#elseif java\n\t\tb.write(src.getData(), 0, src.length);\n\t\t#elseif js\n\t\tvar b1 = b;\n\t\tvar b2 = @:privateAccess src.b;\n\t\tfor( i in 0...src.length )\n\t\t\tb.push(b2[i]);\n\t\t#else\n\t\tvar b1 = b;\n\t\tvar b2 = src.getData();\n\t\tfor( i in 0...src.length )\n\t\t\tb.push(b2[i]);\n\t\t#end\n\t}\n\n\tpublic inline function addString( v : String ) {\n\t\t#if neko\n\t\tuntyped StringBuf.__add(b, v.__s);\n\t\t#elseif flash\n\t\tb.writeUTFBytes(v);\n\t\t#else\n\t\tadd(Bytes.ofString(v));\n\t\t#end\n\t}\n\n\tpublic #if flash inline #end function addInt32( v : Int ) {\n\t\t#if flash\n\t\tb.writeUnsignedInt(v);\n\t\t#else\n\t\taddByte(v&0xFF);\n\t\taddByte((v>>8)&0xFF);\n\t\taddByte((v>>16)&0xFF);\n\t\taddByte(v>>>24);\n\t\t#end\n\t}\n\n\tpublic #if flash inline #end function addInt64( v : haxe.Int64 ) {\n\t\taddInt32(v.low);\n\t\taddInt32(v.high);\n\t}\n\n\tpublic inline function addFloat( v : Float ) {\n\t\t#if flash\n\t\tb.writeFloat(v);\n\t\t#else\n\t\taddInt32(FPHelper.floatToI32(v));\n\t\t#end\n\t}\n\n\tpublic inline function addDouble( v : Float ) {\n\t\t#if flash\n\t\tb.writeDouble(v);\n\t\t#else\n\t\taddInt64(FPHelper.doubleToI64(v));\n\t\t#end\n\t}\n\n\tpublic inline function addBytes( src : Bytes, pos : Int, len : Int ) {\n\t\t#if !neko\n\t\tif( pos < 0 || len < 0 || pos + len > src.length ) throw Error.OutsideBounds;\n\t\t#end\n\t\t#if neko\n\t\ttry untyped StringBuf.__add_sub(b,src.getData(),pos,len) catch( e : Dynamic ) throw Error.OutsideBounds;\n\t\t#elseif flash\n\t\tif( len > 0 ) b.writeBytes(src.getData(),pos,len);\n\t\t#elseif php\n\t\tb += untyped __call__(\"substr\", src.b, pos, len);\n\t\t#elseif cs\n\t\tb.Write(src.getData(), pos, len);\n\t\t#elseif java\n\t\tb.write(src.getData(), pos, len);\n\t\t#elseif js\n\t\tvar b1 = b;\n\t\tvar b2 = @:privateAccess src.b;\n\t\tfor( i in pos...pos+len )\n\t\t\tb.push(b2[i]);\n\t\t#else\n\t\tvar b1 = b;\n\t\tvar b2 = src.getData();\n\t\tfor( i in pos...pos+len )\n\t\t\tb.push(b2[i]);\n\t\t#end\n\t}\n\n\t/**\n\t\tReturns either a copy or a reference of the current bytes.\n\t\tOnce called, the buffer can no longer be used.\n\t**/\n\tpublic function getBytes() : Bytes untyped {\n\t\t#if neko\n\t\tvar str = StringBuf.__to_string(b);\n\t\tvar bytes = new Bytes(__dollar__ssize(str),str);\n\t\t#elseif flash\n\t\tvar bytes = new Bytes(b.length,b);\n\t\tb.position = 0;\n\t\t#elseif php\n\t\tvar bytes = new Bytes(b.length, cast b);\n\t\t#elseif cs\n\t\tvar buf = b.GetBuffer();\n\t\tvar bytes = new Bytes(cast b.Length, buf);\n\t\t#elseif java\n\t\tvar buf = b.toByteArray();\n\t\tvar bytes = new Bytes(buf.length, buf);\n\t\t#elseif python\n\t\tvar buf = new python.Bytearray(b);\n\t\tvar bytes = new Bytes(buf.length, buf);\n\t\t#elseif js\n\t\tvar bytes = new Bytes(new js.html.Uint8Array(b).buffer);\n\t\t#else\n\t\tvar bytes = new Bytes(b.length,b);\n\t\t#end\n\t\tb = null;\n\t\treturn bytes;\n\t}\n\n}\n","/*\n * Copyright (C)2005-2014 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.io;\n\n/**\n\tAn Input is an abstract reader. See other classes in the `haxe.io` package\n\tfor several possible implementations.\n**/\nclass Input {\n\n\t/**\n\t\tEndianness (word byte order) used when reading numbers.\n\n\t\tIf `true`, big-endian is used, otherwise `little-endian` is used.\n\t**/\n\tpublic var bigEndian(default,set) : Bool;\n\n\t#if cs\n\tprivate var helper:BytesData;\n\t#elseif java\n\tprivate var helper:java.nio.ByteBuffer;\n\t#end\n\n\t/**\n\t\tRead and return one byte.\n\t**/\n\tpublic function readByte() : Int {\n\t#if cpp\n\t\tthrow \"Not implemented\";\n\t#else\n\t\treturn throw \"Not implemented\";\n\t#end\n\t}\n\n\t/**\n\t\tRead `len` bytes and write them into `s` to the position specified by `pos`.\n\n\t\tReturns the actual length of read data that can be smaller than `len`.\n\n\t\tSee `readFullBytes` that tries to read the exact amount of specified bytes.\n\t**/\n\tpublic function readBytes( s : Bytes, pos : Int, len : Int ) : Int {\n\t\tvar k = len;\n\t\tvar b = #if js @:privateAccess s.b #else s.getData() #end;\n\t\tif( pos < 0 || len < 0 || pos + len > s.length )\n\t\t\tthrow Error.OutsideBounds;\n\t\twhile( k > 0 ) {\n\t\t\t#if neko\n\t\t\t\tuntyped __dollar__sset(b,pos,readByte());\n\t\t\t#elseif php\n\t\t\t\tb[pos] = untyped __call__(\"chr\", readByte());\n\t\t\t#elseif cpp\n\t\t\t\tb[pos] = untyped readByte();\n\t\t\t#else\n\t\t\t\tb[pos] = cast readByte();\n\t\t\t#end\n\t\t\tpos++;\n\t\t\tk--;\n\t\t}\n\t\treturn len;\n\t}\n\n\t/**\n\t\tClose the input source.\n\n\t\tBehaviour while reading after calling this method is unspecified.\n\t**/\n\tpublic function close() : Void {\n\t}\n\n\tfunction set_bigEndian( b : Bool ) : Bool {\n\t\tbigEndian = b;\n\t\treturn b;\n\t}\n\n\t/* ------------------ API ------------------ */\n\n\t/**\n\t\tRead and return all available data.\n\n\t\tThe `bufsize` optional argument specifies the size of chunks by\n\t\twhich data is read. Its default value is target-specific.\n\t**/\n\tpublic function readAll( ?bufsize : Int ) : Bytes {\n\t\tif( bufsize == null )\n\t\t#if php\n\t\t\tbufsize = 8192; // default value for PHP and max under certain circumstances\n\t\t#else\n\t\t\tbufsize = (1 << 14); // 16 Ko\n\t\t#end\n\n\t\tvar buf = Bytes.alloc(bufsize);\n\t\tvar total = new haxe.io.BytesBuffer();\n\t\ttry {\n\t\t\twhile( true ) {\n\t\t\t\tvar len = readBytes(buf,0,bufsize);\n\t\t\t\tif( len == 0 )\n\t\t\t\t\tthrow Error.Blocked;\n\t\t\t\ttotal.addBytes(buf,0,len);\n\t\t\t}\n\t\t} catch( e : Eof ) {\n\t\t}\n\t\treturn total.getBytes();\n\t}\n\n\t/**\n\t\tRead `len` bytes and write them into `s` to the position specified by `pos`.\n\n\t\tUnlike `readBytes`, this method tries to read the exact `len` amount of bytes.\n\t**/\n\tpublic function readFullBytes( s : Bytes, pos : Int, len : Int ) : Void {\n\t\twhile( len > 0 ) {\n\t\t\tvar k = readBytes(s,pos,len);\n\t\t\tpos += k;\n\t\t\tlen -= k;\n\t\t}\n\t}\n\n\t/**\n\t\tRead and return `nbytes` bytes.\n\t**/\n\tpublic function read( nbytes : Int ) : Bytes {\n\t\tvar s = Bytes.alloc(nbytes);\n\t\tvar p = 0;\n\t\twhile( nbytes > 0 ) {\n\t\t\tvar k = readBytes(s,p,nbytes);\n\t\t\tif( k == 0 ) throw Error.Blocked;\n\t\t\tp += k;\n\t\t\tnbytes -= k;\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tRead a string until a character code specified by `end` is occurred.\n\n\t\tThe final character is not included in the resulting string.\n\t**/\n\tpublic function readUntil( end : Int ) : String {\n\t\tvar buf = new StringBuf();\n\t\tvar last : Int;\n\t\twhile( (last = readByte()) != end )\n\t\t\tbuf.addChar( last );\n\t\treturn buf.toString();\n\t}\n\n\t/**\n\t\tRead a line of text separated by CR and/or LF bytes.\n\n\t\tThe CR/LF characters are not included in the resulting string.\n\t**/\n\tpublic function readLine() : String {\n\t\tvar buf = new StringBuf();\n\t\tvar last : Int;\n\t\tvar s;\n\t\ttry {\n\t\t\twhile( (last = readByte()) != 10 )\n\t\t\t\tbuf.addChar( last );\n\t\t\ts = buf.toString();\n\t\t\tif( s.charCodeAt(s.length-1) == 13 ) s = s.substr(0,-1);\n\t\t} catch( e : Eof ) {\n\t\t\ts = buf.toString();\n\t\t\tif( s.length == 0 )\n\t\t\t\t#if neko neko.Lib.rethrow #else throw #end (e);\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t\tRead a 32-bit floating point number.\n\n\t\tEndianness is specified by the `bigEndian` property.\n\t**/\n\tpublic #if !(flash || python) inline #end function readFloat() : Float {\n\t\treturn FPHelper.i32ToFloat(readInt32());\n\t}\n\n\t/**\n\t\tRead a 64-bit double-precision floating point number.\n\n\t\tEndianness is specified by the `bigEndian` property.\n\t**/\n\tpublic function readDouble() : Float {\n\t\tvar i1 = readInt32();\n\t\tvar i2 = readInt32();\n\t\treturn bigEndian ? FPHelper.i64ToDouble(i2,i1) : FPHelper.i64ToDouble(i1,i2);\n\t}\n\n\t/**\n\t\tRead a 8-bit signed integer.\n\t**/\n\tpublic function readInt8() : Int {\n\t\tvar n = readByte();\n\t\tif( n >= 128 )\n\t\t\treturn n - 256;\n\t\treturn n;\n\t}\n\n\t/**\n\t\tRead a 16-bit signed integer.\n\n\t\tEndianness is specified by the `bigEndian` property.\n\t**/\n\tpublic function readInt16() : Int {\n\t\tvar ch1 = readByte();\n\t\tvar ch2 = readByte();\n\t\tvar n = bigEndian ? ch2 | (ch1 << 8) : ch1 | (ch2 << 8);\n\t\tif( n & 0x8000 != 0 )\n\t\t\treturn n - 0x10000;\n\t\treturn n;\n\t}\n\n\t/**\n\t\tRead a 16-bit unsigned integer.\n\n\t\tEndianness is specified by the `bigEndian` property.\n\t**/\n\tpublic function readUInt16() : Int {\n\t\tvar ch1 = readByte();\n\t\tvar ch2 = readByte();\n\t\treturn bigEndian ? ch2 | (ch1 << 8) : ch1 | (ch2 << 8);\n\t}\n\n\t/**\n\t\tRead a 24-bit signed integer.\n\n\t\tEndianness is specified by the `bigEndian` property.\n\t**/\n\tpublic function readInt24() : Int {\n\t\tvar ch1 = readByte();\n\t\tvar ch2 = readByte();\n\t\tvar ch3 = readByte();\n\t\tvar n = bigEndian ? ch3 | (ch2 << 8) | (ch1 << 16) : ch1 | (ch2 << 8) | (ch3 << 16);\n\t\tif( n & 0x800000 != 0 )\n\t\t\treturn n - 0x1000000;\n\t\treturn n;\n\t}\n\n\t/**\n\t\tRead a 24-bit unsigned integer.\n\n\t\tEndianness is specified by the `bigEndian` property.\n\t**/\n\tpublic function readUInt24() : Int {\n\t\tvar ch1 = readByte();\n\t\tvar ch2 = readByte();\n\t\tvar ch3 = readByte();\n\t\treturn bigEndian ? ch3 | (ch2 << 8) | (ch1 << 16) : ch1 | (ch2 << 8) | (ch3 << 16);\n\t}\n\n\t/**\n\t\tRead a 32-bit signed integer.\n\n\t\tEndianness is specified by the `bigEndian` property.\n\t**/\n\tpublic function readInt32() : Int {\n\t\tvar ch1 = readByte();\n\t\tvar ch2 = readByte();\n\t\tvar ch3 = readByte();\n\t\tvar ch4 = readByte();\n#if (php || python)\n        // php will overflow integers.  Convert them back to signed 32-bit ints.\n        var n = bigEndian ? ch4 | (ch3 << 8) | (ch2 << 16) | (ch1 << 24) : ch1 | (ch2 << 8) | (ch3 << 16) | (ch4 << 24);\n        if (n & 0x80000000 != 0)\n            return ( n | 0x80000000);\n        else return n;\n#else\n\t\treturn bigEndian ? ch4 | (ch3 << 8) | (ch2 << 16) | (ch1 << 24) : ch1 | (ch2 << 8) | (ch3 << 16) | (ch4 << 24);\n#end\n\t}\n\n\t/**\n\t\tRead and `len` bytes as a string.\n\t**/\n\tpublic function readString( len : Int ) : String {\n\t\tvar b = Bytes.alloc(len);\n\t\treadFullBytes(b,0,len);\n\t\t#if neko\n\t\treturn neko.Lib.stringReference(b);\n\t\t#else\n\t\treturn b.toString();\n\t\t#end\n\t}\n\n#if neko\n\tstatic var _float_of_bytes = neko.Lib.load(\"std\",\"float_of_bytes\",2);\n\tstatic var _double_of_bytes = neko.Lib.load(\"std\",\"double_of_bytes\",2);\n\tstatic function __init__() untyped {\n\t\tInput.prototype.bigEndian = false;\n\t}\n#elseif cpp\n\tstatic var _float_of_bytes = cpp.Lib.load(\"std\",\"float_of_bytes\",2);\n\tstatic var _double_of_bytes = cpp.Lib.load(\"std\",\"double_of_bytes\",2);\n#end\n\n#if (flash || js || python)\n\tfunction getDoubleSig(bytes:Array<Int>)\n    {\n        return (((bytes[1]&0xF) << 16) | (bytes[2] << 8) | bytes[3] ) * 4294967296. +\n            (bytes[4] >> 7) * 2147483648 +\n            (((bytes[4]&0x7F) << 24) | (bytes[5] << 16) | (bytes[6] << 8) | bytes[7]);\n    }\n#end\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.io;\n\nclass BytesInput extends Input {\n\tvar b : #if js js.html.Uint8Array #else BytesData #end;\n\t#if !flash\n\tvar pos : Int;\n\tvar len : Int;\n\tvar totlen : Int;\n\t#end\n\n\t/** The current position in the stream in bytes. */\n\tpublic var position(get,set) : Int;\n\n\t/** The length of the stream in bytes. */\n\tpublic var length(get,never) : Int;\n\n\tpublic function new( b : Bytes, ?pos : Int, ?len : Int ) {\n\t\tif( pos == null ) pos = 0;\n\t\tif( len == null ) len = b.length - pos;\n\t\tif( pos < 0 || len < 0 || pos + len > b.length ) throw Error.OutsideBounds;\n\t\t#if flash\n\t\tvar ba = b.getData();\n\t\tba.position = pos;\n\t\tif( len != ba.bytesAvailable ) {\n\t\t\t// truncate\n\t\t\tthis.b = new flash.utils.ByteArray();\n\t\t\tba.readBytes(this.b,0,len);\n\t\t} else\n\t\t\tthis.b = ba;\n\t\tthis.b.endian = flash.utils.Endian.LITTLE_ENDIAN;\n\t\t#else\n\t\tthis.b = #if js @:privateAccess b.b #else b.getData() #end;\n\t\tthis.pos = pos;\n\t\tthis.len = len;\n\t\tthis.totlen = len;\n\t\t#end\n\t\t#if python\n\t\tbigEndian = false;\n\t\t#end\n\t}\n\n\tinline function get_position() : Int {\n\t\t#if flash\n\t\treturn b.position;\n\t\t#else\n\t\treturn pos;\n\t\t#end\n\t}\n\n\tinline function get_length() : Int {\n\t\t#if flash\n\t\treturn b.length;\n\t\t#else\n\t\treturn totlen;\n\t\t#end\n\t}\n\n\tfunction set_position( p : Int ) : Int {\n\t\tif( p < 0 ) p = 0;\n\t\telse if( p > length ) p = length;\n\t\t#if flash\n\t\treturn b.position = p;\n\t\t#else\n\t\tlen = totlen - p;\n\t\treturn pos = p;\n\t\t#end\n\t}\n\n\tpublic override function readByte() : Int {\n\t\t#if flash\n\t\t\treturn try b.readUnsignedByte() catch( e : Dynamic ) throw new Eof();\n\t\t#else\n\t\t\tif( this.len == 0 )\n\t\t\t\tthrow new Eof();\n\t\t\tlen--;\n\t\t\t#if neko\n\t\t\treturn untyped __dollar__sget(b,pos++);\n\t\t\t#elseif php\n\t\t\treturn untyped __call__(\"ord\", b[pos++]);\n\t\t\t#elseif cpp\n\t\t\treturn untyped b[pos++];\n\t\t\t#elseif java\n\t\t\treturn untyped b[pos++] & 0xFF;\n\t\t\t#else\n\t\t\treturn b[pos++];\n\t\t\t#end\n\t\t#end\n\t}\n\n\tpublic override function readBytes( buf : Bytes, pos, len ) : Int {\n\t\t#if !neko\n\t\t\tif( pos < 0 || len < 0 || pos + len > buf.length )\n\t\t\t\tthrow Error.OutsideBounds;\n\t\t#end\n\t\t#if flash\n\t\t\tvar avail : Int = b.bytesAvailable;\n\t\t\tif( len > avail && avail > 0 ) len = avail;\n\t\t\ttry b.readBytes(buf.getData(),pos,len) catch( e : Dynamic ) throw new Eof();\n\t\t#elseif java\n\t\t\tvar avail : Int = this.len;\n\t\t\tif ( len > avail ) len = avail;\n\t\t\tif (len == 0)\n\t\t\t\tthrow new Eof();\n\t\t\tjava.lang.System.arraycopy(this.b, this.pos, buf.getData(), pos, len);\n\t\t\tthis.pos += len;\n\t\t\tthis.len -= len;\n\t\t#elseif cs\n\t\t\tvar avail : Int = this.len;\n\t\t\tif ( len > avail ) len = avail;\n\t\t\tif (len == 0)\n\t\t\t\tthrow new Eof();\n\t\t\tcs.system.Array.Copy(this.b,this.pos, buf.getData(), pos, len);\n\t\t\tthis.pos += len;\n\t\t\tthis.len -= len;\n\t\t#else\n\t\t\tif( this.len == 0 && len > 0 )\n\t\t\t\tthrow new Eof();\n\t\t\tif( this.len < len )\n\t\t\t\tlen = this.len;\n\t\t\t#if neko\n\t\t\ttry untyped __dollar__sblit(buf.getData(),pos,b,this.pos,len) catch( e : Dynamic ) throw Error.OutsideBounds;\n\t\t\t#elseif php\n\t\t\tuntyped __php__(\"$buf->b = substr($buf->b, 0, $pos) . substr($this->b, $this->pos, $len) . substr($buf->b, $pos+$len)\");\n\t\t\t#else\n\t\t\tvar b1 = b;\n\t\t\tvar b2 = #if js @:privateAccess buf.b #else buf.getData() #end;\n\t\t\tfor( i in 0...len )\n\t\t\t\tb2[pos+i] = b1[this.pos+i];\n\t\t\t#end\n\t\t\tthis.pos += len;\n\t\t\tthis.len -= len;\n\t\t#end\n\t\treturn len;\n\t}\n\n\t#if flash\n\t@:dox(hide)\n\toverride function set_bigEndian(e) {\n\t\tbigEndian = e;\n\t\tb.endian = e ? flash.utils.Endian.BIG_ENDIAN : flash.utils.Endian.LITTLE_ENDIAN;\n\t\treturn e;\n\t}\n\n\t@:dox(hide)\n\toverride function readFloat() {\n\t\treturn try b.readFloat() catch( e : Dynamic ) throw new Eof();\n\t}\n\n\t@:dox(hide)\n\toverride function readDouble() {\n\t\treturn try b.readDouble() catch( e : Dynamic ) throw new Eof();\n\t}\n\n\t@:dox(hide)\n\toverride function readInt8() {\n\t\treturn try b.readByte() catch( e : Dynamic ) throw new Eof();\n\t}\n\n\t@:dox(hide)\n\toverride function readInt16() {\n\t\treturn try b.readShort() catch( e : Dynamic ) throw new Eof();\n\t}\n\n\t@:dox(hide)\n\toverride function readUInt16() : Int {\n\t\treturn try b.readUnsignedShort() catch( e : Dynamic ) throw new Eof();\n\t}\n\n\t@:dox(hide)\n\toverride function readInt32() : Int {\n\t\treturn try b.readInt() catch( e : Dynamic ) throw new Eof();\n\t}\n\n\t@:dox(hide)\n\toverride function readString( len : Int ) {\n\t\treturn try b.readUTFBytes(len) catch( e : Dynamic ) throw new Eof();\n\t}\n\n\t#end\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.io;\n\nclass BytesOutput extends Output {\n\n\t#if flash\n\tvar b : flash.utils.ByteArray;\n\t#else\n\tvar b : BytesBuffer;\n\t#end\n\n\t/** The length of the stream in bytes. **/\n\tpublic var length(get,never) : Int;\n\n\tpublic function new() {\n\t\t#if flash\n\t\tb = new flash.utils.ByteArray();\n\t\tb.endian = flash.utils.Endian.LITTLE_ENDIAN;\n\t\t#else\n\t\tb = new BytesBuffer();\n\t\t#end\n\t\t#if python\n\t\tbigEndian = false;\n\t\t#end\n\t}\n\n\tinline function get_length() : Int {\n\t\treturn b.length;\n\t}\n\n\toverride function writeByte(c) {\n\t\t#if flash\n\t\tb.writeByte(c);\n\t\t#else\n\t\tb.addByte(c);\n\t\t#end\n\t}\n\n\toverride function writeBytes( buf : Bytes, pos, len ) : Int {\n\t\t#if flash\n\t\tif( pos < 0 || len < 0 || pos + len > buf.length ) throw Error.OutsideBounds;\n\t\tb.writeBytes(buf.getData(),pos,len);\n\t\t#else\n\t\tb.addBytes(buf,pos,len);\n\t\t#end\n\t\treturn len;\n\t}\n\n\t#if flash\n\t// optimized operations\n\n\t@:dox(hide)\n\toverride function set_bigEndian(e) {\n\t\tbigEndian = e;\n\t\tb.endian = e ? flash.utils.Endian.BIG_ENDIAN : flash.utils.Endian.LITTLE_ENDIAN;\n\t\treturn e;\n\t}\n\n\t@:dox(hide)\n\toverride function writeFloat( f : Float ) {\n\t\tb.writeFloat(f);\n\t}\n\n\t@:dox(hide)\n\toverride function writeDouble( f : Float ) {\n\t\tb.writeDouble(f);\n\t}\n\n\t@:dox(hide)\n\toverride function writeInt8( x : Int ) {\n\t\tif( x < -0x80 || x >= 0x80 )\n\t\t\tthrow Error.Overflow;\n\t\tb.writeByte(x);\n\t}\n\n\t@:dox(hide)\n\toverride function writeInt16( x : Int ) {\n\t\tif( x < -0x8000 || x >= 0x8000 ) throw Error.Overflow;\n\t\tb.writeShort(x);\n\t}\n\n\t@:dox(hide)\n\toverride function writeUInt16( x : Int ) {\n\t\tif( x < 0 || x >= 0x10000 ) throw Error.Overflow;\n\t\tb.writeShort(x);\n\t}\n\n\t@:dox(hide)\n\toverride function writeInt32( x : Int ) {\n\t\tb.writeInt(x);\n\t}\n\n\t@:dox(hide)\n\toverride function prepare( size : Int ) {\n\t\tif( size > 0 ) b[size-1] = b[size-1];\n\t}\n\n\t@:dox(hide)\n\toverride function writeString( s : String ) {\n\t\tb.writeUTFBytes(s);\n\t}\n\n\t#end\n\n\tpublic function getBytes() : Bytes {\n\t\t#if flash\n\t\tvar bytes = b;\n\t\tb = null;\n\t\treturn untyped new Bytes(bytes.length,bytes);\n\t\t#else\n\t\treturn b.getBytes();\n\t\t#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.io;\n\n/**\n\tThis exception is raised when reading while data is no longer available in the [Input].\n**/\nclass Eof {\n\tpublic function new() {\n\t}\n\t@:keep function toString() {\n\t\treturn \"Eof\";\n\t}\n}\n","/*\n * Copyright (C)2005-2015 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.io;\n\n/**\n\tHelper that converts between floating point and binary representation.\n\tAlways works in low-endian encoding.\n**/\nclass FPHelper {\n\n\t#if neko_v21\n\t// stored in helper\n\t#elseif neko\n\tstatic var i64tmp = new neko.vm.Tls<Int64>();\n\t#elseif !(java || cs)\n\tstatic var i64tmp = Int64.ofInt(0);\n\t#end\n\n\t#if neko\n\t\t#if neko_v21\n\t\tstatic var helpers = new neko.vm.Tls<neko.NativeArray<Dynamic>>();\n\t\t#else\n\t\tstatic var helperf = new neko.vm.Tls<neko.NativeString>();\n\t\tstatic var helperd = new neko.vm.Tls<neko.NativeString>();\n\t\tstatic var _float_of_bytes = neko.Lib.load(\"std\",\"float_of_bytes\",2);\n\t\tstatic var _double_of_bytes = neko.Lib.load(\"std\",\"double_of_bytes\",2);\n\t\tstatic var _float_bytes = neko.Lib.load(\"std\",\"float_bytes\",2);\n\t\tstatic var _double_bytes = neko.Lib.load(\"std\",\"double_bytes\",2);\n\t\t#end\n\t#elseif flash\n\t\tstatic var helper = {\n\t\t\tvar b = new flash.utils.ByteArray();\n\t\t\tb.endian = flash.utils.Endian.LITTLE_ENDIAN;\n\t\t\tb;\n\t\t}\n\t#elseif php\n\t\tstatic var isLittleEndian : Bool = untyped __call__('unpack','S','\\x01\\x00')[1] == 1;\n\t#else\n\t\tstatic inline var LN2 = 0.6931471805599453; // Math.log(2)\n\t#end\n\n\t#if neko_v21 inline #end\n\tpublic static function i32ToFloat( i : Int ) : Float {\n\t\t#if neko\n\t\t\t#if neko_v21\n\t\t\treturn untyped $itof(i,false);\n\t\t\t#else\n\t\t\tvar helper = helperf.value;\n\t\t\tif( helper == null )\n\t\t\t\thelperf.value = helper = neko.NativeString.alloc(4);\n\t\t\tuntyped $sset(helper,0,i&0xFF);\n\t\t\tuntyped $sset(helper,1,(i>>8)&0xFF);\n\t\t\tuntyped $sset(helper,2,(i>>16)&0xFF);\n\t\t\tuntyped $sset(helper,3,i>>>24);\n\t\t\treturn _float_of_bytes(helper,false);\n\t\t\t#end\n\t\t#elseif cpp\n\t\t\treturn untyped __global__.__hxcpp_reinterpret_le_int32_as_float32(i);\n\t\t#elseif cs\n\t\t\tvar helper = new SingleHelper(0);\n\t\t\tif( cs.system.BitConverter.IsLittleEndian )\n\t\t\t{\n\t\t\t\thelper.i = i;\n\t\t\t} else {\n\t\t\t\thelper.i = ((i >>> 24) & 0xFF) | (((i >> 16) & 0xFF) << 8) | (((i >> 8) & 0xFF) << 16) | ((i & 0xFF) << 24);\n\t\t\t}\n\n\t\t\treturn helper.f;\n\t\t#elseif java\n\t\t\treturn java.lang.Float.FloatClass.intBitsToFloat(i);\n\t\t#elseif php\n\t\t\treturn untyped  __call__('unpack', 'f', __call__('pack', 'l', i))[1];\n\t\t#elseif flash\n\t\t\tvar helper = helper;\n\t\t\thelper.position = 0;\n\t\t\thelper.writeUnsignedInt(i);\n\t\t\thelper.position = 0;\n\t\t\treturn helper.readFloat();\n\t\t#else\n\t\t\tvar sign = 1 - ((i >>> 31) << 1);\n\t\t\tvar exp = (i >>> 23) & 0xFF;\n\t\t\tvar sig = i & 0x7FFFFF;\n\t\t\tif( sig == 0 && exp == 0 )\n\t\t\t\treturn 0.0;\n\t\t\treturn sign*(1 + Math.pow(2, -23)*sig) * Math.pow(2, exp-127);\n\t\t#end\n\t}\n\n\t#if neko_v21 inline #end\n\tpublic static function floatToI32( f : Float ) : Int {\n\t\t#if neko\n\t\t\t#if neko_v21\n\t\t\treturn untyped $ftoi(f,false);\n\t\t\t#else\n\t\t\tvar r = _float_bytes(f,false);\n\t\t\treturn untyped $sget(r,0) | ($sget(r,1)<<8) | ($sget(r,2)<<16) | ($sget(r,3)<<24);\n\t\t\t#end\n\t\t#elseif cpp\n\t\t\treturn untyped __global__.__hxcpp_reinterpret_float32_as_le_int32(f);\n\t\t#elseif cs\n\t\t\tvar helper = new SingleHelper(f);\n\t\t\tif( cs.system.BitConverter.IsLittleEndian )\n\t\t\t{\n\t\t\t\treturn helper.i;\n\t\t\t} else {\n\t\t\t\tvar i = helper.i;\n\t\t\t\treturn ((i >>> 24) & 0xFF) | (((i >> 16) & 0xFF) << 8) | (((i >> 8) & 0xFF) << 16) | ((i & 0xFF) << 24);\n\t\t\t}\n\t\t#elseif java\n\t\t\treturn java.lang.Float.FloatClass.floatToRawIntBits(f);\n\t\t#elseif flash\n\t\t\tvar helper = helper;\n\t\t\thelper.position = 0;\n\t\t\thelper.writeFloat(f);\n\t\t\thelper.position = 0;\n\t\t\treturn helper.readUnsignedInt();\n\t\t#elseif php\n\t\t\treturn untyped __call__('unpack','l',__call__('pack', 'f', f))[1];\n\t\t#else\n\t\t\tif( f == 0 ) return 0;\n\t\t\tvar af = f < 0 ? -f : f;\n\t\t\tvar exp = Math.floor(Math.log(af) / LN2);\n\t\t\tif( exp < -127 ) exp = -127 else if( exp > 128 ) exp = 128;\n\t\t\tvar sig = Math.round((af / Math.pow(2, exp) - 1) * 0x800000) & 0x7FFFFF;\n\t\t\treturn (f < 0 ? 0x80000000 : 0) | ((exp + 127) << 23) | sig;\n\t\t#end\n\t}\n\n\t#if neko_v21 inline #end\n\tpublic static function i64ToDouble( low : Int, high : Int ) : Float {\n\t\t#if neko\n\t\t\t#if neko_v21\n\t\t\treturn untyped $itod(low,high,false);\n\t\t\t#else\n\t\t\tvar helper = helperd.value;\n\t\t\tif( helper == null )\n\t\t\t\thelperd.value = helper = neko.NativeString.alloc(8);\n\t\t\tuntyped $sset(helper,0,low&0xFF);\n\t\t\tuntyped $sset(helper,1,(low>>8)&0xFF);\n\t\t\tuntyped $sset(helper,2,(low>>16)&0xFF);\n\t\t\tuntyped $sset(helper,3,low>>>24);\n\t\t\tuntyped $sset(helper,4,high&0xFF);\n\t\t\tuntyped $sset(helper,5,(high>>8)&0xFF);\n\t\t\tuntyped $sset(helper,6,(high>>16)&0xFF);\n\t\t\tuntyped $sset(helper,7,high>>>24);\n\t\t\treturn _double_of_bytes(helper,false);\n\t\t\t#end\n\t\t#elseif cpp\n\t\t\treturn untyped __global__.__hxcpp_reinterpret_le_int32s_as_float64(low,high);\n\t\t#elseif cs\n\t\t\tvar helper = new FloatHelper(0);\n\t\t\tif( cs.system.BitConverter.IsLittleEndian )\n\t\t\t{\n\t\t\t\thelper.i = haxe.Int64.make(high,low);\n\t\t\t} else {\n\t\t\t\tvar i1 = high,\n\t\t\t\t    i2 = low;\n\t\t\t\tvar j2 = ((i1 >>> 24) & 0xFF) | (((i1 >> 16) & 0xFF) << 8) | (((i1 >> 8) & 0xFF) << 16) | ((i1 & 0xFF) << 24);\n\t\t\t\tvar j1 = ((i2 >>> 24) & 0xFF) | (((i2 >> 16) & 0xFF) << 8) | (((i2 >> 8) & 0xFF) << 16) | ((i2 & 0xFF) << 24);\n\t\t\t\thelper.i = haxe.Int64.make(j1,j2);\n\t\t\t}\n\t\t\treturn helper.f;\n\t\t#elseif java\n\t\t\treturn java.lang.Double.DoubleClass.longBitsToDouble( Int64.make(high,low) );\n\t\t#elseif flash\n\t\t\tvar helper = helper;\n\t\t\thelper.position = 0;\n\t\t\thelper.writeUnsignedInt(low);\n\t\t\thelper.writeUnsignedInt(high);\n\t\t\thelper.position = 0;\n\t\t\treturn helper.readDouble();\n\t\t#elseif php\n\t\t\treturn untyped  __call__('unpack', 'd', __call__('pack', 'ii', isLittleEndian ? low : high, isLittleEndian ? high : low))[1];\n\t\t#else\n\t\t\tvar sign = 1 - ((high >>> 31) << 1);\n\t\t\tvar exp = ((high >> 20) & 0x7FF) - 1023;\n\t\t\tvar sig = (high&0xFFFFF) * 4294967296. + (low>>>31) * 2147483648. + (low&0x7FFFFFFF);\n\t\t\tif( sig == 0 && exp == -1023 )\n\t\t\t\treturn 0.0;\n\t\t\treturn sign*(1.0 + Math.pow(2, -52)*sig) * Math.pow(2, exp);\n\t\t#end\n\t}\n\n\t/**\n\t\tReturns an Int64 representing the bytes representation of the double precision IEEE float value.\n\t\tWARNING : for performance reason, the same Int64 value might be reused every time. Copy its low/high values before calling again.\n\t\tWe still ensure that this is safe to use in a multithread environment\n\t**/\n\tpublic static function doubleToI64( v : Float ) : Int64 {\n\t\t#if neko\n\t\t\t#if neko_v21\n\t\t\tvar helper = helpers.value;\n\t\t\tif( helper == null ) {\n\t\t\t\thelpers.value = helper = neko.NativeArray.alloc(2);\n\t\t\t\thelper[0] = neko.NativeArray.alloc(2);\n\t\t\t\thelper[1] = haxe.Int64.ofInt(0);\n\t\t\t}\n\t\t\tvar i64 : haxe.Int64 = helper[1], int2 = helper[0];\n\t\t\tuntyped $dtoi(v,int2,false);\n\t\t\t@:privateAccess {\n\t\t\t\ti64.set_low(int2[0]);\n\t\t\t\ti64.set_high(int2[1]);\n\t\t\t}\n\t\t\treturn i64;\n\t\t\t#else\n\t\t\tvar r = _double_bytes(v,false), i64 = i64tmp.value;\n\t\t\tif( i64 == null )\n\t\t\t\ti64 = i64tmp.value = haxe.Int64.ofInt(0);\n\t\t\t@:privateAccess {\n\t\t\t\ti64.set_low(untyped $sget(r,0) | ($sget(r,1)<<8) | ($sget(r,2)<<16) | ($sget(r,3)<<24));\n\t\t\t\ti64.set_high(untyped $sget(r,4) | ($sget(r,5)<<8) | ($sget(r,6)<<16) | ($sget(r,7)<<24));\n\t\t\t}\n\t\t\treturn i64;\n\t\t\t#end\n\t\t#elseif cpp\n\t\t\treturn Int64.make(untyped __global__.__hxcpp_reinterpret_float64_as_le_int32_high(v),\n\t\t\t\t               untyped __global__.__hxcpp_reinterpret_float64_as_le_int32_low(v) );\n\t\t#elseif java\n\t\t\treturn java.lang.Double.DoubleClass.doubleToRawLongBits(v);\n\t\t#elseif cs\n\t\t\tvar helper = new FloatHelper(v);\n\t\t\tif( cs.system.BitConverter.IsLittleEndian )\n\t\t\t{\n\t\t\t\treturn helper.i;\n\t\t\t} else {\n\t\t\t\tvar i = helper.i;\n\t\t\t\tvar i1 = haxe.Int64.getHigh(i),\n\t\t\t\t    i2 = haxe.Int64.getLow(i);\n\t\t\t\tvar j2 = ((i1 >>> 24) & 0xFF) | (((i1 >> 16) & 0xFF) << 8) | (((i1 >> 8) & 0xFF) << 16) | ((i1 & 0xFF) << 24);\n\t\t\t\tvar j1 = ((i2 >>> 24) & 0xFF) | (((i2 >> 16) & 0xFF) << 8) | (((i2 >> 8) & 0xFF) << 16) | ((i2 & 0xFF) << 24);\n\n\t\t\t\treturn haxe.Int64.make(j1,j2);\n\t\t\t}\n\t\t#elseif flash\n\t\t\tvar helper = helper;\n\t\t\thelper.position = 0;\n\t\t\thelper.writeDouble(v);\n\t\t\thelper.position = 0;\n\t\t\tvar i64 = i64tmp;\n\t\t\t@:privateAccess {\n\t\t\t\ti64.set_low(cast helper.readUnsignedInt());\n\t\t\t\ti64.set_high(cast helper.readUnsignedInt());\n\t\t\t}\n\t\t\treturn i64;\n\t\t#elseif php\n\t\t\tvar a = untyped __call__('unpack',isLittleEndian ? 'V2' : 'N2',__call__('pack', 'd', v));\n\t\t\tvar i64 = i64tmp;\n\t\t\t@:privateAccess {\n\t\t\t\ti64.set_low(a[isLittleEndian ? 1 : 2]);\n\t\t\t\ti64.set_high(a[isLittleEndian ? 2 : 1]);\n\t\t\t}\n\t\t\treturn i64;\n\t\t#else\n\t\t\tvar i64 = i64tmp;\n\t\t\tif( v == 0 ) {\n\t\t\t\t@:privateAccess {\n\t\t\t\t\ti64.set_low(0);\n\t\t\t\t\ti64.set_high(0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar av = v < 0 ? -v : v;\n\t\t\t\tvar exp = Math.floor(Math.log(av) / LN2);\n\t\t\t\tvar sig = Math.fround(((av / Math.pow(2, exp)) - 1) * 4503599627370496.); // 2^52\n\t\t\t\tvar sig_l = Std.int(sig);\n\t\t\t\tvar sig_h = Std.int(sig / 4294967296.0);\n\t\t\t\t@:privateAccess {\n\t\t\t\t\ti64.set_low(sig_l);\n\t\t\t\t\ti64.set_high((v < 0 ? 0x80000000 : 0) | ((exp + 1023) << 20) | sig_h);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn i64;\n\t\t#end\n\t}\n\n}\n\n#if cs\n@:meta(System.Runtime.InteropServices.StructLayout(System.Runtime.InteropServices.LayoutKind.Explicit))\n@:nativeGen @:struct private class SingleHelper\n{\n\t@:meta(System.Runtime.InteropServices.FieldOffset(0))\n\tpublic var i:Int;\n\t@:meta(System.Runtime.InteropServices.FieldOffset(0))\n\tpublic var f:Single;\n\n\tpublic function new(f:Single)\n\t{\n\t\tthis.i = 0;\n\t\tthis.f = f;\n\t}\n}\n\n@:meta(System.Runtime.InteropServices.StructLayout(System.Runtime.InteropServices.LayoutKind.Explicit))\n@:nativeGen @:struct private class FloatHelper\n{\n\t@:meta(System.Runtime.InteropServices.FieldOffset(0))\n\tpublic var i:haxe.Int64;\n\t@:meta(System.Runtime.InteropServices.FieldOffset(0))\n\tpublic var f:Float;\n\n\tpublic function new(f:Float)\n\t{\n\t\tthis.i = haxe.Int64.ofInt(0);\n\t\tthis.f = f;\n\t}\n}\n\n#end\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.io;\n\nclass StringInput extends BytesInput {\n\n\tpublic function new( s : String ) {\n\t\t#if neko\n\t\t// don't copy the string\n\t\tsuper( neko.Lib.bytesReference(s) );\n\t\t#else\n\t\tsuper( haxe.io.Bytes.ofString(s) );\n\t\t#end\n\t}\n\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.rtti;\n\n/**\n\tAn api to access classes and enums metadata at runtime.\n**/\nclass Meta {\n\n\t/**\n\t\tReturns the metadata that were declared for the given type (class or enum)\n\t**/\n\tpublic static function getType( t : Dynamic ) : Dynamic<Array<Dynamic>> {\n\t\tvar meta = getMeta(t);\n\t\treturn (meta == null || meta.obj == null) ? {} : meta.obj;\n\t}\n\n\tprivate static function getMeta(t:Dynamic):Dynamic\n\t{\n#if (java || cs)\n\t\tvar ret = Reflect.field(t, \"__meta__\");\n\t\tif (ret == null && Std.is(t,Class))\n\t\t{\n#if java\n\t\t\tvar interf = java.Lib.toNativeType(t).isInterface();\n#elseif cs\n\t\t\tvar interf = cs.Lib.toNativeType(t).IsInterface;\n#end\n\t\t\tif (interf)\n\t\t\t{\n\t\t\t\tvar name = Type.getClassName(t),\n\t\t\t\t    cls = Type.resolveClass(name + '_HxMeta');\n\t\t\t\tif (cls != null)\n\t\t\t\t\treturn Reflect.field(cls, \"__meta__\");\n\t\t\t}\n\t\t}\n\t\treturn ret;\n#else\n\t\treturn untyped t.__meta__;\n#end\n\t}\n\n\t/**\n\t\tReturns the metadata that were declared for the given class static fields\n\t**/\n\tpublic static function getStatics( t : Dynamic ) : Dynamic<Dynamic<Array<Dynamic>>> {\n\t\tvar meta = getMeta(t);\n\t\treturn (meta == null || meta.statics == null) ? {} : meta.statics;\n\t}\n\n\t/**\n\t\tReturns the metadata that were declared for the given class fields or enum constructors\n\t**/\n\tpublic static function getFields( t : Dynamic ) : Dynamic<Dynamic<Array<Dynamic>>> {\n\t\tvar meta = getMeta(t);\n\t\treturn (meta == null || meta.fields == null) ? {} : meta.fields;\n\t}\n\n}\n","package haxe.ui.backend;\r\n\r\nimport flambe.Entity;\r\nimport flambe.System;\r\nimport flambe.asset.AssetPack;\r\nimport flambe.asset.Manifest;\r\nimport flambe.display.FillSprite;\r\n\r\nclass AppBase {\r\n    private var _callback:Void->Void;\r\n\r\n    public function new() {\r\n\r\n    }\r\n\r\n    private function build() {\r\n\r\n    }\r\n\r\n    private function init(callback:Void->Void, onEnd:Void->Void = null) {\r\n        _callback = callback;\r\n\r\n        // Wind up all platform-specific stuff\r\n        System.init();\r\n\r\n        // Load up the compiled pack in the assets directory named \"bootstrap\"\r\n        var manifest = Manifest.fromAssets(Toolkit.backendProperties.getProp(\"haxe.ui.flambe.assets.pack\", \"bootstrap\"));\r\n        var loader = System.loadAssetPack(manifest);\r\n        loader.get(onAssetsLoaded);\r\n    }\r\n\r\n    private function onAssetsLoaded(pack:AssetPack) {\r\n        ToolkitAssets.instance.assetPack = pack;\r\n\r\n        var background = new FillSprite(Toolkit.backendProperties.getPropCol(\"haxe.ui.flambe.background.color\", 0xFFFFFF),\r\n                                        System.stage.width, System.stage.height);\r\n        System.root.addChild(new Entity().add(background));\r\n\r\n        _callback();\r\n    }\r\n\r\n    private function getToolkitInit():Dynamic {\r\n        return {\r\n        };\r\n    }\r\n\r\n    public function start() {\r\n\r\n    }\r\n}","package haxe.ui;\r\n\r\nimport haxe.ui.backend.AppBase;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.Screen;\r\nimport haxe.ui.macros.ComponentMacros;\r\n\r\nclass HaxeUIApp extends AppBase {\r\n    public function new() {\r\n        super();\r\n        Toolkit.build();\r\n        build();\r\n    }\r\n\r\n    public function ready(onReady:Void->Void, onEnd:Void->Void = null) {\r\n        init(onReady, onEnd);\r\n    }\r\n\r\n    private override function init(onReady:Void->Void, onEnd:Void->Void = null) {\r\n        if (Toolkit.backendProperties.getProp(\"haxe.ui.theme\") != null && Toolkit.theme == \"default\") {\r\n            Toolkit.theme = Toolkit.backendProperties.getProp(\"haxe.ui.theme\");\r\n        }\r\n\r\n        Toolkit.init(getToolkitInit());\r\n        super.init(onReady, onEnd);\r\n    }\r\n\r\n    public function addComponent(component:Component) {\r\n        Screen.instance.addComponent(component);\r\n    }\r\n}","package haxe.ui.util;\r\n\r\n#if (macro || sys)\r\nimport sys.io.File;\r\n#end\r\n\r\nclass Properties {\r\n    private var _props:Map<String, String> = new Map<String, String>();\r\n    public function new() {\r\n    }\r\n\r\n    #if (macro || sys)\r\n    public function fromFile(filePath:String) {\r\n        _props = new Map<String, String>();\r\n        var content:String = File.getContent(filePath);\r\n        var lines:Array<String> = content.split(\"\\r\\n\");\r\n        for (line in lines) {\r\n            line = StringTools.trim(line);\r\n            if (line.length != 0) {\r\n                var parts:Array<String> = line.split(\"=\");\r\n                _props.set(parts[0], parts[1]);\r\n            }\r\n        }\r\n    }\r\n    #end\r\n\r\n    public function getProp(name:String, defaultValue = null):String {\r\n        var v:String = defaultValue;\r\n        if (_props.exists(name)) {\r\n            v = _props.get(name);\r\n        }\r\n        return v;\r\n    }\r\n\r\n    public function getPropInt(name:String, defaultValue:Int = 0):Int {\r\n        var v:Int = defaultValue;\r\n        var stringValue = getProp(name);\r\n        if (stringValue != null) {\r\n            v = Std.parseInt(stringValue);\r\n        }\r\n        return v;\r\n    }\r\n\r\n    public function getPropBool(name:String, defaultValue:Bool = false):Bool {\r\n        var v:Bool = defaultValue;\r\n        var stringValue = getProp(name);\r\n        if (stringValue != null) {\r\n            v = stringValue == \"true\";\r\n        }\r\n        return v;\r\n    }\r\n\r\n    public function getPropCol(name:String, defaultValue:Int = 0x000000):Int {\r\n        var v:Int = defaultValue;\r\n        var stringValue = getProp(name);\r\n        if (stringValue != null) {\r\n            v = ColorUtil.parseColor(stringValue);\r\n        }\r\n        return v;\r\n    }\r\n\r\n    public function setProp(name:String, value:String) {\r\n        _props.set(name, value);\r\n    }\r\n\r\n    public function names():Iterator<String> {\r\n        return _props.keys();\r\n    }\r\n\r\n    public function addAll(p:Properties) {\r\n        for (name in p.names()) {\r\n            _props.set(name, p.getProp(name));\r\n        }\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nclass GenericConfig {\r\n    public var values:Map<String, String> = new Map<String, String>();\r\n    public var sections:Map<String, Array<GenericConfig>> = new Map<String, Array<GenericConfig>>();\r\n\r\n    public function new() {\r\n\r\n    }\r\n\r\n    public function addSection(name:String):GenericConfig {\r\n        var config:GenericConfig = new GenericConfig();\r\n        var array:Array<GenericConfig> = sections.get(name);\r\n        if (array == null) {\r\n            array = new Array<GenericConfig>();\r\n            sections.set(name, array);\r\n        }\r\n        array.push(config);\r\n        return config;\r\n    }\r\n\r\n    public function findBy(section:String, field:String = null, value:String = null):GenericConfig {\r\n        var array:Array<GenericConfig> = sections.get(section);\r\n        if (array == null) {\r\n            return null;\r\n        }\r\n\r\n        if (field == null && value == null) {\r\n            return array[0];\r\n        }\r\n\r\n        var r = null;\r\n        for (item in array) {\r\n            for (key in item.values.keys()) {\r\n                if (key == field && item.values.get(key) == value) {\r\n                    r = item;\r\n                    break;\r\n                }\r\n            }\r\n            if (r != null) {\r\n                break;\r\n            }\r\n        }\r\n        return r;\r\n    }\r\n\r\n    public function queryBool(q:String, defaultValue:Bool = false):Bool {\r\n        var r = query(q, null);\r\n        if (r == null) {\r\n            return defaultValue;\r\n        }\r\n        return (r == \"true\");\r\n    }\r\n\r\n    public function query(q:String, defaultValue:String = null):String {\r\n        var regexp:EReg = new EReg(\"\\\\.(?![^\\\\[]*\\\\])\", \"g\");\r\n        var final:Array<String> = regexp.split(q);\r\n        var ref:GenericConfig = this;\r\n\r\n        var value:String = null;\r\n        for (f in final) {\r\n            if (f.indexOf(\"[\") == -1 && f.indexOf(\"@\") == -1) {\r\n                ref = ref.findBy(f);\r\n            } else if (f.indexOf(\"[\") != -1) {\r\n                var p:Array<String> = f.split(\"[\");\r\n                var p1:String = p[0];\r\n                var p2:String = p[1].split(\"=\")[0];\r\n                var p3:String = p[1].split(\"=\")[1];\r\n                p3 = p3.substr(0, p3.length - 1);\r\n\r\n                ref = ref.findBy(p1, p2, p3);\r\n             } else if (f.indexOf(\"@\") != -1) {\r\n                var v = f.substr(1, f.length);\r\n                value = ref.values.get(v);\r\n                break;\r\n             }\r\n\r\n            if (ref == null) {\r\n                return defaultValue;\r\n            }\r\n        }\r\n\r\n        if (value == null) {\r\n            value = defaultValue;\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    // TODO: duplication\r\n    public function queryValues(q:String):Map<String, String> {\r\n        var regexp:EReg = new EReg(\"\\\\.(?![^\\\\[]*\\\\])\", \"g\");\r\n        var final:Array<String> = regexp.split(q);\r\n        var ref:GenericConfig = this;\r\n\r\n        for (f in final) {\r\n            if (f.indexOf(\"[\") == -1 && f.indexOf(\"@\") == -1) {\r\n                ref = ref.findBy(f);\r\n            } else if (f.indexOf(\"[\") != -1) {\r\n                var p:Array<String> = f.split(\"[\");\r\n                var p1:String = p[0];\r\n                var p2:String = p[1].split(\"=\")[0];\r\n                var p3:String = p[1].split(\"=\")[1];\r\n                p3 = p3.substr(0, p3.length - 1);\r\n\r\n                ref = ref.findBy(p1, p2, p3);\r\n             }\r\n\r\n            if (ref == null) {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        return ref.values;\r\n    }\r\n}","package haxe.ui.styles;\r\n\r\nimport haxe.ui.styles.Defs;\r\nimport haxe.ui.core.Component;\r\n\r\nclass Rule {\r\n    public var id : Int;\r\n    public var c : CssClass;\r\n    public var priority : Int;\r\n    public var s : Style;\r\n    public function new() {\r\n    }\r\n}\r\n\r\nclass Engine {\r\n\r\n    var rules : Array<Rule>;\r\n\r\n    public function new() {\r\n        rules = [];\r\n    }\r\n\r\n    public function applyClasses( c : Component, set:Bool = true) {\r\n        var s = new Style();\r\n        if (set == true) {\r\n            c.style = s;\r\n        }\r\n        var rules = [];\r\n        for(r in this.rules) {\r\n            if(!ruleMatch(r.c, c)) {\r\n                continue;\r\n            }\r\n            rules.push(r);\r\n        }\r\n        rules.sort(sortByPriority);\r\n        for(r in rules)\r\n            s.apply(r.s);\r\n        if (c.customStyle != null) {\r\n            s.apply(c.customStyle);\r\n        }\r\n        return s;\r\n    }\r\n\r\n    function sortByPriority(r1:Rule, r2:Rule) {\r\n        var dp = r1.priority - r2.priority;\r\n        return dp == 0 ? r1.id - r2.id : dp;\r\n    }\r\n\r\n    public static function ruleMatch( c : CssClass, d : Component ) {\r\n        if( c.pseudoClass != null ) {\r\n            var pc = \":\" + c.pseudoClass;\r\n            var found = false;\r\n            for( cc in d.classes )\r\n                if( cc == pc ) {\r\n                    found = true;\r\n                    break;\r\n                }\r\n            if( !found )\r\n                return false;\r\n        }\r\n        if( c.className != null ) {\r\n            if( d.classes == null )\r\n                return false;\r\n            var found = false;\r\n            for( cc in d.classes )\r\n                if( cc == c.className ) {\r\n                    found = true;\r\n                    break;\r\n                }\r\n            if( !found )\r\n                return false;\r\n        }\r\n        /*\r\n        if( c.node != null && c.node != d.name )\r\n            return false;\r\n        */\r\n        if( c.id != null && c.id != d.id )\r\n            return false;\r\n        if( c.parent != null ) {\r\n            var p = d.parentComponent;\r\n            while( p != null ) {\r\n                if( ruleMatch(c.parent, p) )\r\n                    break;\r\n                p = p.parentComponent;\r\n            }\r\n            if( p == null )\r\n                return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public function addRules( text : String ) {\r\n        for( r in new Parser().parseRules(text) ) {\r\n            var c = r.c;\r\n            var imp = r.imp ? 1 : 0;\r\n            var nids = 0, nothers = 0, nnodes = 0;\r\n            while( c != null ) {\r\n                if( c.id != null ) nids++;\r\n                if( c.node != null ) nnodes++;\r\n                if( c.pseudoClass != null ) nothers++;\r\n                if( c.className != null ) nothers++;\r\n                c = c.parent;\r\n            }\r\n            var rule = new Rule();\r\n            rule.id = rules.length;\r\n            rule.c = r.c;\r\n            rule.s = r.s;\r\n            rule.priority = (imp << 24) | (nids << 16) | (nothers << 8) | nnodes;\r\n            rules.push(rule);\r\n        }\r\n    }\r\n\r\n}\r\n","package haxe.ui;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.ComponentClassMap;\r\nimport haxe.ui.core.KeyboardEvent;\r\nimport haxe.ui.core.Screen;\r\nimport haxe.ui.focus.FocusManager;\r\nimport haxe.ui.macros.BackendMacros;\r\nimport haxe.ui.macros.ModuleMacros;\r\nimport haxe.ui.macros.NativeMacros;\r\nimport haxe.ui.parsers.ui.ComponentInfo;\r\nimport haxe.ui.parsers.ui.ComponentParser;\r\nimport haxe.ui.styles.Engine;\r\nimport haxe.ui.themes.ThemeManager;\r\nimport haxe.ui.util.GenericConfig;\r\nimport haxe.ui.util.Properties;\r\n\r\nclass Toolkit {\r\n    public static var styleSheet:Engine = new Engine();\r\n    public static var theme:String = \"default\";\r\n\r\n    public static var properties:Map<String, String> = new Map<String, String>();\r\n\r\n    public static var backendProperties:Properties = new Properties();\r\n    public static var nativeConfig:GenericConfig = new GenericConfig();\r\n\r\n    private static var _built:Bool = false;\r\n    public static function build() {\r\n        if (_built == true) {\r\n            return;\r\n        }\r\n        BackendMacros.processBackend();\r\n        ModuleMacros.processModules();\r\n        NativeMacros.processNative();\r\n        _built = true;\r\n\r\n        #if (haxeui_remoting && !haxeui_remoting_server)\r\n        var client:haxe.ui.remoting.client.Client = new haxe.ui.remoting.client.Client();\r\n        #end\r\n    }\r\n\r\n    public static function init(options:Dynamic = null) {\r\n        build();\r\n        ThemeManager.instance.applyTheme(theme);\r\n        if (options != null) {\r\n            screen.options = options;\r\n            ToolkitAssets.instance.options = options;\r\n        }\r\n        screen.registerEvent(KeyboardEvent.KEY_DOWN, onKeyDown);\r\n    }\r\n\r\n    private static function onKeyDown(event:KeyboardEvent) {\r\n        if (event.keyCode == KeyboardEvent.KEY_TAB) {\r\n            if (event.shiftKey == false) {\r\n                FocusManager.instance.focusNext();\r\n            } else {\r\n                FocusManager.instance.focusPrev();\r\n            }\r\n        }\r\n    }\r\n\r\n    public static var assets(get, null):ToolkitAssets;\r\n    private static function get_assets():ToolkitAssets {\r\n        return ToolkitAssets.instance;\r\n    }\r\n\r\n    public static var screen(get, null):Screen;\r\n    private static function get_screen():Screen {\r\n        return Screen.instance;\r\n    }\r\n    \r\n    public static function componentFromString(data:String, type:String = null):Component {\r\n        if (data == null || data.length == 0) {\r\n            return null;\r\n        }\r\n        \r\n        if (type == null) { // lets try and auto detect\r\n            if (StringTools.startsWith(StringTools.trim(data), \"<\")) {\r\n                type = \"xml\";\r\n            }\r\n        }\r\n        \r\n        var parser:ComponentParser = ComponentParser.get(type);\r\n        if (parser == null) {\r\n            trace('WARNING: type \"${type}\" not recognised');\r\n            return null;\r\n        }\r\n\r\n        var c:ComponentInfo = parser.parse(data);\r\n        var component = buildComponentFromInfo(c);\r\n        \r\n        var fullScript = \"\";\r\n        for (scriptString in c.scriptlets) {\r\n            fullScript += scriptString;\r\n        }\r\n\r\n        component.script = fullScript;\r\n        \r\n        return component;\r\n    }\r\n    \r\n    private static function buildComponentFromInfo(c:ComponentInfo):Component {\r\n        var className:String = ComponentClassMap.get(c.type);\r\n        if (className == null) {\r\n            trace(\"WARNING: no class found for component: \" + c.type);\r\n            return null;\r\n        }\r\n        \r\n        var component:Component = Type.createInstance(Type.resolveClass(className), []);\r\n        if (component == null) {\r\n            trace(\"WARNING: could not create class instance: \" + className);\r\n            return null;\r\n        }\r\n        \r\n        if (c.id != null)               component.id = c.id;\r\n        if (c.left != null)             component.left = c.left;\r\n        if (c.top != null)              component.top = c.top;\r\n        if (c.width != null)            component.width = c.width;\r\n        if (c.height != null)           component.height = c.height;\r\n        if (c.percentWidth != null)     component.percentWidth = c.percentWidth;\r\n        if (c.percentHeight != null)    component.percentHeight = c.percentHeight;\r\n        if (c.text != null)             component.text = c.text;\r\n        if (c.styleNames != null)       component.styleNames = c.styleNames;\r\n        if (c.style != null)            component.styleString = c.style;\r\n        for (propName in c.properties.keys()) {\r\n            var propValue:Dynamic = c.properties.get(propName);\r\n            if (StringTools.startsWith(propName, \"on\")) {\r\n                component.addScriptEvent(propName, propValue);\r\n            } else {\r\n                if (Reflect.hasField(component, propName) == false) {\r\n                    continue;\r\n                }\r\n\r\n                if (propValue == \"true\" || propValue == \"yes\" || propValue == \"false\" || propValue == \"no\") {\r\n                    propValue = (propValue == \"true\" || propValue == \"yes\");\r\n                } else if (Std.parseInt(propValue) != null) {\r\n                    propValue = Std.parseInt(propValue);\r\n                }\r\n                \r\n                Reflect.setField(component, propName, propValue);\r\n            }\r\n        }\r\n        \r\n        for (childInfo in c.children) {\r\n            var childComponent = buildComponentFromInfo(childInfo);\r\n            if (childComponent != null) {\r\n                component.addComponent(childComponent);\r\n            }\r\n        }\r\n\r\n        return component;\r\n    }\r\n}","package haxe.ui.backend;\r\n\r\nimport flambe.System;\r\nimport flambe.asset.AssetPack;\r\nimport flambe.asset.File;\r\nimport flambe.display.Texture;\r\nimport flambe.platform.BasicFile;\r\nimport haxe.Resource;\r\nimport haxe.io.Bytes;\r\nimport haxe.ui.assets.FontInfo;\r\nimport haxe.ui.assets.ImageInfo;\r\n\r\n#if (html || js)\r\nimport js.Browser;\r\nimport js.html.*;\r\n#else\r\nimport haxe.ui.util.ByteConverter;\r\nimport flash.display.Bitmap;\r\nimport flash.display.Loader;\r\nimport flash.events.Event;\r\nimport flash.utils.ByteArray;\r\n#end\r\n\r\nclass AssetsBase {\r\n    private var _assetPack:AssetPack;\r\n\r\n    public function new() {\r\n\r\n    }\r\n\r\n    public var assetPack(get, set):AssetPack;\r\n    private function get_assetPack():AssetPack {\r\n        if (_assetPack != null) {\r\n            return _assetPack;\r\n        }\r\n        var options = cast(this, ToolkitAssets).options;\r\n        if (options == null) {\r\n            return null;\r\n        }\r\n        return options.assetPack;\r\n    }\r\n    private function set_assetPack(value:AssetPack):AssetPack {\r\n        _assetPack = value;\r\n        return value;\r\n    }\r\n\r\n    private function getImageInternal(resourceId:String, callback:ImageInfo->Void):Void {\r\n        try {\r\n            if (assetPack != null) {\r\n                var t:Texture = assetPack.getTexture(getAssetName(resourceId));\r\n                var imageInfo:ImageInfo = {\r\n                    width: t.width,\r\n                    height: t.height,\r\n                    data: t\r\n                }\r\n                callback(imageInfo);\r\n            } else {\r\n                callback(null);\r\n            }\r\n        } catch (ex:Dynamic) {\r\n            callback(null);\r\n        }\r\n    }\r\n\r\n    private function getImageFromHaxeResource(resourceId:String, callback:String->ImageInfo->Void) {\r\n        var bytes:Bytes = Resource.getBytes(resourceId);\r\n\r\n        #if (html || js)\r\n\r\n        var image = Browser.document.createImageElement();\r\n        image.onload = function(e) {\r\n            var t = System.renderer.createTextureFromImage(image);\r\n            var imageInfo:ImageInfo = {\r\n                width: t.width,\r\n                height: t.height,\r\n                data: t\r\n            }\r\n            callback(resourceId, imageInfo);\r\n\r\n        }\r\n        var base64:String = haxe.crypto.Base64.encode(bytes);\r\n        image.src = \"data:image/png;base64,\" + base64;\r\n\r\n        #else\r\n\r\n        var ba:ByteArray = ByteConverter.fromHaxeBytes(bytes);\r\n        var loader:Loader = new Loader();\r\n        loader.contentLoaderInfo.addEventListener(Event.COMPLETE, function(e) {\r\n            if (loader.content != null) {\r\n                var bmpData = cast(loader.content, Bitmap).bitmapData;\r\n                var t = System.renderer.createTextureFromImage(bmpData);\r\n                var imageInfo:ImageInfo = {\r\n                    width: t.width,\r\n                    height: t.height,\r\n                    data: t\r\n                }\r\n                callback(resourceId, imageInfo);\r\n\r\n            }\r\n        });\r\n        loader.loadBytes(ba);\r\n\r\n        #end\r\n    }\r\n\r\n    private function getFontInternal(resourceId:String, callback:FontInfo->Void):Void {\r\n        try {\r\n            if (assetPack != null) {\r\n                var f:File = assetPack.getFile(resourceId);\r\n                if (f != null) {\r\n                    callback({\r\n                        data: null\r\n                    });\r\n                } else {\r\n                    callback(null);\r\n                }\r\n            }\r\n        } catch (ex:Dynamic) {\r\n            callback(null);\r\n        }\r\n    }\r\n\r\n    private function getFontFromHaxeResource(resourceId:String, callback:String->FontInfo->Void) {\r\n        var text = Resource.getString(resourceId);\r\n        if (text == null) {\r\n            callback(resourceId, null);\r\n            return;\r\n        }\r\n\r\n        var n1 = text.indexOf(\"file=\");\r\n        n1 += 6;\r\n        var n2 = text.indexOf(\"\\\"\", n1);\r\n        var file = text.substring(n1, n2);\r\n        var arr = resourceId.split(\"/\");\r\n        arr.pop();\r\n        var path = arr.join(\"/\");\r\n        var textureId:String = path + \"/\" + file;\r\n\r\n\r\n        var map:Map<String, Dynamic> = Reflect.field(assetPack, \"files\");\r\n        map.set(resourceId, new BasicFile(text));\r\n        getImageFromHaxeResource(textureId, function(r, info) {\r\n            var map:Map<String, Dynamic> = Reflect.field(assetPack, \"textures\");\r\n            map.set(textureId.substr(0, textureId.length - 4), info.data);\r\n            callback(resourceId, {\r\n                data: null\r\n            });\r\n        });\r\n    }\r\n\r\n    public function getTextDelegate(resourceId:String):String {\r\n        try {\r\n            if (assetPack == null) {\r\n                return null;\r\n            }\r\n            var f:File = assetPack.getFile(resourceId);\r\n            if (f != null) {\r\n                return f.toString();\r\n            }\r\n        } catch (e:Dynamic) {\r\n            trace(e);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private function getAssetName(resourceId:String):String {\r\n        var s = resourceId;\r\n        if (s.indexOf(\".\") != -1) {\r\n            var n = s.lastIndexOf(\".\");\r\n            s = s.substr(0, n);\r\n        }\r\n        return s;\r\n    }\r\n}","package haxe.ui;\r\n\r\nimport haxe.ds.Either;\r\nimport haxe.io.Bytes;\r\nimport haxe.Resource;\r\nimport haxe.ui.assets.AssetPlugin;\r\nimport haxe.ui.backend.AssetsBase;\r\nimport haxe.ui.util.CallbackMap;\r\nimport haxe.ui.assets.FontInfo;\r\nimport haxe.ui.assets.ImageInfo;\r\n\r\nclass ToolkitAssets extends AssetsBase {\r\n    private static var _instance:ToolkitAssets;\r\n    public static var instance(get, never):ToolkitAssets;\r\n    private static function get_instance():ToolkitAssets {\r\n        if (_instance == null) {\r\n            _instance = new ToolkitAssets();\r\n        }\r\n        return _instance;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Instance\r\n    //***********************************************************************************************************\r\n    public var options:Dynamic = null;\r\n\r\n    private var _fontCache:Map<String, FontInfo>;\r\n    private var _fontCallbacks:CallbackMap<FontInfo>;\r\n\r\n    private var _imageCache:Map<String, ImageInfo>;\r\n    private var _imageCallbacks:CallbackMap<ImageInfo>;\r\n\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    public function getFont(resourceId:String, callback:FontInfo->Void, useCache:Bool = true):Void {\r\n        if (_fontCache != null && _fontCache.get(resourceId) != null && useCache == true) {\r\n            callback(_fontCache.get(resourceId));\r\n        } else {\r\n            if (_fontCallbacks == null) {\r\n                _fontCallbacks = new CallbackMap<FontInfo>();\r\n            }\r\n\r\n            _fontCallbacks.add(resourceId, callback);\r\n\r\n            if (_fontCallbacks.count(resourceId) == 1) {\r\n                getFontInternal(resourceId, function(font:FontInfo) {\r\n                    if (font != null) {\r\n                        _onFontLoaded(resourceId, font);\r\n                    } else if (Resource.listNames().indexOf(resourceId) != -1) {\r\n                        getFontFromHaxeResource(resourceId, _onFontLoaded);\r\n                    } else {\r\n                        _fontCallbacks.remove(resourceId, callback);\r\n                        callback(null);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private function _onFontLoaded(resourceId:String, font:FontInfo):Void {\r\n        if (_fontCache == null) {\r\n            _fontCache = new Map<String, FontInfo>();\r\n        }\r\n        _fontCache.set(resourceId, font);\r\n        _fontCallbacks.invokeAndRemove(resourceId, font);\r\n    }\r\n\r\n    public function getImage(resourceId:String, callback:ImageInfo->Void, useCache:Bool = true):Void {\r\n        var orginalResourceId = resourceId;\r\n        resourceId = runPlugins(resourceId);\r\n        if (_imageCache != null && _imageCache.get(resourceId) != null && useCache == true) {\r\n            callback(_imageCache.get(resourceId));\r\n        } else {\r\n            if (_imageCallbacks == null) {\r\n                _imageCallbacks = new CallbackMap<ImageInfo>();\r\n            }\r\n\r\n            _imageCallbacks.add(resourceId, callback);\r\n\r\n            if (_imageCallbacks.count(resourceId) == 1) {\r\n                getImageInternal(resourceId, function(imageInfo:ImageInfo) {\r\n                    if (imageInfo != null) {\r\n                        _onImageLoaded(resourceId, imageInfo);\r\n                    } else if (Resource.listNames().indexOf(orginalResourceId) != -1) {\r\n                        _imageCallbacks.remove(resourceId, callback);\r\n                        _imageCallbacks.add(orginalResourceId, callback);\r\n                        getImageFromHaxeResource(orginalResourceId, _onImageLoaded);\r\n                    } else if (Resource.listNames().indexOf(resourceId) != -1) {\r\n                        getImageFromHaxeResource(resourceId, _onImageLoaded);\r\n                    } else {\r\n                        _imageCallbacks.remove(resourceId, callback);\r\n                        callback(null);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    private function _onImageLoaded(resourceId:String, imageInfo:ImageInfo):Void {\r\n        if (imageInfo != null && (imageInfo.width == -1 || imageInfo.width == -1)) {\r\n            trace(\"WARNING: imageData.originalWidth == -1 || imageData.originalHeight == -1\");\r\n        }\r\n\r\n        if (_imageCache == null) {\r\n            _imageCache = new Map<String, ImageInfo>();\r\n        }\r\n        _imageCache.set(resourceId, imageInfo);\r\n        _imageCallbacks.invokeAndRemove(resourceId, imageInfo);\r\n    }\r\n\r\n\r\n    public function getText(resourceId:String):String {\r\n        var s = getTextDelegate(resourceId);\r\n        if (s == null) {\r\n            s = Resource.getString(resourceId);\r\n        }\r\n        return s;\r\n    }\r\n\r\n    public function getBytes(resourceId):Bytes {\r\n        return null;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Plugins\r\n    //***********************************************************************************************************\r\n    private var _plugins:Array<AssetPlugin>;\r\n    public function addPlugin(plugin:AssetPlugin) {\r\n        if (_plugins == null) {\r\n            _plugins = new Array<AssetPlugin>();\r\n        }\r\n        _plugins.push(plugin);\r\n    }\r\n\r\n    private function runPlugins(asset:Dynamic):Dynamic {\r\n        if (_plugins == null) {\r\n            return asset;\r\n        }\r\n\r\n        for (p in _plugins) {\r\n            asset = p.invoke(asset);\r\n        }\r\n\r\n        return asset;\r\n    }\r\n}","package haxe.ui.animation;\r\n\r\nimport haxe.ui.core.Component;\r\n#if actuate\r\nimport motion.easing.IEasing;\r\nimport motion.easing.Back;\r\nimport motion.easing.Bounce;\r\nimport motion.easing.Cubic;\r\nimport motion.easing.Expo;\r\nimport motion.easing.IEasing;\r\nimport motion.easing.Linear;\r\nimport motion.easing.Quad;\r\nimport motion.easing.Quart;\r\nimport motion.easing.Quint;\r\nimport motion.easing.Sine;\r\n#end\r\n\r\nclass Animation {\r\n    public var keyFrames:Array<AnimationKeyFrame> = new Array<AnimationKeyFrame>();\r\n    public var componentMap:Map<String, Component> = new Map<String, Component>();\r\n\r\n    #if actuate\r\n    public var easing:IEasing = Linear.easeNone;\r\n    #else\r\n    public var easing:Dynamic = null;\r\n    #end\r\n\r\n    public var id:String;\r\n\r\n    public function new() {\r\n    }\r\n\r\n    public var easingString(null, set):String;\r\n    private function set_easingString(value:String):String {\r\n        easing = easingFromString(value);\r\n        return value;\r\n    }\r\n\r\n    public function addKeyFrame(time:Int):AnimationKeyFrame {\r\n        var keyFrame:AnimationKeyFrame = new AnimationKeyFrame(time);\r\n        keyFrame.animation = this;\r\n        keyFrames.push(keyFrame);\r\n        return keyFrame;\r\n    }\r\n\r\n    public function setComponent(id:String, component:Component) {\r\n        componentMap.set(id, component);\r\n    }\r\n\r\n    public function getComponent(id:String):Component {\r\n        return componentMap.get(id);\r\n    }\r\n\r\n    private var _currentTime:Int = 0;\r\n    private var _currentFrameIndex:Int = 0;\r\n    private var _complete:Void->Void;\r\n    public function start(complete:Void->Void = null) {\r\n        _complete = complete;\r\n        _stopped = false;\r\n        _currentTime = 0;\r\n        _currentFrameIndex = 0;\r\n        runFrame(_currentFrameIndex);\r\n    }\r\n\r\n    private function runFrame(index:Int) {\r\n        var f:AnimationKeyFrame = keyFrames[index];\r\n        var duration:Float = f.time - _currentTime;\r\n        f.run(duration, function() {\r\n            _currentTime = f.time;\r\n            nextFrame();\r\n        });\r\n    }\r\n\r\n    private function nextFrame() {\r\n        _currentFrameIndex++;\r\n        if (_stopped == true) {\r\n            complete();\r\n            return;\r\n        }\r\n        if (_currentFrameIndex >= keyFrames.length) {\r\n            complete();\r\n        } else {\r\n            runFrame(_currentFrameIndex);\r\n        }\r\n    }\r\n\r\n    public var looping:Bool = false;\r\n\r\n    private var _loop:Bool = false;\r\n    private function complete() {\r\n        if (_loop == true) {\r\n            start();\r\n        } else {\r\n            if (_complete != null) {\r\n                _complete();\r\n            }\r\n        }\r\n    }\r\n\r\n    public function loop(complete:Void->Void = null) {\r\n        _loop = true;\r\n        looping = true;\r\n        start(complete);\r\n    }\r\n\r\n    private var _stopped:Bool = false;\r\n    public function stop() {\r\n        _stopped = true;\r\n        _loop = false;\r\n    }\r\n\r\n    public function fromXML(xml:Xml) {\r\n        id = xml.get(\"id\");\r\n        easing = easingFromString(xml.get(\"ease\"));\r\n        for (keyFrameNode in xml.elementsNamed(\"keyframe\")) {\r\n            var kf = addKeyFrame(Std.parseInt(keyFrameNode.get(\"time\")));\r\n            for (refNode in keyFrameNode.elements()) {\r\n                var r = kf.addComponentRef(refNode.nodeName);\r\n                for (attrName in refNode.attributes()) {\r\n                    var attrValue = refNode.get(attrName);\r\n                    if (StringTools.startsWith(attrValue, \"{\") && StringTools.endsWith(attrValue, \"}\")) {\r\n                        attrValue = attrValue.substring(1, attrValue.length - 1);\r\n                        r.addVar(attrName, attrValue);\r\n                    } else {\r\n                        r.addProperty(attrName, Std.parseFloat(attrValue));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public var vars:Map<String, Float> = new Map<String, Float>();\r\n    public function setVar(name:String, value:Float) {\r\n        vars.set(name, value);\r\n    }\r\n\r\n    public function clone():Animation {\r\n        var c:Animation = new Animation();\r\n        c.id = this.id;\r\n        c.easingString = this.easingString;\r\n        c.easing = this.easing;\r\n        for (f in keyFrames) {\r\n            var cf = f.clone();\r\n            cf.animation = c;\r\n            c.keyFrames.push(cf);\r\n        }\r\n        return c;\r\n    }\r\n\r\n    #if actuate\r\n    public static function easingFromString(s:String):IEasing {\r\n        switch(s) {\r\n            case \"Linear.easeNone\": return Linear.easeNone;\r\n            case \"Back.easeIn\":     return Back.easeIn;\r\n            case \"Back.easeOut\":    return Back.easeOut;\r\n            case \"Bounce.easeIn\":   return Bounce.easeIn;\r\n            case \"Bounce.easeOut\":  return Bounce.easeOut;\r\n            case \"Cubic.easeIn\":    return Cubic.easeIn;\r\n            case \"Cubic.easeOut\":   return Cubic.easeOut;\r\n            case \"Expo.easeIn\":     return Expo.easeIn;\r\n            case \"Expo.easeOut\":    return Expo.easeOut;\r\n            case \"Quad.easeIn\":     return Quad.easeIn;\r\n            case \"Quad.easeOut\":    return Quad.easeOut;\r\n            case \"Quart.easeIn\":    return Quart.easeIn;\r\n            case \"Quart.easeOut\":   return Quart.easeOut;\r\n            case \"Quint.easeIn\":    return Quint.easeIn;\r\n            case \"Quint.easeOut\":   return Quint.easeOut;\r\n            case \"Sine.easeIn\":     return Sine.easeIn;\r\n            case \"Sine.easeOut\":    return Sine.easeOut;\r\n            default:                return Linear.easeNone;\r\n        }\r\n    }\r\n    #else\r\n    public static function easingFromString(s:String):Dynamic {\r\n        return null;\r\n    }\r\n    #end\r\n}","package haxe.ui.animation;\r\n\r\nclass AnimationComponentRef {\r\n    public var keyFrame:AnimationKeyFrame;\r\n\r\n    public var id:String;\r\n    public var properties:Map<String, Float> = new Map<String, Float>();\r\n    public var vars:Map<String, String> = new Map<String, String>();\r\n\r\n    public function new(id:String) {\r\n        this.id = id;\r\n    }\r\n\r\n    public function addProperty(name:String, value:Float) {\r\n        properties.set(name, value);\r\n    }\r\n\r\n    public function addVar(name:String, value:String) {\r\n        vars.set(name, value);\r\n    }\r\n\r\n    public function clone():AnimationComponentRef {\r\n        var c:AnimationComponentRef = new AnimationComponentRef(this.id);\r\n        for (k in this.properties.keys()) {\r\n            c.properties.set(k, this.properties.get(k));\r\n        }\r\n        for (k in this.vars.keys()) {\r\n            c.vars.set(k, this.vars.get(k));\r\n        }\r\n        return c;\r\n    }\r\n}","package haxe.ui.animation;\r\n\r\n#if actuate\r\nimport motion.Actuate;\r\n#end\r\n\r\nclass AnimationKeyFrame {\r\n    public var animation:Animation;\r\n    public var time(default, default):Int;\r\n\r\n    public var componentRefs:Array<AnimationComponentRef> = new Array<AnimationComponentRef>();\r\n\r\n    public function new(time:Int) {\r\n        this.time = time;\r\n    }\r\n\r\n    public function addComponentRef(id:String):AnimationComponentRef {\r\n        var componentRef:AnimationComponentRef = new AnimationComponentRef(id);\r\n        componentRef.keyFrame = this;\r\n        componentRefs.push(componentRef);\r\n        return componentRef;\r\n    }\r\n\r\n    private var _completeCallback:Void->Void;\r\n    private var _count:Int = 0;\r\n\r\n    public function run(duration:Float, complete:Void->Void) {\r\n        _completeCallback = complete;\r\n        _count = componentRefs.length;\r\n        for (ref in componentRefs) {\r\n            if (animation.getComponent(ref.id) == null) {\r\n                _count--;\r\n            }\r\n        }\r\n\r\n        for (ref in componentRefs) {\r\n            var actualComponent = animation.getComponent(ref.id);\r\n            if (actualComponent != null) {\r\n                var props:Dynamic = { };\r\n\r\n                for (k in ref.properties.keys()) {\r\n                    Reflect.setField(props, k,  ref.properties.get(k));\r\n                }\r\n\r\n                for (k in ref.vars.keys()) {\r\n                    var v = ref.vars.get(k);\r\n                    if (animation.vars.exists(v)) {\r\n                        Reflect.setField(props, k, animation.vars.get(v));\r\n                    }\r\n                }\r\n\r\n                #if actuate\r\n                Actuate.tween(actualComponent, duration / 1000, props, true).ease(animation.easing).onComplete(onComplete);\r\n                #end\r\n            }\r\n        }\r\n    }\r\n\r\n    private function onComplete() {\r\n        _count--;\r\n        if (_count == 0) {\r\n            _completeCallback();\r\n        }\r\n    }\r\n\r\n    public function clone():AnimationKeyFrame {\r\n        var c:AnimationKeyFrame = new AnimationKeyFrame(this.time);\r\n        c.animation = this.animation;\r\n        for (r in this.componentRefs) {\r\n            var cr = r.clone();\r\n            cr.keyFrame = c;\r\n            c.componentRefs.push(cr);\r\n        }\r\n        return c;\r\n    }\r\n}","package haxe.ui.animation;\r\nimport haxe.ui.core.Component;\r\n\r\nclass AnimationManager {\r\n    private static var _instance:AnimationManager;\r\n    public static var instance(get, never):AnimationManager;\r\n    private static function get_instance():AnimationManager {\r\n        if (_instance == null) {\r\n            _instance = new AnimationManager();\r\n        }\r\n        return _instance;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Instance\r\n    //***********************************************************************************************************\r\n    private var _animations:Map<String, Animation> = new Map<String, Animation>();\r\n    public function new() {\r\n\r\n    }\r\n\r\n    public function registerAnimation(id:String, animation:Animation) {\r\n        _animations.set(id, animation);\r\n    }\r\n\r\n    public function run(id:String, components:Map<String, Component> = null, vars:Map<String, Float> = null, complete:Void->Void = null):Animation {\r\n        var a:Animation = initAnimation(id, components, vars);\r\n        if (a != null) {\r\n            a.start(function() {\r\n                if (complete != null) {\r\n                    complete();\r\n                }\r\n            });\r\n        }\r\n        return a;\r\n    }\r\n\r\n    public function loop(id:String, components:Map<String, Component> = null, vars:Map<String, Float> = null, complete:Void->Void = null):Animation {\r\n        var a:Animation = initAnimation(id, components, vars);\r\n        if (a != null) {\r\n            a.loop(function() {\r\n                if (complete != null) {\r\n                    complete();\r\n                }\r\n            });\r\n        }\r\n        return a;\r\n    }\r\n\r\n    private function initAnimation(id:String, components:Map<String, Component> = null, vars:Map<String, Float> = null):Animation {\r\n        var a:Animation = get(id);\r\n        if (a != null) {\r\n            if (components != null) {\r\n                for (k in components.keys() ) {\r\n                    a.setComponent(k, components.get(k));\r\n                }\r\n            }\r\n\r\n            if (vars != null) {\r\n                for (k in vars.keys()) {\r\n                    a.setVar(k, vars.get(k));\r\n                }\r\n            }\r\n        }\r\n        return a;\r\n    }\r\n\r\n    public function get(id:String):Animation {\r\n        var a:Animation = _animations.get(id);\r\n        if (a == null) {\r\n            return null;\r\n        }\r\n        return a.clone();\r\n    }\r\n\r\n}","package haxe.ui.assets;\r\n\r\nclass AssetPlugin {\r\n    private var _props:Map<String, String>;\r\n\r\n    public function new() {\r\n\r\n    }\r\n\r\n    public function invoke(asset:Dynamic):Dynamic {\r\n        return asset;\r\n    }\r\n\r\n    public function setProperty(name:String, value:String) {\r\n        if (_props == null) {\r\n            _props = new Map<String, String>();\r\n        }\r\n        _props.set(name, value);\r\n    }\r\n\r\n    public function getProperty(name:String, defaultValue:String = null):String {\r\n        if (_props == null) {\r\n            return defaultValue;\r\n        }\r\n        var v:String = _props.get(name);\r\n        if (v == null) {\r\n            v = defaultValue;\r\n        }\r\n        return v;\r\n    }\r\n}","package haxe.ui.backend;\r\n\r\nimport flambe.Entity;\r\nimport flambe.System;\r\nimport flambe.display.Graphics;\r\nimport flambe.display.Sprite;\r\nimport flambe.input.MouseCursor;\r\nimport flambe.input.PointerEvent;\r\nimport flambe.util.SignalConnection;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.IComponentBase;\r\nimport haxe.ui.core.ImageDisplay;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.core.TextDisplay;\r\nimport haxe.ui.core.TextInput;\r\nimport haxe.ui.core.UIEvent;\r\nimport haxe.ui.backend.flambe.StyleHelper;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.Rectangle;\r\n\r\nclass ComponentBase extends Sprite implements IComponentBase {\r\n    private var _entity:Entity;\r\n    private var _eventMap:Map<String, UIEvent->Void>;\r\n\r\n    public function new() {\r\n        super();\r\n        _entity = new Entity();\r\n        _eventMap = new Map<String, UIEvent->Void>();\r\n        //this.pixelSnapping = false;\r\n    }\r\n\r\n    public function handleCreate(native:Bool):Void {\r\n\r\n    }\r\n\r\n    public override function getNaturalWidth():Float {\r\n        return _naturalWidth;\r\n    }\r\n\r\n    public override function getNaturalHeight():Float {\r\n        return _naturalHeight;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Text related\r\n    //***********************************************************************************************************\r\n    private var _textDisplay:TextDisplay;\r\n    public function createTextDisplay(text:String = null):TextDisplay {\r\n        if (_textDisplay == null) {\r\n            _textDisplay = new TextDisplay();\r\n            _textDisplay.parentComponent = cast this;\r\n            _entity.add(_textDisplay);\r\n        }\r\n        if (text != null) {\r\n            _textDisplay.text = text;\r\n        }\r\n        return _textDisplay;\r\n    }\r\n\r\n    public function getTextDisplay():TextDisplay {\r\n        return createTextDisplay();\r\n    }\r\n\r\n    public function hasTextDisplay():Bool {\r\n        return (_textDisplay != null);\r\n    }\r\n\r\n    private var _textInput:TextInput;\r\n    public function createTextInput(text:String = null):TextInput {\r\n        if (_textInput == null) {\r\n            _textInput = new TextInput();\r\n            _textInput.parentComponent = cast this;\r\n            _entity.add(_textInput);\r\n        }\r\n        if (text != null) {\r\n            _textInput.text = text;\r\n        }\r\n        return _textInput;\r\n    }\r\n\r\n    public function getTextInput():TextInput {\r\n        return createTextInput();\r\n    }\r\n\r\n    public function hasTextInput():Bool {\r\n        return (_textInput != null);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Image related\r\n    //***********************************************************************************************************\r\n    private var _imageDisplay:ImageDisplay;\r\n    public function createImageDisplay():ImageDisplay {\r\n        if (_imageDisplay == null) {\r\n            _imageDisplay = new ImageDisplay();\r\n            _entity.add(_imageDisplay);\r\n        }\r\n        return _imageDisplay;\r\n    }\r\n\r\n    public function getImageDisplay():ImageDisplay {\r\n        return createImageDisplay();\r\n    }\r\n\r\n    public function hasImageDisplay():Bool {\r\n        return (_imageDisplay != null);\r\n    }\r\n\r\n\r\n    public function removeImageDisplay():Void {\r\n        if (_imageDisplay != null) {\r\n            _entity.remove(_imageDisplay);\r\n            _imageDisplay.dispose();\r\n            _imageDisplay = null;\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Display tree\r\n    //***********************************************************************************************************\r\n    private var _childToEntity:Map<Component, Entity>;\r\n    private function handleAddComponent(child:Component):Component {\r\n        if (_childToEntity == null) {\r\n            _childToEntity = new Map<Component, Entity>();\r\n        }\r\n        var childEntity:Entity = new Entity();\r\n        childEntity.add(child);\r\n        _entity.addChild(childEntity);\r\n        _childToEntity.set(child, childEntity);\r\n        return child;\r\n    }\r\n\r\n    private function handleRemoveComponent(child:Component, dispose:Bool = true):Component {\r\n        var childEntity:Entity = _childToEntity.get(child);\r\n        _entity.removeChild(childEntity);\r\n        return child;\r\n    }\r\n\r\n    private function handleVisibility(show:Bool):Void {\r\n        this.visible = show;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Redraw callbacks\r\n    //***********************************************************************************************************\r\n    private function applyStyle(style:Style) {\r\n        if (style.hidden != null) {\r\n            this.visible = !style.hidden;\r\n        }\r\n    }\r\n\r\n    private var _naturalWidth:Float = 0;\r\n    private var _naturalHeight:Float = 0;\r\n    private function handleSize(width:Null<Float>, height:Null<Float>, style:Style) {\r\n        if (width == null || height == null || width <= 0 || height <= 0) {\r\n            return;\r\n        }\r\n\r\n        _naturalWidth = width;\r\n        _naturalHeight = height;\r\n    }\r\n\r\n    private function handlePosition(left:Null<Float>, top:Null<Float>, style:Style):Void {\r\n        if (left != null) {\r\n            this.x._ = left;\r\n        }\r\n        if (top != null) {\r\n            this.y._ = top;\r\n        }\r\n    }\r\n\r\n    private function handleClipRect(value:Rectangle):Void {\r\n        this.scissor = new flambe.math.Rectangle(value.left, value.top, value.width, value.height);\r\n        this.x._ = -value.left + 1;\r\n        this.y._ = -value.top + 1;\r\n    }\r\n\r\n    private function handleReady() {\r\n\r\n    }\r\n\r\n    public function handlePreReposition():Void {\r\n    }\r\n\r\n    public function handlePostReposition():Void {\r\n    }\r\n\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    public override function onStart() {\r\n        super.onStart();\r\n        cast(this, Component).ready();\r\n        owner.addChild(_entity);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Redraw\r\n    //***********************************************************************************************************\r\n\r\n    public override function draw(g:Graphics) {\r\n        if (_naturalWidth <= 0 || _naturalHeight <= 0) {\r\n            return;\r\n        }\r\n\r\n        var style:Style = cast(this, Component).style;\r\n        StyleHelper.paintStyle(g, style, _naturalWidth, _naturalHeight);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    private var _pointerInConnection:SignalConnection;\r\n    private var _pointerOutConnection:SignalConnection;\r\n    private var _pointerDownConnection:SignalConnection;\r\n    private var _pointerUpConnection:SignalConnection;\r\n\r\n    private function mapEvent(type:String, listener:UIEvent->Void) {\r\n        switch (type) {\r\n            case MouseEvent.MOUSE_OVER:\r\n                if (_eventMap.exists(MouseEvent.MOUSE_OVER) == false) {\r\n                    _pointerInConnection = this.pointerIn.connect(__onPointerOver);\r\n                    _eventMap.set(MouseEvent.MOUSE_OVER, listener);\r\n                }\r\n\r\n            case MouseEvent.MOUSE_OUT:\r\n                if (_eventMap.exists(MouseEvent.MOUSE_OUT) == false) {\r\n                    _pointerOutConnection = this.pointerOut.connect(__onPointerOut);\r\n                    _eventMap.set(MouseEvent.MOUSE_OUT, listener);\r\n                }\r\n\r\n            case MouseEvent.MOUSE_DOWN:\r\n                if (_eventMap.exists(MouseEvent.MOUSE_DOWN) == false) {\r\n                    _pointerDownConnection = this.pointerDown.connect(__onPointerDown);\r\n                    _eventMap.set(MouseEvent.MOUSE_DOWN, listener);\r\n                }\r\n\r\n            case MouseEvent.MOUSE_UP:\r\n                if (_eventMap.exists(MouseEvent.MOUSE_UP) == false) {\r\n                    _pointerUpConnection = this.pointerUp.connect(__onPointerUp);\r\n                    _eventMap.set(MouseEvent.MOUSE_UP, listener);\r\n                }\r\n\r\n            case MouseEvent.CLICK:\r\n                if (_eventMap.exists(MouseEvent.CLICK) == false) {\r\n                    _eventMap.set(MouseEvent.CLICK, listener);\r\n\r\n                    if (_eventMap.exists(MouseEvent.MOUSE_DOWN) == false) {\r\n                        _pointerDownConnection = this.pointerDown.connect(__onPointerDown);\r\n                    }\r\n                    if (_eventMap.exists(MouseEvent.MOUSE_UP) == false) {\r\n                        _pointerUpConnection = this.pointerUp.connect(__onPointerUp);\r\n                    }\r\n                }\r\n        }\r\n    }\r\n\r\n    private function unmapEvent(type:String, listener:UIEvent->Void) {\r\n        _eventMap.remove(type);\r\n\r\n        if (_eventMap.exists(MouseEvent.MOUSE_OVER) == false) {\r\n            if (_pointerInConnection != null) {\r\n                _pointerInConnection.dispose();\r\n                _pointerInConnection = null;\r\n            }\r\n        }\r\n        if (_eventMap.exists(MouseEvent.MOUSE_OUT) == false) {\r\n            if (_pointerOutConnection != null) {\r\n                _pointerOutConnection.dispose();\r\n                _pointerOutConnection = null;\r\n            }\r\n        }\r\n        if (_eventMap.exists(MouseEvent.MOUSE_DOWN) == false\r\n            && _eventMap.exists(MouseEvent.CLICK) == false) {\r\n            if (_pointerDownConnection != null) {\r\n                _pointerDownConnection.dispose();\r\n                _pointerDownConnection = null;\r\n            }\r\n        }\r\n        if (_eventMap.exists(MouseEvent.MOUSE_UP) == false\r\n            && _eventMap.exists(MouseEvent.CLICK) == false) {\r\n            if (_pointerUpConnection != null) {\r\n                _pointerUpConnection.dispose();\r\n                _pointerUpConnection = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    private function __onPointerOver(event:PointerEvent):Void {\r\n        dispatchMouseEvent(MouseEvent.MOUSE_OVER, event);\r\n\r\n        var useHandCursor = false;\r\n        var style:Style = cast(this, Component).style;\r\n        if (style.cursor != null && style.cursor == \"pointer\") {\r\n            useHandCursor = true;\r\n        }\r\n        if (useHandCursor == true) {\r\n            System.mouse.cursor = MouseCursor.Button;\r\n        }\r\n    }\r\n\r\n    private function __onPointerOut(event:PointerEvent):Void {\r\n        dispatchMouseEvent(MouseEvent.MOUSE_OUT, event);\r\n\r\n        var useHandCursor = false;\r\n        var style:Style = cast(this, Component).style;\r\n        if (style.cursor != null && style.cursor == \"pointer\") {\r\n            useHandCursor = true;\r\n        }\r\n        if (useHandCursor == true) {\r\n            System.mouse.cursor = MouseCursor.Default;\r\n        }\r\n    }\r\n\r\n    private var _pointerDownFlag:Bool = false;\r\n    private function __onPointerDown(event:PointerEvent):Void {\r\n        _pointerDownFlag = true;\r\n        dispatchMouseEvent(MouseEvent.MOUSE_DOWN, event);\r\n    }\r\n\r\n    private function __onPointerUp(event:PointerEvent):Void {\r\n        if (_pointerDownFlag == true) {\r\n            dispatchMouseEvent(MouseEvent.CLICK, event);\r\n        }\r\n\r\n        _pointerDownFlag = false;\r\n        dispatchMouseEvent(MouseEvent.MOUSE_UP, event);\r\n    }\r\n\r\n    private function dispatchMouseEvent(type:String, copyFrom:PointerEvent):Void {\r\n        copyFrom.stopPropagation();\r\n        var fn = _eventMap.get(type);\r\n        if (fn != null) {\r\n            var mouseEvent = new MouseEvent(type);\r\n            mouseEvent.screenX = copyFrom.viewX;\r\n            mouseEvent.screenY = copyFrom.viewY;\r\n            fn(mouseEvent);\r\n        }\r\n    }\r\n}","package haxe.ui.backend;\r\n\r\nimport flambe.display.ImageSprite;\r\nimport haxe.ui.assets.ImageInfo;\r\n\r\n#if (html || js)\r\nimport js.Browser;\r\nimport js.html.*;\r\n#else\r\nimport haxe.ui.util.ByteConverter;\r\nimport flash.display.Bitmap;\r\nimport flash.display.Loader;\r\nimport flash.events.Event;\r\nimport flash.utils.ByteArray;\r\n#end\r\n\r\nclass ImageDisplayBase extends ImageSprite {\r\n    public var aspectRatio:Float = 1; // width x height\r\n\r\n    private var _originalWidth:Float;\r\n    private var _originalHeight:Float;\r\n\r\n    public function new() {\r\n        super(null);\r\n    }\r\n\r\n    public var left(get, set):Float;\r\n    private function get_left():Float {\r\n        return this.x._;\r\n    }\r\n    private function set_left(value:Float):Float {\r\n        this.x._ = value;\r\n        return value;\r\n    }\r\n\r\n    public var top(get, set):Float;\r\n    private function get_top():Float {\r\n        return this.y._;\r\n    }\r\n    private function set_top(value:Float):Float {\r\n        this.y._ = value;\r\n        return value;\r\n    }\r\n\r\n    public var imageWidth(get, set):Float;\r\n    private function set_imageWidth(value:Float):Float {\r\n        //this.scaleX._ = value / _originalWidth;\r\n        return value;\r\n    }\r\n\r\n    private function get_imageWidth():Float {\r\n        return this.getNaturalWidth() * this.scaleX._;\r\n    }\r\n\r\n    public var imageHeight(get, set):Float;\r\n    private function set_imageHeight(value:Float):Float {\r\n        //this.scaleY._ = value / _originalHeight;\r\n        return value;\r\n    }\r\n\r\n    private function get_imageHeight():Float {\r\n        return this.getNaturalHeight() * this.scaleY._;\r\n    }\r\n\r\n\r\n    private var _imageInfo:ImageInfo;\r\n    public var imageInfo(get, set):ImageInfo;\r\n    private function get_imageInfo():ImageInfo {\r\n        return _imageInfo;\r\n    }\r\n    private function set_imageInfo(value:ImageInfo):ImageInfo {\r\n        _imageInfo = value;\r\n        this.texture = _imageInfo.data;\r\n        _originalWidth = _imageInfo.width;\r\n        _originalHeight = _imageInfo.height;\r\n        aspectRatio = _imageInfo.width / _imageInfo.height;\r\n        imageWidth = _imageInfo.width;\r\n        imageHeight = _imageInfo.height;\r\n        return value;\r\n    }\r\n}","package haxe.ui.backend;\r\n\r\nimport flambe.Entity;\r\nimport flambe.System;\r\nimport flambe.util.SignalConnection;\r\nimport haxe.ui.containers.dialogs.Dialog;\r\nimport haxe.ui.containers.dialogs.DialogButton;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.core.UIEvent;\r\n\r\nclass ScreenBase {\r\n    private var _mapping:Map<String, UIEvent->Void>;\r\n    private var _entityMap:Map<Component, Entity> = new Map<Component, Entity>();\r\n\r\n    public function new() {\r\n        _mapping = new Map<String, UIEvent->Void>();\r\n    }\r\n\r\n    public var options(default, default):Dynamic;\r\n\r\n    public var width(get, null):Float;\r\n    public function get_width():Float {\r\n        return System.stage.width;\r\n    }\r\n\r\n    public var height(get, null):Float;\r\n    public function get_height() {\r\n        return System.stage.height;\r\n    }\r\n\r\n    public var focus(get, set):Component;\r\n    private function get_focus():Component {\r\n        return null;\r\n    }\r\n    private function set_focus(value:Component):Component {\r\n        return value;\r\n    }\r\n\r\n    public function addComponent(component:Component) {\r\n        resizeComponent(component);\r\n        var entity = new Entity().add(component);\r\n        _entityMap.set(component, entity);\r\n        System.root.addChild(entity);\r\n    }\r\n\r\n    public function removeComponent(component:Component) {\r\n        var entity = _entityMap.get(component);\r\n        _entityMap.remove(component);\r\n        System.root.removeChild(entity);\r\n    }\r\n\r\n    private function resizeComponent(c:Component) {\r\n        if (c.percentWidth > 0) {\r\n            c.width = (this.width * c.percentWidth) / 100;\r\n        }\r\n        if (c.percentHeight > 0) {\r\n            c.height = (this.height * c.percentHeight) / 100;\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Dialogs\r\n    //***********************************************************************************************************\r\n    public function messageDialog(message:String, title:String = null, options:Dynamic = null, callback:DialogButton->Void = null):Dialog {\r\n        return null;\r\n    }\r\n\r\n    public function showDialog(content:Component, options:Dynamic = null, callback:DialogButton->Void = null):Dialog {\r\n        return null;\r\n    }\r\n\r\n    public function hideDialog(dialog:Dialog):Bool {\r\n        return false;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    private var _mouseDownConnection:SignalConnection;\r\n    private var _mouseUpConnection:SignalConnection;\r\n    private var _mouseMoveConnection:SignalConnection;\r\n\r\n    private function supportsEvent(type:String):Bool {\r\n        switch (type) {\r\n            case MouseEvent.MOUSE_DOWN | MouseEvent.MOUSE_UP | MouseEvent.MOUSE_MOVE:\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private function mapEvent(type:String, listener:UIEvent->Void) {\r\n        switch (type) {\r\n            case MouseEvent.MOUSE_DOWN:\r\n                if (_mapping.exists(type) == false) {\r\n                    _mapping.set(type, listener);\r\n                    _mouseDownConnection = System.mouse.down.connect(__onMouseDown);\r\n                }\r\n            case MouseEvent.MOUSE_UP:\r\n                if (_mapping.exists(type) == false) {\r\n                    _mapping.set(type, listener);\r\n                    _mouseUpConnection = System.mouse.up.connect(__onMouseUp);\r\n                }\r\n            case MouseEvent.MOUSE_MOVE:\r\n                if (_mapping.exists(type) == false) {\r\n                    _mapping.set(type, listener);\r\n                    _mouseMoveConnection = System.mouse.move.connect(__onMouseMove);\r\n                }\r\n        }\r\n    }\r\n\r\n    private function unmapEvent(type:String, listener:UIEvent->Void) {\r\n        switch (type) {\r\n            case MouseEvent.MOUSE_DOWN:\r\n                _mapping.remove(type);\r\n                if (_mouseDownConnection != null) {\r\n                    _mouseDownConnection.dispose();\r\n                    _mouseDownConnection = null;\r\n                }\r\n            case MouseEvent.MOUSE_UP:\r\n                _mapping.remove(type);\r\n                if (_mouseUpConnection != null) {\r\n                    _mouseUpConnection.dispose();\r\n                    _mouseUpConnection = null;\r\n                }\r\n            case MouseEvent.MOUSE_MOVE:\r\n                _mapping.remove(type);\r\n                if (_mouseMoveConnection != null) {\r\n                    _mouseMoveConnection.dispose();\r\n                    _mouseMoveConnection = null;\r\n                }\r\n        }\r\n    }\r\n\r\n    private function __onMouseDown(event:flambe.input.MouseEvent):Void {\r\n        dispatchMouseEvent(MouseEvent.MOUSE_DOWN, event);\r\n    }\r\n\r\n    private function __onMouseUp(event:flambe.input.MouseEvent):Void {\r\n        dispatchMouseEvent(MouseEvent.MOUSE_UP, event);\r\n    }\r\n\r\n    private function __onMouseMove(event:flambe.input.MouseEvent):Void {\r\n        dispatchMouseEvent(MouseEvent.MOUSE_MOVE, event);\r\n    }\r\n\r\n    private function dispatchMouseEvent(type:String, copyFrom:flambe.input.MouseEvent):Void {\r\n        var fn = _mapping.get(type);\r\n        if (fn != null) {\r\n            var mouseEvent = new MouseEvent(type);\r\n            mouseEvent.screenX = copyFrom.viewX;\r\n            mouseEvent.screenY = copyFrom.viewY;\r\n            fn(mouseEvent);\r\n        }\r\n    }\r\n}","package haxe.ui.backend.flambe;\r\n\r\nimport flambe.display.Font;\r\nimport flambe.display.Graphics;\r\nimport flambe.display.TextSprite;\r\n\r\nclass TextSpriteEx extends TextSprite {\r\n    public function new(font :Font, ?text :String = \"\") {\r\n        super(font, text);\r\n    }\r\n\r\n    override private function updateLayout() {\r\n        if (_font == null) {\r\n            return;\r\n        }\r\n\r\n        super.updateLayout();\r\n    }\r\n\r\n    override public function getNaturalWidth():Float {\r\n        updateLayout();\r\n        if (_layout == null) {\r\n            return 0;\r\n        }\r\n        return super.getNaturalWidth();\r\n    }\r\n\r\n    override public function getNaturalHeight():Float {\r\n        updateLayout();\r\n        if (_layout == null) {\r\n            return 0;\r\n        }\r\n        return super.getNaturalHeight();\r\n    }\r\n\r\n    override public function containsLocal(localX:Float, localY:Float):Bool {\r\n        if (_layout == null) {\r\n            return false;\r\n        }\r\n        return super.containsLocal(localX, localY);\r\n    }\r\n\r\n    override public function draw(g:Graphics) {\r\n        if (_layout == null) {\r\n            return;\r\n        }\r\n        super.draw(g);\r\n    }\r\n}","package haxe.ui.backend;\r\n\r\nimport flambe.asset.AssetPack;\r\nimport flambe.display.Font;\r\nimport haxe.ui.Toolkit;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.backend.flambe.TextSpriteEx;\r\n\r\nclass TextDisplayBase extends TextSpriteEx {\r\n    public var parentComponent:Component;\r\n\r\n    public function new() {\r\n        super(null);\r\n    }\r\n\r\n    public var left(get, set):Float;\r\n    private function get_left():Float {\r\n        return this.x._;\r\n    }\r\n    private function set_left(value:Float):Float {\r\n        this.x._ = value;\r\n        return value;\r\n    }\r\n\r\n    public var top(get, set):Float;\r\n    private function get_top():Float {\r\n        return this.y._;\r\n    }\r\n    private function set_top(value:Float):Float {\r\n        this.y._ = value;\r\n        return value;\r\n    }\r\n\r\n    public var width(get, set):Float;\r\n    public function set_width(value:Float):Float {\r\n        return value;\r\n    }\r\n\r\n    public function get_width():Float {\r\n        return textWidth;\r\n    }\r\n\r\n    public var height(get, set):Float;\r\n    public function set_height(value:Float):Float {\r\n        return value;\r\n    }\r\n\r\n    public function get_height() {\r\n        return textHeight;\r\n    }\r\n\r\n    public var textWidth(get, null):Float;\r\n    private function get_textWidth():Float {\r\n        return getNaturalWidth();\r\n    }\r\n\r\n    public var textHeight(get, null):Float;\r\n    private function get_textHeight():Float {\r\n        return getNaturalHeight();\r\n    }\r\n\r\n    public var color(get, set):Int;\r\n    private function get_color():Int {\r\n        return 0;\r\n    }\r\n    private function set_color(value:Int):Int {\r\n        return value;\r\n    }\r\n\r\n    private var _fontName:String;\r\n    public var fontName(get, set):String;\r\n    private function get_fontName():String {\r\n        return _fontName;\r\n    }\r\n    private function set_fontName(value:String):String {\r\n        if (value == _fontName) {\r\n            return value;\r\n        }\r\n        _fontName = value;\r\n\r\n        Toolkit.assets.getFont(value, function(f) {\r\n            var pack:AssetPack = ToolkitAssets.instance.assetPack;\r\n            font = new Font(pack, _fontName.substr(0, _fontName.length - 4));\r\n            parentComponent.invalidateLayout();\r\n        });\r\n\r\n        return value;\r\n    }\r\n\r\n    private var _fontSize:Float;// = 16;\r\n    public var fontSize(get, set):Null<Float>;\r\n    private function get_fontSize():Null<Float> {\r\n        return _fontSize;\r\n    }\r\n    private function set_fontSize(value:Null<Float>):Null<Float> {\r\n        if (value == _fontSize) {\r\n            return value;\r\n        }\r\n        return value;\r\n    }\r\n}","package haxe.ui.backend;\r\n\r\nclass TextInputBase extends TextDisplayBase {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n}","package haxe.ui.backend;\r\n\r\nimport haxe.Timer;\r\n\r\nclass TimerBase {\r\n    private var _timer:Timer;\r\n\r\n    public function new(delay:Int, callback:Void->Void) {\r\n        _timer = new Timer(delay);\r\n        _timer.run = function() {\r\n            callback();\r\n        }\r\n    }\r\n\r\n    public function stop() {\r\n        _timer.stop();\r\n    }\r\n}\r\n","package haxe.ui.backend.flambe;\r\n\r\nimport flambe.display.Graphics;\r\nimport flambe.display.Texture;\r\nimport haxe.ui.assets.ImageInfo;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.ColorUtil;\r\nimport haxe.ui.util.Rectangle;\r\nimport haxe.ui.util.Slice9;\r\n\r\nclass StyleHelper {\r\n    public static function paintStyle(g:Graphics, style:Style, w:Float, h:Float):Void {\r\n        var x:Float = 0;\r\n        var y:Float = 0;\r\n\r\n        if (style.borderLeftSize != null\r\n            && style.borderLeftSize == style.borderRightSize\r\n            && style.borderLeftSize == style.borderBottomSize\r\n            && style.borderLeftSize == style.borderTopSize) { // full border\r\n\r\n            var borderSize:Float = style.borderLeftSize;\r\n\r\n            g.fillRect(style.borderTopColor, x, y, w, borderSize); // top\r\n            g.fillRect(style.borderRightColor, x + w - borderSize, y, borderSize, h); // right\r\n            g.fillRect(style.borderBottomColor, x, y + h - borderSize, w, borderSize); // bottom\r\n            g.fillRect(style.borderLeftColor, x, y, borderSize, h); // left\r\n\r\n            x += borderSize;\r\n            y += borderSize;\r\n            w -= borderSize * 2;\r\n            h -= borderSize * 2;\r\n\r\n        } else if (style.borderLeftSize == null\r\n            && style.borderRightSize == null\r\n            && style.borderBottomSize == null\r\n            && style.borderTopSize == null) { // no border\r\n        } else { // compound border\r\n            if (style.borderTopSize != null && style.borderTopSize > 0) {\r\n                g.fillRect(style.borderTopColor, x, y, w, style.borderTopSize); // top\r\n                y += style.borderTopSize;\r\n                h -= style.borderTopSize;\r\n            }\r\n\r\n            if (style.borderLeftSize != null && style.borderLeftSize > 0) {\r\n                g.fillRect(style.borderLeftColor, x, y, style.borderLeftSize, h); // left\r\n                x += style.borderLeftSize;\r\n                w -= style.borderLeftSize;\r\n            }\r\n\r\n            if (style.borderBottomSize != null && style.borderBottomSize > 0) {\r\n                g.fillRect(style.borderBottomColor, x, y + h - style.borderBottomSize, w, style.borderBottomSize); // bottom\r\n                h -= style.borderBottomSize;\r\n            }\r\n\r\n            if (style.borderRightSize != null && style.borderRightSize > 0) {\r\n                g.fillRect(style.borderRightColor, x + w - style.borderRightSize, y, style.borderRightSize, h); // right\r\n                w -= style.borderRightSize;\r\n            }\r\n        }\r\n\r\n        if (style.backgroundColor != null) {\r\n            if (style.backgroundColorEnd != null && style.backgroundColor != style.backgroundColorEnd) {\r\n                var gradientType:String = \"vertical\";\r\n                if (style.backgroundGradientStyle != null) {\r\n                    gradientType = style.backgroundGradientStyle;\r\n                }\r\n\r\n                var arr:Array<Int> = null;\r\n                var n:Int = 0;\r\n                if (gradientType == \"vertical\") {\r\n                    arr = ColorUtil.buildColorArray(style.backgroundColor, style.backgroundColorEnd, Std.int(h));\r\n                    for (c in arr) {\r\n                        g.fillRect(c, x, y + n, w, 1);\r\n                        n++;\r\n                    }\r\n                } else if (gradientType == \"horizontal\") {\r\n                    arr = ColorUtil.buildColorArray(style.backgroundColor, style.backgroundColorEnd, Std.int(w));\r\n                    for (c in arr) {\r\n                        g.fillRect(c, x + n, y, 1, h);\r\n                        n++;\r\n                    }\r\n                }\r\n            } else {\r\n                g.fillRect(style.backgroundColor, x, y, w, h);\r\n                /*\r\n                g.fillRect(0xFFFFFF, x, y, w, h);\r\n                drawShadow(g, 0x888888, x, y, w, h, 3, true);\r\n                */\r\n            }\r\n        }\r\n\r\n        if (style.backgroundImage != null) {\r\n            Toolkit.assets.getImage(style.backgroundImage, function(imageInfo:ImageInfo) {\r\n                paintBitmapBackground(g, imageInfo.data, style, new Rectangle(x, y, w, h));\r\n            });\r\n        }\r\n\r\n        if (style.filter != null) {\r\n            drawShadow(g, 0x888888 | 0x444444, x, y, w, h, 1, true);\r\n        }\r\n    }\r\n\r\n    private static function drawShadow(g:Graphics, color:Int, x:Float, y:Float, w:Float, h:Float, size:Int, inset:Bool = false):Void {\r\n        if (inset == false) {\r\n            for (i in 0...size) {\r\n                g.setAlpha(1 - ((1 / size) * i));\r\n                g.setAlpha(.5);\r\n                g.fillRect(color, x + i, y + w + 1 + i, w + 1, 1); // bottom\r\n                g.fillRect(color, x + w + 1 + i, y + i, 1, h + 2); // right\r\n            }\r\n        } else {\r\n            for (i in 0...size) {\r\n                g.setAlpha(1 - ((1 / size) * i));\r\n                g.setAlpha(.5);\r\n                g.fillRect(color, x + i, y + i, w - i, 1); // top\r\n                g.fillRect(color, x + i, y + i, 1, h - i); // left\r\n            }\r\n        }\r\n        g.setAlpha(1);\r\n    }\r\n\r\n    private static function paintBitmapBackground(graphics:Graphics, texture:Texture, style:Style, rc:Rectangle) {\r\n        var trc:Rectangle = new Rectangle(0, 0, texture.width, texture.height);\r\n        if (style.backgroundImageClipTop != null\r\n            && style.backgroundImageClipLeft != null\r\n            && style.backgroundImageClipBottom != null\r\n            && style.backgroundImageClipRight != null) {\r\n                trc = new Rectangle(style.backgroundImageClipLeft,\r\n                                    style.backgroundImageClipTop,\r\n                                    style.backgroundImageClipRight - style.backgroundImageClipLeft,\r\n                                    style.backgroundImageClipBottom - style.backgroundImageClipTop);\r\n        }\r\n\r\n        var slice:Rectangle = null;\r\n        if (style.backgroundImageSliceTop != null\r\n            && style.backgroundImageSliceLeft != null\r\n            && style.backgroundImageSliceBottom != null\r\n            && style.backgroundImageSliceRight != null) {\r\n            slice = new Rectangle(style.backgroundImageSliceLeft,\r\n                                  style.backgroundImageSliceTop,\r\n                                  style.backgroundImageSliceRight - style.backgroundImageSliceLeft,\r\n                                  style.backgroundImageSliceBottom - style.backgroundImageSliceTop);\r\n        }\r\n\r\n        if (slice == null) {\r\n            if (style.backgroundImageRepeat == null) {\r\n                graphics.drawSubTexture(texture, 0, 0, 0, 0, trc.width, trc.height);\r\n            } else if (style.backgroundImageRepeat == \"repeat\") {\r\n                graphics.drawPattern(texture, 0, 0, rc.width, rc.height);\r\n            } else if (style.backgroundImageRepeat == \"stretch\") {\r\n                graphics.save();\r\n                var sx:Float = rc.width / trc.width;\r\n                var sy:Float = rc.height / trc.height;\r\n                graphics.scale(sx, sy);\r\n                graphics.drawSubTexture(texture, 0, 0, 0, 0, trc.width, trc.height);\r\n                graphics.restore();\r\n            }\r\n        } else {\r\n            var rects:Slice9Rects = Slice9.buildRects(rc.width, rc.height, trc.width, trc.height, slice);\r\n            var srcRects:Array<Rectangle> = rects.src;\r\n            var dstRects:Array<Rectangle> = rects.dst;\r\n            for (i in 0...srcRects.length) {\r\n                var srcRect = new Rectangle(srcRects[i].left + trc.left,\r\n                                            srcRects[i].top + trc.top,\r\n                                            srcRects[i].width,\r\n                                            srcRects[i].height);\r\n                var dstRect = dstRects[i];\r\n                paintBitmap(graphics, texture, srcRect, dstRect);\r\n            }\r\n        }\r\n    }\r\n\r\n    private static function paintBitmap(graphics:Graphics, texture:Texture, srcRect:Rectangle, dstRect:Rectangle) {\r\n        graphics.save();\r\n        var sx:Float = dstRect.width / srcRect.width;\r\n        var sy:Float = dstRect.height / srcRect.height;\r\n        graphics.scale(sx, sy);\r\n        graphics.drawSubTexture(texture, dstRect.left / sx, dstRect.top / sy, srcRect.left, srcRect.top, srcRect.width, srcRect.height);\r\n        graphics.restore();\r\n    }\r\n}","package haxe.ui.core;\r\n\r\nimport haxe.ui.backend.ComponentBase;\r\nimport haxe.ui.core.Component.DeferredBindingInfo;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.layouts.DelegateLayout;\r\nimport haxe.ui.layouts.Layout;\r\nimport haxe.ui.scripting.ScriptInterp;\r\nimport haxe.ui.styles.Parser;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.CallStackHelper;\r\nimport haxe.ui.util.EventMap;\r\nimport haxe.ui.util.GenericConfig;\r\nimport haxe.ui.util.Rectangle;\r\nimport haxe.ui.util.Size;\r\nimport haxe.ui.util.StringUtil;\r\nimport haxe.ui.util.Variant;\r\n\r\n@:dox(hide)\r\nclass BindingInfo {\r\n    public function new() {\r\n    }\r\n    public var target:Component;\r\n    public var targetProperty:String;\r\n    public var sourceProperty:String;\r\n    public var transform:String;\r\n}\r\n\r\n@:dox(hide)\r\nclass DeferredBindingInfo {\r\n    public function new() {\r\n    }\r\n    public var targetId:String;\r\n    public var sourceId:String;\r\n    public var targetProperty:String;\r\n    public var sourceProperty:String;\r\n    public var transform:String;\r\n}\r\n\r\n/**\r\n Base class of all HaxeUI controls\r\n**/\r\n@:allow(haxe.ui.backend.ComponentBase)\r\n@:build(haxe.ui.macros.Macros.buildStyles())\r\n@:autoBuild(haxe.ui.macros.Macros.buildStyles())\r\n@:autoBuild(haxe.ui.macros.Macros.buildBindings())\r\n@:build(haxe.ui.macros.Macros.addClonable())\r\n@:autoBuild(haxe.ui.macros.Macros.addClonable())\r\nclass Component extends ComponentBase implements IComponentBase implements IClonable<Component> {\r\n    public function new() {\r\n        super();\r\n\r\n        #if flash\r\n        addClass(\"flash\");\r\n        #end\r\n        #if html5\r\n        addClass(\"html5\");\r\n        #end\r\n\r\n        var parts:Array<String> = Type.getClassName(Type.getClass(this)).split(\".\");\r\n        var className:String = parts[parts.length - 1].toLowerCase();\r\n        addClass(className, false);\r\n\r\n        layout = new DefaultLayout();\r\n\r\n        createDefaults();\r\n\r\n        // we dont want to actually apply the classes, just find out if native is there or not\r\n        var s = Toolkit.styleSheet.applyClasses(this, false);\r\n        if (s.native != null && hasNativeEntry == true) {\r\n            native = s.native;\r\n        } else {\r\n            create();\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Construction\r\n    //***********************************************************************************************************\r\n    private function create():Void {\r\n        handleCreate(native);\r\n        destroyChildren();\r\n\r\n        layout = createLayout();\r\n        if (native == false || native == null) {\r\n            createChildren();\r\n        }\r\n    }\r\n\r\n    private function createDefaults():Void {\r\n\r\n    }\r\n\r\n    private function createChildren():Void {\r\n\r\n    }\r\n\r\n    private function destroyChildren():Void {\r\n\r\n    }\r\n\r\n    private var hasNativeEntry(get, null):Bool;\r\n    private function get_hasNativeEntry():Bool {\r\n        return getNativeConfigProperty(\".@id\") != null;\r\n    }\r\n\r\n    private var _defaultLayout:Layout;\r\n    private function createLayout():Layout {\r\n        var l:Layout = null;\r\n        if (native == true) {\r\n            var sizeProps = getNativeConfigProperties('.size');\r\n            if (sizeProps != null && sizeProps.exists(\"class\")) {\r\n                var size:DelegateLayoutSize = Type.createInstance(Type.resolveClass(sizeProps.get(\"class\")), []);\r\n                size.config = sizeProps;\r\n                l = new DelegateLayout(size);\r\n            } else {\r\n                var layoutProps = getNativeConfigProperties('.layout');\r\n                if (layoutProps != null && layoutProps.exists(\"class\")) {\r\n                    l = Type.createInstance(Type.resolveClass(layoutProps.get(\"class\")), []);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (l == null) {\r\n            l = _defaultLayout;\r\n        }\r\n        if (l == null) {\r\n            return layout;\r\n        }\r\n        return l;\r\n    }\r\n\r\n    private var _defaultBehaviours:Map<String, Behaviour> = new Map<String, Behaviour>();\r\n    private var _behaviours:Map<String, Behaviour> = new Map<String, Behaviour>();\r\n    private function getBehaviour(id:String):Behaviour {\r\n        var b:Behaviour = _behaviours.get(id);\r\n        if (b != null) {\r\n            return b;\r\n        }\r\n\r\n        if (native == true) {\r\n            var nativeProps = getNativeConfigProperties('.behaviour[id=${id}]');\r\n            if (nativeProps != null && nativeProps.exists(\"class\")) {\r\n                b = Type.createInstance(Type.resolveClass(nativeProps.get(\"class\")), [this]);\r\n                b.config = nativeProps;\r\n            }\r\n        }\r\n\r\n        if (b == null) {\r\n            b = _defaultBehaviours.get(id);\r\n        }\r\n        _behaviours.set(id, b);\r\n        return b;\r\n    }\r\n\r\n    private function behaviourGet(id:String):Variant {\r\n        var b:Behaviour = getBehaviour(id);\r\n        if (b != null) {\r\n            return b.get();\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private function behaviourSet(id:String, value:Variant):Void {\r\n        var b:Behaviour = getBehaviour(id);\r\n        if (b != null) {\r\n            b.set(value);\r\n        }\r\n    }\r\n\r\n    private function behavioursUpdate():Void {\r\n        for (b in _behaviours) {\r\n            if (b != null) {\r\n                b.update();\r\n            }\r\n        }\r\n    }\r\n\r\n    private var _native:Null<Bool> = null;\r\n    /**\r\n     Whether to try to use a native version of this component\r\n    **/\r\n    public var native(get, set):Null<Bool>;\r\n    private function get_native():Null<Bool> {\r\n        if (hasNativeEntry == false) {\r\n            return false;\r\n        }\r\n        return _native;\r\n    }\r\n    private function set_native(value:Null<Bool>):Null<Bool> {\r\n        var className:String = Type.getClassName(Type.getClass(this));\r\n        if (hasNativeEntry == false) {\r\n            return value;\r\n        }\r\n        if (_native == value) {\r\n            return value;\r\n        }\r\n\r\n        if (_ready == false) {\r\n            //return value;\r\n        }\r\n\r\n        _native = value;\r\n        if (_native == true && hasNativeEntry) {\r\n            addClass(\":native\");\r\n        } else {\r\n            removeClass(\":native\");\r\n        }\r\n        _behaviours  = new Map<String, Behaviour>();\r\n        create();\r\n        return value;\r\n    }\r\n\r\n    private var _animatable = true;\r\n    /**\r\n     Whether this component is allowed to animate\r\n    **/\r\n    public var animatable(get, set):Bool;\r\n    private function get_animatable():Bool {\r\n        #if !actuate\r\n            return false;\r\n        #end\r\n        return _animatable;\r\n    }\r\n    private function set_animatable(value:Bool):Bool {\r\n        _animatable = value;\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     User specific data stored against this component instance\r\n    **/\r\n    public var userData(default, default):Dynamic = null;\r\n\r\n    //***********************************************************************************************************\r\n    // General\r\n    //***********************************************************************************************************\r\n    @clonable private var _id:String = null;\r\n    /**\r\n     The identifier of this component\r\n    **/\r\n    @clonable public var id(get, set):String;\r\n    private function get_id():String {\r\n        return _id;\r\n    }\r\n    private function set_id(value:String):String {\r\n        if (_id != value) {\r\n            _id = value;\r\n            //invalidate(InvalidationFlags.STYLE);\r\n            //invalidateDisplay();\r\n        }\r\n        return _id;\r\n    }\r\n\r\n    private var _text:String = null;\r\n    /**\r\n     The text of this component (not used in all sub classes)\r\n    **/\r\n    @clonable public var text(get, set):String;\r\n    private function get_text():String {\r\n        return _text;\r\n    }\r\n    private function set_text(value:String):String {\r\n        if (_text != value) {\r\n            _text = value;\r\n        }\r\n        return _text;\r\n    }\r\n\r\n    /**\r\n     The value of this component. This can mean different things depending on the component.\r\n\r\n     For example a buttons value is its text, and sliders value is its slider position.\r\n    **/\r\n    @clonable public var value(get, set):Variant;\r\n    private function get_value():Variant {\r\n        return text;\r\n    }\r\n    private function set_value(value:Variant):Variant {\r\n        text = value;\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     Reference to the `Screen` object this component is displayed on\r\n    **/\r\n    public var screen(get, null):Screen;\r\n    private function get_screen():Screen {\r\n        return Toolkit.screen;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    //{Binding related}\r\n    //***********************************************************************************************************\r\n    private var _bindings:Map<String, Array<BindingInfo>>;\r\n    /**\r\n     Binds a property of this component to the property of another\r\n    **/\r\n    @:dox(group=\"Binding related properties and methods\")\r\n    public function addBinding(target:Component, transform:String = null, targetProperty:String = \"value\", sourceProperty:String = \"value\") {\r\n        if (_bindings == null) {\r\n            _bindings = new Map<String, Array<BindingInfo>>();\r\n        }\r\n\r\n        var array:Array<BindingInfo> = _bindings.get(sourceProperty);\r\n        if (array == null) {\r\n            array = new Array<BindingInfo>();\r\n            _bindings.set(sourceProperty, array);\r\n        }\r\n\r\n        var info:BindingInfo = new BindingInfo();\r\n        info.target = target;\r\n        info.targetProperty = targetProperty;\r\n        info.sourceProperty = sourceProperty;\r\n        info.transform = transform;\r\n        array.push(info);\r\n    }\r\n\r\n    private var _deferredBindings:Array<DeferredBindingInfo>;\r\n    /**\r\n     Binds a property of this component to the property of another that may or may not current exist in the component tree\r\n    **/\r\n    @:dox(group=\"Binding related properties and methods\")\r\n    public function addDeferredBinding(targetId:String, sourceId:String, transform:String = null, targetProperty:String = \"value\", sourceProperty:String = \"value\") {\r\n        if (_deferredBindings == null) {\r\n            _deferredBindings = new Array<DeferredBindingInfo>();\r\n        }\r\n\r\n        var deferredBinding:DeferredBindingInfo = new DeferredBindingInfo();\r\n        deferredBinding.targetId = targetId;\r\n        deferredBinding.sourceId = sourceId;\r\n        deferredBinding.transform = transform;\r\n        deferredBinding.targetProperty = targetProperty;\r\n        deferredBinding.sourceProperty = sourceProperty;\r\n\r\n        _deferredBindings.push(deferredBinding);\r\n    }\r\n\r\n    private function getDefferedBindings():Array<DeferredBindingInfo> {\r\n        var b = null;\r\n        var c = this;\r\n        while (b == null && c != null) {\r\n            if (c._deferredBindings != null) {\r\n                b = c._deferredBindings;\r\n                break;\r\n            }\r\n            c = c.parentComponent;\r\n        }\r\n        return b;\r\n    }\r\n\r\n    private function handleBindings(sourceProperties:Array<String>) {\r\n        if (_bindings == null) {\r\n            return;\r\n        }\r\n\r\n        for (sourceProperty in sourceProperties) {\r\n            var v:Variant = getProperty(sourceProperty);\r\n            if (v == null) {\r\n                continue;\r\n            }\r\n\r\n            var array:Array<BindingInfo> = _bindings.get(sourceProperty);\r\n            if (array == null) {\r\n                continue;\r\n            }\r\n\r\n            for (info in array) {\r\n\r\n                if (info.target == null) {\r\n                    continue;\r\n                }\r\n\r\n                if (info.transform == null) {\r\n                    info.target.setProperty(info.targetProperty, v);\r\n                } else if (info.transform.indexOf(\"${value}\") != -1) {\r\n                    v = StringTools.replace(info.transform, \"${value}\", v);\r\n                    info.target.setProperty(info.targetProperty, v);\r\n                } else if (info.transform.indexOf(\"${\") != -1) {\r\n                    var s:String = info.transform.substr(2, info.transform.length - 3);\r\n\r\n                    // probably not the most effecient method\r\n                    var scriptResult:Variant = null;\r\n                    try {\r\n                        var parser = new hscript.Parser();\r\n                        var program = parser.parseString(s);\r\n                        var interp = findScriptInterp();\r\n                        interp.variables.set(\"Math\", Math);\r\n                        interp.variables.set(\"value\", Variant.toDynamic(v));\r\n                        scriptResult = Variant.fromDynamic(interp.expr(program));\r\n                    } catch (e:Dynamic) {\r\n                        trace(\"Problem executing binding script: \" + e);\r\n                    }\r\n\r\n                    if (scriptResult != null) {\r\n                        info.target.setProperty(info.targetProperty, scriptResult);\r\n                    }\r\n\r\n                } else {\r\n\r\n                }\r\n            }\r\n        }\r\n    }\r\n    //}\r\n    //***********************************************************************************************************\r\n\r\n    //***********************************************************************************************************\r\n    // Clip rect\r\n    //***********************************************************************************************************\r\n    private var _clipRect:Rectangle = null;\r\n    /**\r\n     Whether to clip the display of this component\r\n    **/\r\n    public var clipRect(get, set):Rectangle;\r\n    private function get_clipRect():Rectangle {\r\n        return _clipRect;\r\n    }\r\n    private function set_clipRect(value:Rectangle):Rectangle {\r\n        _clipRect = value;\r\n        handleClipRect(value);\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Display tree\r\n    //***********************************************************************************************************\r\n    /**\r\n     The top level component of this component instance\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public var rootComponent(get, never):Component;\r\n    private function get_rootComponent():Component {\r\n        var r = this;\r\n        while (r.parentComponent != null) {\r\n            r = r.parentComponent;\r\n        }\r\n        return r;\r\n    }\r\n\r\n\r\n    private var _children:Array<Component>;\r\n    /**\r\n     The parent component of this component instance\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public var parentComponent:Component = null;\r\n\r\n    /**\r\n     Adds a child component to this component instance\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public function addComponent(child:Component):Component {\r\n        if (this.native == true) {\r\n            var className:String = Type.getClassName(Type.getClass(this));\r\n            var allowChildren:Bool = getNativeConfigPropertyBool('.@allowChildren', true);\r\n            if (allowChildren == false) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        child.parentComponent = this;\r\n\r\n        if (_children == null) {\r\n            _children = new Array<Component>();\r\n        }\r\n        _children.push(child);\r\n\r\n        var deferredBindings:Array<DeferredBindingInfo> = getDefferedBindings();\r\n        if (deferredBindings != null) {\r\n            var itemsToRemove:Array<DeferredBindingInfo> = new Array<DeferredBindingInfo>();\r\n            for (binding in deferredBindings) {\r\n                var source = findComponent(binding.sourceId, null, true);\r\n                var target = findComponent(binding.targetId, null, true);\r\n                if (source != null && target != null) {\r\n                    source.addBinding(target, binding.transform, binding.targetProperty,  binding.sourceProperty);\r\n                    itemsToRemove.push(binding);\r\n                }\r\n            }\r\n\r\n            // remove found bindings\r\n            for (item in itemsToRemove) {\r\n                deferredBindings.remove(item);\r\n            }\r\n        }\r\n\r\n        handleAddComponent(child);\r\n        if (_ready) {\r\n            child.ready();\r\n        }\r\n\r\n        invalidateLayout();\r\n        return child;\r\n    }\r\n\r\n    /**\r\n     Removes the specified child component from this component instance\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public function removeComponent(child:Component, dispose:Bool = true, invalidate:Bool = true):Component {\r\n        handleRemoveComponent(child, dispose);\r\n        if (_children != null) {\r\n            _children.remove(child);\r\n            invalidateLayout();\r\n        }\r\n\r\n        return child;\r\n    }\r\n\r\n    /**\r\n     Removes all child components from this component instance\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public function removeAllComponents(dispose:Bool = true) {\r\n        if (_children != null) {\r\n            while (_children.length > 0) {\r\n                _children[0].removeAllComponents(dispose);\r\n                removeComponent(_children[0], dispose, false);\r\n            }\r\n            invalidateLayout();\r\n        }\r\n    }\r\n\r\n    /**\r\n     A list of this components children\r\n\r\n     _Note_: This function will return an empty array if the component has no children\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public var childComponents(get, null):Array<Component>;\r\n    private function get_childComponents():Array<Component> {\r\n        if (_children == null) {\r\n            return new Array<Component>();\r\n        }\r\n        return _children;\r\n    }\r\n\r\n    /**\r\n     Finds a specific child in this components display tree (recusively if desired) and can optionally cast the result\r\n\r\n     - `critera` - The criteria by which to search, the interpretation of this is defined using `searchType` (the default search type is _id_)\r\n\r\n     - `type` - The component class you wish to cast the result to (defaults to _null_)\r\n\r\n     - `recursive` - Whether to search this components children and all its childrens children till it finds a match (defaults to _false_)\r\n\r\n     - `searchType` - Allows you specify how to consider a child a match (defaults to _id_), can be either:\r\n\r\n            - `id` - The first component that has the id specified in `criteria` will be considered a match\r\n\r\n            - `css` - The first component that contains a style name specified by `criteria` will be considered a match\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public function findComponent<T>(critera:String, type:Class<T> = null, recursive:Bool = false, searchType:String = \"id\"):Null<T> {\r\n        var match:Component = null;\r\n        for (child in childComponents) {\r\n            if (critera != null) {\r\n                if (searchType == \"id\" && child.id == critera) {\r\n                    match = cast child;\r\n                    break;\r\n                } else if (searchType == \"css\" && child.hasClass(critera) == true) {\r\n                    match = cast child;\r\n                    break;\r\n                }\r\n            } else if (type != null) {\r\n                if (Std.is(child, type) == true) {\r\n                    match = cast child;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (match == null && recursive == true) {\r\n            for (child in childComponents) {\r\n                var temp:Component = cast child.findComponent(critera, type, recursive, searchType);\r\n                if (temp != null) {\r\n                    match = temp;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return cast match;\r\n    }\r\n\r\n    /**\r\n     Gets the index of a child component\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public function getComponentIndex(child:Component):Int {\r\n        var index:Int = -1;\r\n        if (_children != null && child != null) {\r\n            index = _children.indexOf(child);\r\n        }\r\n        return index;\r\n    }\r\n\r\n    /**\r\n     Gets a child component at a specified index\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public function getComponentAt(index:Int):Component {\r\n        if (_children == null) {\r\n            return null;\r\n        }\r\n        return _children[index];\r\n    }\r\n\r\n\r\n    /**\r\n     Hides this component and all its children\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public function hide():Void {\r\n        handleVisibility(false);\r\n        _hidden = true;\r\n        if (parentComponent != null) {\r\n            parentComponent.invalidateLayout();\r\n        }\r\n    }\r\n\r\n    /**\r\n     Shows this component and all its children\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public function show():Void {\r\n        handleVisibility(true);\r\n        _hidden = false;\r\n        if (parentComponent != null) {\r\n            parentComponent.invalidateLayout();\r\n        }\r\n    }\r\n\r\n    private var _hidden:Bool = false;\r\n    /**\r\n     Whether this component is hidden or not\r\n    **/\r\n    @:dox(group=\"Display tree related properties and methods\")\r\n    public var hidden(get, set):Bool;\r\n    private function get_hidden():Bool {\r\n        if (_hidden == true) {\r\n            return true;\r\n        }\r\n        if (parentComponent != null) {\r\n            return parentComponent.hidden;\r\n        }\r\n        return false;\r\n    }\r\n    private function set_hidden(value:Bool):Bool {\r\n        if (value == _hidden) {\r\n            return value;\r\n        }\r\n        if (value == true) {\r\n            hide();\r\n        } else {\r\n            show();\r\n        }\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Style related\r\n    //***********************************************************************************************************\r\n    /**\r\n     A custom style object that will appled to this component after any css rules have been matched and applied\r\n    **/\r\n    @:dox(group=\"Style related properties and methods\")\r\n    public var customStyle:Style = new Style();\r\n    @:dox(group = \"Style related properties and methods\")\r\n    @:allow(haxe.ui.styles.Engine)\r\n    private var classes:Array<String> = new Array<String>();\r\n\r\n    /**\r\n     Adds a css style name to this component\r\n    **/\r\n    @:dox(group=\"Style related properties and methods\")\r\n    public function addClass(name:String, invalidate:Bool = true) {\r\n        if (classes.indexOf(name) == -1) {\r\n            classes.push(name);\r\n            if (invalidate == true) {\r\n                invalidateStyle();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     Removes a css style name from this component\r\n    **/\r\n    @:dox(group=\"Style related properties and methods\")\r\n    public function removeClass(name:String, invalidate:Bool = true) {\r\n        if (classes.indexOf(name) != -1) {\r\n            classes.remove(name);\r\n            if (invalidate == true) {\r\n                invalidateStyle();\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     Whether or not this component has a css class associated with it\r\n    **/\r\n    @:dox(group=\"Style related properties and methods\")\r\n    public function hasClass(name:String):Bool {\r\n        return (classes.indexOf(name) != -1);\r\n    }\r\n\r\n    /**\r\n     A string representation of the css classes associated with this component\r\n    **/\r\n    @:dox(group=\"Style related properties and methods\")\r\n    public var styleNames(get, set):String;\r\n    private function get_styleNames():String {\r\n        return classes.join(\" \");\r\n    }\r\n    private function set_styleNames(value:String):String {\r\n        if (value == null) {\r\n            return value;\r\n        }\r\n\r\n        for (x in value.split(\" \")) {\r\n            addClass(x);\r\n        }\r\n        return value;\r\n    }\r\n\r\n    private var _styleString:String;\r\n    /**\r\n     An inline css string that will be parsed and applied as a custom style\r\n    **/\r\n    @:dox(group=\"Style related properties and methods\")\r\n    public var styleString(null, set):String;\r\n    private function set_styleString(value:String):String {\r\n        if (value == null) {\r\n            return value;\r\n        }\r\n        var cssString = StringTools.trim(value);\r\n        if (cssString.length == 0) {\r\n            return value;\r\n        }\r\n        if (StringTools.endsWith(cssString, \";\") == false) {\r\n            cssString += \";\";\r\n        }\r\n        cssString = \"_ { \" + cssString + \"}\";\r\n        var s = new Parser().parseRules(cssString)[0].s;\r\n        customStyle.apply(s);\r\n        _styleString = value;\r\n        return value;\r\n    }\r\n\r\n    private var _style:Style;\r\n    /**\r\n     The calculated style of this component\r\n    **/\r\n    @:dox(group=\"Style related properties and methods\")\r\n    public var style(get, set):Style;\r\n    private function get_style():Style {\r\n        return _style;\r\n    }\r\n\r\n    private function set_style(value):Style {\r\n        _style = value;\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    private var __events:EventMap;\r\n\r\n    /**\r\n     Register a listener for a certain `UIEvent`\r\n    **/\r\n    @:dox(group=\"Event related properties and methods\")\r\n    public function registerEvent(type:String, listener:Dynamic->Void) {\r\n        if (__events == null) {\r\n            __events = new EventMap();\r\n        }\r\n        if (__events.add(type, listener) == true) {\r\n            mapEvent(type, _onMappedEvent);\r\n        }\r\n    }\r\n\r\n    /**\r\n     Unregister a listener for a certain `UIEvent`\r\n    **/\r\n    @:dox(group=\"Event related properties and methods\")\r\n    public function unregisterEvent(type:String, listener:Dynamic->Void) {\r\n        if (__events != null) {\r\n            if (__events.remove(type, listener) == true) {\r\n                unmapEvent(type, _onMappedEvent);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     Dispatch a certain `UIEvent`\r\n    **/\r\n    @:dox(group=\"Event related properties and methods\")\r\n    public function dispatch(event:UIEvent) {\r\n        if (__events != null) {\r\n            __events.invoke(event.type, event, this);\r\n        }\r\n    }\r\n\r\n    private function _onMappedEvent(event:UIEvent) {\r\n        dispatch(event);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Layout related\r\n    //***********************************************************************************************************\r\n    private var _includeInLayout:Bool = true;\r\n    /**\r\n     Whether to use this component as part of its part layout\r\n\r\n     _Note_: Invisible components are not included in parent layouts\r\n    **/\r\n    @:dox(group=\"Layout related properties and methods\")\r\n    public var includeInLayout(get, set):Bool;\r\n    private function get_includeInLayout():Bool {\r\n        return _includeInLayout && !_hidden;\r\n    }\r\n    private function set_includeInLayout(value:Bool):Bool {\r\n        _includeInLayout = value;\r\n        return value;\r\n    }\r\n\r\n    private var _layout:Layout;\r\n    /**\r\n     The layout of this component\r\n    **/\r\n    @:dox(group=\"Layout related properties and methods\")\r\n    public var layout(get, set):Layout;\r\n    private function get_layout():Layout {\r\n        return _layout;\r\n    }\r\n    private function set_layout(value:Layout):Layout {\r\n        if (value == null) {\r\n            //_layout = null;\r\n            return value;\r\n        }\r\n        _layout = value;\r\n        _layout.component = this;\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Event handlers\r\n    //***********************************************************************************************************\r\n    private var _ready:Bool = false;\r\n    /**\r\n     Whether the framework considers this component ready or not\r\n    **/\r\n    public var isReady(get, null):Bool;\r\n    private function get_isReady():Bool {\r\n        return _ready;\r\n    }\r\n\r\n    /**\r\n     Tells the framework this component is ready\r\n\r\n     _Note_: this is called internally by the framework\r\n    **/\r\n    public function ready() {\r\n        if (_ready == false) {\r\n            invalidateStyle(false);\r\n\r\n            _ready = true;\r\n            handleReady();\r\n\r\n            if (childComponents != null) {\r\n                for (child in childComponents) {\r\n                    child.ready();\r\n                }\r\n            }\r\n\r\n            if (autoWidth == true || autoHeight == true) {\r\n                var s:Size = layout.calcAutoSize();\r\n                var calculatedWidth:Null<Float> = null;\r\n                var calculatedHeight:Null<Float> = null;\r\n                if (autoWidth == true) {\r\n                    calculatedWidth = s.width;\r\n                }\r\n                if (autoHeight == true) {\r\n                    calculatedHeight = s.height;\r\n                }\r\n                resizeComponent(calculatedWidth, calculatedHeight);\r\n            } else {\r\n                invalidateDisplay();\r\n            }\r\n            invalidateLayout();\r\n\r\n            onReady();\r\n        }\r\n    }\r\n\r\n    private function onReady() {\r\n        behavioursUpdate();\r\n\r\n        handleBindings([\"text\", \"value\", \"width\", \"height\"]);\r\n        initScript();\r\n    }\r\n\r\n    private function onResized() {\r\n\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Styles\r\n    //***********************************************************************************************************\r\n    @style      public var backgroundColor:Int;\r\n    @style      public var borderColor:Int;\r\n    @style      public var borderSize:Float;\r\n    @style      public var borderRadius:Float;\r\n\r\n    @style      public var paddingLeft:Float;\r\n    @style      public var paddingRight:Float;\r\n    @style      public var paddingTop:Float;\r\n    @style      public var paddingBottom:Float;\r\n\r\n    @style      public var marginLeft:Float;\r\n    @style      public var marginRight:Float;\r\n    @style      public var marginTop:Float;\r\n    @style      public var marginBottom:Float;\r\n    @style      public var clip:Bool;\r\n\r\n    @style      public var opacity:Float;\r\n\r\n    //***********************************************************************************************************\r\n    // Size related\r\n    //***********************************************************************************************************\r\n    /**\r\n     Whether this component will automatically resize itself based on it childrens calculated width\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    public var autoWidth(get, null):Bool;\r\n    private function get_autoWidth():Bool {\r\n        if (_percentWidth != null || _width != null || style == null) {\r\n            return false;\r\n        }\r\n        if (style.autoWidth == null) {\r\n            return false;\r\n        }\r\n        return style.autoWidth;\r\n    }\r\n\r\n    /**\r\n     Whether this component will automatically resize itself based on it childrens calculated height\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    public var autoHeight(get, null):Bool;\r\n    private function get_autoHeight():Bool {\r\n        if (_percentHeight != null || _height  != null || style == null) {\r\n            return false;\r\n        }\r\n        if (style.autoHeight == null) {\r\n            return false;\r\n        }\r\n        return style.autoHeight;\r\n    }\r\n\r\n    /**\r\n     Resize this components width and height in one call\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    public function resizeComponent(width:Null<Float>, height:Null<Float>) {\r\n        var invalidate:Bool = false;\r\n        if (width != null && _componentWidth != width) {\r\n            _componentWidth = width;\r\n\r\n            invalidate = true;\r\n        }\r\n\r\n        if (height != null && _componentHeight != height) {\r\n            _componentHeight = height;\r\n\r\n            invalidate = true;\r\n        }\r\n\r\n        if (invalidate == true) {\r\n            invalidateDisplay();\r\n            invalidateLayout();\r\n\r\n            onResized();\r\n            dispatch(new UIEvent(UIEvent.RESIZE));\r\n\r\n            if (parentComponent != null) {\r\n                parentComponent.invalidateLayout();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     Autosize this component based on its children\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    private function autoSize():Bool {\r\n        if (_ready == false || _layout == null) {\r\n           return false;\r\n        }\r\n        return layout.autoSize();\r\n    }\r\n\r\n    @clonable private var _percentWidth:Null<Float>;\r\n    /**\r\n     What percentage of this components parent to use to calculate its width\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    @clonable @bindable public var percentWidth(get, set):Null<Float>;\r\n    private function get_percentWidth():Null<Float> {\r\n        return _percentWidth;\r\n    }\r\n    private function set_percentWidth(value:Null<Float>):Null<Float> {\r\n        if (_percentWidth == value) {\r\n            return value;\r\n        }\r\n\r\n        _percentWidth = value;\r\n\r\n        if (parentComponent != null) {\r\n            parentComponent.invalidateLayout();\r\n        }\r\n        return value;\r\n    }\r\n\r\n    @clonable private var _percentHeight:Null<Float>;\r\n    /**\r\n     What percentage of this components parent to use to calculate its height\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    @clonable @bindable public var percentHeight(get, set):Null<Float>;\r\n    private function get_percentHeight():Null<Float> {\r\n        return _percentHeight;\r\n    }\r\n    private function set_percentHeight(value:Null<Float>):Null<Float> {\r\n        if (_percentHeight == value) {\r\n            return value;\r\n        }\r\n        _percentHeight = value;\r\n\r\n        if (parentComponent != null) {\r\n            parentComponent.invalidateLayout();\r\n        }\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     Whether or not a point is inside this components bounds\r\n\r\n     _Note_: `left` and `top` must be stage (screen) co-ords\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    public function hitTest(left:Float, top:Float):Bool { // co-ords must be stage\r\n        var b:Bool = false;\r\n        var sx:Float = screenLeft;\r\n        var sy:Float = screenTop;\r\n        var cx:Float = 0;\r\n        if (componentWidth != null) {\r\n            cx = componentWidth;\r\n        }\r\n        var cy:Float = 0;\r\n        if (componentHeight != null) {\r\n            cy = componentHeight;\r\n        }\r\n\r\n        if (cx <= 0 || cy <= 0) {\r\n            return false;\r\n        }\r\n\r\n        if (left > sx && left < sx + cx && top > sy && top < sy + cy) {\r\n            b = true;\r\n        }\r\n\r\n        return b;\r\n    }\r\n\r\n    private var _componentWidth:Null<Float>;\r\n    @:allow(haxe.ui.layouts.Layout)\r\n    @:allow(haxe.ui.core.Screen)\r\n    /**\r\n     The calculated width of this component\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    private var componentWidth(get, set):Null<Float>;\r\n    private function get_componentWidth():Null<Float> {\r\n        if (_componentWidth == null) {\r\n            return 0;\r\n        }\r\n        return _componentWidth;\r\n    }\r\n    private function set_componentWidth(value:Null<Float>):Null<Float> {\r\n        resizeComponent(value, null);\r\n        return value;\r\n    }\r\n\r\n\r\n    private var _componentHeight:Null<Float>;\r\n    @:allow(haxe.ui.layouts.Layout)\r\n    @:allow(haxe.ui.core.Screen)\r\n    /**\r\n     The calculated height of this component\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    private var componentHeight(get, set):Null<Float>;\r\n    private function get_componentHeight():Null<Float> {\r\n        if (_componentHeight == null) {\r\n            return 0;\r\n        }\r\n        return _componentHeight;\r\n    }\r\n    private function set_componentHeight(value:Null<Float>):Null<Float> {\r\n        resizeComponent(null, value);\r\n        return value;\r\n    }\r\n\r\n    #if (openfl || nme)\r\n\r\n    private var _width:Null<Float>;\r\n    #if flash @:setter(width) #else override #end\r\n    public function set_width(value:Float): #if flash Void #else Float #end {\r\n        if (_width == value) {\r\n            return #if !flash value #end;\r\n        }\r\n        _width = value;\r\n        componentWidth = value;\r\n        #if !flash return value; #end\r\n    }\r\n\r\n    #if flash @:getter(width) #else override #end\r\n    public function get_width():Float {\r\n        var f:Float = componentWidth;\r\n        return f;\r\n    }\r\n\r\n    private var _height:Null<Float>;\r\n    #if flash @:setter(height) #else override #end\r\n    public function set_height(value:Float): #if flash Void #else Float #end {\r\n        if (_height == value) {\r\n            return #if !flash value #end;\r\n        }\r\n        _height = value;\r\n        componentHeight = value;\r\n        #if !flash return value; #end\r\n    }\r\n\r\n    #if flash @:getter(height) #else override #end\r\n    public function get_height():Float {\r\n        var f:Float = componentHeight;\r\n        return f;\r\n    }\r\n\r\n    #else\r\n\r\n    /**\r\n     The width of this component\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    @clonable @bindable public var width(get, set):Float;\r\n    private var _width:Null<Float>;\r\n    private function set_width(value:Float):Float {\r\n        if (_width == value) {\r\n            return value;\r\n        }\r\n        _width = value;\r\n        componentWidth = value;\r\n        return value;\r\n    }\r\n\r\n    private function get_width():Float {\r\n        var f:Float = componentWidth;\r\n        return f;\r\n    }\r\n\r\n    /**\r\n     The height of this component\r\n    **/\r\n    @:dox(group=\"Size related properties and methods\")\r\n    @clonable @bindable public var height(get, set):Float;\r\n    private var _height:Null<Float>;\r\n    private function set_height(value:Float):Float {\r\n        if (_height == value) {\r\n            return value;\r\n        }\r\n        _height = value;\r\n        componentHeight = value;\r\n        return value;\r\n    }\r\n\r\n    private function get_height() {\r\n        var f:Float = componentHeight;\r\n        return f;\r\n    }\r\n\r\n    #end\r\n\r\n    //***********************************************************************************************************\r\n    // Position related\r\n    //***********************************************************************************************************\r\n    /**\r\n     Move this components left and top co-ord in one call\r\n    **/\r\n    @:dox(group=\"Position related properties and methods\")\r\n    public function moveComponent(left:Null<Float>, top:Null<Float>) {\r\n        var invalidate:Bool = false;\r\n        if (left != null && _left != left) {\r\n            _left = left;\r\n            invalidate = true;\r\n        }\r\n        if (top != null && _top != top) {\r\n            _top = top;\r\n            invalidate = true;\r\n        }\r\n\r\n        if (invalidate == true) {\r\n            handlePosition(_left, _top, _style);\r\n        }\r\n    }\r\n\r\n    private var _left:Null<Float> = 0;\r\n    /**\r\n     The left co-ord of this component relative to its parent\r\n    **/\r\n    @:dox(group=\"Position related properties and methods\")\r\n    public var left(get, set):Null<Float>;\r\n    private function get_left():Null<Float> {\r\n        return _left;\r\n    }\r\n    private function set_left(value:Null<Float>):Null<Float> {\r\n        moveComponent(value, null);\r\n        return value;\r\n    }\r\n\r\n    private var _top:Null<Float> = 0;\r\n    /**\r\n     The top co-ord of this component relative to its parent\r\n    **/\r\n    @:dox(group=\"Position related properties and methods\")\r\n    public var top(get, set):Null<Float>;\r\n    private function get_top():Null<Float> {\r\n        return _top;\r\n    }\r\n    private function set_top(value:Null<Float>):Null<Float> {\r\n        moveComponent(null, value);\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     The left co-ord of this component relative to the screen\r\n    **/\r\n    @:dox(group=\"Position related properties and methods\")\r\n    public var screenLeft(get, null):Float;\r\n    private function get_screenLeft():Float {\r\n        var c:Component = this;\r\n        var xpos:Float = 0;\r\n        while (c != null) {\r\n            xpos += c.left;\r\n            /*\r\n            if (c.sprite.scrollRect != null) {\r\n                xpos -= c.sprite.scrollRect.left;\r\n            }\r\n            */\r\n            c = c.parentComponent;\r\n        }\r\n        return xpos;\r\n    }\r\n\r\n    /**\r\n     The top co-ord of this component relative to the screen\r\n    **/\r\n    @:dox(group=\"Position related properties and methods\")\r\n    public var screenTop(get, null):Float;\r\n    private function get_screenTop():Float {\r\n        var c:Component = this;\r\n        var ypos:Float = 0;\r\n        while (c != null) {\r\n            ypos += c.top;\r\n            /*\r\n            if (c.sprite.scrollRect != null) {\r\n                ypos -= c.sprite.scrollRect.top;\r\n            }\r\n            */\r\n            c = c.parentComponent;\r\n        }\r\n        return ypos;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Script related\r\n    //***********************************************************************************************************\r\n    /**\r\n     Whether or not this component is allowed to be exposed to script interpreters (defaults to _true_)\r\n    **/\r\n    @:dox(group=\"Script related properties and methods\")\r\n    public var scriptAccess:Bool = true;\r\n\r\n    private var _interp:ScriptInterp;\r\n    private var _script:String;\r\n    /**\r\n     A script string to associate with this component\r\n\r\n     _Note_: Setting this to non-null will cause this component to create and maintain its own script interpreter during initialsation\r\n    **/\r\n    @:dox(group=\"Script related properties and methods\")\r\n    public var script(null, set):String;\r\n    private function set_script(value:String):String {\r\n        _script = value;\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     Execute a script call\r\n\r\n     _Note_: This component will first attempt to use its own script interpreter if its avialable otherwise it will scan its parents until it finds one\r\n    **/\r\n    @:dox(group=\"Script related properties and methods\")\r\n    public function executeScriptCall(expr:String) {\r\n        #if allow_script_errors\r\n        try {\r\n        #end\r\n            var parser = new hscript.Parser();\r\n            var line = parser.parseString(expr);\r\n            var interp:ScriptInterp = findScriptInterp();\r\n            interp.variables.set(\"this\", this);\r\n            interp.expr(line);\r\n            interp.variables.remove(\"this\");\r\n        #if allow_script_errors\r\n        } catch (e:Dynamic) {\r\n            trace(\"Problem executing scriptlet: \" + e);\r\n            #if debug\r\n                CallStackHelper.traceExceptionStack();\r\n            #end\r\n        }\r\n        #end\r\n    }\r\n\r\n    private function findScriptInterp(refreshNamedComponents:Bool = true):ScriptInterp {\r\n        var interp:ScriptInterp = null;\r\n        var c:Component = this;\r\n        while (c != null && interp == null) {\r\n            if (c._interp != null) {\r\n                interp = c._interp;\r\n                break;\r\n            }\r\n            c = c.parentComponent;\r\n        }\r\n\r\n        if (interp == null) {\r\n            c = rootComponent;\r\n            c._interp = new ScriptInterp();\r\n            interp = c._interp;\r\n        }\r\n\r\n        if (refreshNamedComponents == true && c != null) {\r\n            var comps:Array<Component> = c.namedComponents;\r\n            for (comp in comps) {\r\n                var safeId = StringUtil.capitalizeHyphens(comp.id);\r\n                interp.variables.set(safeId, comp);\r\n            }\r\n        }\r\n\r\n        return interp;\r\n    }\r\n\r\n    private function initScript():Void {\r\n        if (_script != null) {\r\n            try {\r\n                var parser = new hscript.Parser();\r\n                var program = parser.parseString(_script);\r\n                _interp = new ScriptInterp();\r\n\r\n                var comps:Array<Component> = namedComponents;\r\n                for (comp in comps) {\r\n                    if (comp.scriptAccess == true) {\r\n                        var safeId = StringUtil.capitalizeHyphens(comp.id);\r\n                        _interp.variables.set(safeId, comp);\r\n                    }\r\n                }\r\n\r\n                _interp.execute(program);\r\n            } catch (e:Dynamic) {\r\n                trace(\"Problem initializing script: \" + e);\r\n                CallStackHelper.traceExceptionStack();\r\n            }\r\n        }\r\n    }\r\n\r\n    private var _scriptEvents:Map<String, String>;\r\n    /**\r\n     Registers a piece of hscript to be execute when a certain `UIEvent` is fired\r\n    **/\r\n    @:dox(group=\"Script related properties and methods\")\r\n    public function addScriptEvent(event:String, script:String):Void {\r\n        event = event.toLowerCase();\r\n        if (_scriptEvents == null) {\r\n            _scriptEvents = new Map<String, String>();\r\n        }\r\n        _scriptEvents.set(event, script);\r\n        switch (event) {\r\n            case \"onclick\":\r\n                registerEvent(MouseEvent.CLICK, _onScriptClick);\r\n            case \"onchange\":\r\n                registerEvent(UIEvent.CHANGE, _onScriptChange);\r\n        }\r\n    }\r\n\r\n    private function _onScriptClick(event:MouseEvent):Void {\r\n        if (_scriptEvents != null) {\r\n            var script:String = _scriptEvents.get(\"onclick\");\r\n            if (script != null) {\r\n                executeScriptCall(script);\r\n            }\r\n        }\r\n    }\r\n\r\n    private function _onScriptChange(event:UIEvent):Void {\r\n        if (_scriptEvents != null) {\r\n            var script:String = _scriptEvents.get(\"onchange\");\r\n            if (script != null) {\r\n                executeScriptCall(script);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     Recursively generates list of all child components that have specified an `id`\r\n    **/\r\n    @:dox(group=\"Script related properties and methods\")\r\n    public var namedComponents(get, null):Array<Component>;\r\n    private function get_namedComponents():Array<Component> {\r\n        var list:Array<Component> = new Array<Component>();\r\n        addNamedComponentsFrom(this, list);\r\n        return list;\r\n    }\r\n\r\n    private static function addNamedComponentsFrom(parent:Component, list:Array<Component>):Void {\r\n        if (parent == null) {\r\n            return;\r\n        }\r\n\r\n        if (parent.id != null) {\r\n            list.push(parent);\r\n        }\r\n\r\n        for (child in parent.childComponents) {\r\n            addNamedComponentsFrom(child, list);\r\n        }\r\n    }\r\n\r\n    private var __onClick:MouseEvent->Void;\r\n    /**\r\n     Utility property to add a single `UIEvent.CLICK` event\r\n    **/\r\n    @:dox(group=\"Event related properties and methods\")\r\n    public var onClick(null, set):MouseEvent->Void;\r\n    private function set_onClick(value:MouseEvent->Void):MouseEvent->Void {\r\n        if (__onClick != null) {\r\n            unregisterEvent(MouseEvent.CLICK, __onClick);\r\n            __onClick = null;\r\n        }\r\n        registerEvent(MouseEvent.CLICK, value);\r\n        __onClick = value;\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     Utility property to add a single `UIEvent.CHANGE` event\r\n    **/\r\n    @:dox(group=\"Event related properties and methods\")\r\n    public var onChange(null, set):UIEvent->Void;\r\n    private function set_onChange(value:UIEvent->Void):UIEvent->Void {\r\n        registerEvent(UIEvent.CHANGE, value);\r\n        return value;\r\n    }\r\n\r\n\r\n    //***********************************************************************************************************\r\n    // Invalidation\r\n    //***********************************************************************************************************\r\n    private var _layoutInvalidating:Bool = false;\r\n    private var _layoutReinvalidation:Bool = false;\r\n    /**\r\n     Invalidate this components layout, may result in multiple calls to `invalidateDisplay` and `invalidateLayout` of its children\r\n    **/\r\n    @:dox(group=\"Invalidation related properties and methods\")\r\n    public function invalidateLayout() {\r\n        if (_ready == false) {\r\n            return;\r\n        }\r\n\r\n        if (_layoutInvalidating == true) {\r\n            // means that if a request to invalidate comes through and were busy\r\n            // (like async resources), we make note to invalidate when were done\r\n            _layoutReinvalidation = true;\r\n            return;\r\n        }\r\n\r\n        _layoutInvalidating = true;\r\n\r\n        layout.refresh();\r\n\r\n        _layoutInvalidating = false;\r\n\r\n        if (_layoutReinvalidation == true) {\r\n            _layoutReinvalidation = false;\r\n            invalidateLayout();\r\n        }\r\n    }\r\n\r\n    private var _displayingInvalidating:Bool = false;\r\n    /**\r\n     Invalidate the visible aspect of this component\r\n    **/\r\n    @:dox(group=\"Invalidation related properties and methods\")\r\n    public function invalidateDisplay() {\r\n        if (_ready == false) {\r\n            return;\r\n        }\r\n\r\n        if (_displayingInvalidating == true) {\r\n            return;\r\n        }\r\n\r\n        if (componentWidth == null || componentHeight == null || componentWidth <= 0 || componentHeight <= 0) {\r\n            return;\r\n        }\r\n\r\n        _displayingInvalidating = true;\r\n\r\n        handleSize(componentWidth, componentHeight, _style);\r\n\r\n        _displayingInvalidating = false;\r\n    }\r\n\r\n    /**\r\n     Invalidate and recalculate this components style, may result in a call to `invalidateDisplay`\r\n    **/\r\n    @:dox(group=\"Invalidation related properties and methods\")\r\n    public function invalidateStyle(invalidate:Bool = true) {\r\n        var s:Style = Toolkit.styleSheet.applyClasses(this, false);\r\n        if (_ready == false || _style == null || _style.equalTo(s) == false) { // lets not update if nothing has changed\r\n            _style = s;\r\n            applyStyle(_style);\r\n            if (invalidate == true) {\r\n                invalidateDisplay();\r\n            }\r\n        }\r\n    }\r\n\r\n    private override function applyStyle(style:Style):Void {\r\n        super.applyStyle(style);\r\n\r\n        if (style.percentWidth != null) {\r\n            percentWidth = style.percentWidth;\r\n        }\r\n        if (style.percentHeight != null) {\r\n            percentHeight = style.percentHeight;\r\n        }\r\n        if (style.width != null) {\r\n            width = style.width;\r\n        }\r\n        if (style.height != null) {\r\n            height = style.height;\r\n        }\r\n\r\n        if (style.native != null) {\r\n            native = style.native;\r\n        }\r\n\r\n        /*\r\n        if (style.clip != null) {\r\n            clipContent = style.clip;\r\n        }\r\n\r\n        if (style.native != null) {\r\n            if (style.backgroundImageSliceTop == null\r\n                && style.backgroundImageSliceLeft == null\r\n                && style.backgroundImageSliceBottom == null\r\n                && style.backgroundImageSliceRight == null) {\r\n                native = style.native;\r\n            }\r\n        }\r\n\r\n        if (style.backgroundImageSliceTop != null\r\n            && style.backgroundImageSliceLeft != null\r\n            && style.backgroundImageSliceBottom != null\r\n            && style.backgroundImageSliceRight != null) {\r\n            native = false;\r\n        }\r\n        */\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Properties\r\n    //***********************************************************************************************************\r\n    private function getProperty(name:String):Variant {\r\n        switch (name) {\r\n            case \"value\":       return this.value;\r\n            case \"width\":       return this.width;\r\n            case \"height\":      return this.height;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private function setProperty(name:String, value:Variant):Variant {\r\n        switch (name) {\r\n            case \"value\":       return this.value = value;\r\n            case \"width\":       return this.width = value;\r\n            case \"height\":      return this.height = value;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     Gets a property that is associated with all classes of this type\r\n    **/\r\n    public function getClassProperty(name:String):String {\r\n        var v = null;\r\n        if (_classProperties != null) {\r\n            v = _classProperties.get(name);\r\n        }\r\n        if (v == null) {\r\n            var c = Type.getClassName(Type.getClass(this)).toLowerCase() + \".\" + name;\r\n            v = Toolkit.properties.get(c);\r\n        }\r\n        return v;\r\n    }\r\n\r\n    private var _classProperties:Map<String, String>;\r\n    /**\r\n     Sets a property that is associated with all classes of this type\r\n    **/\r\n    public function setClassProperty(name:String, value:String) {\r\n        if (_classProperties == null) {\r\n            _classProperties = new Map<String, String>();\r\n        }\r\n        _classProperties.set(name, value);\r\n    }\r\n\r\n    private function getNativeConfigProperty(query:String, defaultValue:String = null):String {\r\n        query = 'component[id=${className}]${query}';\r\n        return Toolkit.nativeConfig.query(query, defaultValue);\r\n    }\r\n\r\n    private function getNativeConfigPropertyBool(query:String, defaultValue:Bool = false):Bool {\r\n        query = 'component[id=${className}]${query}';\r\n        return Toolkit.nativeConfig.queryBool(query, defaultValue);\r\n    }\r\n\r\n    private function getNativeConfigProperties(query:String = \"\"):Map<String, String> {\r\n        query = 'component[id=${className}]${query}';\r\n        return Toolkit.nativeConfig.queryValues(query);\r\n    }\r\n\r\n    public var className(get, null):String;\r\n    private function get_className():String {\r\n        return Type.getClassName(Type.getClass(this));\r\n    }\r\n}",null,"package haxe.ui.core;\r\n\r\nimport haxe.ui.focus.FocusManager;\r\nimport haxe.ui.focus.IFocusable;\r\n\r\n/**\r\n A component that can be interacted with and gain input focus via either mouse or keyboard\r\n**/\r\nclass InteractiveComponent extends Component implements IFocusable implements IClonable<InteractiveComponent> {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    private var _focus:Bool;\r\n    /**\r\n     Whether this component currently has focus\r\n\r\n     _Note_: components that have focus will have an `:active` css psuedo class automatically added\r\n    **/\r\n    public var focus(get, set):Bool;\r\n    private function get_focus():Bool {\r\n        return _focus;\r\n    }\r\n    private function set_focus(value:Bool):Bool {\r\n        if (_focus == value || allowFocus == false) {\r\n            return value;\r\n        }\r\n\r\n        _focus = value;\r\n        if (_focus == true) {\r\n            addClass(\":active\");\r\n        } else {\r\n            removeClass(\":active\");\r\n        }\r\n        return value;\r\n    }\r\n\r\n    private var _allowFocus:Bool = true;\r\n    /**\r\n     Whether this component is allowed to gain focus\r\n    **/\r\n    public var allowFocus(get, set):Bool;\r\n    private function get_allowFocus():Bool {\r\n        return _allowFocus;\r\n    }\r\n    private function set_allowFocus(value:Bool):Bool {\r\n        if (_allowFocus == value) {\r\n            return value;\r\n        }\r\n\r\n        _allowFocus = value;\r\n        return value;\r\n    }\r\n}",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.core.Behaviour;\r\nimport haxe.ui.core.IClonable;\r\nimport haxe.ui.core.InteractiveComponent;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.focus.FocusManager;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.Timer;\r\nimport haxe.ui.util.Variant;\r\n\r\n/**\r\n General purpose push button that supports both text and icon as well as repeat event dispatching\r\n**/\r\n@:dox(icon=\"/icons/ui-button.png\")\r\nclass Button extends InteractiveComponent implements IClonable<Button> {\r\n    private var _label:Label;\r\n    private var _icon:Image;\r\n    private var _repeatTimer:Timer;\r\n\r\n    public function new() {\r\n        super();\r\n        #if openfl\r\n        //mouseChildren = false;\r\n        #end\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        _defaultBehaviours = [\r\n            \"text\" => new ButtonDefaultTextBehaviour(this),\r\n            \"icon\" => new ButtonDefaultIconBehaviour(this)\r\n        ];\r\n        _defaultLayout = new ButtonLayout();\r\n    }\r\n\r\n    private override function create():Void {\r\n        super.create();\r\n        behaviourSet(\"text\", _text);\r\n        behaviourSet(\"icon\", _iconResource);\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        registerEvent(MouseEvent.MOUSE_OVER, _onMouseOver);\r\n        registerEvent(MouseEvent.MOUSE_OUT, _onMouseOut);\r\n        registerEvent(MouseEvent.MOUSE_DOWN, _onMouseDown);\r\n    }\r\n\r\n    private override function destroyChildren():Void {\r\n        super.destroyChildren();\r\n\r\n        unregisterEvent(MouseEvent.MOUSE_OVER, _onMouseOver);\r\n        unregisterEvent(MouseEvent.MOUSE_OUT, _onMouseOut);\r\n        unregisterEvent(MouseEvent.MOUSE_DOWN, _onMouseDown);\r\n\r\n        if (_label != null) {\r\n            removeComponent(_label);\r\n            _label = null;\r\n        }\r\n        if (_icon != null) {\r\n            removeComponent(_icon);\r\n            _icon = null;\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    private override function set_text(value:String):String {\r\n        value = super.set_text(value);\r\n        behaviourSet(\"text\", value);\r\n        return value;\r\n    }\r\n\r\n    private override function applyStyle(style:Style):Void {\r\n        super.applyStyle(style);\r\n        if (style.icon != null) {\r\n            icon = style.icon;\r\n        }\r\n        if (_label != null) {\r\n            _label.customStyle.color = style.color;\r\n            _label.customStyle.fontName = style.fontName;\r\n            _label.customStyle.fontSize = style.fontSize;\r\n            _label.customStyle.cursor = style.cursor;\r\n            _label.invalidateStyle();\r\n        }\r\n        if (_icon != null) {\r\n            _icon.customStyle.cursor = style.cursor;\r\n            _icon.invalidateStyle();\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    /**\r\n     Whether the buttons state should remain pressed even when the mouse has left its bounds\r\n    **/\r\n    @:clonable public var remainPressed(default, default):Bool = false;\r\n\r\n    /**\r\n     Whether this button will dispatch multiple click events while the the mouse is pressed within it\r\n    **/\r\n    @:dox(group=\"Repeater related properties\")\r\n    @:clonable public var repeater(default, default):Bool = false;\r\n\r\n    /**\r\n     How often this button will dispatch multiple click events while the the mouse is pressed within it\r\n    **/\r\n    @:dox(group=\"Repeater related properties\")\r\n    @:clonable public var repeatInterval(default, default):Int = 50;\r\n\r\n    private var _iconResource:String;\r\n    /**\r\n     The image resource to use as the buttons icon\r\n    **/\r\n    @:clonable public var icon(get, set):String;\r\n    private function get_icon():String {\r\n        return _iconResource; // TODO: temp\r\n    }\r\n\r\n    private function set_icon(value:String):String {\r\n        if (_iconResource == value) {\r\n            return value;\r\n        }\r\n\r\n        _iconResource = value;\r\n        behaviourSet(\"icon\", value);\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    private var _down:Bool = false;\r\n    private function _onMouseOver(event:MouseEvent):Void {\r\n        if (event.buttonDown == false || _down == false) {\r\n            addClass(\":hover\");\r\n        } else {\r\n            addClass(\":down\");\r\n        }\r\n    }\r\n\r\n    private function _onMouseOut(event:MouseEvent):Void {\r\n        if (remainPressed == false) {\r\n            removeClass(\":down\");\r\n        }\r\n        removeClass(\":hover\");\r\n    }\r\n\r\n    private function _onMouseDown(event:MouseEvent):Void {\r\n        if (FocusManager.instance.focusInfo != null && FocusManager.instance.focusInfo.currentFocus != null) {\r\n            FocusManager.instance.focusInfo.currentFocus.focus = false;\r\n        }\r\n        _down = true;\r\n        addClass(\":down\");\r\n        screen.registerEvent(MouseEvent.MOUSE_UP, _onMouseUp);\r\n\r\n        if (repeater == true) {\r\n            _repeatTimer = new Timer(repeatInterval, _onRepeatTimer);\r\n        }\r\n    }\r\n\r\n    private function _onRepeatTimer() {\r\n        if (hasClass(\":hover\") && _down == true) {\r\n            var event:MouseEvent = new MouseEvent(MouseEvent.CLICK);\r\n            dispatch(event);\r\n        }\r\n    }\r\n\r\n    private function _onMouseUp(event:MouseEvent):Void {\r\n        _down = false;\r\n        removeClass(\":down\");\r\n        if (hitTest(event.screenX, event.screenY)) {\r\n            addClass(\":hover\");\r\n        }\r\n\r\n        if (_repeatTimer != null) {\r\n            #if !(cpp || neko)\r\n            _repeatTimer.stop();\r\n            _repeatTimer = null;\r\n            #end\r\n        }\r\n\r\n        screen.unregisterEvent(MouseEvent.MOUSE_UP, _onMouseUp);\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Default behaviours\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Button)\r\nclass ButtonDefaultTextBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        if (value.isNull) {\r\n            return;\r\n        }\r\n\r\n        var button:Button = cast _component;\r\n        if (button._label == null) {\r\n            button._label = new Label();\r\n            button._label.id = \"button-label\";\r\n            button._label.scriptAccess = false;\r\n            button.addComponent(button._label);\r\n        }\r\n        button._label.text = value;\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Button)\r\nclass ButtonDefaultIconBehaviour extends Behaviour {\r\n    public override function get():Variant {\r\n        var button:Button = cast _component;\r\n        if (button._icon == null) {\r\n            return null;\r\n        }\r\n\r\n        return button._icon.resource;\r\n    }\r\n\r\n    public override function set(value:Variant) {\r\n        if (value.isNull) {\r\n            return;\r\n        }\r\n\r\n        var button:Button = cast _component;\r\n        if (button._icon == null) {\r\n            button._icon = new Image();\r\n            button._icon.addClass(\"icon\");\r\n            button._icon.id = \"button-icon\";\r\n            button._icon.scriptAccess = false;\r\n            button.addComponent(button._icon);\r\n        }\r\n\r\n        button._icon.resource = value.toString();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\nclass ButtonLayout extends DefaultLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    private var iconPosition(get, null):String;\r\n    private function get_iconPosition():String {\r\n        if (component.style.iconPosition == null) {\r\n            return \"left\";\r\n        }\r\n        return component.style.iconPosition;\r\n    }\r\n\r\n    private override function repositionChildren():Void {\r\n        super.repositionChildren();\r\n\r\n        var label:Label = component.findComponent(\"button-label\");\r\n        var icon:Image = component.findComponent(\"button-icon\");\r\n\r\n        switch (iconPosition) {\r\n            case \"left\" | \"right\":\r\n                if (label != null && icon != null) {\r\n                    var cx:Float = label.componentWidth + icon.componentWidth + horizontalSpacing;\r\n                    var x:Float = Std.int((component.componentWidth / 2) - (cx / 2));\r\n\r\n                    if (iconPosition == \"right\") {\r\n                        label.left = x + marginLeft(label) - marginRight(label);\r\n                        x += horizontalSpacing + label.componentWidth;\r\n                        icon.left = x + marginLeft(icon) - marginRight(icon);\r\n                    } else {\r\n                        icon.left = x + marginLeft(icon) - marginRight(icon);\r\n                        x += horizontalSpacing + icon.componentWidth;\r\n                        label.left = x + marginLeft(label) - marginRight(label);\r\n                    }\r\n\r\n                    label.top = Std.int((component.componentHeight / 2) - (label.componentHeight / 2)) + marginTop(label) - marginBottom(label);\r\n                    icon.top = Std.int((component.componentHeight / 2) - (icon.componentHeight / 2)) + marginTop(icon) - marginBottom(icon);\r\n                } else if (label != null) {\r\n                    label.left = Std.int((component.componentWidth / 2) - (label.componentWidth / 2)) + marginLeft(label) - marginRight(label);\r\n                    label.top = Std.int((component.componentHeight / 2) - (label.componentHeight / 2)) + marginTop(label) - marginBottom(label);\r\n                } else if (icon != null) {\r\n                    icon.left = Std.int((component.componentWidth / 2) - (icon.componentWidth / 2));// + marginLeft(icon) - marginRight(icon);\r\n                    icon.top = Std.int((component.componentHeight / 2) - (icon.componentHeight / 2)) + marginTop(icon) - marginBottom(icon);\r\n                }\r\n            case \"top\" | \"bottom\":\r\n                if (label != null && icon != null) {\r\n                    var cy:Float = label.componentHeight + icon.componentHeight + verticalSpacing;\r\n                    var y:Float = Std.int((component.componentHeight / 2) - (cy / 2));\r\n\r\n                    if (iconPosition == \"bottom\") {\r\n                        label.top = y + marginTop(label) - marginBottom(label);\r\n                        y += verticalSpacing + label.componentHeight;\r\n                        icon.top = y + marginTop(icon) - marginBottom(icon);\r\n                    } else {\r\n                        icon.top = y + marginTop(icon) - marginBottom(icon);\r\n                        y += verticalSpacing + icon.componentHeight;\r\n                        label.top = y + marginTop(label) - marginBottom(label);\r\n                    }\r\n\r\n                    label.left = Std.int((component.componentWidth / 2) - (label.componentWidth / 2)) + marginLeft(label) - marginRight(label);\r\n                    icon.left = Std.int((component.componentWidth / 2) - (icon.componentWidth / 2)) + marginLeft(icon) - marginRight(icon);\r\n                } else if (label != null) {\r\n                    label.left = Std.int((component.componentWidth / 2) - (label.componentWidth / 2)) + marginLeft(label) - marginRight(label);\r\n                    label.top = Std.int((component.componentHeight / 2) - (label.componentHeight / 2)) + marginTop(label) - marginBottom(label);\r\n                } else if (icon != null) {\r\n                    icon.left = Std.int((component.componentWidth / 2) - (icon.componentWidth / 2)) + marginLeft(icon) - marginRight(icon);\r\n                    icon.top = Std.int((component.componentHeight / 2) - (icon.componentHeight / 2)) + marginTop(icon) - marginBottom(icon);\r\n                }\r\n        }\r\n    }\r\n}",null,"package haxe.ui.core;\r\n\r\nimport haxe.ui.util.Variant;\r\n\r\n/**\r\n Base class that allows property getters and setters to have overridden functionality\r\n**/\r\n@:allow(haxe.ui.core.Component)\r\nclass Behaviour {\r\n    private var config:Map<String, String> = null;\r\n\r\n    private var _component:Component;\r\n\r\n    public function new(component:Component) {\r\n        _component = component;\r\n    }\r\n\r\n    /**\r\n     Called when a component property setter is called\r\n    **/\r\n    public function set(value:Variant):Void {\r\n\r\n    }\r\n\r\n    /**\r\n     Called when a component property getter is called\r\n    **/\r\n    public function get():Variant {\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     Update this behaviour with its current value\r\n    **/\r\n    public function update():Void {\r\n\r\n    }\r\n\r\n    /**\r\n     Utility function to retrieve a string config value for this behaviour\r\n    **/\r\n    public function getConfigValue(name:String, defaultValue:String = null):String {\r\n        if (config == null) {\r\n            return defaultValue;\r\n        }\r\n        if (config.exists(name) == false) {\r\n            return defaultValue;\r\n        }\r\n        return config.get(name);\r\n    }\r\n\r\n    /**\r\n     Utility function to retrieve a boolean config value for this behaviour\r\n    **/\r\n    public function getConfigValueBool(name:String, defaultValue:Bool = false):Bool {\r\n        var v:Bool = defaultValue;\r\n        var s = getConfigValue(name);\r\n        if (s != null) {\r\n            v = (s == \"true\");\r\n        }\r\n        return v;\r\n    }\r\n}","package haxe.ui.layouts;\r\n\r\nimport haxe.ui.containers.ScrollView;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.util.Size;\r\nimport haxe.ui.util.CallStackHelper;\r\n\r\nclass Layout implements ILayout {\r\n    public function new() {\r\n\r\n    }\r\n\r\n    private var _component:Component;\r\n    public var component(get, set):Component;\r\n    private function get_component():Component {\r\n        return _component;\r\n    }\r\n    private function set_component(value:Component):Component {\r\n        _component = value;\r\n        refresh();\r\n        return value;\r\n    }\r\n\r\n    @:access(haxe.ui.core.Component)\r\n    public function refresh():Void {\r\n        if (_component != null && _component.isReady == true) {\r\n\r\n            resizeChildren();\r\n\r\n            _component.handlePreReposition();\r\n            repositionChildren();\r\n            _component.handlePostReposition();\r\n\r\n            if ((component.autoWidth == true || component.autoHeight == true)) {\r\n                var size:Size = calcAutoSize();\r\n                var calculatedWidth:Null<Float> = null;\r\n                var calculatedHeight:Null<Float> = null;\r\n                if (component.autoWidth == true) {\r\n                    calculatedWidth = size.width;\r\n                }\r\n                if (component.autoHeight == true) {\r\n                    calculatedHeight = size.height;\r\n                }\r\n                component.resizeComponent(calculatedWidth, calculatedHeight);\r\n            }\r\n        }\r\n    }\r\n\r\n    public function autoSize():Bool {\r\n        if (component.isReady == false) {\r\n            return false;\r\n        }\r\n\r\n        var calculatedWidth:Null<Float> = null;\r\n        var calculatedHeight:Null<Float> = null;\r\n        if (component.autoWidth == true || component.autoHeight == true) {\r\n            var size:Size = calcAutoSize();\r\n            if (component.autoWidth == true) {\r\n                calculatedWidth = size.width;\r\n            }\r\n            if (component.autoHeight == true) {\r\n                calculatedHeight = size.height;\r\n            }\r\n            component.resizeComponent(calculatedWidth, calculatedHeight);\r\n        }\r\n\r\n        return (calculatedWidth != null || calculatedHeight != null);\r\n    }\r\n\r\n    //******************************************************************************************\r\n    // Child helpers\r\n    //******************************************************************************************\r\n    private function marginTop(child:Component):Float {\r\n        if (child == null || child.style == null || child.style.marginTop == null) {\r\n            return 0;\r\n        }\r\n        return child.style.marginTop;\r\n    }\r\n\r\n    private function marginLeft(child:Component):Float {\r\n        if (child == null || child.style == null || child.style.marginLeft == null) {\r\n            return 0;\r\n        }\r\n\r\n        return child.style.marginLeft;\r\n    }\r\n\r\n    private function marginBottom(child:Component):Float {\r\n        if (child == null || child.style == null || child.style.marginBottom == null) {\r\n            return 0;\r\n        }\r\n\r\n        return child.style.marginBottom;\r\n    }\r\n\r\n    private function marginRight(child:Component):Float {\r\n        if (child == null || child.style == null || child.style.marginRight == null) {\r\n            return 0;\r\n        }\r\n\r\n        return child.style.marginRight;\r\n    }\r\n\r\n    private function hidden(c:Component = null):Bool {\r\n        if (c == null) {\r\n            c = component;\r\n        }\r\n        if (c.style.hidden == null) {\r\n            return false;\r\n        }\r\n        return c.style.hidden;\r\n    }\r\n\r\n    private function horizontalAlign(child:Component):String {\r\n        if (child == null || child.style == null || child.style.horizontalAlign == null) {\r\n            return \"left\";\r\n        }\r\n        return child.style.horizontalAlign;\r\n    }\r\n\r\n    private function verticalAlign(child:Component):String {\r\n        if (child == null || child.style == null || child.style.verticalAlign == null) {\r\n            return \"top\";\r\n        }\r\n        return child.style.verticalAlign;\r\n    }\r\n\r\n    //******************************************************************************************\r\n    // Helper props\r\n    //******************************************************************************************\r\n    public var paddingLeft(get, null):Float;\r\n    private function get_paddingLeft():Float {\r\n        if (_component == null || _component.style == null || _component.style.paddingLeft == null) {\r\n            return 0;\r\n        }\r\n        return _component.style.paddingLeft;\r\n    }\r\n\r\n    public var paddingTop(get, null):Float;\r\n    private function get_paddingTop():Float {\r\n        if (_component == null || _component.style == null || _component.style.paddingTop == null) {\r\n            return 0;\r\n        }\r\n        return _component.style.paddingTop;\r\n    }\r\n\r\n    public var paddingBottom(get, null):Float;\r\n    private function get_paddingBottom():Float {\r\n        if (_component == null || _component.style == null || _component.style.paddingBottom == null) {\r\n            return 0;\r\n        }\r\n        return _component.style.paddingBottom;\r\n    }\r\n\r\n    public var paddingRight(get, null):Float;\r\n    private function get_paddingRight():Float {\r\n        if (_component == null || _component.style == null || _component.style.paddingRight == null) {\r\n            return 0;\r\n        }\r\n        return _component.style.paddingRight;\r\n    }\r\n\r\n    public var horizontalSpacing(get, null):Float;\r\n    private function get_horizontalSpacing():Float {\r\n        if (_component == null || _component.style == null || _component.style.horizontalSpacing == null) {\r\n            return 0;\r\n        }\r\n        return _component.style.horizontalSpacing;\r\n    }\r\n\r\n    public var verticalSpacing(get, null):Float;\r\n    private function get_verticalSpacing():Float {\r\n        if (_component == null || _component.style == null || _component.style.verticalSpacing == null) {\r\n            return 0;\r\n        }\r\n        return _component.style.verticalSpacing;\r\n    }\r\n    //******************************************************************************************\r\n    // Helpers\r\n    //******************************************************************************************\r\n    public var innerWidth(get, null):Float;\r\n    public var innerHeight(get, null):Float;\r\n\r\n    // Inner width returns the size of the component minus padding\r\n    private function get_innerWidth():Float {\r\n        if (component == null) {\r\n            return 0;\r\n        }\r\n        return component.componentWidth - (paddingLeft + paddingRight);\r\n    }\r\n\r\n    // Inner height returns the size of the component minus padding\r\n    private function get_innerHeight():Float {\r\n        if (component == null) {\r\n            return 0;\r\n        }\r\n        var padding:Float = 0;\r\n        if (component.style.paddingTop != null) padding += component.style.paddingTop;\r\n        if (component.style.paddingBottom != null) padding += component.style.paddingBottom;\r\n        var icy:Float = component.componentHeight - padding;\r\n        return icy;\r\n    }\r\n\r\n    private function resizeChildren():Bool {\r\n        return true;\r\n    }\r\n\r\n    private function repositionChildren() {\r\n    }\r\n\r\n    public var usableSize(get, null):Size;\r\n    private function get_usableSize():Size {\r\n        var ucx:Float = 0;\r\n        if (_component.componentWidth != null) {\r\n            ucx = _component.componentWidth;\r\n            ucx -= paddingLeft + paddingRight;\r\n        }\r\n\r\n        var ucy:Float = 0;\r\n        if (_component.componentHeight != null) {\r\n            ucy = _component.componentHeight;\r\n            ucy -= paddingTop + paddingBottom;\r\n        }\r\n\r\n        return new Size(ucx, ucy);\r\n    }\r\n\r\n    public var usableWidth(get, null):Float;\r\n    private function get_usableWidth():Float {\r\n        return usableSize.width;\r\n    }\r\n\r\n    public var usableHeight(get, null):Float;\r\n    private function get_usableHeight():Float {\r\n        return usableSize.height;\r\n    }\r\n\r\n    public function calcAutoWidth():Float {\r\n        return calcAutoSize().width;\r\n    }\r\n\r\n    public function calcAutoHeight():Float {\r\n        return calcAutoSize().height;\r\n    }\r\n\r\n    public function calcAutoSize():Size {\r\n        var x1:Float = 0xFFFFFF;\r\n        var x2:Float = 0;\r\n        var y1:Float = 0xFFFFFF;\r\n        var y2:Float = 0;\r\n        for (child in component.childComponents) {\r\n            if (child.includeInLayout == false) {\r\n                continue;\r\n            }\r\n\r\n\r\n            if (child.percentWidth == null) {\r\n                if (child.left < x1) {\r\n                    x1 = child.left;\r\n                }\r\n                if (child.componentWidth != null && child.left + child.componentWidth > x2) {\r\n                    x2 = child.left + child.componentWidth;\r\n                }\r\n            }\r\n\r\n            if (child.percentHeight == null) {\r\n                if (child.top < y1) {\r\n                    y1 = child.top;\r\n                }\r\n                if (child.componentHeight != null && child.top + child.componentHeight > y2) {\r\n                    y2 = child.top + child.componentHeight;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (x1 == 0xFFFFFF) {\r\n            x1 = 0;\r\n        }\r\n        if (y1 == 0xFFFFFF) {\r\n            y1 = 0;\r\n        }\r\n\r\n        var w:Float = (x2 - x1) + (paddingLeft + paddingRight);\r\n        var h:Float = (y2 - y1) + (paddingTop + paddingBottom);\r\n        return new Size(w, h);\r\n    }\r\n}","package haxe.ui.layouts;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.Size;\r\n\r\nclass DefaultLayout extends Layout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    private override function resizeChildren() {\r\n        var usableSize:Size = usableSize;\r\n        var resized:Bool = false;\r\n        for (child in component.childComponents) {\r\n            var cx:Null<Float> = null;\r\n            var cy:Null<Float> = null;\r\n\r\n            if (child.percentWidth != null) {\r\n                cx = (usableSize.width * child.percentWidth) / 100;\r\n                resized = true;\r\n            }\r\n            if (child.percentHeight != null) {\r\n                cy = (usableSize.height * child.percentHeight) / 100;\r\n                resized = true;\r\n            }\r\n\r\n            child.resizeComponent(cx, cy);\r\n        }\r\n        return resized;\r\n    }\r\n\r\n    private override function repositionChildren() {\r\n        var usableSize:Size = component.layout.usableSize;\r\n\r\n        for (child in component.childComponents) {\r\n            if (child.includeInLayout == false) {\r\n                continue;\r\n            }\r\n\r\n            var xpos:Float = paddingLeft + marginLeft(child) - marginRight(child);\r\n            var ypos:Float = paddingTop + marginTop(child) - marginBottom(child);\r\n\r\n            switch (horizontalAlign(child)) {\r\n                case \"center\":\r\n                    xpos = ((component.componentWidth / 2) - (child.componentWidth / 2)) + marginLeft(child) - marginRight(child);\r\n//                  xpos = ((usableSize.width / 2) - (child.componentWidth / 2)) + marginLeft(child) - marginRight(child);\r\n                case \"right\":\r\n                    xpos = component.componentWidth - (child.componentWidth + paddingRight + marginLeft(child) - marginRight(child));\r\n//                  xpos = usableSize.width - (child.componentWidth + paddingRight + marginLeft(child) - marginRight(child));\r\n            }\r\n\r\n            switch (verticalAlign(child)) {\r\n                case \"center\":\r\n                    ypos = ((component.componentHeight / 2) - (child.componentHeight / 2)) + marginTop(child) - marginBottom(child);\r\n//                  ypos = ((usableSize.height / 2) - (child.componentHeight / 2)) + marginTop(child) - marginBottom(child);\r\n                case \"bottom\":\r\n                    ypos = ((component.componentHeight / 2) - (child.componentHeight / 2)) + marginTop(child) - marginBottom(child);\r\n//                  ypos = ((usableSize.height / 2) - (child.componentHeight / 2)) + marginTop(child) - marginBottom(child);\r\n            }\r\n\r\n            child.moveComponent(xpos, ypos);\r\n        }\r\n    }\r\n}","package haxe.ui.components;\r\n\r\nimport haxe.ui.core.Behaviour;\r\nimport haxe.ui.core.IClonable;\r\nimport haxe.ui.core.InteractiveComponent;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.core.UIEvent;\r\nimport haxe.ui.layouts.HorizontalLayout;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.Variant;\r\n\r\n/**\r\n Checkbox component showing either a selected or unselected state including a text label\r\n**/\r\n@:dox(icon=\"/icons/ui-check-boxes.png\")\r\nclass CheckBox extends InteractiveComponent implements IClonable<CheckBox> {\r\n    private var _value:CheckBoxValue;\r\n    private var _label:Label;\r\n\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        _defaultBehaviours = [\r\n            \"text\" => new CheckBoxDefaultTextBehaviour(this),\r\n            \"selected\" => new CheckBoxDefaultSelectedBehaviour(this)\r\n        ];\r\n        _defaultLayout = new HorizontalLayout();\r\n    }\r\n\r\n    private override function create():Void {\r\n        super.create();\r\n        behaviourSet(\"text\", _text);\r\n        behaviourSet(\"selected\", selected);\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        if (_value == null) {\r\n            _value = new CheckBoxValue();\r\n            _value.id = \"checkbox-value\";\r\n            _value.addClass(\"checkbox-value\");\r\n            addComponent(_value);\r\n\r\n            _value.registerEvent(MouseEvent.CLICK, _onClick);\r\n            _value.registerEvent(MouseEvent.MOUSE_OVER, _onMouseOver);\r\n            _value.registerEvent(MouseEvent.MOUSE_OUT, _onMouseOut);\r\n        }\r\n    }\r\n\r\n    private override function destroyChildren():Void {\r\n        if (_value != null) {\r\n            removeComponent(_value);\r\n            _value = null;\r\n        }\r\n        if (_label != null) {\r\n            removeComponent(_label);\r\n            _label = null;\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    private override function get_value():Variant {\r\n        return selected;\r\n    }\r\n\r\n    private override function set_value(value:Variant):Variant {\r\n        selected = value;\r\n        return value;\r\n    }\r\n\r\n    private override function set_text(value:String):String {\r\n        value = super.set_text(value);\r\n        behaviourSet(\"text\", value);\r\n        return value;\r\n    }\r\n\r\n    private override function applyStyle(style:Style):Void {\r\n        super.applyStyle(style);\r\n        if (_label != null) {\r\n            _label.customStyle.color = style.color;\r\n            _label.customStyle.fontName = style.fontName;\r\n            _label.customStyle.fontSize = style.fontSize;\r\n            _label.customStyle.cursor = style.cursor;\r\n            _label.invalidateStyle();\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    private var _selected:Bool = false;\r\n    /**\r\n     Whether to show a checkmark in this checkbox component or not\r\n    **/\r\n    @:dox(group=\"Selection related properties\")\r\n    @:clonable public var selected(get, set):Bool;\r\n    private function set_selected(value:Bool):Bool {\r\n        if (value == _selected) {\r\n            return value;\r\n        }\r\n        _selected = value;\r\n        behaviourSet(\"selected\", value);\r\n        var event:UIEvent = new UIEvent(UIEvent.CHANGE);\r\n        dispatch(event);\r\n        return value;\r\n    }\r\n\r\n    private function get_selected():Bool {\r\n        return _selected;\r\n    }\r\n\r\n    private function toggleSelected():Bool {\r\n        return selected = !selected;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    private function _onClick(event:MouseEvent):Void {\r\n        toggleSelected();\r\n        var event:UIEvent = new UIEvent(UIEvent.CHANGE);\r\n        dispatch(event);\r\n    }\r\n\r\n    private function _onMouseOver(event:MouseEvent):Void {\r\n        addClass(\":hover\");\r\n        _value.addClass(\":hover\");\r\n    }\r\n\r\n    private function _onMouseOut(event:MouseEvent):Void {\r\n        removeClass(\":hover\");\r\n        _value.removeClass(\":hover\");\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Default behaviours\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.CheckBox)\r\nclass CheckBoxDefaultTextBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var checkbox:CheckBox = cast _component;\r\n        if (checkbox._label == null) {\r\n            checkbox._label = new Label();\r\n            checkbox._label.id = \"checkbox-label\";\r\n            checkbox._label.addClass(\"checkbox-label\");\r\n\r\n            checkbox._label.registerEvent(MouseEvent.CLICK, checkbox._onClick);\r\n            checkbox._label.registerEvent(MouseEvent.MOUSE_OVER, checkbox._onMouseOver);\r\n            checkbox._label.registerEvent(MouseEvent.MOUSE_OUT, checkbox._onMouseOut);\r\n\r\n            checkbox.addComponent(checkbox._label);\r\n        }\r\n        checkbox._label.text = value;\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.CheckBox)\r\nclass CheckBoxDefaultSelectedBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var checkbox:CheckBox = cast _component;\r\n        if (checkbox._value == null) {\r\n            return;\r\n        }\r\n\r\n        if (value == true) {\r\n            checkbox._value.addClass(\":selected\");\r\n        } else {\r\n            checkbox._value.removeClass(\":selected\");\r\n        }\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Special children\r\n//***********************************************************************************************************\r\n/**\r\n Specialised `InteractiveComponent` used to contain the `CheckBox` icon and respond to style changes\r\n**/\r\nclass CheckBoxValue extends InteractiveComponent {\r\n    private var _icon:Image;\r\n\r\n    public function new() {\r\n        super();\r\n        #if openfl\r\n        mouseChildren = false;\r\n        #end\r\n\r\n        _icon = new Image();\r\n        _icon.id = \"checkbox-icon\";\r\n        _icon.addClass(\"checkbox-icon\");\r\n        addComponent(_icon);\r\n    }\r\n\r\n    private override function applyStyle(style:Style):Void {\r\n        super.applyStyle(style);\r\n        if (_icon != null) {\r\n            _icon.resource = style.icon;\r\n        }\r\n    }\r\n}",null,null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.animation.AnimationManager;\r\nimport haxe.ui.core.Behaviour;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.IClonable;\r\nimport haxe.ui.core.InteractiveComponent;\r\nimport haxe.ui.core.UIEvent;\r\nimport haxe.ui.util.Variant;\r\n\r\n/**\r\n Encapsulates shared functionality of both vertical and horizontal progressbar components\r\n**/\r\n@:dox(icon=\"/icons/ui-progress-bar.png\")\r\nclass Progress extends InteractiveComponent implements IClonable<Progress> {\r\n    private var _value:Component;\r\n\r\n    public function new() {\r\n        super();\r\n        allowFocus = false;\r\n        addClass(\"progress\");\r\n\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        _defaultBehaviours = [\r\n            \"min\" => new ProgressDefaultMinBehaviour(this),\r\n            \"max\" => new ProgressDefaultMaxBehaviour(this),\r\n            \"pos\" => new ProgressDefaultPosBehaviour(this),\r\n            \"rangeStart\" => new ProgressDefaultRangeStartBehaviour(this),\r\n            \"rangeEnd\" => new ProgressDefaultRangeEndBehaviour(this),\r\n            \"indeterminate\" => new ProgressDefaultIndeterminateBehaviour(this)\r\n        ];\r\n    }\r\n\r\n    private override function create():Void {\r\n        super.create();\r\n\r\n        behaviourSet(\"min\", _min);\r\n        behaviourSet(\"max\", _max);\r\n        behaviourSet(\"pos\", _pos);\r\n        behaviourSet(\"indeterminate\", _indeterminate);\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        if (_value == null) {\r\n            _value = new Component();\r\n            _value.id = \"progress-value\";\r\n            _value.addClass(\"progress-value\");\r\n            #if flambe\r\n            _value.pixelSnapping = false;\r\n            #end\r\n            addComponent(_value);\r\n        }\r\n    }\r\n\r\n    private override function destroyChildren():Void {\r\n        if (_value != null) {\r\n            removeComponent(_value);\r\n            _value = null;\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    private override function get_value():Variant {\r\n        return pos;\r\n    }\r\n\r\n    private override function set_value(value:Variant):Variant {\r\n        pos = value;\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    private var _pos:Float = 0;\r\n    /**\r\n     The current value of the progressbar\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var pos(get, set):Float;\r\n    private function get_pos():Float {\r\n        return _pos;\r\n    }\r\n    private function set_pos(value:Float):Float {\r\n        if (_ready) { // only enforce constraints when ready as xml attrs can come in in any order\r\n            if (value < _min) {\r\n                value = _min;\r\n            }\r\n            if (value > _max) {\r\n                value = _max;\r\n            }\r\n        }\r\n\r\n        if (value == _pos) {\r\n            return value;\r\n        }\r\n\r\n        _pos = value;\r\n        behaviourSet(\"pos\", value);\r\n        var changeEvent:UIEvent = new UIEvent(UIEvent.CHANGE);\r\n        dispatch(changeEvent);\r\n        handleBindings([\"value\"]);\r\n        return value;\r\n    }\r\n\r\n    private var _min:Float = 0;\r\n    /**\r\n     The minimum value the progress can hold\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var min(get, set):Float;\r\n    private function get_min():Float {\r\n        return _min;\r\n    }\r\n    private function set_min(value:Float):Float {\r\n        if (_ready) {\r\n            if (value < _min) {\r\n                value = _min;\r\n            }\r\n        }\r\n        if (value == _min) {\r\n            return value;\r\n        }\r\n\r\n        _min = value;\r\n        behaviourSet(\"min\", value);\r\n        return value;\r\n    }\r\n\r\n    private var _max:Float = 100;\r\n    /**\r\n     The maximum value the progress can hold\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var max(get, set):Float;\r\n    private function get_max():Float {\r\n        return _max;\r\n    }\r\n    private function set_max(value:Float):Float {\r\n        if (_ready) {\r\n            if (value > _max) {\r\n                value = _max;\r\n            }\r\n        }\r\n        if (value == _max) {\r\n            return value;\r\n        }\r\n\r\n        _max = value;\r\n        behaviourSet(\"max\", value);\r\n        return value;\r\n    }\r\n\r\n    private var _rangeStart:Float = 0;\r\n    /**\r\n     The start of the progressbars range value\r\n    **/\r\n    @:dox(group=\"Range related properties and methods\")\r\n    @bindable @clonable public var rangeStart(get, set):Float;\r\n    private function get_rangeStart():Float {\r\n        return _rangeStart;\r\n    }\r\n    private function set_rangeStart(value:Float):Float {\r\n        if (_ready) {\r\n            if (value < _min) {\r\n                value = _min;\r\n            }\r\n            if (value >= _rangeEnd) {\r\n                value = _rangeEnd;\r\n            }\r\n        }\r\n\r\n        _rangeStart = value;\r\n        behaviourSet(\"rangeStart\", value);\r\n        return value;\r\n    }\r\n\r\n    private var _rangeEnd:Float = 0;\r\n    /**\r\n     The end of the progressbars range value\r\n    **/\r\n    @:dox(group=\"Range related properties and methods\")\r\n    @bindable @clonable public var rangeEnd(get, set):Float;\r\n    private function get_rangeEnd():Float {\r\n        return _rangeEnd;\r\n    }\r\n    private function set_rangeEnd(value:Float):Float {\r\n        if (_ready) {\r\n            if (value > _max) {\r\n                value = _max;\r\n            }\r\n            if (value <= _rangeStart) {\r\n                value = _rangeStart;\r\n            }\r\n        }\r\n\r\n        _rangeEnd = value;\r\n        behaviourSet(\"rangeEnd\", value);\r\n        return value;\r\n    }\r\n\r\n    private var _indeterminate:Bool = false;\r\n    /**\r\n     Whether to show this progress bar as an animated \"indeterminate\" progressbar\r\n    **/\r\n    @:dox(group=\"Indeterminate mode related properties\")\r\n    @bindable @clonable public var indeterminate(get, set):Bool;\r\n    private function get_indeterminate():Bool {\r\n        return _indeterminate;\r\n    }\r\n    private function set_indeterminate(value:Bool):Bool {\r\n        if (value == _indeterminate) {\r\n            return value;\r\n        }\r\n\r\n        _indeterminate = value;\r\n        behaviourSet(\"indeterminate\", value);\r\n\r\n        return value;\r\n    }\r\n\r\n    private function startIndeterminateAnimation():Void {\r\n        var animationId:String = getClassProperty(\"animation.indeterminate\");\r\n        if (animationId == null) {\r\n            return;\r\n        }\r\n        AnimationManager.instance.loop(animationId, [\"target\" => this]);\r\n    }\r\n\r\n    private function stopIndeterminateAnimation():Void {\r\n\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Default behaviours\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Progress)\r\nclass ProgressDefaultMinBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var progress:Progress = cast _component;\r\n        progress.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Progress)\r\nclass ProgressDefaultMaxBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var progress:Progress = cast _component;\r\n        progress.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Progress)\r\nclass ProgressDefaultPosBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var progress:Progress = cast _component;\r\n        progress.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Progress)\r\nclass ProgressDefaultRangeStartBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var progress:Progress = cast _component;\r\n        progress.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Progress)\r\nclass ProgressDefaultRangeEndBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var progress:Progress = cast _component;\r\n        progress.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Progress)\r\nclass ProgressDefaultIndeterminateBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var progress:Progress = cast _component;\r\n        if (progress._indeterminate == true) {\r\n            progress.startIndeterminateAnimation();\r\n        } else {\r\n            progress.stopIndeterminateAnimation();\r\n        }\r\n\r\n    }\r\n}",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.core.IClonable;\r\n\r\n/**\r\n A horizontal implementation of a `Slider`\r\n**/\r\n@:dox(icon=\"/icons/ui-progress-bar.png\")\r\nclass HProgress extends Progress implements IClonable<HProgress> {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        super.createDefaults();\r\n        _defaultLayout = new HProgressLayout();\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        super.createChildren();\r\n        if (componentWidth <= 0) {\r\n            componentWidth = 150;\r\n        }\r\n        if (componentHeight <= 0) {\r\n            componentHeight = 20;\r\n        }\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\nclass HProgressLayout extends DefaultLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    public override function resizeChildren():Bool {\r\n        super.resizeChildren();\r\n\r\n        var value:Component = component.findComponent(\"progress-value\");\r\n        var progress:Progress = cast component;\r\n        if (value != null) {\r\n            var ucx:Float = usableWidth;\r\n\r\n            var cx:Float = 0;\r\n            if (progress.rangeStart == progress.rangeEnd) {\r\n                cx = (progress.pos - progress.min) / (progress.max - progress.min) * ucx;\r\n            } else {\r\n                cx = ((progress.rangeEnd - progress.rangeStart) - progress.min) / (progress.max - progress.min) * ucx;\r\n            }\r\n\r\n            if (cx < 0) {\r\n                cx = 0;\r\n            } else if (cx > ucx) {\r\n                cx = ucx;\r\n            }\r\n\r\n            if (cx == 0) {\r\n                value.componentWidth = 0;\r\n                value.hidden = true;\r\n            } else {\r\n                value.componentWidth = cx;\r\n                value.hidden = false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public override function repositionChildren():Void {\r\n        super.repositionChildren();\r\n\r\n        var value:Component = component.findComponent(\"progress-value\");\r\n        var progress:Progress = cast component;\r\n        if (value != null) {\r\n            if (progress.rangeStart != progress.rangeEnd) {\r\n                var ucx:Float = usableWidth;\r\n                value.left = paddingLeft + (progress.rangeStart - progress.min) / (progress.max - progress.min) * ucx;\r\n            }\r\n\r\n        }\r\n    }\r\n}",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.animation.AnimationManager;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.InteractiveComponent;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.core.UIEvent;\r\nimport haxe.ui.util.Variant;\r\nimport haxe.ui.core.IClonable;\r\nimport haxe.ui.core.Behaviour;\r\n\r\n/**\r\n Encapsulates shared functionality of both vertical and horizontal scrollbar components\r\n**/\r\n@:dox(icon=\"/icons/ui-scroll-bar-horizontal.png\")\r\nclass Scroll extends InteractiveComponent implements IClonable<Scroll> {\r\n    private var _incButton:Button;\r\n    private var _deincButton:Button;\r\n    private var _thumb:Button;\r\n\r\n    public function new() {\r\n        super();\r\n        addClass(\"scroll\");\r\n        allowFocus = false;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        _defaultBehaviours = [\r\n            \"min\" => new ScrollDefaultMinBehaviour(this),\r\n            \"max\" => new ScrollDefaultMaxBehaviour(this),\r\n            \"pos\" => new ScrollDefaultPosBehaviour(this),\r\n            \"pageSize\" => new ScrollDefaultPageSizeBehaviour(this)\r\n        ];\r\n    }\r\n\r\n    private override function create():Void {\r\n        super.create();\r\n\r\n        behaviourSet(\"min\", _min);\r\n        behaviourSet(\"max\", _max);\r\n        behaviourSet(\"pos\", _pos);\r\n        behaviourSet(\"pageSize\", _pageSize);\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        if (componentWidth <= 0) {\r\n            componentWidth = 100;\r\n        }\r\n        if (componentHeight <= 0) {\r\n            componentHeight = 100;\r\n        }\r\n\r\n        if (_deincButton == null) {\r\n            _deincButton = new Button();\r\n            _deincButton.scriptAccess = false;\r\n            _deincButton.customStyle.native = false;\r\n            //_deincButton.clipContent = false;\r\n            _deincButton.id = \"scroll-deinc-button\";\r\n            _deincButton.addClass(\"deinc\");\r\n            _deincButton.allowFocus = false;\r\n            _deincButton.repeater = true;\r\n            _deincButton.registerEvent(MouseEvent.CLICK, _onDeinc);\r\n            addComponent(_deincButton);\r\n        }\r\n\r\n        if (_incButton == null) {\r\n            _incButton = new Button();\r\n            _incButton.scriptAccess = false;\r\n            _incButton.customStyle.native = false;\r\n            //_incButton.clipContent = false;\r\n            _incButton.id = \"scroll-inc-button\";\r\n            _incButton.addClass(\"inc\");\r\n            _incButton.allowFocus = false;\r\n            _incButton.repeater = true;\r\n            _incButton.registerEvent(MouseEvent.CLICK, _onInc);\r\n            addComponent(_incButton);\r\n        }\r\n\r\n        if (_thumb == null) {\r\n            _thumb = new Button();\r\n            _thumb.scriptAccess = false;\r\n            _thumb.customStyle.native = false;\r\n            //_thumb.clipContent = false;\r\n            _thumb.id = \"scroll-thumb-button\";\r\n            _thumb.addClass(\"thumb\");\r\n            _thumb.allowFocus = false;\r\n            _thumb.remainPressed = true;\r\n            _thumb.registerEvent(MouseEvent.MOUSE_DOWN, _onThumbMouseDown);\r\n            addComponent(_thumb);\r\n        }\r\n\r\n        registerEvent(MouseEvent.MOUSE_DOWN, _onMouseDown);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    private override function get_value():Variant {\r\n        return pos;\r\n    }\r\n\r\n    private override function set_value(value:Variant):Variant {\r\n        pos = value;\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    private var _pos:Float = 0;\r\n    /**\r\n     The current value of the scrollbar\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var pos(get, set):Float;\r\n    private function get_pos():Float {\r\n        return _pos;\r\n    }\r\n    private function set_pos(value:Float):Float {\r\n        if (_ready) { // only enforce constraints when ready as xml attrs can come in in any order\r\n            if (value < _min) {\r\n                value = _min;\r\n            }\r\n            if (value > _max) {\r\n                value = _max;\r\n            }\r\n        }\r\n\r\n        if (value != _pos) {\r\n            _pos = value;\r\n            behaviourSet(\"pos\", value);\r\n            var changeEvent:UIEvent = new UIEvent(UIEvent.CHANGE);\r\n            dispatch(changeEvent);\r\n            handleBindings([\"value\"]);\r\n        }\r\n        return value;\r\n    }\r\n\r\n    private function animatePos(value:Float) {\r\n        if (animatable == false) {\r\n            pos = value;\r\n            return;\r\n        }\r\n\r\n        var animationId:String = getClassProperty(\"animation.pos\");\r\n        if (animationId == null) {\r\n            pos = value;\r\n            return;\r\n        }\r\n\r\n        AnimationManager.instance.run(animationId, [\"target\" => this], [\"pos\" => value]);\r\n    }\r\n\r\n    private var _min:Float = 0;\r\n    /**\r\n     The minimum value the scrollbar can hold\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var min(get, set):Float;\r\n    private function get_min():Float {\r\n        return _min;\r\n    }\r\n    private function set_min(value:Float):Float {\r\n        if (value != _min) {\r\n            _min = value;\r\n            if (_pos < _min) {\r\n                _pos = _min;\r\n            }\r\n            behaviourSet(\"min\", value);\r\n        }\r\n        return value;\r\n    }\r\n\r\n    private var _max:Float = 100;\r\n    /**\r\n     The maximum value the scrollbar can hold\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var max(get, set):Float;\r\n    private function get_max():Float {\r\n        return _max;\r\n    }\r\n    private function set_max(value:Float):Float {\r\n        if (value != _max) {\r\n            _max = value;\r\n            if (_pos > _max) {\r\n                _pos = _max;\r\n            }\r\n            behaviourSet(\"max\", value);\r\n        }\r\n        return value;\r\n    }\r\n\r\n    private var _pageSize:Float = 0;\r\n    /**\r\n     How big a page is considered to be in this scrollbar (affects the size of the thumb)\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var pageSize(get, set):Float;\r\n    private function get_pageSize():Float {\r\n        return _pageSize;\r\n    }\r\n    private function set_pageSize(value:Float):Float {\r\n        if (value == _pageSize) {\r\n            return value;\r\n        }\r\n\r\n        _pageSize = value;\r\n        behaviourSet(\"pageSize\", value);\r\n        return value;\r\n    }\r\n\r\n    private var _incrementSize:Float = 20;\r\n    /**\r\n     What value to add to or subtract from the scrollbars value when using the up/down or left/right buttons\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var incrementSize(get, set):Float;\r\n    private function get_incrementSize():Float {\r\n        return _incrementSize;\r\n    }\r\n    private function set_incrementSize(value:Float):Float {\r\n        if (_incrementSize == value) {\r\n            return value;\r\n        }\r\n        _incrementSize = value;\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    var _mouseDownOffset:Float = -1;\r\n    private function _onDeinc(event:MouseEvent) {\r\n        deincrementValue();\r\n    }\r\n\r\n    private function _onInc(event:MouseEvent) {\r\n        incrementValue();\r\n    }\r\n\r\n    private function _onThumbMouseDown(event:MouseEvent) {\r\n        screen.registerEvent(MouseEvent.MOUSE_UP, _onScreenMouseUp);\r\n        screen.registerEvent(MouseEvent.MOUSE_MOVE, _onScreenMouseMove);\r\n    }\r\n\r\n    private function _onScreenMouseMove(event:MouseEvent) {\r\n    }\r\n\r\n    private function _onScreenMouseUp(event:MouseEvent) {\r\n        _mouseDownOffset = -1;\r\n        screen.unregisterEvent(MouseEvent.MOUSE_UP, _onScreenMouseUp);\r\n        screen.unregisterEvent(MouseEvent.MOUSE_MOVE, _onScreenMouseMove);\r\n    }\r\n\r\n    private function _onMouseDown(event:MouseEvent) {\r\n        if (event.screenY < _thumb.screenTop) {\r\n            animatePos(pos - pageSize);\r\n        } else if (event.screenY > _thumb.screenTop + _thumb.componentHeight) {\r\n            animatePos(pos + pageSize);\r\n        }\r\n    }\r\n\r\n    //******************************************************************************************\r\n    // Helpers\r\n    //******************************************************************************************\r\n    /**\r\n     Deincrement the scrollbars value\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    public function deincrementValue():Void {\r\n        //pos -= _incrementSize;\r\n        animatePos(pos - _incrementSize);\r\n    }\r\n\r\n    /**\r\n     Increment the scrollbars value\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    public function incrementValue():Void {\r\n        //pos += _incrementSize;\r\n        animatePos(pos + _incrementSize);\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Default behaviours\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Scroll)\r\nclass ScrollDefaultMinBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var scroll:Scroll = cast _component;\r\n        scroll.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Scroll)\r\nclass ScrollDefaultMaxBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var scroll:Scroll = cast _component;\r\n        scroll.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Scroll)\r\nclass ScrollDefaultPosBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var scroll:Scroll = cast _component;\r\n        scroll.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Scroll)\r\nclass ScrollDefaultPageSizeBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var scroll:Scroll = cast _component;\r\n        scroll.invalidateLayout();\r\n    }\r\n}\r\n\r\n",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.core.IClonable;\r\n\r\n/**\r\n A horizontal implementation of a `Scroll`\r\n**/\r\n@:dox(icon=\"/icons/ui-scroll-bar-horizontal.png\")\r\nclass HScroll extends Scroll implements IClonable<HScroll> {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        super.createDefaults();\r\n        _defaultLayout = new HScrollLayout();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Event overrides\r\n    //***********************************************************************************************************\r\n    private override function _onThumbMouseDown(event:MouseEvent) {\r\n        super._onThumbMouseDown(event);\r\n\r\n        _mouseDownOffset = event.screenX - _thumb.left;\r\n    }\r\n\r\n    private override function _onScreenMouseMove(event:MouseEvent) {\r\n        super._onScreenMouseMove(event);\r\n        if (_mouseDownOffset == -1) {\r\n            return;\r\n        }\r\n\r\n        var xpos:Float = event.screenX - _mouseDownOffset;\r\n        var minX:Float = 0;\r\n        if (_deincButton != null) {\r\n            minX = _deincButton.componentWidth + layout.horizontalSpacing;\r\n        }\r\n        var maxX:Float = layout.usableWidth - _thumb.componentWidth;\r\n        if (_deincButton != null) {\r\n            maxX += _deincButton.componentWidth + layout.horizontalSpacing;\r\n        }\r\n        if (xpos < minX) {\r\n            xpos = minX;\r\n        } else if (xpos > maxX) {\r\n            xpos = maxX;\r\n        }\r\n\r\n        var ucx:Float = layout.usableWidth;\r\n        ucx -= _thumb.componentWidth;\r\n        var m:Int = Std.int(max - min);\r\n        var v:Float = xpos - minX;\r\n        var newValue:Float = min + ((v / ucx) * m);\r\n        pos = newValue;\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\nclass HScrollLayout extends DefaultLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    public override function resizeChildren():Bool {\r\n        super.resizeChildren();\r\n\r\n        var scroll:Scroll = cast component;\r\n        var thumb:Button =  component.findComponent(\"scroll-thumb-button\");\r\n        if (thumb != null) {\r\n            var m:Float = scroll.max - scroll.min;\r\n            var ucx:Float = usableWidth;\r\n            var thumbWidth = (scroll.pageSize / m) * ucx;\r\n            if (thumbWidth < innerHeight) {\r\n                thumbWidth = innerHeight;\r\n            } else if (thumbWidth > ucx) {\r\n                thumbWidth = ucx;\r\n            }\r\n            if (thumbWidth > 0 && Math.isNaN(thumbWidth) == false) {\r\n                thumb.componentWidth = thumbWidth;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public override function repositionChildren():Void {\r\n        super.repositionChildren();\r\n\r\n        var deinc:Button = component.findComponent(\"scroll-deinc-button\");\r\n        var inc:Button = component.findComponent(\"scroll-inc-button\");\r\n        if (inc != null && hidden(inc) == false) {\r\n            inc.left = component.componentWidth - inc.componentWidth - paddingRight;\r\n        }\r\n\r\n        var scroll:Scroll = cast component;\r\n        var thumb:Button =  component.findComponent(\"scroll-thumb-button\");\r\n        if (thumb != null) {\r\n            var m:Float = scroll.max - scroll.min;\r\n            var u:Float = usableWidth;\r\n            u -= thumb.componentWidth;\r\n            var x:Float = ((scroll.pos - scroll.min) / m) * u;\r\n            x += paddingLeft;\r\n            if (deinc != null && hidden(deinc) == false) {\r\n                x += deinc.componentWidth + horizontalSpacing;\r\n            }\r\n            thumb.left = x;\r\n        }\r\n    }\r\n\r\n    // usable height returns the amount of available space for % size components\r\n    private override function get_usableWidth():Float {\r\n        var ucx:Float = innerWidth;\r\n        var deinc:Button = component.findComponent(\"scroll-deinc-button\");\r\n        var inc:Button = component.findComponent(\"scroll-inc-button\");\r\n        if (deinc != null && hidden(deinc) == false) {\r\n            ucx -= deinc.componentWidth + horizontalSpacing;\r\n        }\r\n        if (inc != null && hidden(inc) == false) {\r\n            ucx -= inc.componentWidth + horizontalSpacing;\r\n        }\r\n        return ucx;\r\n    }\r\n}",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.animation.AnimationManager;\r\nimport haxe.ui.core.Behaviour;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.InteractiveComponent;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.core.UIEvent;\r\nimport haxe.ui.util.Variant;\r\nimport haxe.ui.core.IClonable;\r\n\r\n/**\r\n Encapsulates shared functionality of both vertical and horizontal slider components\r\n**/\r\n@:dox(icon=\"/icons/ui-slider-050.png\")\r\nclass Slider extends InteractiveComponent implements IClonable<Slider> {\r\n    private var _valueBackground:Component;\r\n    private var _value:Component;\r\n\r\n    private var _rangeStartThumb:Button;\r\n    private var _rangeEndThumb:Button;\r\n\r\n    public function new() {\r\n        super();\r\n        allowFocus = false;\r\n        addClass(\"slider\");\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        _defaultBehaviours = [\r\n            \"min\" => new SliderDefaultMinBehaviour(this),\r\n            \"max\" => new SliderDefaultMaxBehaviour(this),\r\n            \"pos\" => new SliderDefaultPosBehaviour(this),\r\n            \"rangeStart\" => new SliderDefaultRangeStartBehaviour(this),\r\n            \"rangeEnd\" => new SliderDefaultRangeEndBehaviour(this)\r\n        ];\r\n    }\r\n\r\n    private override function create():Void {\r\n        super.create();\r\n\r\n        behaviourSet(\"min\", _min);\r\n        behaviourSet(\"max\", _max);\r\n        behaviourSet(\"pos\", _pos);\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        super.createChildren();\r\n\r\n        if (_valueBackground == null) {\r\n            _valueBackground = new Component();\r\n            _valueBackground.id = \"slider-value-background\";\r\n            _valueBackground.addClass(\"slider-value-background\");\r\n            addComponent(_valueBackground);\r\n            _valueBackground.registerEvent(MouseEvent.MOUSE_DOWN, _onValueBackgroundMouseDown);\r\n        }\r\n\r\n        if (_value == null) {\r\n            _value = new Component();\r\n            _value.id = \"slider-value\";\r\n            _value.addClass(\"slider-value\");\r\n            #if flambe\r\n            _value.pixelSnapping = false;\r\n            #end\r\n            _valueBackground.addComponent(_value);\r\n            _value.registerEvent(MouseEvent.MOUSE_DOWN, _onValueMouseDown);\r\n        }\r\n\r\n        if (_rangeEndThumb == null) {\r\n            _rangeEndThumb = new Button();\r\n            _rangeEndThumb.scriptAccess = false;\r\n            _rangeEndThumb.customStyle.native = false;\r\n            //_rangeEndThumb.clipContent = false;\r\n            _rangeEndThumb.id = \"slider-range-end-button\";\r\n            _rangeEndThumb.addClass(\"slider-button\");\r\n            _rangeEndThumb.remainPressed = true;\r\n            addComponent(_rangeEndThumb);\r\n            _rangeEndThumb.registerEvent(MouseEvent.MOUSE_DOWN, _onRangeEndThumbMouseDown);\r\n        }\r\n    }\r\n\r\n    private override function destroyChildren():Void {\r\n        if (_valueBackground != null) {\r\n            if (_value != null) {\r\n                _valueBackground.removeComponent(_value);\r\n                _value = null;\r\n            }\r\n            removeComponent(_valueBackground);\r\n            _valueBackground = null;\r\n        }\r\n\r\n        if (_rangeEndThumb != null) {\r\n            removeComponent(_rangeEndThumb);\r\n            _rangeEndThumb = null;\r\n        }\r\n        if (_rangeStartThumb != null) {\r\n            removeComponent(_rangeStartThumb);\r\n            _rangeStartThumb = null;\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    private override function get_value():Variant {\r\n        return pos;\r\n    }\r\n\r\n    private override function set_value(value:Variant):Variant {\r\n        pos = value;\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    private var _pos:Float = 0;\r\n    /**\r\n     The current value of the slider\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var pos(get, set):Float;\r\n    private function get_pos():Float {\r\n        return _pos;\r\n    }\r\n    private function set_pos(value:Float):Float {\r\n        if (_ready) { // only enforce constraints when ready as xml attrs can come in in any order\r\n            if (value < _min) {\r\n                value = _min;\r\n            }\r\n            if (value > _max) {\r\n                value = _max;\r\n            }\r\n        }\r\n\r\n        if (value == _pos) {\r\n            return value;\r\n        }\r\n        _pos = value;\r\n        behaviourSet(\"pos\", value);\r\n        var changeEvent:UIEvent = new UIEvent(UIEvent.CHANGE);\r\n        dispatch(changeEvent);\r\n        handleBindings([\"value\"]);\r\n        return value;\r\n    }\r\n\r\n    private function animatePos(value:Float) {\r\n        if (animatable == false) {\r\n            pos = value;\r\n            return;\r\n        }\r\n\r\n        var animationId:String = getClassProperty(\"animation.pos\");\r\n        if (animationId == null) {\r\n            pos = value;\r\n            return;\r\n        }\r\n\r\n        AnimationManager.instance.run(animationId, [\"target\" => this], [\"pos\" => value]);\r\n    }\r\n\r\n    private var _min:Float = 0;\r\n    /**\r\n     The minimum value the slider can hold\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var min(get, set):Float;\r\n    private function get_min():Float {\r\n        return _min;\r\n    }\r\n    private function set_min(value:Float):Float {\r\n        if (_ready) {\r\n            if (value < _min) {\r\n                value = _min;\r\n            }\r\n        }\r\n        if (value == _min) {\r\n            return value;\r\n        }\r\n\r\n        _min = value;\r\n        behaviourSet(\"min\", value);\r\n        return value;\r\n    }\r\n\r\n    private var _max:Float = 100;\r\n    /**\r\n     The maximum value the slider can hold\r\n    **/\r\n    @:dox(group=\"Value related properties and methods\")\r\n    @bindable @clonable public var max(get, set):Float;\r\n    private function get_max():Float {\r\n        return _max;\r\n    }\r\n    private function set_max(value:Float):Float {\r\n        if (_ready) {\r\n            if (value > _max) {\r\n                value = _max;\r\n            }\r\n        }\r\n        if (value == _max) {\r\n            return value;\r\n        }\r\n\r\n        _max = value;\r\n        behaviourSet(\"max\", value);\r\n        return value;\r\n    }\r\n\r\n    private var _rangeStart:Float = 0;\r\n    /**\r\n     The start of the sliders range value\r\n    **/\r\n    @:dox(group=\"Range related properties and methods\")\r\n    @bindable @clonable public var rangeStart(get, set):Float;\r\n    private function get_rangeStart():Float {\r\n        return _rangeStart;\r\n    }\r\n    private function set_rangeStart(value:Float):Float {\r\n        if (_ready) {\r\n            if (value < _min) {\r\n                value = _min;\r\n            }\r\n            if (value >= _rangeEnd - 1) { // TODO: calc this\r\n                value = _rangeEnd - 1;\r\n            }\r\n        }\r\n        if (value != _rangeStart) {\r\n            if (_rangeStartThumb == null) {\r\n                _rangeStartThumb = new Button();\r\n                _rangeStartThumb.scriptAccess = false;\r\n                _rangeStartThumb.native = false;\r\n                //_rangeStartThumb.clipContent = false;\r\n                _rangeStartThumb.id = \"slider-range-start-button\";\r\n                _rangeStartThumb.addClass(\"slider-button\");\r\n                _rangeStartThumb.remainPressed = true;\r\n                _rangeStartThumb.registerEvent(MouseEvent.MOUSE_DOWN, _onRangeStartThumbMouseDown);\r\n                addComponent(_rangeStartThumb);\r\n            }\r\n\r\n            _rangeStart = value;\r\n            invalidateLayout();\r\n            handleBindings([\"value\"]);\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    private function animateRangeStart(value:Float) {\r\n        if (animatable == false) {\r\n            rangeStart = value;\r\n            return;\r\n        }\r\n\r\n        var animationId:String = getClassProperty(\"animation.rangeStart\");\r\n        if (animationId == null) {\r\n            rangeStart = value;\r\n            return;\r\n        }\r\n\r\n        AnimationManager.instance.run(animationId, [\"target\" => this], [\"rangeStart\" => value]);\r\n    }\r\n\r\n    private var _rangeEnd:Float = 0;\r\n    /**\r\n     The end of the sliders range value\r\n    **/\r\n    @:dox(group=\"Range related properties and methods\")\r\n    @bindable @clonable public var rangeEnd(get, set):Float;\r\n    private function get_rangeEnd():Float {\r\n        return _rangeEnd;\r\n    }\r\n    private function set_rangeEnd(value:Float):Float {\r\n        if (_ready) {\r\n            if (value > _max) {\r\n                value = _max;\r\n            }\r\n            if (value <= _rangeStart + 1) { // TODO: calc this\r\n                value = _rangeStart + 1;\r\n            }\r\n        }\r\n        if (value != _rangeEnd) {\r\n            _rangeEnd = value;\r\n            invalidateLayout();\r\n            handleBindings([\"value\"]);\r\n        }\r\n        return value;\r\n    }\r\n\r\n    private function animateRangeEnd(value:Float) {\r\n        if (animatable == false) {\r\n            rangeEnd = value;\r\n            return;\r\n        }\r\n\r\n        var animationId:String = getClassProperty(\"animation.rangeEnd\");\r\n        if (animationId == null) {\r\n            rangeEnd = value;\r\n            return;\r\n        }\r\n\r\n        AnimationManager.instance.run(animationId, [\"target\" => this], [\"rangeEnd\" => value]);\r\n    }\r\n\r\n\r\n    /**\r\n     Allows setting the sliders start and end range at the same time\r\n    **/\r\n    @:dox(group=\"Range related properties and methods\")\r\n    public function setRange(start:Float, end:Float) {\r\n        if (start != _rangeStart) {\r\n            _rangeStart = start;\r\n        }\r\n        if (end != _rangeEnd) {\r\n            _rangeEnd = end;\r\n        }\r\n        invalidateLayout();\r\n        handleBindings([\"value\"]);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    var _mouseDownOffset:Float = -1;\r\n    private var _activeThumb:Button;\r\n\r\n    private function _onValueBackgroundMouseDown(event:MouseEvent) {\r\n\r\n    }\r\n\r\n    private function _onValueMouseDown(event:MouseEvent) {\r\n        _activeThumb = null;\r\n        screen.registerEvent(MouseEvent.MOUSE_UP, _onScreenMouseUp);\r\n        screen.registerEvent(MouseEvent.MOUSE_MOVE, _onScreenMouseMove);\r\n    }\r\n\r\n    private function _onRangeEndThumbMouseDown(event:MouseEvent) {\r\n        _activeThumb = _rangeEndThumb;\r\n        screen.registerEvent(MouseEvent.MOUSE_UP, _onScreenMouseUp);\r\n        screen.registerEvent(MouseEvent.MOUSE_MOVE, _onScreenMouseMove);\r\n    }\r\n\r\n    private function _onRangeStartThumbMouseDown(event:MouseEvent) {\r\n        _activeThumb = _rangeStartThumb;\r\n        screen.registerEvent(MouseEvent.MOUSE_UP, _onScreenMouseUp);\r\n        screen.registerEvent(MouseEvent.MOUSE_MOVE, _onScreenMouseMove);\r\n    }\r\n\r\n    private function _onScreenMouseMove(event:MouseEvent) {\r\n    }\r\n\r\n    private function _onScreenMouseUp(event:MouseEvent) {\r\n        _mouseDownOffset = -1;\r\n        _activeThumb = null;\r\n        screen.unregisterEvent(MouseEvent.MOUSE_UP, _onScreenMouseUp);\r\n        screen.unregisterEvent(MouseEvent.MOUSE_MOVE, _onScreenMouseMove);\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Default behaviours\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Slider)\r\nclass SliderDefaultMinBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var slider:Slider = cast _component;\r\n        slider.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Slider)\r\nclass SliderDefaultMaxBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var slider:Slider = cast _component;\r\n        slider.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Slider)\r\nclass SliderDefaultPosBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var slider:Slider = cast _component;\r\n        slider.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Slider)\r\nclass SliderDefaultRangeStartBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var slider:Slider = cast _component;\r\n        slider.invalidateLayout();\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Slider)\r\nclass SliderDefaultRangeEndBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var slider:Slider = cast _component;\r\n        slider.invalidateLayout();\r\n    }\r\n}",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.animation.Animation;\r\nimport haxe.ui.animation.AnimationManager;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.core.IClonable;\r\n\r\n/**\r\n A horizontal implementation of a `Slider`\r\n**/\r\n@:dox(icon=\"/icons/ui-slider-050.png\")\r\nclass HSlider extends Slider implements IClonable<HSlider> {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        super.createDefaults();\r\n        _defaultLayout = new HSliderLayout();\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        super.createChildren();\r\n\r\n        if (componentWidth <= 0) {\r\n            componentWidth = 150;\r\n        }\r\n        if (componentHeight <= 0) {\r\n            componentHeight = 20;\r\n        }\r\n\r\n        if (_valueBackground != null) {\r\n            /*\r\n            componentWidth = 150;\r\n            componentHeight = 20;\r\n            */\r\n            //layout = new HSliderLayout();\r\n            //_valueBackground.layout.allowLeftChange = false;\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Event overrides\r\n    //***********************************************************************************************************\r\n    private override function _onValueBackgroundMouseDown(event:MouseEvent) {\r\n        super._onValueBackgroundMouseDown(event);\r\n        if (_value.hitTest(event.screenX, event.screenY) == false) {\r\n            if (rangeEnd != rangeStart) {\r\n                if (event.screenX < _rangeStartThumb.screenLeft) {\r\n                    _activeThumb = _rangeStartThumb;\r\n                    var xpos:Float = event.screenX - _valueBackground.screenLeft - (_activeThumb.componentWidth / 2) - _valueBackground.paddingLeft;\r\n                    animateRangeStart(calcPosFromCoord(xpos));\r\n                    //rangeStart = calcPosFromCoord(xpos);\r\n                    _onRangeStartThumbMouseDown(event);\r\n                } else if (event.screenX > _rangeEndThumb.screenLeft + _rangeEndThumb.componentWidth) {\r\n                    _activeThumb = _rangeEndThumb;\r\n                    var xpos:Float = event.screenX - _valueBackground.screenLeft - (_activeThumb.componentWidth / 2) - _valueBackground.paddingLeft;\r\n                    animateRangeEnd(calcPosFromCoord(xpos));\r\n                    //rangeEnd = calcPosFromCoord(xpos);\r\n                    _onRangeEndThumbMouseDown(event);\r\n                }\r\n            } else {\r\n                _activeThumb = _rangeEndThumb;\r\n                var xpos:Float = event.screenX - _valueBackground.screenLeft - (_activeThumb.componentWidth / 2) - _valueBackground.paddingLeft;\r\n                animatePos(calcPosFromCoord(xpos));\r\n                //pos = calcPosFromCoord(xpos);\r\n                _onRangeEndThumbMouseDown(event);\r\n            }\r\n        }\r\n    }\r\n\r\n    private override function _onValueMouseDown(event:MouseEvent) {\r\n        super._onValueMouseDown(event);\r\n        if (rangeEnd != rangeStart) {\r\n            _mouseDownOffset = event.screenX - _value.left;\r\n        } else {\r\n            _activeThumb = _rangeEndThumb;\r\n            var xpos:Float = event.screenX - _valueBackground.screenLeft - (_activeThumb.componentWidth / 2) - _valueBackground.paddingLeft;\r\n            animatePos(calcPosFromCoord(xpos));\r\n            //pos = calcPosFromCoord(xpos);\r\n            _onRangeEndThumbMouseDown(event);\r\n        }\r\n    }\r\n\r\n    private override function _onRangeEndThumbMouseDown(event:MouseEvent) {\r\n        super._onRangeEndThumbMouseDown(event);\r\n        _mouseDownOffset = event.screenX - _activeThumb.screenLeft + _valueBackground.paddingLeft;\r\n    }\r\n\r\n    private override function _onRangeStartThumbMouseDown(event:MouseEvent) {\r\n        super._onRangeStartThumbMouseDown(event);\r\n        _mouseDownOffset = event.screenX - _activeThumb.screenLeft + _valueBackground.paddingLeft;\r\n    }\r\n\r\n    private override function _onScreenMouseMove(event:MouseEvent):Void {\r\n        if (_mouseDownOffset == -1) {\r\n            return;\r\n        }\r\n\r\n        if (_activeThumb != null) {\r\n            var xpos:Float = event.screenX - _valueBackground.screenLeft - _mouseDownOffset;\r\n            if (rangeEnd != rangeStart) {\r\n                if (_activeThumb == _rangeEndThumb) {\r\n                    rangeEnd = calcPosFromCoord(xpos);\r\n                } else if (_activeThumb == _rangeStartThumb) {\r\n                    rangeStart = calcPosFromCoord(xpos);\r\n                }\r\n            } else {\r\n                pos = calcPosFromCoord(xpos);\r\n            }\r\n        } else {\r\n            var diff = rangeEnd - rangeStart;\r\n            var xpos:Float = event.screenX - _mouseDownOffset;\r\n            _activeThumb = _rangeStartThumb;\r\n            var start = calcPosFromCoord(xpos - (_activeThumb.componentWidth / 2) - _valueBackground.paddingLeft);\r\n            _activeThumb = null;\r\n\r\n            if (start + diff > max) {\r\n                return;\r\n            }\r\n\r\n            var end = start + diff;\r\n            setRange(start, end);\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Helpers\r\n    //***********************************************************************************************************\r\n    private function calcPosFromCoord(xpos:Float):Float {\r\n        var minX:Float = -(_activeThumb.componentWidth / 2);\r\n        var maxX:Float = layout.usableWidth - (_activeThumb.componentWidth / 2) - (_valueBackground.paddingLeft + _valueBackground.paddingRight);\r\n\r\n        if (xpos < minX) {\r\n            xpos = minX;\r\n        } else if (xpos > maxX) {\r\n            xpos = maxX;\r\n        }\r\n\r\n        var ucx:Float = layout.usableWidth - (_valueBackground.paddingLeft + _valueBackground.paddingRight);\r\n        //var ucx:Float = layout.innerWidth - (_valueBackground.paddingLeft + _valueBackground.paddingRight);\r\n        var m:Float = max - min;\r\n        var v:Float = xpos - minX;\r\n        var newValue:Float = min + ((v / ucx) * m);\r\n        return newValue;\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\nclass HSliderLayout extends DefaultLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    public override function resizeChildren():Bool {\r\n        super.resizeChildren();\r\n\r\n        var background:Component = component.findComponent(\"slider-value-background\");\r\n        var value:Component = null;\r\n        if (background != null) {\r\n            value = background.findComponent(\"slider-value\");\r\n        }\r\n        var slider:Slider = cast component;\r\n        if (value != null) {\r\n            var ucx:Float = background.layout.usableWidth;\r\n\r\n            var cx:Float = 0;\r\n            if (slider.rangeStart == slider.rangeEnd) {\r\n                cx = (slider.pos - slider.min) / (slider.max - slider.min) * ucx;\r\n            } else {\r\n                cx = ((slider.rangeEnd - slider.rangeStart) - slider.min) / (slider.max - slider.min) * ucx;\r\n            }\r\n\r\n            if (cx < 0) {\r\n                cx = 0;\r\n            } else if (cx > ucx) {\r\n                cx = ucx;\r\n            }\r\n\r\n            if (cx == 0) {\r\n                value.componentWidth = cx;\r\n                if (value.hidden == false) {\r\n                    value.hidden = true;\r\n                    value.invalidateStyle();\r\n                }\r\n            } else {\r\n                value.componentWidth = cx;\r\n                if (value.hidden == true) {\r\n                    value.hidden = false;\r\n                    value.invalidateStyle();\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public override function repositionChildren():Void {\r\n        super.repositionChildren();\r\n\r\n        var background:Component = component.findComponent(\"slider-value-background\");\r\n        var value:Component = null;\r\n        if (background != null) {\r\n            value = background.findComponent(\"slider-value\");\r\n        }\r\n        var slider:Slider = cast component;\r\n        if (value != null) {\r\n            var rangeStartButton:Button = null;\r\n            var rangeEndButton:Button = component.findComponent(\"slider-range-end-button\");\r\n\r\n            var x:Float = 0;\r\n            if (slider.rangeStart != slider.rangeEnd) {\r\n                rangeStartButton = component.findComponent(\"slider-range-start-button\");\r\n                var ucx:Float = background.layout.usableWidth;\r\n                x = (slider.rangeStart - slider.min) / (slider.max - slider.min) * ucx;\r\n            }\r\n\r\n            //x += background.layout.paddingLeft;\r\n            value.left = x + background.layout.paddingLeft;\r\n\r\n            if (rangeStartButton != null) {\r\n                rangeStartButton.left = x;// - (rangeStartButton.width / 2);\r\n            }\r\n            if (rangeEndButton != null) {\r\n                rangeEndButton.left = paddingLeft + value.left + value.componentWidth - (rangeEndButton.componentWidth / 2);\r\n            }\r\n        }\r\n    }\r\n}",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.core.Behaviour;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.ImageDisplay;\r\nimport haxe.ui.Toolkit;\r\nimport haxe.ui.core.IClonable;\r\nimport haxe.ui.assets.ImageInfo;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.Size;\r\nimport haxe.ui.util.Variant;\r\n\r\n/**\r\n A general purpose component to display images\r\n**/\r\n@:dox(icon=\"/icons/image-sunset.png\")\r\nclass Image extends Component implements IClonable<Image> {\r\n    private var _originalSize:Size = new Size();\r\n\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        _defaultBehaviours = [\r\n            \"resource\" => new ImageDefaultResourceBehaviour(this)\r\n        ];\r\n        _defaultLayout = new ImageLayout();\r\n    }\r\n\r\n    private override function create():Void {\r\n        super.create();\r\n        behaviourSet(\"resource\", _resource);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    private var _resource:String;\r\n    /**\r\n     The resource to use for this image, currently only assets are supported, later versions will also support things like HTTP, files, etc\r\n    **/\r\n    @:clonable @:bindable public var resource(get, set):Dynamic;\r\n    private function get_resource():Dynamic {\r\n        return _resource;\r\n    }\r\n    private function set_resource(value:Dynamic):Dynamic {\r\n        if (_resource == value) {\r\n            return value;\r\n        }\r\n\r\n        if (value == null) {\r\n            _resource = null;\r\n            removeImageDisplay();\r\n            return value;\r\n        }\r\n\r\n        _resource = \"\" + value;\r\n        behaviourSet(\"resource\", _resource);\r\n        _resource = value;\r\n        return value;\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Image)\r\nclass ImageLayout extends DefaultLayout {\r\n    private var maintainAspectRatio(get, null):Bool;\r\n    private function get_maintainAspectRatio():Bool {\r\n        return true;\r\n    }\r\n\r\n    private override function resizeChildren():Bool {\r\n        if (component.hasImageDisplay()) {\r\n            // this feels like it might be the wrong place to do this, ie, setting the component size here - its a special case though\r\n            if (component.autoWidth == false) {\r\n                var usz = usableSize;\r\n                component.getImageDisplay().imageWidth = usz.width;\r\n                if (maintainAspectRatio == true) {\r\n                    var image:Image = cast _component;\r\n                    var r:Float = usz.width / image._originalSize.width;\r\n                    component.getImageDisplay().imageHeight = image._originalSize.height * r;\r\n                    component.componentHeight = component.getImageDisplay().imageHeight + (paddingTop + paddingBottom);\r\n                }\r\n            }\r\n\r\n            if (component.autoHeight == false) {\r\n                var usz = usableSize;\r\n                component.getImageDisplay().imageHeight = usz.height;\r\n                if (maintainAspectRatio == true) {\r\n                    var image:Image = cast _component;\r\n                    var r:Float = usz.height / image._originalSize.height;\r\n                    component.getImageDisplay().imageWidth = image._originalSize.width * r;\r\n                    component.componentWidth = component.getImageDisplay().imageWidth + (paddingLeft + paddingRight);\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private override function repositionChildren():Void {\r\n        if (component.hasImageDisplay()) {\r\n            component.getImageDisplay().left = paddingLeft;\r\n            component.getImageDisplay().top = paddingTop;\r\n        }\r\n    }\r\n\r\n    public override function calcAutoSize():Size {\r\n        var size:Size = super.calcAutoSize();\r\n        if (component.hasImageDisplay()) {\r\n            size.width += component.getImageDisplay().imageWidth;\r\n            size.height += component.getImageDisplay().imageHeight;\r\n        }\r\n        return size;\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Default behaviours\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Image)\r\nclass ImageDefaultResourceBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var image:Image = cast _component;\r\n\r\n        if (value == null || value.isNull || value == \"null\") { // TODO: hack\r\n            image.removeImageDisplay();\r\n            return;\r\n        }\r\n\r\n        if (value.isString) {\r\n            var resource:String = value.toString();\r\n            if (StringTools.startsWith(resource, \"http://\")) {\r\n                // load remote placeholder\r\n            } else { // assume asset\r\n                Toolkit.assets.getImage(resource, function(imageInfo:ImageInfo) {\r\n                    if (imageInfo != null) {\r\n                        var display:ImageDisplay = image.getImageDisplay();\r\n                        if (display != null) {\r\n                            display.imageInfo = imageInfo;\r\n                            image._originalSize = new Size(imageInfo.width, imageInfo.height);\r\n                            if (image.autoSize() == true) {\r\n                                image.parentComponent.invalidateLayout();\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n        }\r\n    }\r\n}",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.components.Label.LabelLayout;\r\nimport haxe.ui.core.Behaviour;\r\nimport haxe.ui.core.IClonable;\r\nimport haxe.ui.core.InteractiveComponent;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.Size;\r\nimport haxe.ui.util.Variant;\r\n\r\n/**\r\n A general purpose component to display text\r\n**/\r\n@:dox(icon=\"/icons/ui-label.png\")\r\nclass Label extends InteractiveComponent implements IClonable<Label> {\r\n    public function new() {\r\n        super();\r\n        #if openfl\r\n        mouseChildren = false;\r\n        #end\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        _defaultBehaviours = [\r\n            \"text\" => new LabelDefaultTextBehaviour(this)\r\n        ];\r\n        _defaultLayout = new LabelLayout();\r\n    }\r\n\r\n    private override function create():Void {\r\n        super.create();\r\n        behaviourSet(\"text\", _text);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    private override function set_text(value:String):String {\r\n        if (value == _text) {\r\n            return value;\r\n        }\r\n\r\n        value = super.set_text(value);\r\n        behaviourSet(\"text\", value);\r\n        handleBindings([\"text\", \"value\"]);\r\n        invalidateLayout();\r\n        return value;\r\n    }\r\n\r\n    private override function applyStyle(style:Style):Void {\r\n        super.applyStyle(style);\r\n        if (hasTextDisplay() == true) {\r\n            if (style.color != null) {\r\n                getTextDisplay().color = style.color;\r\n            }\r\n            if (style.fontName != null) {\r\n                getTextDisplay().fontName = style.fontName;\r\n            }\r\n            if (style.fontSize != null) {\r\n                getTextDisplay().fontSize = style.fontSize;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Label)\r\nclass LabelLayout extends DefaultLayout {\r\n    private override function resizeChildren():Bool {\r\n        if (component.autoWidth == false) {\r\n            component.getTextDisplay().width = component.componentWidth;\r\n            #if openfl // TODO: make not specific\r\n            component.getTextDisplay().multiline = true;\r\n            component.getTextDisplay().wordWrap = true;\r\n            #end\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private override function repositionChildren():Void {\r\n        if (component.hasTextDisplay() == true) {\r\n            component.getTextDisplay().left = paddingLeft;\r\n            component.getTextDisplay().top = paddingTop;\r\n        }\r\n    }\r\n\r\n    public override function calcAutoSize():Size {\r\n        var size:Size = super.calcAutoSize();\r\n        if (component.hasTextDisplay() == true) {\r\n            size.width += component.getTextDisplay().textWidth;\r\n            size.height += component.getTextDisplay().textHeight;\r\n        }\r\n        return size;\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Default behaviours\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.Label)\r\nclass LabelDefaultTextBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        if (value.isNull) {\r\n            value = \"\";\r\n        }\r\n\r\n        var label:Label = cast _component;\r\n        label.getTextDisplay().text = value;\r\n        label.invalidateDisplay();\r\n    }\r\n}\r\n",null,"package haxe.ui.components;\r\n\r\nimport haxe.ds.StringMap;\r\nimport haxe.ui.core.Behaviour;\r\nimport haxe.ui.core.IClonable;\r\nimport haxe.ui.core.InteractiveComponent;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.core.UIEvent;\r\nimport haxe.ui.layouts.HorizontalLayout;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.Variant;\r\n\r\n/**\r\n Optionbox component where only one option of a group may be selected at a single time\r\n**/\r\n@:dox(icon=\"/icons/ui-radio-buttons.png\")\r\nclass OptionBox extends InteractiveComponent implements IClonable<OptionBox> {\r\n    private static var _groups:StringMap<Array<OptionBox>>;\r\n\r\n    private var _value:OptionBoxValue;\r\n    private var _label:Label;\r\n\r\n    public function new() {\r\n        super();\r\n\r\n        if (_groups == null) {\r\n            _groups = new StringMap<Array<OptionBox>>();\r\n        }\r\n        group = \"defaultGroup\";\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        _defaultBehaviours = [\r\n            \"text\" => new OptionBoxDefaultTextBehaviour(this),\r\n            \"selected\" => new OptionBoxDefaultSelectedBehaviour(this)\r\n        ];\r\n        _defaultLayout = new HorizontalLayout();\r\n    }\r\n\r\n    private override function create():Void {\r\n        super.create();\r\n        behaviourSet(\"text\", _text);\r\n        behaviourSet(\"group\", _group);\r\n        behaviourSet(\"selected\", selected);\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        if (_value == null) {\r\n            _value = new OptionBoxValue();\r\n            _value.id = \"optionbox-value\";\r\n            _value.addClass(\"optionbox-value\");\r\n            addComponent(_value);\r\n\r\n            _value.registerEvent(MouseEvent.CLICK, _onClick);\r\n            _value.registerEvent(MouseEvent.MOUSE_OVER, _onMouseOver);\r\n            _value.registerEvent(MouseEvent.MOUSE_OUT, _onMouseOut);\r\n        }\r\n    }\r\n\r\n    private override function destroyChildren():Void {\r\n        if (_value != null) {\r\n            removeComponent(_value);\r\n            _value = null;\r\n        }\r\n        if (_label != null) {\r\n            removeComponent(_label);\r\n            _label = null;\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    private override function get_value():Variant {\r\n        return selected;\r\n    }\r\n\r\n    private override function set_value(value:Variant):Variant {\r\n        selected = value;\r\n        return value;\r\n    }\r\n\r\n    private override function set_text(value:String):String {\r\n        value = super.set_text(value);\r\n        behaviourSet(\"text\", value);\r\n        return value;\r\n    }\r\n\r\n    private override function applyStyle(style:Style):Void {\r\n        super.applyStyle(style);\r\n        if (_label != null) {\r\n            _label.customStyle.color = style.color;\r\n            _label.customStyle.fontName = style.fontName;\r\n            _label.customStyle.fontSize = style.fontSize;\r\n            _label.customStyle.cursor = style.cursor;\r\n            _label.invalidateStyle();\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    private var _selected:Bool = false;\r\n    /**\r\n     Whether to set this optionbox to be selected, any other optionboxes in the same group will be unselected\r\n    **/\r\n    @:clonable @:bindable public var selected(get, set):Bool;\r\n    private function set_selected(value:Bool):Bool {\r\n        if (value == _selected) {\r\n            return value;\r\n        }\r\n\r\n        if (_group != null && value == false) { // dont allow false if no other group selection\r\n            var arr:Array<OptionBox> = _groups.get(_group);\r\n            var hasSelection:Bool = false;\r\n            if (arr != null) {\r\n                for (option in arr) {\r\n                    if (option != this && option.selected == true) {\r\n                        hasSelection = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (hasSelection == false) {\r\n                return value;\r\n            }\r\n        }\r\n\r\n        _selected = value;\r\n        behaviourSet(\"selected\", value);\r\n\r\n        /*\r\n        if (value == true) {\r\n            _value.addClass(\":selected\");\r\n        } else {\r\n            _value.removeClass(\":selected\");\r\n        }\r\n        */\r\n\r\n        if (_group != null && value == true) { // set all the others in group\r\n            var arr:Array<OptionBox> = _groups.get(_group);\r\n            if (arr != null) {\r\n                for (option in arr) {\r\n                    if (option != this) {\r\n                        option.selected = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    private function get_selected():Bool {\r\n        return _selected;\r\n    }\r\n\r\n    private function toggleSelected():Bool {\r\n        return selected = !selected;\r\n    }\r\n\r\n    private var _group:String;\r\n    /**\r\n     The group that this optionbox belongs to, any options that belong to the same group can only ever have a single option selected at a time\r\n    **/\r\n    @:clonable public var group(get, set):String;\r\n    private function get_group():String {\r\n        return _group;\r\n    }\r\n\r\n    private function set_group(value:String):String {\r\n        if (value != null) {\r\n            var arr:Array<OptionBox> = _groups.get(value);\r\n            if (arr != null) {\r\n                arr.remove(this);\r\n            }\r\n        }\r\n\r\n        _group = value;\r\n        behaviourSet(\"group\", value);\r\n        var arr:Array<OptionBox> = _groups.get(value);\r\n        if (arr == null) {\r\n            arr = new Array<OptionBox>();\r\n        }\r\n\r\n        if (optionInGroup(value, this) == false) {\r\n            arr.push(this);\r\n        }\r\n        _groups.set(value, arr);\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     A utility property to retrieve that actual `OptionBox` that is currently selected\r\n    **/\r\n    public var selectedOption(get, null):OptionBox;\r\n    private function get_selectedOption():OptionBox {\r\n        var arr:Array<OptionBox> = getGroupOptions(_group);\r\n        var selectionOption:OptionBox = null;\r\n        if (arr != null) {\r\n            for (test in arr) {\r\n                if (test.selected == true) {\r\n                    selectionOption = test;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return selectionOption;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    private function _onClick(event:MouseEvent):Void {\r\n        toggleSelected();\r\n        var event:UIEvent = new UIEvent(UIEvent.CHANGE);\r\n        dispatch(event);\r\n    }\r\n\r\n    private function _onMouseOver(event:MouseEvent):Void {\r\n        addClass(\":hover\");\r\n        _value.addClass(\":hover\");\r\n    }\r\n\r\n    private function _onMouseOut(event:MouseEvent):Void {\r\n        removeClass(\":hover\");\r\n        _value.removeClass(\":hover\");\r\n    }\r\n\r\n    //******************************************************************************************\r\n    // Helpers\r\n    //******************************************************************************************\r\n    private static function optionInGroup(value:String, option:OptionBox):Bool {\r\n        var exists:Bool = false;\r\n        var arr:Array<OptionBox> = _groups.get(value);\r\n        if (arr != null) {\r\n            for (test in arr) {\r\n                if (test == option) {\r\n                    exists = true;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return exists;\r\n    }\r\n\r\n    private static function getGroupOptions(group:String):Array<OptionBox> {\r\n        return _groups.get(group);\r\n    }\r\n\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Default behaviours\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.OptionBox)\r\nclass OptionBoxDefaultTextBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var optionbox:OptionBox = cast _component;\r\n        if (optionbox._label == null) {\r\n            optionbox._label = new Label();\r\n            optionbox._label.id = \"optionbox-label\";\r\n            optionbox._label.addClass(\"optionbox-label\");\r\n\r\n            optionbox._label.registerEvent(MouseEvent.CLICK, optionbox._onClick);\r\n            optionbox._label.registerEvent(MouseEvent.MOUSE_OVER, optionbox._onMouseOver);\r\n            optionbox._label.registerEvent(MouseEvent.MOUSE_OUT, optionbox._onMouseOut);\r\n\r\n            optionbox.addComponent(optionbox._label);\r\n        }\r\n        optionbox._label.text = value;\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.OptionBox)\r\nclass OptionBoxDefaultSelectedBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        var optionbox:OptionBox = cast _component;\r\n        if (optionbox._value == null) {\r\n            return;\r\n        }\r\n\r\n        if (value == true) {\r\n            optionbox._value.addClass(\":selected\");\r\n        } else {\r\n            optionbox._value.removeClass(\":selected\");\r\n        }\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Special children\r\n//***********************************************************************************************************\r\n/**\r\n Specialised `InteractiveComponent` used to contain the `OptionBox` icon and respond to style changes\r\n**/\r\nclass OptionBoxValue extends InteractiveComponent {\r\n    private var _icon:Image;\r\n\r\n    public function new() {\r\n        super();\r\n        #if openfl\r\n        mouseChildren = false;\r\n        #end\r\n\r\n        _icon = new Image();\r\n        _icon.id = \"optionbox-icon\";\r\n        _icon.addClass(\"optionbox-icon\");\r\n        addComponent(_icon);\r\n    }\r\n\r\n    private override function applyStyle(style:Style):Void {\r\n        super.applyStyle(style);\r\n        if (_icon != null) {\r\n            _icon.resource = style.icon;\r\n        }\r\n    }\r\n}",null,null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.core.UIEvent;\r\nimport haxe.ui.layouts.HorizontalLayout;\r\nimport haxe.ui.core.IClonable;\r\nimport haxe.ui.util.Size;\r\n\r\n/**\r\n A specially styled list of toggle buttons where one one can be selected at a time\r\n**/\r\n@:dox(icon=\"/icons/ui-tab.png\")\r\nclass TabBar extends Component implements IClonable<TabBar> {\r\n    private var _currentButton:Button;\r\n\r\n    public function new() {\r\n        super();\r\n        layout = new HorizontalLayout();// TabBarLayout();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    public override function addComponent(child:Component):Component {\r\n        var v = super.addComponent(child);\r\n\r\n        //if (child != _background) {\r\n            child.addClass(\"tabbar-button\");\r\n            child.registerEvent(MouseEvent.MOUSE_DOWN, __onButtonMouseDown);\r\n            if (_selectedIndex == -1) {\r\n                selectedIndex = 0;\r\n            }\r\n        //}\r\n        return v;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    private var _selectedIndex:Int = -1;\r\n    /**\r\n     The currently selected button index\r\n    **/\r\n    @bindable public var selectedIndex(get, set):Int;\r\n    private function get_selectedIndex():Int {\r\n        return _selectedIndex;\r\n    }\r\n    private function set_selectedIndex(value:Int) {\r\n        if (value < 0) {\r\n            return value;\r\n        }\r\n        if (_selectedIndex == value) {\r\n            return value;\r\n        }\r\n\r\n        _selectedIndex = value;\r\n\r\n        var button:Button = cast getComponentAt(_selectedIndex); // offset as 0 is background\r\n        if (button != null) {\r\n            if (_currentButton != null) {\r\n                _currentButton.removeClass(\"tabbar-button-selected\");\r\n            }\r\n            _currentButton = button;\r\n            _currentButton.addClass(\"tabbar-button-selected\");\r\n            invalidateLayout();\r\n\r\n            var event:UIEvent = new UIEvent(UIEvent.CHANGE);\r\n            event.target = this;\r\n            dispatch(event);\r\n        }\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    private function __onButtonMouseDown(event:MouseEvent):Void {\r\n        if (event.target == _currentButton) {\r\n            return;\r\n        }\r\n\r\n        selectedIndex = getComponentIndex(event.target);// - 1;\r\n\r\n    }\r\n\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\nclass TabBarLayout extends HorizontalLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    private override function resizeChildren():Bool {\r\n        super.resizeChildren();\r\n\r\n        return true;\r\n\r\n        var background:Component = component.findComponent(\"tabbar-background\");\r\n        if (background != null) {\r\n            background.componentWidth = component.componentWidth;\r\n            background.componentHeight = component.componentHeight - 1;\r\n        }\r\n\r\n        return true;\r\n\r\n        var ucy = usableHeight;\r\n\r\n        var background:Component = component.findComponent(\"tabbar-background\");\r\n        if (background != null) {\r\n            background.componentWidth = component.componentWidth;\r\n            background.componentHeight = component.componentHeight - 1;\r\n        }\r\n\r\n        for (c in component.childComponents) {\r\n            if (c.includeInLayout == false) {\r\n                continue;\r\n            }\r\n\r\n            if (c.hasClass(\"tabbar-button-selected\")) {\r\n                c.componentHeight = ucy;// + 1;\r\n            } else {\r\n                c.componentHeight = ucy;\r\n            }\r\n        }\r\n    }\r\n}",null,"package haxe.ui.layouts;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.Size;\r\n\r\nclass HorizontalLayout extends DefaultLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    private override function repositionChildren() {\r\n        var xpos = paddingLeft;\r\n        var usableSize:Size = component.layout.usableSize;\r\n\r\n        for (child in component.childComponents) {\r\n            if (child.includeInLayout == false) {\r\n                continue;\r\n            }\r\n\r\n            var ypos:Float = 0;\r\n\r\n            switch (verticalAlign(child)) {\r\n                case \"center\":\r\n                    ypos = ((component.componentHeight / 2) - (child.componentHeight / 2)) + marginTop(child) - marginBottom(child);\r\n//                  ypos = ((usableSize.height / 2) - (child.componentHeight / 2)) + marginTop(child) - marginBottom(child);\r\n                case \"bottom\":\r\n                    if (child.componentHeight < component.componentHeight) {\r\n//                      ypos = component.componentHeight - (child.componentHeight + paddingBottom + marginTop(child) - marginBottom(child));\r\n                        ypos = usableSize.height - (child.componentHeight + paddingBottom + marginTop(child) - marginBottom(child));\r\n                    }\r\n                default:\r\n                    ypos = paddingTop + marginTop(child) - marginBottom(child);\r\n            }\r\n\r\n            child.moveComponent(xpos + marginLeft(child) - marginRight(child), ypos);\r\n            xpos += child.componentWidth + horizontalSpacing;\r\n        }\r\n    }\r\n\r\n    private override function get_usableSize():Size {\r\n        var size:Size = super.get_usableSize();\r\n\r\n        var visibleChildren = component.childComponents.length;\r\n        for (child in component.childComponents) {\r\n            if (child.includeInLayout == false) {\r\n                visibleChildren--;\r\n                continue;\r\n            }\r\n\r\n            if (child.componentWidth > 0 && child.percentWidth == null) { // means its a fixed width, ie, not a % sized control\r\n                size.width -= child.componentWidth + marginLeft(child) + marginRight(child);\r\n            }\r\n        }\r\n\r\n        if (visibleChildren > 1) {\r\n            size.width -= horizontalSpacing * (visibleChildren - 1);\r\n        }\r\n\r\n        if (size.width < 0) {\r\n            size.width = 0;\r\n        }\r\n\r\n        return size;\r\n    }\r\n}","package haxe.ui.components;\r\n\r\nimport haxe.ui.core.Behaviour;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.InteractiveComponent;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.core.UIEvent;\r\nimport haxe.ui.focus.FocusManager;\r\nimport haxe.ui.focus.IFocusable;\r\nimport haxe.ui.core.IClonable;\r\nimport haxe.ui.styles.Style;\r\nimport haxe.ui.util.Size;\r\nimport haxe.ui.util.Variant;\r\nimport haxe.ui.layouts.DefaultLayout;\r\n\r\n@:dox(icon=\"/icons/ui-text-field.png\")\r\nclass TextField extends InteractiveComponent implements IFocusable implements IClonable<TextField> {\r\n    private var _icon:Image;\r\n\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        _defaultBehaviours = [\r\n            \"text\" => new TextFieldDefaultTextBehaviour(this),\r\n            \"icon\" => new TextFieldDefaultIconBehaviour(this)\r\n        ];\r\n        _defaultLayout = new TextFieldLayout();\r\n    }\r\n\r\n    private override function create():Void {\r\n        super.create();\r\n        //behaviourSet(\"text\", _text);\r\n        //behaviourSet(\"icon\", _iconResource);\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        if (componentWidth == 0) {\r\n            componentWidth = 150;\r\n        }\r\n\r\n        registerEvent(MouseEvent.MOUSE_DOWN, _onMouseDown);\r\n        registerEvent(UIEvent.CHANGE, _onTextChanged);\r\n    }\r\n\r\n    private override function destroyChildren():Void {\r\n        super.destroyChildren();\r\n\r\n        unregisterEvent(MouseEvent.MOUSE_DOWN, _onMouseDown);\r\n        unregisterEvent(UIEvent.CHANGE, _onTextChanged);\r\n\r\n        if (_icon != null) {\r\n            removeComponent(_icon);\r\n            _icon = null;\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    private override function get_text():String {\r\n        return behaviourGet(\"text\");\r\n    }\r\n\r\n    private override function set_text(value:String):String {\r\n        if (value == _text) {\r\n            return value;\r\n        }\r\n\r\n        value = super.set_text(value);\r\n        behaviourSet(\"text\", value);\r\n        return value;\r\n    }\r\n\r\n    private override function applyStyle(style:Style):Void {\r\n        super.applyStyle(style);\r\n        if (style.icon != null) {\r\n            icon = style.icon;\r\n        }\r\n        if (hasTextInput() == true) {\r\n            if (style.color != null) {\r\n                getTextInput().color = style.color;\r\n            }\r\n            if (style.fontName != null) {\r\n                getTextInput().fontName = style.fontName;\r\n            }\r\n            if (style.fontSize != null) {\r\n                getTextInput().fontSize = style.fontSize;\r\n            }\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    private var _iconResource:String;\r\n    /**\r\n     The image resource to use as the textfields icon\r\n    **/\r\n    @:clonable public var icon(get, set):String;\r\n    private function get_icon():String {\r\n        return _iconResource; // TODO: temp\r\n    }\r\n\r\n    private function set_icon(value:String):String {\r\n        if (_iconResource == value) {\r\n            return value;\r\n        }\r\n\r\n        _iconResource = value;\r\n        behaviourSet(\"icon\", value);\r\n        return value;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    private function _onTextChanged(event:UIEvent):Void {\r\n        handleBindings([\"text\", \"value\"]);\r\n    }\r\n\r\n    private function _onMouseDown(event:MouseEvent):Void {\r\n        FocusManager.instance.focus = this;\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Default behaviours\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.TextField)\r\nclass TextFieldDefaultTextBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        if (value.isNull) {\r\n            return;\r\n        }\r\n\r\n        var textField:TextField = cast _component;\r\n        textField.getTextInput().text = value;\r\n        textField.invalidateDisplay();\r\n    }\r\n\r\n    public override function get():Variant {\r\n        var textField:TextField = cast _component;\r\n        return textField.getTextInput().text;\r\n    }\r\n}\r\n\r\n@:dox(hide)\r\n@:access(haxe.ui.components.TextField)\r\nclass TextFieldDefaultIconBehaviour extends Behaviour {\r\n    public override function set(value:Variant) {\r\n        if (value == null || value.isNull || value == \"null\") { // TODO: hack\r\n            return;\r\n        }\r\n\r\n        var textField:TextField = cast _component;\r\n        if (textField._icon == null) {\r\n            textField._icon = new Image();\r\n            textField._icon.id = \"textfield-icon\";\r\n            textField._icon.addClass(\"icon\");\r\n            textField._icon.scriptAccess = false;\r\n            textField.addComponent(textField._icon);\r\n        }\r\n        textField._icon.resource = value.toString();\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\n@:access(haxe.ui.components.TextField)\r\nclass TextFieldLayout extends DefaultLayout {\r\n    private var iconPosition(get, null):String;\r\n    private function get_iconPosition():String {\r\n        if (component.style.iconPosition == null) {\r\n            return \"left\";\r\n        }\r\n        return component.style.iconPosition;\r\n    }\r\n\r\n    private override function repositionChildren():Void {\r\n        //super.repositionChildren();\r\n        var icon:Image = component.findComponent(\"textfield-icon\");\r\n        var xpos:Float = paddingLeft;\r\n        if (icon != null) {\r\n            switch (iconPosition) {\r\n                case \"left\":\r\n                    icon.left = xpos;\r\n                    icon.top = (component.componentHeight / 2) - (icon.componentHeight / 2);\r\n                    xpos += icon.componentWidth + horizontalSpacing;\r\n                case \"right\":\r\n                    icon.left = component.componentWidth - icon.componentWidth - paddingRight;\r\n                    icon.top = (component.componentHeight / 2) - (icon.componentHeight / 2);\r\n            }\r\n        }\r\n\r\n        if (component.hasTextInput() == true) {\r\n            component.getTextInput().left = xpos;\r\n            component.getTextInput().top = (component.componentHeight / 2) - (component.getTextInput().textHeight / 2);\r\n        }\r\n    }\r\n\r\n    private override function resizeChildren():Bool {\r\n        super.resizeChildren();\r\n\r\n        if (component.hasTextInput() == true) {\r\n            var size:Size = usableSize;\r\n            component.getTextInput().width = size.width;\r\n            //component.getTextInput().height = size.height;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public override function calcAutoSize():Size {\r\n        var size:Size = super.calcAutoSize();\r\n        if (component.hasTextInput() == true) {\r\n            if (component.getTextInput().textWidth + paddingLeft + paddingRight > size.width) {\r\n                size.width = component.getTextInput().textWidth + paddingLeft + paddingRight;\r\n            }\r\n            if (component.getTextInput().textHeight + paddingTop + paddingBottom > size.height) {\r\n                size.height = component.getTextInput().textHeight + paddingTop + paddingBottom;\r\n            }\r\n        }\r\n\r\n        return size;\r\n    }\r\n\r\n    private override function get_usableSize():Size {\r\n        var size:Size = super.get_usableSize();\r\n        var icon:Image = component.findComponent(\"textfield-icon\");\r\n        if (icon != null) {\r\n            size.width -= icon.componentWidth + horizontalSpacing;\r\n        }\r\n        return size;\r\n    }\r\n}",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.core.IClonable;\r\n\r\n/**\r\n A vertical implementation of a `Progress`\r\n**/\r\n@:dox(icon=\"/icons/ui-progress-bar-vertical.png\")\r\nclass VProgress extends Progress implements IClonable<VProgress> {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        super.createDefaults();\r\n        _defaultLayout = new VProgressLayout();\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        super.createChildren();\r\n        if (componentWidth <= 0) {\r\n            componentWidth = 20;\r\n        }\r\n        if (componentHeight <= 0) {\r\n            componentHeight = 150;\r\n        }\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\nclass VProgressLayout extends DefaultLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    public override function resizeChildren():Bool {\r\n        super.resizeChildren();\r\n\r\n        var value:Component = component.findComponent(\"progress-value\");\r\n        var progress:Progress = cast component;\r\n        if (value != null) {\r\n            var ucy:Float = usableHeight;\r\n\r\n            var cy:Float = 0;\r\n            if (progress.rangeStart == progress.rangeEnd) {\r\n                cy = (progress.pos - progress.min) / (progress.max - progress.min) * ucy;\r\n            } else {\r\n                cy = ((progress.rangeEnd - progress.rangeStart) - progress.min) / (progress.max - progress.min) * ucy;\r\n            }\r\n\r\n            if (cy < 0) {\r\n                cy = 0;\r\n            } else if (cy > ucy) {\r\n                cy = ucy;\r\n            }\r\n\r\n            if (cy == 0) {\r\n                value.componentHeight = 0;\r\n                value.hidden = true;\r\n            } else {\r\n                value.componentHeight = cy;\r\n                value.hidden = false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public override function repositionChildren():Void {\r\n        super.repositionChildren();\r\n\r\n        var value:Component = component.findComponent(\"progress-value\");\r\n        var progress:Progress = cast component;\r\n        if (value != null) {\r\n            var ucy:Float = usableHeight;\r\n            var y:Float = ucy - value.componentHeight + paddingBottom;\r\n            if (progress.rangeStart != progress.rangeEnd) {\r\n                y -= (progress.rangeStart - progress.min) / (progress.max - progress.min) * ucy;\r\n            }\r\n            value.top = y;\r\n        }\r\n    }\r\n}\r\n",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.core.IClonable;\r\n\r\n/**\r\n A vertical implementation of a `Scroll`\r\n**/\r\n@:dox(icon=\"/icons/ui-scroll-bar.png\")\r\nclass VScroll extends Scroll implements IClonable<VScroll> {\r\n    public function new() {\r\n        super();\r\n        layout = new VScrollLayout();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Event overrides\r\n    //***********************************************************************************************************\r\n    private override function _onThumbMouseDown(event:MouseEvent) {\r\n        super._onThumbMouseDown(event);\r\n\r\n        _mouseDownOffset = event.screenY - _thumb.top;\r\n    }\r\n\r\n    private override function _onScreenMouseMove(event:MouseEvent) {\r\n        super._onScreenMouseMove(event);\r\n        if (_mouseDownOffset == -1) {\r\n            return;\r\n        }\r\n\r\n        var ypos:Float = event.screenY - _mouseDownOffset;\r\n        var minY:Float = 0;\r\n        if (_deincButton != null) {\r\n            minY = _deincButton.componentHeight + layout.verticalSpacing;\r\n        }\r\n        var maxY:Float = layout.usableHeight - _thumb.componentHeight;\r\n        if (_deincButton != null) {\r\n            maxY += _deincButton.componentHeight + layout.verticalSpacing;\r\n        }\r\n        if (ypos < minY) {\r\n            ypos = minY;\r\n        } else if (ypos > maxY) {\r\n            ypos = maxY;\r\n        }\r\n\r\n        var ucy:Float = layout.usableHeight;\r\n        ucy -= _thumb.componentHeight;\r\n        var m:Int = Std.int(max - min);\r\n        var v:Float = ypos - minY;\r\n        var newValue:Float = min + ((v / ucy) * m);\r\n        pos = newValue;\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\nclass VScrollLayout extends DefaultLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    public override function resizeChildren():Bool {\r\n        super.resizeChildren();\r\n\r\n        var scroll:Scroll = cast component;\r\n        var thumb:Button =  component.findComponent(\"scroll-thumb-button\");\r\n        if (thumb != null) {\r\n            var m:Float = scroll.max - scroll.min;\r\n            var ucy:Float = usableHeight;\r\n            var thumbHeight = (scroll.pageSize / m) * ucy;\r\n            if (thumbHeight < innerWidth) {\r\n                thumbHeight = innerWidth;\r\n            } else if (thumbHeight > ucy) {\r\n                thumbHeight = ucy;\r\n            }\r\n            if (thumbHeight > 0 && Math.isNaN(thumbHeight) == false) {\r\n                thumb.componentHeight = thumbHeight;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public override function repositionChildren():Void {\r\n        super.repositionChildren();\r\n\r\n        var deinc:Button = component.findComponent(\"scroll-deinc-button\");\r\n        var inc:Button = component.findComponent(\"scroll-inc-button\");\r\n        if (inc != null && hidden(inc) == false) {\r\n            inc.top = component.componentHeight - inc.componentHeight - paddingBottom;\r\n        }\r\n\r\n        var scroll:Scroll = cast component;\r\n        var thumb:Button =  component.findComponent(\"scroll-thumb-button\");\r\n        if (thumb != null) {\r\n            var m:Float = scroll.max - scroll.min;\r\n            var u:Float = usableHeight;\r\n            u -= thumb.componentHeight;\r\n            var y:Float = ((scroll.pos - scroll.min) / m) * u;\r\n            y += paddingTop;\r\n            if (deinc != null && hidden(deinc) == false) {\r\n                y += deinc.componentHeight + verticalSpacing;\r\n            }\r\n            thumb.top = y;\r\n        }\r\n    }\r\n\r\n    // usable height returns the amount of available space for % size components\r\n    private override function get_usableHeight():Float {\r\n        var ucy:Float = innerHeight;\r\n        var deinc:Button = component.findComponent(\"scroll-deinc-button\");\r\n        var inc:Button = component.findComponent(\"scroll-inc-button\");\r\n        if (deinc != null && hidden(deinc) == false) {\r\n            ucy -= deinc.componentHeight + verticalSpacing;\r\n        }\r\n        if (inc != null && hidden(inc) == false) {\r\n            ucy -= inc.componentHeight + verticalSpacing;\r\n        }\r\n        return ucy;\r\n    }\r\n}",null,"package haxe.ui.components;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.layouts.DefaultLayout;\r\nimport haxe.ui.core.IClonable;\r\n\r\n/**\r\n A vertical implementation of a `Slider`\r\n**/\r\n@:dox(icon=\"/icons/ui-slider-vertical-050.png\")\r\nclass VSlider extends Slider implements IClonable<VSlider> {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createDefaults():Void {\r\n        super.createDefaults();\r\n        _defaultLayout = new VSliderLayout();\r\n    }\r\n\r\n    private override function createChildren():Void {\r\n        super.createChildren();\r\n        if (componentWidth <= 0) {\r\n            componentWidth = 20;\r\n        }\r\n        if (componentHeight <= 0) {\r\n            componentHeight = 150;\r\n        }\r\n\r\n        if (_valueBackground != null) {\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Event overrides\r\n    //***********************************************************************************************************\r\n    private override function _onValueBackgroundMouseDown(event:MouseEvent) {\r\n        super._onValueBackgroundMouseDown(event);\r\n        if (_value.hitTest(event.screenX, event.screenY) == false) {\r\n            if (rangeEnd != rangeStart) {\r\n                if (event.screenY < _rangeEndThumb.screenTop) {\r\n                    _activeThumb = _rangeEndThumb;\r\n                    var ypos:Float = event.screenY - _valueBackground.screenTop - (_activeThumb.componentHeight / 2) - _valueBackground.paddingBottom;\r\n                    //rangeEnd = calcPosFromCoord(ypos);\r\n                    animateRangeEnd(calcPosFromCoord(ypos));\r\n                    _onRangeEndThumbMouseDown(event);\r\n                } else if (event.screenY > _rangeStartThumb.screenTop + _rangeStartThumb.componentHeight) {\r\n                    _activeThumb = _rangeStartThumb;\r\n                    var ypos:Float = event.screenY - _valueBackground.screenTop - (_activeThumb.componentHeight / 2) - _valueBackground.paddingBottom;\r\n                    //rangeStart = calcPosFromCoord(ypos);\r\n                    animateRangeStart(calcPosFromCoord(ypos));\r\n                    _onRangeStartThumbMouseDown(event);\r\n                }\r\n            } else {\r\n                _activeThumb = _rangeEndThumb;\r\n                var ypos:Float = event.screenY - _valueBackground.screenTop - (_activeThumb.componentHeight / 2) - _valueBackground.paddingBottom;\r\n                //pos = calcPosFromCoord(ypos);\r\n                animatePos(calcPosFromCoord(ypos));\r\n                _onRangeEndThumbMouseDown(event);\r\n            }\r\n        }\r\n    }\r\n\r\n    private override function _onValueMouseDown(event:MouseEvent) {\r\n        super._onValueMouseDown(event);\r\n        if (rangeEnd != rangeStart) {\r\n            _mouseDownOffset = event.screenY - _value.top;\r\n        } else {\r\n            _activeThumb = _rangeEndThumb;\r\n            var ypos:Float = event.screenY - _valueBackground.screenTop - (_activeThumb.componentHeight / 2) - _valueBackground.paddingBottom;\r\n            //pos = calcPosFromCoord(ypos);\r\n            animatePos(calcPosFromCoord(ypos));\r\n            _onRangeEndThumbMouseDown(event);\r\n        }\r\n    }\r\n\r\n    private override function _onRangeEndThumbMouseDown(event:MouseEvent) {\r\n        super._onRangeEndThumbMouseDown(event);\r\n        _mouseDownOffset = event.screenY - _activeThumb.screenTop + _valueBackground.paddingBottom;\r\n    }\r\n\r\n    private override function _onRangeStartThumbMouseDown(event:MouseEvent) {\r\n        super._onRangeStartThumbMouseDown(event);\r\n        _mouseDownOffset = event.screenY - _activeThumb.screenTop + _valueBackground.paddingBottom;\r\n    }\r\n\r\n    private override function _onScreenMouseMove(event:MouseEvent):Void {\r\n        if (_mouseDownOffset == -1) {\r\n            return;\r\n        }\r\n\r\n        if (_activeThumb != null) {\r\n            var ypos:Float = event.screenY - _valueBackground.screenTop - _mouseDownOffset;\r\n            if (rangeEnd != rangeStart) {\r\n                if (_activeThumb == _rangeEndThumb) {\r\n                    rangeEnd = calcPosFromCoord(ypos);\r\n                } else if (_activeThumb == _rangeStartThumb) {\r\n                    rangeStart = calcPosFromCoord(ypos);\r\n                }\r\n            } else {\r\n                pos = calcPosFromCoord(ypos);\r\n            }\r\n        } else {\r\n            var diff = rangeEnd - rangeStart;\r\n            var ypos:Float = event.screenY - _mouseDownOffset;\r\n            ypos += _value.componentHeight;\r\n            _activeThumb = _rangeStartThumb;\r\n            var start = calcPosFromCoord(ypos - (_activeThumb.componentHeight / 2) - _valueBackground.paddingBottom);\r\n            _activeThumb = null;\r\n\r\n            if (start + diff > max) {\r\n                return;\r\n            }\r\n\r\n            var end = start + diff;\r\n            setRange(start, end);\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Helpers\r\n    //***********************************************************************************************************\r\n    private function calcPosFromCoord(ypos:Float):Float {\r\n        var minY:Float = -(_activeThumb.componentHeight / 2);\r\n        var maxY:Float = layout.usableHeight - (_activeThumb.componentHeight / 2) - (_valueBackground.paddingTop + _valueBackground.paddingBottom);\r\n\r\n        if (ypos < minY) {\r\n            ypos = minY;\r\n        } else if (ypos > maxY) {\r\n            ypos = maxY;\r\n        }\r\n\r\n        var ucy:Float = layout.usableHeight - (_valueBackground.paddingTop + _valueBackground.paddingBottom);\r\n        var m:Float = max - min;\r\n        var v:Float = ypos - minY;\r\n        var newValue:Float = min + ((v / ucy) * m);\r\n        return max - newValue;\r\n    }\r\n}\r\n\r\n//***********************************************************************************************************\r\n// Custom layouts\r\n//***********************************************************************************************************\r\n@:dox(hide)\r\nclass VSliderLayout extends DefaultLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    public override function resizeChildren():Bool {\r\n        super.resizeChildren();\r\n\r\n        var background:Component = component.findComponent(\"slider-value-background\");\r\n        var value:Component = null;\r\n        if (background != null) {\r\n            value = background.findComponent(\"slider-value\");\r\n        }\r\n        var slider:Slider = cast component;\r\n        if (value != null) {\r\n            var ucy:Float = background.layout.usableHeight;\r\n\r\n            var cy:Float = 0;\r\n            if (slider.rangeStart == slider.rangeEnd) {\r\n                cy = (slider.pos - slider.min) / (slider.max - slider.min) * ucy;\r\n            } else {\r\n                cy = ((slider.rangeEnd - slider.rangeStart) - slider.min) / (slider.max - slider.min) * ucy;\r\n            }\r\n\r\n            if (cy < 0) {\r\n                cy = 0;\r\n            } else if (cy > ucy) {\r\n                cy = ucy;\r\n            }\r\n\r\n            if (cy == 0) {\r\n                value.componentHeight = cy;\r\n                if (value.hidden == false) {\r\n                    value.hidden = true;\r\n                    value.invalidateStyle();\r\n                }\r\n            } else {\r\n                value.componentHeight = cy;\r\n                if (value.hidden == true) {\r\n                    value.hidden = false;\r\n                    value.invalidateStyle();\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public override function repositionChildren():Void {\r\n        super.repositionChildren();\r\n\r\n        var background:Component = component.findComponent(\"slider-value-background\");\r\n        var value:Component = null;\r\n        if (background != null) {\r\n            value = background.findComponent(\"slider-value\");\r\n        }\r\n        var slider:Slider = cast component;\r\n        if (value != null) {\r\n            var rangeStartButton:Button = null;\r\n            var rangeEndButton:Button = component.findComponent(\"slider-range-end-button\");\r\n\r\n            var ucy:Float = background.layout.usableHeight;\r\n            var y:Float = ucy - value.componentHeight + background.layout.paddingTop;\r\n            if (slider.rangeStart != slider.rangeEnd) {\r\n                rangeStartButton = component.findComponent(\"slider-range-start-button\");\r\n                y -= (slider.rangeStart - slider.min) / (slider.max - slider.min) * ucy;\r\n            }\r\n\r\n            /*\r\n            if (background.style.paddingBottom != null) {\r\n                y += background.style.paddingBottom;\r\n            }\r\n            */\r\n\r\n            value.top = y;// + background.layout.paddingBottom;// - (rangeEndButton.componentHeight / 2) + background.layout.paddingTop;\r\n\r\n            if (rangeStartButton != null) {\r\n                rangeStartButton.top = y + paddingTop + value.componentHeight - (rangeStartButton.componentHeight / 2);\r\n            }\r\n            if (rangeEndButton != null) {\r\n                rangeEndButton.top = paddingTop + value.top - (rangeEndButton.componentHeight / 2);\r\n            }\r\n        }\r\n\r\n    }\r\n}\r\n\r\n",null,"package haxe.ui.containers;\r\n\r\nimport haxe.ui.layouts.VerticalLayout;\r\nimport haxe.ui.core.IClonable;\r\n\r\n/**\r\n Base `Layout` that allows a container to specify an `icon`. How that icon resource is used depends on subclasses, like\r\n `haxe.ui.containers.TabView`\r\n**/\r\n@:dox(icon=\"/icons/ui-panel.png\")\r\nclass Box extends haxe.ui.core.Component implements IClonable<Box> {\r\n    public function new() {\r\n        super();\r\n        layout = new VerticalLayout();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    private var _icon:String;\r\n    /**\r\n     The icon associated with this box component\r\n\r\n     _Note: this class itself does nothing special with this property and simply here to allow subclasses to make use\r\n     of it should they want to_\r\n    **/\r\n    @:clonable public var icon(get, set):String;\r\n    private function get_icon():String {\r\n        return _icon;\r\n    }\r\n\r\n    private function set_icon(value:String):String {\r\n        _icon = value;\r\n        return value;\r\n    }\r\n}",null,"package haxe.ui.containers;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.layouts.HorizontalLayout;\r\nimport haxe.ui.core.IClonable;\r\n\r\n/**\r\n A `Box` component that lays its children out horizontally\r\n**/\r\n@:dox(icon=\"/icons/ui-split-panel.png\")\r\nclass HBox extends Box implements IClonable<HBox> {\r\n    public function new() {\r\n        super();\r\n        layout = new HorizontalLayout();\r\n    }\r\n}",null,"package haxe.ui.containers.dialogs;\r\n\r\nimport haxe.ui.components.Button;\r\nimport haxe.ui.components.Label;\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.MouseEvent;\r\nimport haxe.ui.core.UIEvent;\r\nimport haxe.ui.layouts.VerticalLayout;\r\n\r\n/**\r\n Class returned from `Screen.instance.showDialog` or `Screen.instance.messageDialog`\r\n**/\r\n@:dox(icon=\"/icons/application-sub.png\")\r\nclass Dialog extends Component {\r\n    private var _titleBar:HBox;\r\n    private var _buttons:HBox;\r\n\r\n    private var _title:Label;\r\n    private var _closeButton:Button;\r\n\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Internals\r\n    //***********************************************************************************************************\r\n    private override function createChildren():Void {\r\n        layout = new VerticalLayout();\r\n    }\r\n\r\n    private function createTitleBar():Void {\r\n        if (native == true) {\r\n            return;\r\n        }\r\n        if (_titleBar == null) {\r\n            _titleBar = new HBox();\r\n            _titleBar.id = \"dialog-title-bar\";\r\n            _titleBar.addClass(\"dialog-title-bar\");\r\n\r\n            _title = new Label();\r\n            _title.text = _options.title;\r\n            _title.id = \"dialog-title\";\r\n            _title.addClass(\"dialog-title\");\r\n            _titleBar.addComponent(_title);\r\n\r\n            _closeButton = new Button();\r\n            _closeButton.id = \"dialog-close-button\";\r\n            _closeButton.addClass(\"dialog-close-button\");\r\n            _closeButton.registerEvent(MouseEvent.CLICK, _onButtonClick);\r\n            _titleBar.addComponent(_closeButton);\r\n\r\n            addComponent(_titleBar);\r\n        }\r\n    }\r\n\r\n    private function createButtonBar():Void {\r\n        if (_buttons == null && _options != null && _options.buttons.length > 0) {\r\n            _buttons = new HBox();\r\n            _buttons.id = \"dialog-buttons\";\r\n            _buttons.addClass(\"dialog-buttons\");\r\n\r\n            for (b in _options.buttons) {\r\n                var button = addButton(b);\r\n            }\r\n\r\n            addComponent(_buttons);\r\n        }\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Overrides\r\n    //***********************************************************************************************************\r\n    public override function addComponent(child:Component):Component {\r\n        var r = null;\r\n        if (child == _titleBar || child == _buttons) {\r\n            r = super.addComponent(child);\r\n        } else {\r\n            child.addClass(\"dialog-content\");\r\n            r = super.addComponent(child);\r\n            createButtonBar();\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n\r\n    //***********************************************************************************************************\r\n    // Public API\r\n    //***********************************************************************************************************\r\n    /**\r\n     Closes this dialog and removes it from the `Screen`\r\n    **/\r\n    public function close() {\r\n        screen.hideDialog(this);\r\n    }\r\n\r\n    /**\r\n     Adds a button to the button bar of this dialog\r\n    **/\r\n    public function addButton(dialogButton:DialogButton):Button {\r\n        if (_buttons == null) {\r\n            createButtonBar();\r\n        }\r\n\r\n        var button = new Button();\r\n        button.id = dialogButton.id;\r\n        button.text = dialogButton.text;\r\n        button.styleNames = dialogButton.styleNames;\r\n        button.styleString = dialogButton.style;\r\n        button.icon = dialogButton.icon;\r\n        button.userData = dialogButton;\r\n        button.registerEvent(MouseEvent.CLICK, _onButtonClick);\r\n\r\n        _buttons.addComponent(button);\r\n\r\n        return button;\r\n    }\r\n\r\n    private var _options:DialogOptions;\r\n    /**\r\n     Sets (or gets) the dialog options associated with this dialog instance\r\n    **/\r\n    public var dialogOptions(get, set):DialogOptions;\r\n    private function get_dialogOptions():DialogOptions {\r\n        return _options;\r\n    }\r\n    private function set_dialogOptions(value:DialogOptions):DialogOptions {\r\n        _options = value;\r\n        if (_options.styleNames != null) {\r\n            styleNames = _options.styleNames;\r\n        }\r\n        createTitleBar();\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     The callback function to invoke when one of the dialog buttons has been clicked\r\n    **/\r\n    public var callback:DialogButton->Void;\r\n\r\n    //***********************************************************************************************************\r\n    // Event Handlers\r\n    //***********************************************************************************************************\r\n    private function _onButtonClick(event:MouseEvent) {\r\n        var dialogButton = null;\r\n        if (event.target.userData != null) {\r\n            dialogButton = cast(event.target.userData, DialogButton);\r\n        }\r\n        if (dialogButton == null || dialogButton.closesDialog == true) {\r\n            close();\r\n        }\r\n        if (callback != null) {\r\n            callback(dialogButton);\r\n        }\r\n    }\r\n}",null,"package haxe.ui.containers.dialogs;\r\n\r\n/**\r\n Holds information about a `Button` to create in a `Dialog` button bar\r\n**/\r\n@:dox(icon=\"/icons/application-dialog.png\")\r\nclass DialogButton {\r\n    public inline static var OK:Int = 0x000001;\r\n    public inline static var CANCEL:Int = 0x000002;\r\n    public inline static var CLOSE:Int = 0x000004;\r\n    public inline static var CONFIRM:Int = 0x000008;\r\n    public inline static var YES:Int = 0x000010;\r\n    public inline static var NO:Int = 0x000020;\r\n\r\n    public inline static var YES_NO:Int = 0x000010 | 0x000020;\r\n    public inline static var YES_NO_CANCEL:Int = 0x000010 | 0x000020 | 0x000002;\r\n\r\n    /**\r\n     The string to use as the buttons text\r\n    **/\r\n    public var text:String;\r\n    /**\r\n     The image resource to use as the buttons icon\r\n    **/\r\n    public var icon:String;\r\n    /**\r\n     The identifier of this button\r\n    **/\r\n    public var id:String;\r\n    /**\r\n     Any additional styles names to apply to this button\r\n    **/\r\n    public var styleNames:String;\r\n    /**\r\n     Any inline styling to apply to this button\r\n    **/\r\n    public var style:String;\r\n    /**\r\n     Whether or not clicking this button will close the parent `Dialog` (_defaults to true_)\r\n    **/\r\n    public var closesDialog:Bool = true;\r\n\r\n    public function new() {\r\n\r\n    }\r\n}\r\n","package haxe.ui.containers.dialogs;\r\n\r\n/**\r\n Holds options associated with instances of `Dialog`\r\n**/\r\nclass DialogOptions {\r\n    public static inline var ICON_ERROR:Int = 0x000100;\r\n    public static inline var ICON_INFO:Int = 0x000200;\r\n    public static inline var ICON_WARNING:Int = 0x000400;\r\n    public static inline var ICON_QUESTION:Int = 0x000800;\r\n\r\n    /**\r\n     Array of button definitions in this `Dialog`\r\n\r\n     _Note: A button definition is different from a button instance_\r\n    **/\r\n    public var buttons:Array<DialogButton> = new Array<DialogButton>();\r\n    /**\r\n     The string to display in the dialogs title bar\r\n    **/\r\n    public var title:String;\r\n    /**\r\n     The predefined icon of this dialog, values can be:\r\n\r\n        - `ICON_ERROR` - Error icon\r\n\r\n        - `ICON_INFO` - Info icon\r\n\r\n        - `ICON WARNING` - Warning icon\r\n\r\n        - `ICON_QUESTION` - Question icon\r\n    **/\r\n    public var icon:Int;\r\n    /**\r\n     Any additional styles names to apply to this dialog\r\n    **/\r\n    public var styleNames:String;\r\n\r\n    public function new() {\r\n\r\n    }\r\n\r\n    /**\r\n     Adds a predefined button definition, values can be:\r\n\r\n        - `DialogButton.OK`\r\n\r\n        - `DialogButton.CANCEL`\r\n\r\n        - `DialogButton.CLOSE`\r\n\r\n        - `DialogButton.CONFIRM`\r\n\r\n        - `DialogButton.YES`\r\n\r\n        - `DialogButton.NO`\r\n    **/\r\n    public function addStandardButton(button:Int) {\r\n        switch (button) {\r\n            case DialogButton.OK:\r\n                var b = new DialogButton();\r\n                b.text = \"OK\";\r\n                b.id = '${DialogButton.OK}';\r\n                b.styleNames = \"dialog-button dialog-button-ok\";\r\n                addButton(b);\r\n            case DialogButton.CANCEL:\r\n                var b = new DialogButton();\r\n                b.text = \"Cancel\";\r\n                b.id = '${DialogButton.CANCEL}';\r\n                b.styleNames = \"dialog-button dialog-button-cancel\";\r\n                addButton(b);\r\n            case DialogButton.CLOSE:\r\n                var b = new DialogButton();\r\n                b.text = \"Close\";\r\n                b.id = '${DialogButton.CLOSE}';\r\n                b.styleNames = \"dialog-button dialog-button-close\";\r\n                addButton(b);\r\n            case DialogButton.CONFIRM:\r\n                var b = new DialogButton();\r\n                b.text = \"Confirm\";\r\n                b.id = '${DialogButton.CONFIRM}';\r\n                b.styleNames = \"dialog-button dialog-button-confirm\";\r\n                addButton(b);\r\n            case DialogButton.YES:\r\n                var b = new DialogButton();\r\n                b.text = \"Yes\";\r\n                b.id = '${DialogButton.YES}';\r\n                b.styleNames = \"dialog-button dialog-button-yes\";\r\n                addButton(b);\r\n            case DialogButton.NO:\r\n                var b = new DialogButton();\r\n                b.text = \"No\";\r\n                b.id = '${DialogButton.NO}';\r\n                b.styleNames = \"dialog-button dialog-button-no\";\r\n                addButton(b);\r\n            default:\r\n        }\r\n    }\r\n\r\n    /**\r\n     Adds a button definition\r\n    **/\r\n    public function addButton(button:DialogButton) {\r\n        buttons.push(button);\r\n    }\r\n}\r\n","package haxe.ui.core;\r\n\r\nclass ComponentClassMap {\r\n    private static var _instance:ComponentClassMap;\r\n    public static var instance(get, never):ComponentClassMap;\r\n    private static function get_instance():ComponentClassMap {\r\n        if (_instance == null) {\r\n            _instance = new ComponentClassMap();\r\n        }\r\n        return _instance;\r\n    }\r\n\r\n    public static function get(alias:String):String {\r\n        return instance.getClassName(alias);\r\n    }\r\n\r\n    public static function register(alias:String, className:String) {\r\n        instance.registerClassName(alias, className);\r\n    }\r\n\r\n    public static function list():Iterator<String> {\r\n        return instance._map.keys();\r\n    }\r\n    \r\n    ////////////////////////////////////////////////////////////////////////////////////////////\r\n    // Instance\r\n    ////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n    private var _map:Map<String, String>;\r\n    private function new() {\r\n        _map = new Map<String, String>();\r\n    }\r\n\r\n    public function getClassName(alias:String):String {\r\n        return _map.get(alias);\r\n    }\r\n\r\n    public function registerClassName(alias:String, className:String) {\r\n        _map.set(alias, className);\r\n    }\r\n\r\n}","package haxe.ui.core;\r\nimport haxe.ui.backend.ImageDisplayBase;\r\n\r\n\r\n/**\r\n Class that represents a framework specific method to display an image inside a component\r\n**/\r\nclass ImageDisplay extends ImageDisplayBase {\r\n    public function new() {\r\n        super();\r\n    }\r\n}","package haxe.ui.core;\r\n\r\nclass UIEvent {\r\n    public static inline var READY:String = \"Ready\";\r\n    public static inline var RESIZE:String = \"Resize\";\r\n    public static inline var CHANGE:String = \"Change\";\r\n\r\n    public var type(default, default):String;\r\n    public var target(default, default):Component;\r\n\r\n    public function new(type:String) {\r\n        this.type = type;\r\n    }\r\n\r\n    public function clone():UIEvent {\r\n        var c:UIEvent = new UIEvent(this.type);\r\n        c.type = this.type;\r\n        c.target = this.target;\r\n        return c;\r\n    }\r\n}\r\n","package haxe.ui.core;\r\n\r\nclass KeyboardEvent extends UIEvent {\r\n    public static inline var KEY_TAB:Int = 9;\r\n\r\n    public static inline var KEY_DOWN:String = \"KeyDown\";\r\n    public static inline var KEY_UP:String = \"KeyUp\";\r\n\r\n    public var keyCode:Int;\r\n    public var shiftKey:Bool;\r\n\r\n    public function new(type:String) {\r\n        super(type);\r\n    }\r\n\r\n    public override function clone():KeyboardEvent {\r\n        var c:KeyboardEvent = new KeyboardEvent(this.type);\r\n        c.type = this.type;\r\n        c.target = this.target;\r\n        c.keyCode = this.keyCode;\r\n        c.shiftKey = this.shiftKey;\r\n        return c;\r\n    }\r\n}","package haxe.ui.core;\r\n\r\nclass MouseEvent extends UIEvent {\r\n    public static inline var MOUSE_MOVE:String = \"MouseMove\";\r\n    public static inline var MOUSE_OVER:String = \"MouseOver\";\r\n    public static inline var MOUSE_OUT:String = \"MouseOut\";\r\n    public static inline var MOUSE_DOWN:String = \"MouseDown\";\r\n    public static inline var MOUSE_UP:String = \"MouseUp\";\r\n    public static inline var MOUSE_WHEEL:String = \"MouseWheel\";\r\n    public static inline var CLICK:String = \"Click\";\r\n\r\n    public var screenX:Float;\r\n    public var screenY:Float;\r\n    public var buttonDown:Bool;\r\n    public var delta:Float;\r\n\r\n    public function new(type:String) {\r\n        super(type);\r\n    }\r\n\r\n    public override function clone():MouseEvent {\r\n        var c:MouseEvent = new MouseEvent(this.type);\r\n        c.type = this.type;\r\n        c.target = this.target;\r\n        c.screenX = this.screenX;\r\n        c.screenY = this.screenY;\r\n        c.buttonDown = this.buttonDown;\r\n        c.delta = this.delta;\r\n        return c;\r\n    }\r\n}","package haxe.ui.core;\r\n\r\nimport haxe.ui.animation.Animation;\r\nimport haxe.ui.animation.AnimationManager;\r\nimport haxe.ui.backend.ScreenBase;\r\nimport haxe.ui.components.Label;\r\nimport haxe.ui.containers.HBox;\r\nimport haxe.ui.containers.dialogs.Dialog;\r\nimport haxe.ui.containers.dialogs.DialogButton;\r\nimport haxe.ui.containers.dialogs.DialogOptions;\r\nimport haxe.ui.containers.dialogs.MessageDialog;\r\nimport haxe.ui.focus.FocusManager;\r\nimport haxe.ui.util.EventMap;\r\n\r\n@:dox(hide)\r\nclass DialogEntry {\r\n    public function new() {\r\n\r\n    }\r\n\r\n    public var overlay:Component;\r\n    public var dialog:Dialog;\r\n    public var callback:Int->Void;\r\n}\r\n\r\nclass Screen extends ScreenBase {\r\n    private var _dialogs:Map<Dialog, DialogEntry> = new Map<Dialog, DialogEntry>();\r\n\r\n    public var rootComponents:Array<Component> = new Array<Component>();\r\n\r\n    private static var _instance:Screen;\r\n    public static var instance(get, never):Screen;\r\n    private static function get_instance():Screen {\r\n        if (_instance == null) {\r\n            _instance = new Screen();\r\n        }\r\n        return _instance;\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Instance\r\n    //***********************************************************************************************************\r\n    private var _eventMap:EventMap;\r\n\r\n    public function new() {\r\n        super();\r\n        _eventMap = new EventMap();\r\n    }\r\n\r\n    public override function addComponent(component:Component) {\r\n        super.addComponent(component);\r\n        component.ready();\r\n        rootComponents.push(component);\r\n        FocusManager.instance.pushView(component);\r\n    }\r\n\r\n    public override function removeComponent(component:Component) {\r\n        super.removeComponent(component);\r\n        rootComponents.remove(component);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Dialogs\r\n    //***********************************************************************************************************\r\n    public override function messageDialog(message:String, title:String = null, options:Dynamic = null, callback:DialogButton->Void = null):Dialog {\r\n        var dialog = super.messageDialog(message, title, options, callback);\r\n        if (dialog != null) {\r\n            return dialog;\r\n        }\r\n\r\n        var dialogOptions:DialogOptions = new DialogOptions();\r\n\r\n        var dialogOptions:DialogOptions = createDialogOptions(options);\r\n        if (dialogOptions.buttons.length == 0) {\r\n            dialogOptions.addStandardButton(DialogButton.OK);\r\n        }\r\n        if (title != null) {\r\n            dialogOptions.title = title;\r\n        }\r\n\r\n        var content:HBox = new HBox();\r\n        content.percentWidth = 100;\r\n\r\n        if (dialogOptions.icon > 0) {\r\n            var image:haxe.ui.components.Image = new haxe.ui.components.Image();\r\n            image.id = \"message-dialog-icon\";\r\n            image.styleNames = \"message-dialog-icon\";\r\n            switch (dialogOptions.icon) { // TODO: needs to be style\r\n                case DialogOptions.ICON_ERROR:\r\n                    image.resource = \"haxeui-core/styles/default/dialogs/cross-circle.png\";\r\n                case DialogOptions.ICON_INFO:\r\n                    image.resource = \"haxeui-core/styles/default/dialogs/information.png\";\r\n                case DialogOptions.ICON_WARNING:\r\n                    image.resource = \"haxeui-core/styles/default/dialogs/exclamation.png\";\r\n                case DialogOptions.ICON_QUESTION:\r\n                    image.resource = \"haxeui-core/styles/default/dialogs/question.png\";\r\n\r\n            }\r\n            content.addComponent(image);\r\n        }\r\n\r\n        var label:Label = new Label();\r\n        label.percentWidth = 100;\r\n        label.text = message;\r\n        label.id = \"message-dialog-message\";\r\n        label.addClass(\"message-dialog-message\");\r\n\r\n        content.addComponent(label);\r\n\r\n        return showDialog(content, dialogOptions, callback);\r\n    }\r\n\r\n    public override function showDialog(content:Component, options:Dynamic = null, callback:DialogButton->Void = null):Dialog {\r\n        var dialog = super.showDialog(content, options, callback);\r\n        if (dialog != null) {\r\n            return dialog;\r\n        }\r\n\r\n        var overlay:Component = new Component();\r\n        overlay.id = \"modal-background\";\r\n        overlay.addClass(\"modal-background\");\r\n        overlay.percentWidth = overlay.percentHeight = 100;\r\n        addComponent(overlay);\r\n\r\n        var dialog:Dialog = new Dialog();\r\n        dialog.callback = callback;\r\n        dialog.dialogOptions = createDialogOptions(options);\r\n        content.addClass(\"dialog-content\");\r\n        dialog.addComponent(content);\r\n        addComponent(dialog);\r\n        centerDialog(dialog);\r\n\r\n        //var animation:Animation = AnimationManager.instance.get(\"haxe.ui.components.animation.dialog.show\");\r\n        var x = (width / 2) - (dialog.componentWidth / 2);\r\n        var y = (height / 2) - (dialog.componentHeight / 2);\r\n        var vars:Map<String, Float> = [\r\n            \"startLeft\" => x,\r\n            \"startTop\" => -dialog.componentHeight,\r\n            \"endLeft\" => x,\r\n            \"endTop\" => y\r\n        ];\r\n        AnimationManager.instance.run(\"haxe.ui.components.animation.dialog.show\", [\"target\" => dialog], vars);\r\n        //animation.r\r\n\r\n        var entry:DialogEntry = new DialogEntry();\r\n        entry.overlay = overlay;\r\n        entry.dialog = dialog;\r\n        _dialogs.set(dialog, entry);\r\n\r\n        if (Lambda.count(_dialogs) == 1) {\r\n            for (r in rootComponents) {\r\n                r.addClass(\"modal-component\");\r\n            }\r\n        }\r\n\r\n        return dialog;\r\n    }\r\n\r\n    private static function createDialogOptions(options:Dynamic):DialogOptions {\r\n        if (Std.is(options, DialogOptions)) {\r\n            return cast(options, DialogOptions);\r\n        }\r\n\r\n        var dialogOptions:DialogOptions = new DialogOptions();\r\n\r\n        var o:Dynamic = { };\r\n        if (options == null) {\r\n            o = { };\r\n        } else if (Std.is(options, Int)) {\r\n            var n:Int = cast(options, Int);\r\n            o.buttons = [n];\r\n            o.icon = n;\r\n        } else {\r\n            o = options;\r\n        }\r\n\r\n        if (o.buttons == null) {\r\n            o.buttons = [DialogButton.OK];\r\n        } else if (Std.is(o.buttons, Int)) {\r\n            o.buttons = [options.buttons];\r\n        }\r\n\r\n        if (o.title == null) {\r\n            o.title = \"HaxeUI\";\r\n        }\r\n\r\n        var buttons:Array<Dynamic> = o.buttons;\r\n        trace(o.buttons);\r\n        for (b in buttons) {\r\n            if (Std.is(b, Int)) {\r\n                if (b & DialogButton.OK == DialogButton.OK) {\r\n                    dialogOptions.addStandardButton(DialogButton.OK);\r\n                }\r\n                if (b & DialogButton.CANCEL == DialogButton.CANCEL) {\r\n                    dialogOptions.addStandardButton(DialogButton.CANCEL);\r\n                }\r\n                if (b & DialogButton.CLOSE == DialogButton.CLOSE) {\r\n                    dialogOptions.addStandardButton(DialogButton.CLOSE);\r\n                }\r\n                if (b & DialogButton.CONFIRM == DialogButton.CONFIRM) {\r\n                    dialogOptions.addStandardButton(DialogButton.CONFIRM);\r\n                }\r\n                if (b & DialogButton.YES == DialogButton.YES) {\r\n                    dialogOptions.addStandardButton(DialogButton.YES);\r\n                }\r\n                if (b & DialogButton.NO == DialogButton.NO) {\r\n                    dialogOptions.addStandardButton(DialogButton.NO);\r\n                }\r\n            } else {\r\n                var dialogButton:DialogButton = new DialogButton();\r\n                dialogButton.text = b.text;\r\n                dialogButton.icon = b.icon;\r\n                if (b.closesDialog != null) {\r\n                    dialogButton.closesDialog = b.closesDialog;\r\n                }\r\n                dialogOptions.addButton(dialogButton);\r\n            }\r\n        }\r\n\r\n        if (o.icon != null) {\r\n            if (o.icon & DialogOptions.ICON_ERROR == DialogOptions.ICON_ERROR) {\r\n                dialogOptions.icon = DialogOptions.ICON_ERROR;\r\n            } else if (o.icon & DialogOptions.ICON_INFO == DialogOptions.ICON_INFO) {\r\n                dialogOptions.icon = DialogOptions.ICON_INFO;\r\n            } else if (o.icon & DialogOptions.ICON_WARNING == DialogOptions.ICON_WARNING) {\r\n                dialogOptions.icon = DialogOptions.ICON_WARNING;\r\n            } else if (o.icon & DialogOptions.ICON_QUESTION == DialogOptions.ICON_QUESTION) {\r\n                dialogOptions.icon = DialogOptions.ICON_QUESTION;\r\n            }\r\n        }\r\n\r\n        dialogOptions.title = o.title;\r\n        dialogOptions.styleNames = o.styleNames;\r\n\r\n        return dialogOptions;\r\n    }\r\n\r\n    public override function hideDialog(dialog:Dialog):Bool {\r\n        if (super.hideDialog(dialog) == true) {\r\n            return true;\r\n        }\r\n\r\n        var entry:DialogEntry = _dialogs.get(dialog);\r\n        if (entry == null) {\r\n            return false;\r\n        }\r\n\r\n        var x = dialog.left;\r\n        var y = height;\r\n\r\n        var vars:Map<String, Float> = [\r\n            \"startLeft\" => dialog.left,\r\n            \"startTop\" => dialog.top,\r\n            \"endLeft\" => x,\r\n            \"endTop\" => y\r\n        ];\r\n        AnimationManager.instance.run(\"haxe.ui.components.animation.dialog.hide\", [\"target\" => dialog], vars, function() {\r\n            Screen.instance.removeComponent(entry.dialog);\r\n            Screen.instance.removeComponent(entry.overlay);\r\n            _dialogs.remove(dialog);\r\n\r\n            if (Lambda.count(_dialogs) == 0) {\r\n                for (r in rootComponents) {\r\n                    r.removeClass(\"modal-component\");\r\n                }\r\n            }\r\n        });\r\n\r\n        return true;\r\n    }\r\n\r\n    public function centerDialog(dialog:Dialog) {\r\n        var x = (width / 2) - (dialog.componentWidth / 2);\r\n        var y = (height / 2) - (dialog.componentHeight / 2);\r\n        dialog.moveComponent(x, y);\r\n    }\r\n\r\n    //***********************************************************************************************************\r\n    // Events\r\n    //***********************************************************************************************************\r\n    public function registerEvent(type:String, listener:Dynamic->Void) {\r\n        if (supportsEvent(type) == true) {\r\n            if (_eventMap.add(type, listener) == true) {\r\n                mapEvent(type, _onMappedEvent);\r\n            }\r\n        } else {\r\n            //#if debug\r\n            trace('WARNING: Screen event \"${type}\" not supported');\r\n            //#end\r\n        }\r\n    }\r\n\r\n    public function unregisterEvent(type:String, listener:Dynamic->Void) {\r\n        if (_eventMap.remove(type, listener) == true) {\r\n            unmapEvent(type, _onMappedEvent);\r\n        }\r\n    }\r\n\r\n    private function _onMappedEvent(event:UIEvent) {\r\n        _eventMap.invoke(event.type, event);\r\n    }\r\n}","package haxe.ui.core;\r\n\r\nimport haxe.ui.backend.TextDisplayBase;\r\nimport haxe.ui.styles.Style;\r\n\r\n/**\r\n Class that represents a framework specific method to display read-only text inside a component\r\n**/\r\nclass TextDisplay extends TextDisplayBase {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    private var _textStyle:Style;\r\n    /**\r\n     The style to use for this text\r\n    **/\r\n    public var textStyle(get, set):Style;\r\n    private function get_textStyle():Style {\r\n        return _textStyle;\r\n    }\r\n\r\n    private function set_textStyle(value:Style):Style {\r\n        if (value == null) {\r\n            return value;\r\n        }\r\n\r\n        if (value.color != null) {\r\n            color = value.color;\r\n        }\r\n\r\n        return value;\r\n    }\r\n}\r\n","package haxe.ui.core;\r\n\r\nimport haxe.ui.backend.TextInputBase;\r\nimport haxe.ui.styles.Style;\r\n\r\n/**\r\n Class that represents a framework specific method to display editable text inside a component\r\n**/\r\nclass TextInput extends TextInputBase {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    private var _textStyle:Style;\r\n    /**\r\n     The style to use for this text\r\n    **/\r\n    public var textStyle(get, set):Style;\r\n    private function get_textStyle():Style {\r\n        return _textStyle;\r\n    }\r\n\r\n    private function set_textStyle(value:Style):Style {\r\n        if (value == null) {\r\n            return value;\r\n        }\r\n\r\n        if (value.color != null) {\r\n            color = value.color;\r\n        }\r\n\r\n        return value;\r\n    }\r\n}","package haxe.ui.focus;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.Screen;\r\n\r\nclass FocusInfo {\r\n    public function new() {\r\n\r\n    }\r\n    public var view:Component;\r\n    public var currentFocus:IFocusable;\r\n}\r\n\r\nclass FocusManager {\r\n    private static var _instance:FocusManager;\r\n    public static var instance(get, null):FocusManager;\r\n    private static function get_instance():FocusManager {\r\n        if (_instance == null) {\r\n            _instance = new FocusManager();\r\n        }\r\n        return _instance;\r\n    }\r\n\r\n    //****************************************************************************************************\r\n    // Instance\r\n    //****************************************************************************************************\r\n    private var _views:Array<Component>;\r\n    private var _focusInfo:Map<Component, FocusInfo>;\r\n\r\n    public function new() {\r\n        _views = new Array<Component>();\r\n        _focusInfo = new Map<Component, FocusInfo>();\r\n    }\r\n\r\n    public function pushView(component:Component) {\r\n        _views.push(component);\r\n    }\r\n\r\n    public function popView() {\r\n        var c = _views.pop();\r\n        _focusInfo.remove(c);\r\n    }\r\n\r\n    public var focusInfo(get, null):FocusInfo;\r\n    private function get_focusInfo():FocusInfo {\r\n        if (_views.length == 0) {\r\n            return null;\r\n        }\r\n        var c:Component = _views[_views.length - 1];\r\n        var info = _focusInfo.get(c);\r\n        if (info == null) {\r\n            info = new FocusInfo();\r\n            info.view = c;\r\n            _focusInfo.set(c, info);\r\n        }\r\n        return info;\r\n    }\r\n\r\n    public var focus(get, set):IFocusable;\r\n    private function get_focus():IFocusable {\r\n        return focusInfo.currentFocus;\r\n    }\r\n    private function set_focus(value:IFocusable):IFocusable {\r\n        if (Std.is(value, IFocusable) == false) {\r\n            throw \"Component does not implement IFocusable\";\r\n        }\r\n        if (focusInfo.currentFocus != null && focusInfo.currentFocus != value) {\r\n            focusInfo.currentFocus.focus = false;\r\n            focusInfo.currentFocus = null;\r\n            Toolkit.screen.focus = null;\r\n        }\r\n        if (value != null) {\r\n            focusInfo.currentFocus = value;\r\n            focusInfo.currentFocus.focus = true;\r\n            Toolkit.screen.focus = cast value;\r\n        }\r\n        return focusInfo.currentFocus;\r\n    }\r\n\r\n    public function focusNext():Component {\r\n        if (_views.length == 0) {\r\n            return null;\r\n        }\r\n\r\n        var list:Array<IFocusable> = new Array<IFocusable>();\r\n        var info = focusInfo;\r\n        var currentFocus = buildFocusableList(info.view, list);\r\n\r\n        var index = -1;\r\n        if (currentFocus != null) {\r\n            index = list.indexOf(currentFocus);\r\n        }\r\n\r\n        var nextIndex = index + 1;\r\n        if (nextIndex > list.length - 1) {\r\n            nextIndex = 0;\r\n        }\r\n\r\n        var nextFocus = list[nextIndex];\r\n        focus = nextFocus;\r\n        return cast nextFocus;\r\n    }\r\n\r\n    public function focusPrev():Component {\r\n        if (_views.length == 0) {\r\n            return null;\r\n        }\r\n\r\n        var list:Array<IFocusable> = new Array<IFocusable>();\r\n        var info = focusInfo;\r\n        var currentFocus = buildFocusableList(info.view, list);\r\n\r\n        var index = -1;\r\n        if (currentFocus != null) {\r\n            index = list.indexOf(currentFocus);\r\n        }\r\n\r\n        var prevIndex = index - 1;\r\n        if (prevIndex < 0) {\r\n            prevIndex = list.length - 1;\r\n        }\r\n\r\n        var prevFocus = list[prevIndex];\r\n        focus = prevFocus;\r\n        return cast prevFocus;\r\n    }\r\n\r\n    private function buildFocusableList(c:Component, list:Array<IFocusable>):IFocusable {\r\n        var currentFocus = null;\r\n        if (Std.is(c, IFocusable)) {\r\n            var f:IFocusable = cast c;\r\n            if (f.allowFocus == true) {\r\n                if (f.focus == true) {\r\n                    currentFocus = f;\r\n                }\r\n                list.push(f);\r\n            }\r\n        }\r\n\r\n        for (child in c.childComponents) {\r\n            var f:IFocusable = buildFocusableList(child, list);\r\n            if (f != null) {\r\n                currentFocus = f;\r\n            }\r\n        }\r\n        return cast currentFocus;\r\n    }\r\n}","package haxe.ui.layouts;\r\n\r\nimport haxe.ui.util.Size;\r\n\r\nclass VerticalLayout extends DefaultLayout {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    private override function repositionChildren() {\r\n        var ypos = paddingTop;\r\n        var usableSize:Size = component.layout.usableSize;\r\n\r\n        for (child in component.childComponents) {\r\n            if (child.includeInLayout == false) {\r\n                continue;\r\n            }\r\n\r\n            var xpos:Float = 0;\r\n\r\n            switch (horizontalAlign(child)) {\r\n                case \"center\":\r\n                    xpos = ((component.componentWidth / 2) - (child.componentWidth / 2)) + marginLeft(child) - marginRight(child);\r\n                    //xpos = ((usableSize.width / 2) - (child.componentWidth / 2)) + marginLeft(child) - marginRight(child);\r\n                case \"right\":\r\n                    if (child.componentWidth < component.componentWidth) {\r\n                        //xpos = component.componentWidth - (child.componentWidth + paddingRight + marginLeft(child) - marginRight(child));\r\n                        xpos = usableSize.width - (child.componentWidth + paddingRight + marginLeft(child) - marginRight(child));\r\n                    }\r\n                default:\r\n                    xpos = paddingLeft + marginLeft(child) - marginRight(child);\r\n            }\r\n\r\n            child.moveComponent(xpos, ypos + marginTop(child) - marginBottom(child));\r\n            ypos += child.componentHeight + verticalSpacing;\r\n        }\r\n    }\r\n\r\n    private override function get_usableSize():Size {\r\n        var size:Size = super.get_usableSize();\r\n\r\n        var visibleChildren = component.childComponents.length;\r\n        for (child in component.childComponents) {\r\n            if (child.includeInLayout == false) {\r\n                visibleChildren--;\r\n                continue;\r\n            }\r\n\r\n            if (child.componentHeight > 0 && child.percentHeight == null) { // means its a fixed height, ie, not a % sized control\r\n                size.height -= child.componentHeight + marginTop(child) + marginBottom(child);\r\n            }\r\n        }\r\n\r\n        if (visibleChildren > 1) {\r\n            size.height -= verticalSpacing * (visibleChildren - 1);\r\n        }\r\n\r\n        if (size.height < 0) {\r\n            size.height = 0;\r\n        }\r\n        return size;\r\n    }\r\n}","package haxe.ui.layouts;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.util.Size;\r\n\r\nclass DelegateLayout extends VerticalLayout {\r\n    private var _size:DelegateLayoutSize;\r\n\r\n    public function new(size:DelegateLayoutSize) {\r\n        super();\r\n        _size = size;\r\n    }\r\n\r\n    public override function calcAutoSize():Size {\r\n        _size.component = component;\r\n\r\n        var cx:Float = _size.width;\r\n        var cy:Float = _size.height;\r\n        if (_size.getBool(\"includePadding\", false) == true) {\r\n            cx += (paddingLeft + paddingRight);\r\n            cy += (paddingTop + paddingBottom);\r\n        }\r\n\r\n\r\n        var size:Size = new Size(cx, cy);\r\n        return size;\r\n    }\r\n\r\n    public override function get_usableSize():Size {\r\n        var size:Size = super.get_usableSize();\r\n        _size.component = component;\r\n        size.width -= _size.usableWidthModifier;\r\n        size.height -= _size.usableHeightModifier;\r\n        return size;\r\n    }\r\n}\r\n\r\nclass DelegateLayoutSize {\r\n    public var component:Component;\r\n    public var config:Map<String, String>;\r\n\r\n    public var width(get, null):Float;\r\n    private function get_width():Float {\r\n        return 0;\r\n    }\r\n\r\n    public var height(get, null):Float;\r\n    private function get_height():Float {\r\n        return 0;\r\n    }\r\n\r\n    public var usableWidthModifier(get, null):Float;\r\n    private function get_usableWidthModifier():Float {\r\n        return 0;\r\n    }\r\n\r\n    public var usableHeightModifier(get, null):Float;\r\n    private function get_usableHeightModifier():Float {\r\n        return 0;\r\n    }\r\n\r\n    public function getString(name:String, defaultValue:String = null):String {\r\n        if (config == null) {\r\n            return defaultValue;\r\n        }\r\n        if (config.exists(name) == false) {\r\n            return defaultValue;\r\n        }\r\n        return config.get(name);\r\n    }\r\n\r\n    public function getInt(name:String, defaultValue:Int = 0):Int {\r\n        var v = getString(name);\r\n        if (v == null) {\r\n            return defaultValue;\r\n        }\r\n        return Std.parseInt(v);\r\n    }\r\n\r\n    public function getBool(name:String, defaultValue:Bool = false):Bool {\r\n        var v = getString(name);\r\n        if (v == null) {\r\n            return defaultValue;\r\n        }\r\n        return (v == \"true\");\r\n    }\r\n}","package haxe.ui.remoting.client;\r\n\r\nimport haxe.ui.remoting.Msg;\r\nimport haxe.ui.remoting.client.ClientSocket;\r\nimport haxe.ui.remoting.client.calls.Call;\r\n\r\n#if neko\r\nimport neko.vm.Thread;\r\n#elseif cpp\r\nimport cpp.vm.Thread;\r\n#end\r\n\r\nclass Client {\r\n    private var _socket:ClientSocket;\r\n\r\n    public function new() {\r\n        connect();\r\n    }\r\n\r\n    public function connect(host:String = \"localhost\", port:Int = 1234) {\r\n        _socket = new ClientSocket();\r\n        _socket.onMessage = onMessage;\r\n        _socket.onError = onError;\r\n        _socket.connect(host, port);\r\n    }\r\n\r\n    private function onMessage(msg:Msg) {\r\n        var call:Call = Call.create(msg.id);\r\n        if (msg.id == \"client.connected\") {\r\n            return;\r\n        }\r\n        if (msg.id == \"client.disconnect\") {\r\n            _socket.disconnect();\r\n            return;\r\n        }\r\n        if (call == null) {\r\n            trace(\"WARNING: message unrecognised, id=\" + msg.id);\r\n            return;\r\n        }\r\ntrace(\"HERE333333333\");\r\ntrace(\"HERE2 - \" + msg);\r\ntrace(\"HERE2 - \" + msg.details);\r\n        var details = call.execute(msg.details);\r\ntrace(\"HERE3\");\r\n        if (details != null) {\r\n            var response:Msg = {\r\n                id: msg.id,\r\n                details: details\r\n            }\r\n\r\n            _socket.sendMessage(response);\r\n        }\r\n    }\r\n\r\n    #if (neko || cpp)\r\n    private function onError(error:String) {\r\n        trace(error);\r\n        var t:Thread = Thread.create(retryThread);\r\n        t.sendMessage(this);\r\n    }\r\n\r\n    private function retryThread() {\r\n        var that:Client = Thread.readMessage(true);\r\n        Sys.sleep(5);\r\n        that.connect();\r\n    }\r\n    #elseif flash\r\n    private function onError(error:String) {\r\n        var t:flash.utils.Timer = new flash.utils.Timer(5000, 1);\r\n        t.addEventListener(flash.events.TimerEvent.TIMER_COMPLETE, function(e) {\r\n            t.stop();\r\n            _socket.disconnect();\r\n            _socket = null;\r\n           connect();\r\n        });\r\n        t.start();\r\n    }\r\n    #elseif js\r\n    private function onError(error:String) {\r\n        var timer = new Timer(5000);\r\n        timer.run = function() {\r\n            timer.stop();\r\n            _socket.disconnect();\r\n            _socket = null;\r\n            connect();\r\n        }\r\n    }\r\n    #end\r\n}","package haxe.ui.remoting.client;\r\n\r\nimport haxe.Serializer;\r\nimport haxe.Unserializer;\r\nimport haxe.ui.remoting.Msg;\r\n\r\n#if flash\r\ntypedef SocketImpl = haxe.ui.remoting.client.impl.FlashSocket;\r\n#elseif (neko || cpp)\r\ntypedef SocketImpl = haxe.ui.remoting.client.impl.NativeSocket;\r\n#elseif js\r\ntypedef SocketImpl = haxe.ui.remoting.client.impl.JavaScriptSocket;\r\n#end\r\n\r\nclass ClientSocket {\r\n    private var _socket:SocketImpl;\r\n\r\n    public var onMessage:Msg->Void;\r\n    public var onError:String->Void;\r\n\r\n    public function new() {\r\n    }\r\n\r\n    private function onMessageInternal(msg:Msg) {\r\n        if (onMessage != null) {\r\n            onMessage(msg);\r\n        }\r\n    }\r\n\r\n    public function connect(host:String, port:Int) {\r\n        _socket = new SocketImpl();\r\n        _socket.onMessage = onMessageInternal;\r\n        _socket.onError = onError;\r\n        _socket.connect(host, port);\r\n    }\r\n\r\n    public function disconnect() {\r\n        if (_socket != null) {\r\n            _socket.disconnect();\r\n            _socket.onMessage = null;\r\n            _socket.onError = null;\r\n            _socket = null;\r\n        }\r\n    }\r\n\r\n    public function sendMessage(msg:Msg) {\r\n        _socket.sendMessage(msg);\r\n    }\r\n\r\n    public static function unserializeMsg(data:String):Msg {\r\n        var unserializer:Unserializer = new Unserializer(data);\r\n        var msg:Msg = unserializer.unserialize();\r\n        return msg;\r\n    }\r\n\r\n    public static function serializeMsg(msg:Msg):String {\r\n        var serializer:Serializer = new Serializer();\r\n        serializer.serialize(msg);\r\n        return serializer.toString();\r\n    }\r\n}","package haxe.ui.remoting.client.calls;\r\n\r\nclass Call {\r\n    public function new() {\r\n\r\n    }\r\n\r\n    public function execute(details:Dynamic):Dynamic {\r\n        throw \"Not implemented\";\r\n    }\r\n\r\n    public static function create(name:String):Call {\r\n        switch (name) {\r\n            case \"components.list\":\r\n                return new ListComponents();\r\n            case \"component.highlight\":\r\n                return new HighlightComponent();\r\n            case \"component.removeAllChildren\":\r\n                return new RemoveAllChildComponents();\r\n            case \"component.create\":\r\n                return new CreateComponent();\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n}","package haxe.ui.remoting.client.calls;\r\n\r\nclass CreateComponent extends Call {\r\n    public function new() {\r\n        super();\r\n    }\r\n    \r\n    public override function execute(details:Dynamic):Dynamic {\r\n        if (details == null) {\r\n            return false;\r\n        }\r\n        //var componentString:String = details.get(\"componentString\");\r\n        trace(\"COMPONENT STRING = \" + (details == null));\r\n        return true;\r\n    }\r\n}","package haxe.ui.remoting.client.calls;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.Screen;\r\n\r\nclass HighlightComponent extends Call {\r\n    private static var overlay:Component;\r\n\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    @:access(haxe.ui.core.Component)\r\n    public override function execute(details:Dynamic):Dynamic {\r\n        var id:String = details.id;\r\n        var hightlight:Bool = (details.highlight == \"true\");\r\n\r\n        var component:Component = Screen.instance.rootComponents[0].findComponent(id, Component, true);\r\n        if (component != null) {\r\n            if (hightlight == true) {\r\n                if (overlay == null) {\r\n                    overlay = new Component();\r\n                    overlay.includeInLayout = false;\r\n                    overlay.styleString = \"border: 2px solid #FF0000;background-color: #FFCCCC; border-radius:2px;opacity: 0.5\";\r\n                    Screen.instance.addComponent(overlay);\r\n                }\r\n\r\n                overlay.left = component.screenLeft;\r\n                overlay.top = component.screenTop;\r\n                overlay.width = component.componentWidth;\r\n                overlay.height = component.componentHeight;\r\n                overlay.show();\r\n            } else {\r\n                if (overlay != null) {\r\n                    //Screen.instance.removeComponent(overlay);\r\n                    overlay.hide();\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n}","package haxe.ui.remoting.client.calls;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.Screen;\r\nimport haxe.ui.remoting.ComponentInfo;\r\nimport haxe.ui.util.GUID;\r\n\r\nclass ListComponents extends Call {\r\n    public function new() {\r\n        super();\r\n    }\r\n\r\n    public override function execute(details:Dynamic):Dynamic {\r\n        var components = new Array<ComponentInfo>();\r\n        for (component in Screen.instance.rootComponents) {\r\n            var className:String = Type.getClassName(Type.getClass(component));\r\n            var componentInfo:ComponentInfo = {\r\n               className: className\r\n            };\r\n            buildComponentTree(component, componentInfo);\r\n            components.push(componentInfo);\r\n        }\r\n        return components;\r\n    }\r\n\r\n    @:access(haxe.ui.core.Component)\r\n    private static function buildComponentTree(c:Component, i:ComponentInfo) {\r\n        if (c.id == null) {\r\n            c.id = \"__\" + GUID.uuid();\r\n        }\r\n\r\n        if (c.id != null)                           i.id = c.id;\r\n        if (c.left != null)                         i.left = c.left;\r\n        if (c.top != null)                          i.top = c.top;\r\n        if (c.left != null)                         i.screenLeft = c.screenLeft;\r\n        if (c.top != null)                          i.screenTop = c.screenTop;\r\n        if (c.componentWidth != null)               i.width = c.componentWidth;\r\n        if (c.componentHeight != null)              i.height = c.componentHeight;\r\n        if (c.percentWidth != null)                 i.percentWidth = c.percentWidth;\r\n        if (c.percentHeight != null)                i.percentHeight = c.percentHeight;\r\n        if (c.text != null)                         i.text = c.text;\r\n\r\n        for (child in c.childComponents) {\r\n            var childInfo:ComponentInfo = {\r\n                className: Type.getClassName(Type.getClass(child))\r\n            }\r\n            buildComponentTree(child, childInfo);\r\n            if (i.children == null) {\r\n                i.children = new Array<ComponentInfo>();\r\n            }\r\n            i.children.push(childInfo);\r\n        }\r\n    }\r\n}","package haxe.ui.remoting.client.calls;\r\n\r\nimport haxe.ui.core.Screen;\r\n\r\nclass RemoveAllChildComponents extends Call {\r\n    public function new() {\r\n        super();\r\n    }\r\n    \r\n    public override function execute(details:Dynamic):Dynamic {\r\n        for (r in Screen.instance.rootComponents) {\r\n            Screen.instance.removeComponent(r);\r\n        }\r\n        return true;\r\n    }\r\n}","package haxe.ui.remoting.client.impl;\r\n\r\nimport haxe.ui.remoting.Msg;\r\nimport haxe.ui.remoting.client.ClientSocket;\r\nimport js.html.MessageEvent;\r\nimport js.html.WebSocket;\r\n\r\nclass JavaScriptSocket {\r\n    public var onMessage:Msg->Void;\r\n    public var onError:String->Void;\r\n\r\n    private var _socket:WebSocket;\r\n\r\n    public function new() {\r\n    }\r\n\r\n    public function connect(host:String, port:Int) {\r\n        disconnect();\r\n        _socket = new WebSocket(\"ws://\" + host + \":\" + (port + 1));\r\n        _socket.onopen = function() {\r\n            _socket.send(\"ready\");\r\n        }\r\n        _socket.onmessage = function(m:MessageEvent) {\r\n            var msg:Msg = ClientSocket.unserializeMsg(m.data);\r\n            if (onMessage != null) {\r\n                onMessage(msg);\r\n            }\r\n        }\r\n        _socket.onerror = function(e) {\r\n            if (onError != null) {\r\n                onError(e);\r\n            }\r\n        }\r\n        _socket.onclose = function() {\r\n            if (onError != null) {\r\n                onError(null);\r\n            }\r\n        }\r\n    }\r\n\r\n    public function disconnect() {\r\n        if (_socket != null) {\r\n            _socket.onopen = null;\r\n            _socket.onmessage = null;\r\n            _socket.onerror = null;\r\n            _socket.onclose = null;\r\n            _socket.close();\r\n            _socket = null;\r\n        }\r\n    }\r\n\r\n    public function sendMessage(msg:Msg) {\r\n        var data:String = ClientSocket.serializeMsg(msg);\r\n        _socket.send(data);\r\n    }\r\n}","/*\r\n * Copyright (c) 2008, Nicolas Cannasse\r\n * All rights reserved.\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *\r\n *   - Redistributions of source code must retain the above copyright\r\n *     notice, this list of conditions and the following disclaimer.\r\n *   - Redistributions in binary form must reproduce the above copyright\r\n *     notice, this list of conditions and the following disclaimer in the\r\n *     documentation and/or other materials provided with the distribution.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE HAXE PROJECT CONTRIBUTORS \"AS IS\" AND ANY\r\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n * DISCLAIMED. IN NO EVENT SHALL THE HAXE PROJECT CONTRIBUTORS BE LIABLE FOR\r\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\r\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\r\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\r\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\r\n * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY\r\n * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH\r\n * DAMAGE.\r\n */\r\npackage hscript;\r\nimport hscript.Expr;\r\n\r\nprivate enum Stop {\r\n\tSBreak;\r\n\tSContinue;\r\n\tSReturn( v : Dynamic );\r\n}\r\n\r\nclass Interp {\r\n\r\n\t#if haxe3\r\n\tpublic var variables : Map<String,Dynamic>;\r\n\tvar locals : Map<String,{ r : Dynamic }>;\r\n\tvar binops : Map<String, Expr -> Expr -> Dynamic >;\r\n\t#else\r\n\tpublic var variables : Hash<Dynamic>;\r\n\tvar locals : Hash<{ r : Dynamic }>;\r\n\tvar binops : Hash< Expr -> Expr -> Dynamic >;\r\n\t#end\r\n\r\n\tvar depth : Int;\r\n\tvar inTry : Bool;\r\n\tvar declared : Array<{ n : String, old : { r : Dynamic } }>;\r\n\r\n\t#if hscriptPos\r\n\tvar curExpr : Expr;\r\n\t#end\r\n\r\n\tpublic function new() {\r\n\t\t#if haxe3\r\n\t\tvariables = new Map<String,Dynamic>();\r\n\t\tlocals = new Map();\r\n\t\t#else\r\n\t\tvariables = new Hash();\r\n\t\tlocals = new Hash();\r\n\t\t#end\r\n\t\tdeclared = new Array();\r\n\t\tvariables.set(\"null\",null);\r\n\t\tvariables.set(\"true\",true);\r\n\t\tvariables.set(\"false\",false);\r\n\t\tvariables.set(\"trace\",function(e) haxe.Log.trace(Std.string(e),cast { fileName : \"hscript\", lineNumber : 0 }));\r\n\t\tinitOps();\r\n\t}\r\n\r\n\tfunction initOps() {\r\n\t\tvar me = this;\r\n\t\t#if haxe3\r\n\t\tbinops = new Map();\r\n\t\t#else\r\n\t\tbinops = new Hash();\r\n\t\t#end\r\n\t\tbinops.set(\"+\",function(e1,e2) return me.expr(e1) + me.expr(e2));\r\n\t\tbinops.set(\"-\",function(e1,e2) return me.expr(e1) - me.expr(e2));\r\n\t\tbinops.set(\"*\",function(e1,e2) return me.expr(e1) * me.expr(e2));\r\n\t\tbinops.set(\"/\",function(e1,e2) return me.expr(e1) / me.expr(e2));\r\n\t\tbinops.set(\"%\",function(e1,e2) return me.expr(e1) % me.expr(e2));\r\n\t\tbinops.set(\"&\",function(e1,e2) return me.expr(e1) & me.expr(e2));\r\n\t\tbinops.set(\"|\",function(e1,e2) return me.expr(e1) | me.expr(e2));\r\n\t\tbinops.set(\"^\",function(e1,e2) return me.expr(e1) ^ me.expr(e2));\r\n\t\tbinops.set(\"<<\",function(e1,e2) return me.expr(e1) << me.expr(e2));\r\n\t\tbinops.set(\">>\",function(e1,e2) return me.expr(e1) >> me.expr(e2));\r\n\t\tbinops.set(\">>>\",function(e1,e2) return me.expr(e1) >>> me.expr(e2));\r\n\t\tbinops.set(\"==\",function(e1,e2) return me.expr(e1) == me.expr(e2));\r\n\t\tbinops.set(\"!=\",function(e1,e2) return me.expr(e1) != me.expr(e2));\r\n\t\tbinops.set(\">=\",function(e1,e2) return me.expr(e1) >= me.expr(e2));\r\n\t\tbinops.set(\"<=\",function(e1,e2) return me.expr(e1) <= me.expr(e2));\r\n\t\tbinops.set(\">\",function(e1,e2) return me.expr(e1) > me.expr(e2));\r\n\t\tbinops.set(\"<\",function(e1,e2) return me.expr(e1) < me.expr(e2));\r\n\t\tbinops.set(\"||\",function(e1,e2) return me.expr(e1) == true || me.expr(e2) == true);\r\n\t\tbinops.set(\"&&\",function(e1,e2) return me.expr(e1) == true && me.expr(e2) == true);\r\n\t\tbinops.set(\"=\",assign);\r\n\t\tbinops.set(\"...\",function(e1,e2) return new #if (haxe_211 || haxe3) IntIterator #else IntIter #end(me.expr(e1),me.expr(e2)));\r\n\t\tassignOp(\"+=\",function(v1:Dynamic,v2:Dynamic) return v1 + v2);\r\n\t\tassignOp(\"-=\",function(v1:Float,v2:Float) return v1 - v2);\r\n\t\tassignOp(\"*=\",function(v1:Float,v2:Float) return v1 * v2);\r\n\t\tassignOp(\"/=\",function(v1:Float,v2:Float) return v1 / v2);\r\n\t\tassignOp(\"%=\",function(v1:Float,v2:Float) return v1 % v2);\r\n\t\tassignOp(\"&=\",function(v1,v2) return v1 & v2);\r\n\t\tassignOp(\"|=\",function(v1,v2) return v1 | v2);\r\n\t\tassignOp(\"^=\",function(v1,v2) return v1 ^ v2);\r\n\t\tassignOp(\"<<=\",function(v1,v2) return v1 << v2);\r\n\t\tassignOp(\">>=\",function(v1,v2) return v1 >> v2);\r\n\t\tassignOp(\">>>=\",function(v1,v2) return v1 >>> v2);\r\n\t}\r\n\r\n\tfunction assign( e1 : Expr, e2 : Expr ) : Dynamic {\r\n\t\tvar v = expr(e2);\r\n\t\tswitch( edef(e1) ) {\r\n\t\tcase EIdent(id):\r\n\t\t\tvar l = locals.get(id);\r\n\t\t\tif( l == null )\r\n\t\t\t\tvariables.set(id,v)\r\n\t\t\telse\r\n\t\t\t\tl.r = v;\r\n\t\tcase EField(e,f):\r\n\t\t\tv = set(expr(e),f,v);\r\n\t\tcase EArray(e,index):\r\n\t\t\texpr(e)[expr(index)] = v;\r\n\t\tdefault:\r\n\t\t\terror(EInvalidOp(\"=\"));\r\n\t\t}\r\n\t\treturn v;\r\n\t}\r\n\r\n\tfunction assignOp( op, fop : Dynamic -> Dynamic -> Dynamic ) {\r\n\t\tvar me = this;\r\n\t\tbinops.set(op,function(e1,e2) return me.evalAssignOp(op,fop,e1,e2));\r\n\t}\r\n\r\n\tfunction evalAssignOp(op,fop,e1,e2) : Dynamic {\r\n\t\tvar v;\r\n\t\tswitch( edef(e1) ) {\r\n\t\tcase EIdent(id):\r\n\t\t\tvar l = locals.get(id);\r\n\t\t\tv = fop(expr(e1),expr(e2));\r\n\t\t\tif( l == null )\r\n\t\t\t\tvariables.set(id,v)\r\n\t\t\telse\r\n\t\t\t\tl.r = v;\r\n\t\tcase EField(e,f):\r\n\t\t\tvar obj = expr(e);\r\n\t\t\tv = fop(get(obj,f),expr(e2));\r\n\t\t\tv = set(obj,f,v);\r\n\t\tcase EArray(e,index):\r\n\t\t\tvar arr = expr(e);\r\n\t\t\tvar index = expr(index);\r\n\t\t\tv = fop(arr[index],expr(e2));\r\n\t\t\tarr[index] = v;\r\n\t\tdefault:\r\n\t\t\treturn error(EInvalidOp(op));\r\n\t\t}\r\n\t\treturn v;\r\n\t}\r\n\r\n\tfunction increment( e : Expr, prefix : Bool, delta : Int ) : Dynamic {\r\n\t\t#if hscriptPos\r\n\t\tcurExpr = e;\r\n\t\tvar e = e.e;\r\n\t\t#end\r\n\t\tswitch(e) {\r\n\t\tcase EIdent(id):\r\n\t\t\tvar l = locals.get(id);\r\n\t\t\tvar v : Dynamic = (l == null) ? variables.get(id) : l.r;\r\n\t\t\tif( prefix ) {\r\n\t\t\t\tv += delta;\r\n\t\t\t\tif( l == null ) variables.set(id,v) else l.r = v;\r\n\t\t\t} else\r\n\t\t\t\tif( l == null ) variables.set(id,v + delta) else l.r = v + delta;\r\n\t\t\treturn v;\r\n\t\tcase EField(e,f):\r\n\t\t\tvar obj = expr(e);\r\n\t\t\tvar v : Dynamic = get(obj,f);\r\n\t\t\tif( prefix ) {\r\n\t\t\t\tv += delta;\r\n\t\t\t\tset(obj,f,v);\r\n\t\t\t} else\r\n\t\t\t\tset(obj,f,v + delta);\r\n\t\t\treturn v;\r\n\t\tcase EArray(e,index):\r\n\t\t\tvar arr = expr(e);\r\n\t\t\tvar index = expr(index);\r\n\t\t\tvar v = arr[index];\r\n\t\t\tif( prefix ) {\r\n\t\t\t\tv += delta;\r\n\t\t\t\tarr[index] = v;\r\n\t\t\t} else\r\n\t\t\t\tarr[index] = v + delta;\r\n\t\t\treturn v;\r\n\t\tdefault:\r\n\t\t\treturn error(EInvalidOp((delta > 0)?\"++\":\"--\"));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic function execute( expr : Expr ) : Dynamic {\r\n\t\tdepth = 0;\r\n\t\t#if haxe3\r\n\t\tlocals = new Map();\r\n\t\t#else\r\n\t\tlocals = new Hash();\r\n\t\t#end\r\n\t\tdeclared = new Array();\r\n\t\treturn exprReturn(expr);\r\n\t}\r\n\r\n\tfunction exprReturn(e) : Dynamic {\r\n\t\ttry {\r\n\t\t\treturn expr(e);\r\n\t\t} catch( e : Stop ) {\r\n\t\t\tswitch( e ) {\r\n\t\t\tcase SBreak: throw \"Invalid break\";\r\n\t\t\tcase SContinue: throw \"Invalid continue\";\r\n\t\t\tcase SReturn(v): return v;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction duplicate<T>( h : #if haxe3 Map < String, T > #else Hash<T> #end ) {\r\n\t\t#if haxe3\r\n\t\tvar h2 = new Map();\r\n\t\t#else\r\n\t\tvar h2 = new Hash();\r\n\t\t#end\r\n\t\tfor( k in h.keys() )\r\n\t\t\th2.set(k,h.get(k));\r\n\t\treturn h2;\r\n\t}\r\n\r\n\tfunction restore( old : Int ) {\r\n\t\twhile( declared.length > old ) {\r\n\t\t\tvar d = declared.pop();\r\n\t\t\tlocals.set(d.n,d.old);\r\n\t\t}\r\n\t}\r\n\r\n\tinline function edef( e : Expr ) {\r\n\t\t#if hscriptPos\r\n\t\treturn e.e;\r\n\t\t#else\r\n\t\treturn e;\r\n\t\t#end\r\n\t}\r\n\r\n\tinline function error(e : #if hscriptPos ErrorDef #else Error #end ) : Dynamic {\r\n\t\t#if hscriptPos\r\n\t\tthrow new Error(e, curExpr.pmin, curExpr.pmax);\r\n\t\t#else\r\n\t\tthrow e;\r\n\t\t#end\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction resolve( id : String ) : Dynamic {\r\n\t\tvar l = locals.get(id);\r\n\t\tif( l != null )\r\n\t\t\treturn l.r;\r\n\t\tvar v = variables.get(id);\r\n\t\tif( v == null && !variables.exists(id) )\r\n\t\t\terror(EUnknownVariable(id));\r\n\t\treturn v;\r\n\t}\r\n\r\n\tpublic function expr( e : Expr ) : Dynamic {\r\n\t\t#if hscriptPos\r\n\t\tcurExpr = e;\r\n\t\tvar e = e.e;\r\n\t\t#end\r\n\t\tswitch( e ) {\r\n\t\tcase EConst(c):\r\n\t\t\tswitch( c ) {\r\n\t\t\tcase CInt(v): return v;\r\n\t\t\tcase CFloat(f): return f;\r\n\t\t\tcase CString(s): return s;\r\n\t\t\t#if !haxe3\r\n\t\t\tcase CInt32(v): return v;\r\n\t\t\t#end\r\n\t\t\t}\r\n\t\tcase EIdent(id):\r\n\t\t\treturn resolve(id);\r\n\t\tcase EVar(n,_,e):\r\n\t\t\tdeclared.push({ n : n, old : locals.get(n) });\r\n\t\t\tlocals.set(n,{ r : (e == null)?null:expr(e) });\r\n\t\t\treturn null;\r\n\t\tcase EParent(e):\r\n\t\t\treturn expr(e);\r\n\t\tcase EBlock(exprs):\r\n\t\t\tvar old = declared.length;\r\n\t\t\tvar v = null;\r\n\t\t\tfor( e in exprs )\r\n\t\t\t\tv = expr(e);\r\n\t\t\trestore(old);\r\n\t\t\treturn v;\r\n\t\tcase EField(e,f):\r\n\t\t\treturn get(expr(e),f);\r\n\t\tcase EBinop(op,e1,e2):\r\n\t\t\tvar fop = binops.get(op);\r\n\t\t\tif( fop == null ) error(EInvalidOp(op));\r\n\t\t\treturn fop(e1,e2);\r\n\t\tcase EUnop(op,prefix,e):\r\n\t\t\tswitch(op) {\r\n\t\t\tcase \"!\":\r\n\t\t\t\treturn expr(e) != true;\r\n\t\t\tcase \"-\":\r\n\t\t\t\treturn -expr(e);\r\n\t\t\tcase \"++\":\r\n\t\t\t\treturn increment(e,prefix,1);\r\n\t\t\tcase \"--\":\r\n\t\t\t\treturn increment(e,prefix,-1);\r\n\t\t\tcase \"~\":\r\n\t\t\t\t#if (neko && !haxe3)\r\n\t\t\t\treturn haxe.Int32.complement(expr(e));\r\n\t\t\t\t#else\r\n\t\t\t\treturn ~expr(e);\r\n\t\t\t\t#end\r\n\t\t\tdefault:\r\n\t\t\t\terror(EInvalidOp(op));\r\n\t\t\t}\r\n\t\tcase ECall(e,params):\r\n\t\t\tvar args = new Array();\r\n\t\t\tfor( p in params )\r\n\t\t\t\targs.push(expr(p));\r\n\r\n\t\t\tswitch( edef(e) ) {\r\n\t\t\tcase EField(e,f):\r\n\t\t\t\tvar obj = expr(e);\r\n\t\t\t\tif( obj == null ) error(EInvalidAccess(f));\r\n\t\t\t\treturn fcall(obj,f,args);\r\n\t\t\tdefault:\r\n\t\t\t\treturn call(null,expr(e),args);\r\n\t\t\t}\r\n\t\tcase EIf(econd,e1,e2):\r\n\t\t\treturn if( expr(econd) == true ) expr(e1) else if( e2 == null ) null else expr(e2);\r\n\t\tcase EWhile(econd,e):\r\n\t\t\twhileLoop(econd,e);\r\n\t\t\treturn null;\r\n\t\tcase EFor(v,it,e):\r\n\t\t\tforLoop(v,it,e);\r\n\t\t\treturn null;\r\n\t\tcase EBreak:\r\n\t\t\tthrow SBreak;\r\n\t\tcase EContinue:\r\n\t\t\tthrow SContinue;\r\n\t\tcase EReturn(e):\r\n\t\t\tthrow SReturn((e == null)?null:expr(e));\r\n\t\tcase EFunction(params,fexpr,name,_):\r\n\t\t\tvar capturedLocals = duplicate(locals);\r\n\t\t\tvar me = this;\r\n\t\t\tvar hasOpt = false, minParams = 0;\r\n\t\t\tfor( p in params )\r\n\t\t\t\tif( p.opt )\r\n\t\t\t\t\thasOpt = true;\r\n\t\t\t\telse\r\n\t\t\t\t\tminParams++;\r\n\t\t\tvar f = function(args:Array<Dynamic>) {\r\n\t\t\t\tif( args.length != params.length ) {\r\n\t\t\t\t\tif( args.length < minParams ) {\r\n\t\t\t\t\t\tvar str = \"Invalid number of parameters. Got \" + args.length + \", required \" + minParams;\r\n\t\t\t\t\t\tif( name != null ) str += \" for function '\" + name+\"'\";\r\n\t\t\t\t\t\tthrow str;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// make sure mandatory args are forced\r\n\t\t\t\t\tvar args2 = [];\r\n\t\t\t\t\tvar extraParams = args.length - minParams;\r\n\t\t\t\t\tvar pos = 0;\r\n\t\t\t\t\tfor( p in params )\r\n\t\t\t\t\t\tif( p.opt ) {\r\n\t\t\t\t\t\t\tif( extraParams > 0 ) {\r\n\t\t\t\t\t\t\t\targs2.push(args[pos++]);\r\n\t\t\t\t\t\t\t\textraParams--;\r\n\t\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\t\targs2.push(null);\r\n\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\targs2.push(args[pos++]);\r\n\t\t\t\t\targs = args2;\r\n\t\t\t\t}\r\n\t\t\t\tvar old = me.locals, depth = me.depth;\r\n\t\t\t\tme.depth++;\r\n\t\t\t\tme.locals = me.duplicate(capturedLocals);\r\n\t\t\t\tfor( i in 0...params.length )\r\n\t\t\t\t\tme.locals.set(params[i].name,{ r : args[i] });\r\n\t\t\t\tvar r = null;\r\n\t\t\t\tif( inTry )\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tr = me.exprReturn(fexpr);\r\n\t\t\t\t\t} catch( e : Dynamic ) {\r\n\t\t\t\t\t\tme.locals = old;\r\n\t\t\t\t\t\tme.depth = depth;\r\n\t\t\t\t\t\t#if neko\r\n\t\t\t\t\t\tneko.Lib.rethrow(e);\r\n\t\t\t\t\t\t#else\r\n\t\t\t\t\t\tthrow e;\r\n\t\t\t\t\t\t#end\r\n\t\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\tr = me.exprReturn(fexpr);\r\n\t\t\t\tme.locals = old;\r\n\t\t\t\tme.depth = depth;\r\n\t\t\t\treturn r;\r\n\t\t\t};\r\n\t\t\tvar f = Reflect.makeVarArgs(f);\r\n\t\t\tif( name != null ) {\r\n\t\t\t\tif( depth == 0 ) {\r\n\t\t\t\t\t// global function\r\n\t\t\t\t\tvariables.set(name, f);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// function-in-function is a local function\r\n\t\t\t\t\tdeclared.push( { n : name, old : locals.get(name) } );\r\n\t\t\t\t\tvar ref = { r : f };\r\n\t\t\t\t\tlocals.set(name, ref);\r\n\t\t\t\t\tcapturedLocals.set(name, ref); // allow self-recursion\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn f;\r\n\t\tcase EArrayDecl(arr):\r\n\t\t\tvar a = new Array();\r\n\t\t\tfor( e in arr )\r\n\t\t\t\ta.push(expr(e));\r\n\t\t\treturn a;\r\n\t\tcase EArray(e,index):\r\n\t\t\treturn expr(e)[expr(index)];\r\n\t\tcase ENew(cl,params):\r\n\t\t\tvar a = new Array();\r\n\t\t\tfor( e in params )\r\n\t\t\t\ta.push(expr(e));\r\n\t\t\treturn cnew(cl,a);\r\n\t\tcase EThrow(e):\r\n\t\t\tthrow expr(e);\r\n\t\tcase ETry(e,n,_,ecatch):\r\n\t\t\tvar old = declared.length;\r\n\t\t\tvar oldTry = inTry;\r\n\t\t\ttry {\r\n\t\t\t\tinTry = true;\r\n\t\t\t\tvar v : Dynamic = expr(e);\r\n\t\t\t\trestore(old);\r\n\t\t\t\tinTry = oldTry;\r\n\t\t\t\treturn v;\r\n\t\t\t} catch( err : Stop ) {\r\n\t\t\t\tinTry = oldTry;\r\n\t\t\t\tthrow err;\r\n\t\t\t} catch( err : Dynamic ) {\r\n\t\t\t\t// restore vars\r\n\t\t\t\trestore(old);\r\n\t\t\t\tinTry = oldTry;\r\n\t\t\t\t// declare 'v'\r\n\t\t\t\tdeclared.push({ n : n, old : locals.get(n) });\r\n\t\t\t\tlocals.set(n,{ r : err });\r\n\t\t\t\tvar v : Dynamic = expr(ecatch);\r\n\t\t\t\trestore(old);\r\n\t\t\t\treturn v;\r\n\t\t\t}\r\n\t\tcase EObject(fl):\r\n\t\t\tvar o = {};\r\n\t\t\tfor( f in fl )\r\n\t\t\t\tset(o,f.name,expr(f.e));\r\n\t\t\treturn o;\r\n\t\tcase ETernary(econd,e1,e2):\r\n\t\t\treturn if( expr(econd) == true ) expr(e1) else expr(e2);\r\n\t\tcase ESwitch(e, cases, def):\r\n\t\t\tvar val : Dynamic = expr(e);\r\n\t\t\tvar match = false;\r\n\t\t\tfor( c in cases ) {\r\n\t\t\t\tfor( v in c.values )\r\n\t\t\t\t\tif( expr(v) == val ) {\r\n\t\t\t\t\t\tmatch = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\tif( match ) {\r\n\t\t\t\t\tval = expr(c.expr);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif( !match )\r\n\t\t\t\tval = def == null ? null : expr(def);\r\n\t\t\treturn val;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction whileLoop(econd,e) {\r\n\t\tvar old = declared.length;\r\n\t\twhile( expr(econd) == true ) {\r\n\t\t\ttry {\r\n\t\t\t\texpr(e);\r\n\t\t\t} catch( err : Stop ) {\r\n\t\t\t\tswitch(err) {\r\n\t\t\t\tcase SContinue:\r\n\t\t\t\tcase SBreak: break;\r\n\t\t\t\tcase SReturn(_): throw err;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\trestore(old);\r\n\t}\r\n\r\n\tfunction makeIterator( v : Dynamic ) : Iterator<Dynamic> {\r\n\t\t#if (flash && !flash9)\r\n\t\tif( v.iterator != null ) v = v.iterator();\r\n\t\t#else\r\n\t\ttry v = v.iterator() catch( e : Dynamic ) {};\r\n\t\t#end\r\n\t\tif( v.hasNext == null || v.next == null ) error(EInvalidIterator(v));\r\n\t\treturn v;\r\n\t}\r\n\r\n\tfunction forLoop(n,it,e) {\r\n\t\tvar old = declared.length;\r\n\t\tdeclared.push({ n : n, old : locals.get(n) });\r\n\t\tvar it = makeIterator(expr(it));\r\n\t\twhile( it.hasNext() ) {\r\n\t\t\tlocals.set(n,{ r : it.next() });\r\n\t\t\ttry {\r\n\t\t\t\texpr(e);\r\n\t\t\t} catch( err : Stop ) {\r\n\t\t\t\tswitch( err ) {\r\n\t\t\t\tcase SContinue:\r\n\t\t\t\tcase SBreak: break;\r\n\t\t\t\tcase SReturn(_): throw err;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\trestore(old);\r\n\t}\r\n\r\n\tfunction get( o : Dynamic, f : String ) : Dynamic {\r\n\t\tif( o == null ) error(EInvalidAccess(f));\r\n\t\t#if php\r\n\t\t\t// https://github.com/HaxeFoundation/haxe/issues/4915\r\n\t\t\treturn try {\r\n\t\t\t\tReflect.getProperty(o, f);\r\n\t\t\t} catch (e:Dynamic) {\r\n\t\t\t\tReflect.field(o, f);\r\n\t\t\t}\r\n\t\t#else\r\n\t\t\treturn Reflect.getProperty(o, f);\r\n\t\t#end\r\n\t}\r\n\r\n\tfunction set( o : Dynamic, f : String, v : Dynamic ) : Dynamic {\r\n\t\tif( o == null ) error(EInvalidAccess(f));\r\n\t\tReflect.setProperty(o,f,v);\r\n\t\treturn v;\r\n\t}\r\n\r\n\tfunction fcall( o : Dynamic, f : String, args : Array<Dynamic> ) : Dynamic {\r\n\t\treturn call(o, get(o, f), args);\r\n\t}\r\n\r\n\tfunction call( o : Dynamic, f : Dynamic, args : Array<Dynamic> ) : Dynamic {\r\n\t\treturn Reflect.callMethod(o,f,args);\r\n\t}\r\n\r\n\tfunction cnew( cl : String, args : Array<Dynamic> ) : Dynamic {\r\n\t\tvar c = Type.resolveClass(cl);\r\n\t\tif( c == null ) c = resolve(cl);\r\n\t\treturn Type.createInstance(c,args);\r\n\t}\r\n\r\n}\r\n","package haxe.ui.scripting;\r\n\r\nimport hscript.Interp;\r\n\r\nclass ScriptInterp extends Interp {\r\n    private static var _classAliases:Map<String, String>;\r\n    private static var _staticClasses:Map<String, Dynamic>;\r\n\r\n    public function new() {\r\n        super();\r\n        if (_staticClasses != null) {\r\n            for (name in _staticClasses.keys()) {\r\n                var c:Dynamic = _staticClasses.get(name);\r\n                this.variables.set(name, c);\r\n            }\r\n        }\r\n    }\r\n\r\n    override function cnew( cl : String, args : Array<Dynamic> ) : Dynamic {\r\n        if (_classAliases != null && _classAliases.exists(cl)) {\r\n            cl = _classAliases.get(cl);\r\n        }\r\n        return super.cnew(cl, args);\r\n    }\r\n\r\n    override function get( o : Dynamic, f : String ) : Dynamic {\r\n        if( o == null ) throw error(EInvalidAccess(f));\r\n        return Reflect.getProperty(o,f);\r\n    }\r\n\r\n    override function set( o : Dynamic, f : String, v : Dynamic ) : Dynamic {\r\n        if( o == null ) throw error(EInvalidAccess(f));\r\n        Reflect.setProperty(o,f,v);\r\n        return v;\r\n    }\r\n\r\n    public static function addClassAlias(alias:String, classPath:String):Void {\r\n        if (_classAliases == null) {\r\n            _classAliases = new Map<String, String>();\r\n        }\r\n        _classAliases.set(alias, classPath);\r\n    }\r\n\r\n    public static function addStaticClass(alias:String, c:Dynamic):Void {\r\n        if (_staticClasses == null) {\r\n            _staticClasses = new Map<String, Dynamic>();\r\n        }\r\n        _staticClasses.set(alias, c);\r\n    }\r\n}","package haxe.ui.styles;\r\n\r\nenum Unit {\r\n    Pix( v : Float );\r\n    Percent( v : Float );\r\n    EM( v : Float );\r\n}\r\n\r\nenum FillStyle {\r\n    Transparent;\r\n    Color( c : Int );\r\n    Gradient( a : Int, b : Int, c : Int, d : Int );\r\n}\r\n\r\nenum Layout {\r\n    Horizontal;\r\n    Vertical;\r\n    Absolute;\r\n    Dock;\r\n    Inline;\r\n}\r\n\r\nenum DockStyle {\r\n    Top;\r\n    Left;\r\n    Right;\r\n    Bottom;\r\n    Full;\r\n}\r\n\r\nenum TextAlign {\r\n    Left;\r\n    Right;\r\n    Center;\r\n}\r\n\r\nclass CssClass {\r\n    public var parent : Null<CssClass>;\r\n    public var node : Null<String>;\r\n    public var className : Null<String>;\r\n    public var pseudoClass : Null<String>;\r\n    public var id : Null<String>;\r\n    public function new() {\r\n    }\r\n}\r\n","package haxe.ui.styles;\r\n\r\nimport haxe.ui.styles.Defs;\r\nimport haxe.ui.util.MathUtil;\r\n\r\nenum Token {\r\n    TIdent( i : String );\r\n    TString( s : String );\r\n    TInt( i : Int );\r\n    TFloat( f : Float );\r\n    TDblDot;\r\n    TSharp;\r\n    TPOpen;\r\n    TPClose;\r\n    TExclam;\r\n    TComma;\r\n    TEof;\r\n    TPercent;\r\n    TSemicolon;\r\n    TBrOpen;\r\n    TBrClose;\r\n    TDot;\r\n    TSpaces;\r\n    TSlash;\r\n    TStar;\r\n}\r\n\r\nenum Value {\r\n    VIdent( i : String );\r\n    VString( s : String );\r\n    VUnit( v : Float, unit : String );\r\n    VFloat( v : Float );\r\n    VInt( v : Int );\r\n    VHex( v : String );\r\n    VList( l : Array<Value> );\r\n    VGroup( l : Array<Value> );\r\n    VCall( f : String, vl : Array<Value> );\r\n    VLabel( v : String, val : Value );\r\n    VSlash;\r\n}\r\n\r\nclass Parser {\r\n\r\n    var css : String;\r\n    var s : Style;\r\n    var simp : Style;\r\n    var pos : Int;\r\n\r\n    var spacesTokens : Bool;\r\n    var tokens : Array<Token>;\r\n\r\n    public function new() {\r\n    }\r\n\r\n\r\n    // ----------------- style apply ---------------------------\r\n\r\n    #if debug\r\n    function notImplemented( ?pos : haxe.PosInfos ) {\r\n        haxe.Log.trace(\"Not implemented\", pos);\r\n    }\r\n    #else\r\n    inline function notImplemented() {\r\n    }\r\n    #end\r\n\r\n    function applyStyle( r : String, v : Value, s : Style ) : Bool {\r\n        switch( r ) {\r\n        case \"padding\":\r\n            switch( v ) {\r\n            case VGroup([a, b]):\r\n                var a = getVal(a), b = getVal(b);\r\n                if( a != null && b != null ) {\r\n                    s.paddingTop = s.paddingBottom = a;\r\n                    s.paddingLeft = s.paddingRight = b;\r\n                    return true;\r\n                }\r\n            default:\r\n                var i = getVal(v);\r\n                if( i != null ) { s.padding(i); return true; }\r\n            }\r\n        case \"padding-top\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.paddingTop = i; return true; }\r\n        case \"padding-left\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.paddingLeft = i; return true; }\r\n        case \"padding-right\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.paddingRight = i; return true; }\r\n        case \"padding-bottom\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.paddingBottom = i; return true; }\r\n        case \"margin\":\r\n            switch( v ) {\r\n            case VGroup([a, b]):\r\n                var a = getVal(a), b = getVal(b);\r\n                if( a != null && b != null ) {\r\n                    s.marginTop = s.marginBottom = a;\r\n                    s.marginLeft = s.marginRight = b;\r\n                    return true;\r\n                }\r\n            default:\r\n                var i = getVal(v);\r\n                if( i != null ) { s.margin(i); return true; }\r\n            }\r\n        case \"margin-top\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.marginTop = i; return true; }\r\n        case \"margin-left\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.marginLeft = i; return true; }\r\n        case \"margin-right\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.marginRight = i; return true; }\r\n        case \"margin-bottom\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.marginBottom = i; return true; }\r\n        case \"width\":\r\n            var i = getVal(v);\r\n            if(getIdent(v) == \"auto\") {\r\n                s.width = null;\r\n                s.percentWidth = null;\r\n                s.autoWidth = true;\r\n                return true;\r\n            } else if( i != null ) {\r\n                s.width = i;\r\n                return true;\r\n            } else {\r\n                var p = getUnit(v);\r\n                if (p != null) {\r\n                    switch (p) {\r\n                        case Percent(x):\r\n                            s.percentWidth = x * 100;\r\n                            return true;\r\n                        default:\r\n                    }\r\n                }\r\n            }\r\n        case \"height\":\r\n            var i = getVal(v);\r\n            if(getIdent(v) == \"auto\") {\r\n                s.height = null;\r\n                s.percentHeight = null;\r\n                s.autoHeight = true;\r\n                return true;\r\n            } else if(i != null) {\r\n                s.height = i;\r\n                return true;\r\n            } else {\r\n                var p = getUnit(v);\r\n                if (p != null) {\r\n                    switch (p) {\r\n                        case Percent(x):\r\n                            s.percentHeight = x * 100;\r\n                            return true;\r\n                        default:\r\n                    }\r\n                }\r\n            }\r\n            /*\r\n            if( getIdent(v) == \"auto\" ) {\r\n                s.width = null;\r\n                s.autoWidth = true;\r\n                return true;\r\n            }\r\n            */\r\n        /*\r\n        case \"height\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.height = i;\r\n                return true;\r\n            }\r\n            if( getIdent(v) == \"auto\" ) {\r\n                s.height = null;\r\n                s.autoHeight = true;\r\n                return true;\r\n            }\r\n        */\r\n        case \"background-color\":\r\n            if (getIdent(v) == \"none\" || getIdent(v) == \"transparent\") {\r\n                s.backgroundColor = MathUtil.MIN_INT;\r\n                s.backgroundColorEnd = MathUtil.MIN_INT;\r\n                /*\r\n                s.backgroundColor = null;\r\n                s.backgroundColorEnd = null;\r\n                */\r\n                return true;\r\n            }\r\n            var f = getCol(v);\r\n            //var f = getFill(v);\r\n            if( f != null ) {\r\n                s.backgroundColor = f;\r\n                s.backgroundColorEnd = null;\r\n                return true;\r\n            }\r\n        case \"background-color-end\":\r\n            var f = getCol(v);\r\n            //var f = getFill(v);\r\n            if( f != null ) {\r\n                s.backgroundColorEnd = f;\r\n                return true;\r\n            }\r\n        case \"background-gradient-style\":\r\n            var v = getIdent(v);\r\n            if (v != null) {\r\n                if (v == \"vertical\" || v == \"horizontal\") {\r\n                    s.backgroundGradientStyle = v;\r\n                    return true;\r\n                }\r\n                return true;\r\n            }\r\n        case \"background\":\r\n            if( applyComposite([\"background-color\", \"background-color-end\", \"background-gradient-style\"], v, s) )\r\n                return true;\r\n            if (getIdent(v) == \"none\" ) {\r\n                /*\r\n                s.backgroundColor = null;\r\n                s.backgroundColorEnd = null;\r\n                */\r\n                s.backgroundColor = MathUtil.MIN_INT;\r\n                s.backgroundColorEnd = MathUtil.MIN_INT;\r\n                return true;\r\n            }\r\n\r\n\r\n        case \"background-image\":\r\n            var x = getString(v);\r\n            if (x != null) {\r\n                s.backgroundImage = x;\r\n                return true;\r\n            }\r\n\r\n\r\n        case \"background-image-repeat\":\r\n            var v = getIdent(v);\r\n            if (v != null) {\r\n                if (v == \"repeat\" || v == \"stretch\" || v == \"none\") {\r\n                    if (v == \"none\") {\r\n                        s.backgroundImageRepeat = null;\r\n                    } else {\r\n                        s.backgroundImageRepeat = v;\r\n                    }\r\n                    return true;\r\n                }\r\n            }\r\n\r\n\r\n        case \"background-image-clip-top\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.backgroundImageClipTop = i; return true; }\r\n        case \"background-image-clip-left\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.backgroundImageClipLeft = i; return true; }\r\n        case \"background-image-clip-bottom\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.backgroundImageClipBottom = i; return true; }\r\n        case \"background-image-clip-right\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.backgroundImageClipRight = i; return true; }\r\n        case \"background-image-clip\":\r\n            if (applyComposite([\"background-image-clip-top\",\r\n                                \"background-image-clip-left\",\r\n                                \"background-image-clip-bottom\",\r\n                                \"background-image-clip-right\"], v, s) )\r\n                return true;\r\n            if( getIdent(v) == \"none\" ) {\r\n                s.backgroundImageClipTop = null;\r\n                s.backgroundImageClipLeft = null;\r\n                s.backgroundImageClipBottom = null;\r\n                s.backgroundImageClipRight = null;\r\n                return true;\r\n            }\r\n\r\n\r\n        case \"background-image-slice-top\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.backgroundImageSliceTop = i; return true; }\r\n        case \"background-image-slice-left\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.backgroundImageSliceLeft = i; return true; }\r\n        case \"background-image-slice-bottom\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.backgroundImageSliceBottom = i; return true; }\r\n        case \"background-image-slice-right\":\r\n            var i = getVal(v);\r\n            if( i != null ) { s.backgroundImageSliceRight = i; return true; }\r\n        case \"background-image-slice\":\r\n            if (applyComposite([\"background-image-slice-top\",\r\n                                \"background-image-slice-left\",\r\n                                \"background-image-slice-bottom\",\r\n                                \"background-image-slice-right\"], v, s) )\r\n                return true;\r\n            if( getIdent(v) == \"none\" ) {\r\n                s.backgroundImageSliceTop = null;\r\n                s.backgroundImageSliceLeft = null;\r\n                s.backgroundImageSliceBottom = null;\r\n                s.backgroundImageSliceRight = null;\r\n                return true;\r\n            }\r\n\r\n        /*\r\n        case \"background\":\r\n            return applyComposite([\"background-color\"], v, s);\r\n        case \"font-family\":\r\n            var l = getFontName(v);\r\n            if( l != null ) {\r\n                s.fontName = l;\r\n                return true;\r\n            }\r\n        case \"font-size\":\r\n            var i = getUnit(v);\r\n            if( i != null ) {\r\n                switch( i ) {\r\n                case Pix(v):\r\n                    s.fontSize = v;\r\n                default:\r\n                    notImplemented();\r\n                }\r\n                return true;\r\n            }\r\n        */\r\n        case \"color\":\r\n            if (getIdent(v) == \"none\") {\r\n                s.color = MathUtil.MIN_INT;\r\n                return true;\r\n            }\r\n            var c = getCol(v);\r\n            if( c != null ) {\r\n                s.color = c;\r\n                return true;\r\n            }\r\n        case \"border-radius\":\r\n            if (getIdent(v) == \"none\") {\r\n                s.borderRadius = MathUtil.MIN_INT;\r\n                return true;\r\n            }\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.borderRadius = i;\r\n                return true;\r\n            }\r\n        case \"border\":\r\n            if( applyComposite([\"border-width\", \"border-style\", \"border-color\"], v, s) )\r\n                return true;\r\n            if (getIdent(v) == \"none\" ) {\r\n                /*\r\n                s.borderSize = 0;\r\n                s.borderColor = null;// Transparent;\r\n                */\r\n                s.borderTopSize = MathUtil.MIN_INT;\r\n                s.borderLeftSize = MathUtil.MIN_INT;\r\n                s.borderBottomSize = MathUtil.MIN_INT;\r\n                s.borderRightSize = MathUtil.MIN_INT;\r\n                s.borderTopColor = MathUtil.MIN_INT;// Transparent;\r\n                s.borderLeftColor = MathUtil.MIN_INT;// Transparent;\r\n                s.borderBottomColor = MathUtil.MIN_INT;// Transparent;\r\n                s.borderRightColor = MathUtil.MIN_INT;// Transparent;\r\n                return true;\r\n            }\r\n        case \"border-width\" | \"border-size\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n//              s.borderSize = i;\r\n                s.borderTopSize = i;\r\n                s.borderLeftSize = i;\r\n                s.borderBottomSize = i;\r\n                s.borderRightSize = i;\r\n                return true;\r\n            }\r\n        case \"border-top-width\" | \"border-top-size\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.borderTopSize = i;\r\n                return true;\r\n            }\r\n        case \"border-left-width\" | \"border-left-size\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.borderLeftSize = i;\r\n                return true;\r\n            }\r\n        case \"border-bottom-width\" | \"border-bottom-size\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.borderBottomSize = i;\r\n                return true;\r\n            }\r\n        case \"border-right-width\" | \"border-right-size\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.borderRightSize = i;\r\n                return true;\r\n            }\r\n        case \"border-style\":\r\n            if( getIdent(v) == \"solid\" )\r\n                return true;\r\n        case \"border-color\":\r\n            var c = getCol(v);\r\n            //var c = getFill(v);\r\n            if( c != null ) {\r\n                s.borderTopColor = c;\r\n                s.borderLeftColor = c;\r\n                s.borderBottomColor = c;\r\n                s.borderRightColor = c;\r\n                return true;\r\n            }\r\n        case \"border-top-color\":\r\n            var c = getCol(v);\r\n            //var c = getFill(v);\r\n            if( c != null ) {\r\n                s.borderTopColor = c;\r\n                return true;\r\n            }\r\n        case \"border-left-color\":\r\n            var c = getCol(v);\r\n            //var c = getFill(v);\r\n            if( c != null ) {\r\n                s.borderLeftColor = c;\r\n                return true;\r\n            }\r\n        case \"border-bottom-color\":\r\n            var c = getCol(v);\r\n            //var c = getFill(v);\r\n            if( c != null ) {\r\n                s.borderBottomColor = c;\r\n                return true;\r\n            }\r\n        case \"border-right-color\":\r\n            var c = getCol(v);\r\n            //var c = getFill(v);\r\n            if( c != null ) {\r\n                s.borderRightColor = c;\r\n                return true;\r\n            }\r\n        /*\r\n        case \"autosize-width\":\r\n            var v = getBool(v);\r\n            if (v != null) {\r\n                s.autoSizeWidth = v;\r\n                return true;\r\n            }\r\n        case \"autosize-height\":\r\n            var v = getBool(v);\r\n            if (v != null) {\r\n                s.autoSizeHeight = v;\r\n                return true;\r\n            }\r\n        case \"autosize\":\r\n            var v = getIdent(v);\r\n            if (v != null) {\r\n                if (v == \"horizontal\" || v == \"width\") {\r\n                    s.autoSizeWidth = true;\r\n                    s.autoSizeHeight = false;\r\n                } else if (v == \"vertical\" || v == \"height\") {\r\n                    s.autoSizeWidth = false;\r\n                    s.autoSizeHeight = true;\r\n                } else if (v == \"both\" || v == \"true\" || v == \"yes\") {\r\n                    s.autoSizeWidth = true;\r\n                    s.autoSizeHeight = true;\r\n                } else {\r\n                    return false;\r\n                }\r\n                return true;\r\n            }\r\n        */\r\n        case \"cursor\":\r\n            var v = getIdent(v);\r\n            if (v != null) {\r\n                if (v == \"pointer\" || v == \"default\") {\r\n                    s.cursor = v;\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n        case \"filter\":\r\n            var arr = getCall(v);\r\n            if (arr != null) {\r\n                s.filter = arr;\r\n                return true;\r\n            } else {\r\n                var i = getIdent(v);\r\n                if (i != null) {\r\n                    if (i == \"none\") {\r\n                        s.filter = [\"none\"];\r\n                    } else {\r\n                        s.filter = [i];\r\n                    }\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        case \"spacing\":\r\n            return applyComposite([\"vertical-spacing\", \"horizontal-spacing\"], v, s);\r\n        case \"horizontal-spacing\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.horizontalSpacing = i;\r\n                return true;\r\n            }\r\n        case \"vertical-spacing\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.verticalSpacing = i;\r\n                return true;\r\n            }\r\n        case \"icon-position\":\r\n            var x = getIdent(v);\r\n            switch(x) {\r\n            case \"top\" | \"left\" | \"bottom\" | \"right\":\r\n                s.iconPosition = x;\r\n                return true;\r\n            default:\r\n            }\r\n        case \"icon\":\r\n            var x = getString(v);\r\n            if (getIdent(v) == \"none\") {\r\n                s.icon = null;\r\n                return true;\r\n            }\r\n            if (x != null) {\r\n                s.icon = x;\r\n                return true;\r\n            }\r\n        case \"hidden\":\r\n            var b = getBool(v);\r\n            if (b != null) {\r\n                s.hidden = b;\r\n                return true;\r\n            }\r\n        case \"clip\":\r\n            var b = getBool(v);\r\n            if (b != null) {\r\n                s.clip = b;\r\n                return true;\r\n            }\r\n        case \"native\":\r\n            var b = getBool(v);\r\n            if (b != null) {\r\n                s.native = b;\r\n                return true;\r\n            }\r\n        case \"horizontal-align\":\r\n            var x = getIdent(v);\r\n            switch(x) {\r\n            case \"left\" | \"right\" | \"center\":\r\n                s.horizontalAlign = x;\r\n                return true;\r\n            default:\r\n            }\r\n        case \"vertical-align\":\r\n            var x = getIdent(v);\r\n            switch(x) {\r\n            case \"top\" | \"bottom\" | \"center\":\r\n                s.verticalAlign = x;\r\n                return true;\r\n            default:\r\n            }\r\n        case \"opacity\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.opacity = i;\r\n                return true;\r\n            }\r\n\r\n        case \"offset\":\r\n            return applyComposite([\"offset-left\", \"offset-top\"], v, s);\r\n        case \"offset-left\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.offsetLeft = i;\r\n                return true;\r\n            }\r\n        case \"offset-top\":\r\n            var i = getVal(v);\r\n            if ( i != null ) {\r\n                s.offsetTop = i;\r\n                return true;\r\n            }\r\n\r\n\r\n        case \"font\":\r\n            return applyComposite([\"font-name\", \"font-size\", \"font-style\"], v, s);\r\n        case \"font-name\":\r\n            var x = getString(v);\r\n            if (x != null) {\r\n                s.fontName = x;\r\n                return true;\r\n            }\r\n        case \"font-size\":\r\n            var i = getVal(v);\r\n            if ( i != null ) {\r\n                s.fontSize = i;\r\n                return true;\r\n            }\r\n        case \"font-style\":\r\n            var x = getIdent(v);\r\n            if (x == \"bold\") {\r\n                s.fontBold = true;\r\n            }\r\n            return true;\r\n        /*\r\n        case \"layout\":\r\n            var i = mapIdent(v, [Horizontal, Vertical, Absolute, Dock, Inline]);\r\n            if( i != null ) {\r\n                s.layout = i;\r\n                return true;\r\n            }\r\n        case \"spacing\":\r\n            return applyComposite([\"vertical-spacing\", \"horizontal-spacing\"], v, s);\r\n        case \"horizontal-spacing\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.horizontalSpacing = i;\r\n                return true;\r\n            }\r\n        case \"vertical-spacing\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.verticalSpacing = i;\r\n                return true;\r\n            }\r\n        case \"increment\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.increment = i;\r\n                return true;\r\n            }\r\n        case \"max-increment\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.maxIncrement = i;\r\n                return true;\r\n            }\r\n        case \"tick-color\":\r\n            var i = getFill(v);\r\n            if( i != null ) {\r\n                s.tickColor = i;\r\n                return true;\r\n            }\r\n        case \"tick-spacing\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.tickSpacing = i;\r\n                return true;\r\n            }\r\n        case \"dock\":\r\n            var i = mapIdent(v, [Top, Bottom, Left, Right, Full]);\r\n            if( i != null ) {\r\n                s.dock = i;\r\n                return true;\r\n            }\r\n        case \"cursor-color\":\r\n            var i = getColAlpha(v);\r\n            if( i != null ) {\r\n                s.cursorColor = i;\r\n                return true;\r\n            }\r\n        case \"selection-color\":\r\n            var i = getColAlpha(v);\r\n            if( i != null ) {\r\n                s.selectionColor = i;\r\n                return true;\r\n            }\r\n        case \"overflow\":\r\n            switch( getIdent(v) ) {\r\n            case \"hidden\":\r\n                s.overflowHidden = true;\r\n                return true;\r\n            case \"visible\":\r\n                s.overflowHidden = false;\r\n                return true;\r\n            }\r\n        case \"icon\":\r\n            var i = getImage(v);\r\n            if( i != null ) {\r\n                s.icon = i;\r\n                return true;\r\n            }\r\n        case \"icon-color\":\r\n            var c = getColAlpha(v);\r\n            if( c != null ) {\r\n                s.iconColor = c;\r\n                return true;\r\n            }\r\n        case \"icon-left\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.iconLeft = i;\r\n                return true;\r\n            }\r\n        case \"icon-top\":\r\n            var i = getVal(v);\r\n            if( i != null ) {\r\n                s.iconTop = i;\r\n                return true;\r\n            }\r\n        case \"position\":\r\n            switch( getIdent(v) ) {\r\n            case \"absolute\":\r\n                s.positionAbsolute = true;\r\n                return true;\r\n            case \"relative\":\r\n                s.positionAbsolute = false;\r\n                return true;\r\n            default:\r\n            }\r\n        case \"text-align\":\r\n            switch( getIdent(v) ) {\r\n            case \"left\":\r\n                s.textAlign = Left;\r\n                return true;\r\n            case \"right\":\r\n                s.textAlign = Right;\r\n                return true;\r\n            case \"center\":\r\n                s.textAlign = Center;\r\n                return true;\r\n            default:\r\n            }\r\n        case \"display\":\r\n            switch( getIdent(v) ) {\r\n            case \"none\":\r\n                s.display = false;\r\n                return true;\r\n            case \"block\", \"inline-block\":\r\n                s.display = true;\r\n                return true;\r\n            default:\r\n            }\r\n            */\r\n        default:\r\n            //throw \"Not implemented '\" + r + \"' = \" + valueStr(v);\r\n            #if debug\r\n            trace(\"WARNING: Not implemented '\" + r + \"' = \" + valueStr(v));\r\n            #end\r\n        }\r\n        return false;\r\n    }\r\n\r\n    function applyComposite( names : Array<String>, v : Value, s : Style ) {\r\n        var vl = switch( v ) {\r\n        case VGroup(l): l;\r\n        default: [v];\r\n        };\r\n\r\n        if (names.length > vl.length) {\r\n            var last = vl[vl.length - 1];\r\n            for (i in 0...(names.length - vl.length)) {\r\n                vl.push(last);\r\n            }\r\n        }\r\n\r\n        while( vl.length > 0 ) {\r\n            var found = false;\r\n            for( n in names ) {\r\n                var count = 1;\r\n                if( count > vl.length ) count = vl.length;\r\n                while( count > 0 ) {\r\n                    var v = (count == 1) ? vl[0] : VGroup(vl.slice(0, count));\r\n                    if( applyStyle(n, v, s) ) {\r\n                        found = true;\r\n                        names.remove(n);\r\n                        for( i in 0...count )\r\n                            vl.shift();\r\n                        break;\r\n                    }\r\n                    count--;\r\n                }\r\n                if( found ) break;\r\n            }\r\n            if( !found )\r\n                return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    function getGroup<T>( v : Value, f : Value -> Null<T> ) : Null<Array<T>> {\r\n        switch(v) {\r\n        case VGroup(l):\r\n            var a = [];\r\n            for( v in l ) {\r\n                var v = f(v);\r\n                if( v == null ) return null;\r\n                a.push(v);\r\n            }\r\n            return a;\r\n        default:\r\n            var v = f(v);\r\n            return (v == null) ? null : [v];\r\n        }\r\n    }\r\n\r\n    function getList<T>( v : Value, f : Value -> Null<T> ) : Null<Array<T>> {\r\n        switch(v) {\r\n        case VList(l):\r\n            var a = [];\r\n            for( v in l ) {\r\n                var v = f(v);\r\n                if( v == null ) return null;\r\n                a.push(v);\r\n            }\r\n            return a;\r\n        default:\r\n            var v = f(v);\r\n            return (v == null) ? null : [v];\r\n        }\r\n    }\r\n\r\n    function getInt( v : Value ) : Null<Int> {\r\n        return switch( v ) {\r\n        case VUnit(f, u):\r\n            switch( u ) {\r\n            case \"px\": Std.int(f);\r\n            case \"pt\": Std.int(f * 4 / 3);\r\n            default: null;\r\n            }\r\n        case VInt(v):\r\n            Std.int(v);\r\n        default:\r\n            null;\r\n        };\r\n    }\r\n\r\n    function getBool( v : Value ) : Null<Bool> {\r\n        return switch( v ) {\r\n        case VInt(v):\r\n            Std.int(v) == 1;\r\n        case VIdent(v):\r\n            v == \"true\" || v == \"yes\";\r\n        default:\r\n            null;\r\n        };\r\n    }\r\n\r\n    function getString( v : Value ) : Null<String> {\r\n        return switch( v ) {\r\n        case VString(v):\r\n            v;\r\n        default:\r\n            null;\r\n        };\r\n    }\r\n\r\n    function getCall( v : Value ) : Array<Dynamic> {\r\n        return switch( v ) {\r\n        case VCall(v, params):\r\n            var arr:Array<Dynamic> = new Array<Dynamic>();\r\n            arr.push(v);\r\n            for (p in params) {\r\n                var c = getCol(p);\r\n                if (c != null) {\r\n                    arr.push(c);\r\n                } else {\r\n                    switch (p) {\r\n                        case VInt(x):\r\n                            arr.push(x);\r\n                        case VFloat(x):\r\n                            arr.push(x);\r\n                        case VIdent(x):\r\n                            if (x == \"true\") {\r\n                                arr.push(true);\r\n                            } else if (x == \"false\") {\r\n                                arr.push(false);\r\n                            } else {\r\n                                arr.push(x);\r\n                            }\r\n                        default:\r\n                    }\r\n                }\r\n            }\r\n            arr;\r\n        default:\r\n            null;\r\n        };\r\n    }\r\n\r\n    function getVal( v : Value ) : Null<Float> {\r\n        return switch( v ) {\r\n        case VUnit(f, u):\r\n            switch( u ) {\r\n            case \"px\": f;\r\n            case \"pt\": f * 4 / 3;\r\n            default: null;\r\n            }\r\n        case VInt(v):\r\n            v;\r\n        case VFloat(v):\r\n            v;\r\n        default:\r\n            null;\r\n        };\r\n    }\r\n\r\n    function getUnit( v : Value ) : Null<Unit> {\r\n        return switch( v ) {\r\n        case VUnit(f, u):\r\n            switch( u ) {\r\n            case \"px\": Pix(f);\r\n            case \"pt\": Pix(f * 4 / 3);\r\n            case \"%\": Percent(f / 100);\r\n            default: null;\r\n            }\r\n        case VInt(v):\r\n            Pix(v);\r\n        case VFloat(v):\r\n            Pix(v);\r\n        default:\r\n            null;\r\n        };\r\n    }\r\n\r\n    function mapIdent<T:EnumValue>( v : Value, vals : Array<T> ) : T {\r\n        var i = getIdent(v);\r\n        if( i == null ) return null;\r\n        for( v in vals )\r\n            if( v.getName().toLowerCase() == i )\r\n                return v;\r\n        return null;\r\n    }\r\n\r\n    function getIdent( v : Value ) : Null<String> {\r\n        return switch( v ) {\r\n        case VIdent(v): v;\r\n        default: null;\r\n        };\r\n    }\r\n\r\n    function getColAlpha( v : Value ) {\r\n        var c = getCol(v);\r\n        if( c != null && c >>> 24 == 0 )\r\n            c |= 0xFF000000;\r\n        return c;\r\n    }\r\n\r\n    function getFill( v : Value ) {\r\n        var c = getColAlpha(v);\r\n        if( c != null )\r\n            return Color(c);\r\n        switch( v ) {\r\n        case VCall(\"gradient\", [a, b, c, d]):\r\n            var ca = getColAlpha(a);\r\n            var cb = getColAlpha(b);\r\n            var cc = getColAlpha(c);\r\n            var cd = getColAlpha(d);\r\n            if( ca != null && cb != null && cc != null && cd != null )\r\n                return Gradient(ca, cb, cc, cd);\r\n        case VIdent(\"transparent\"):\r\n            return Transparent;\r\n        default:\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function getCol( v : Value ) : Null<Int> {\r\n        return switch( v ) {\r\n        case VHex(v):\r\n            (v.length == 6) ? Std.parseInt(\"0x\" + v) : ((v.length == 3) ? Std.parseInt(\"0x\"+v.charAt(0)+v.charAt(0)+v.charAt(1)+v.charAt(1)+v.charAt(2)+v.charAt(2)) : null);\r\n        case VIdent(i):\r\n            switch( i ) {\r\n            case \"black\":   0x000000;\r\n            case \"red\":     0xFF0000;\r\n            case \"lime\":    0x00FF00;\r\n            case \"blue\":    0x0000FF;\r\n            case \"white\":   0xFFFFFF;\r\n            case \"aqua\":    0x00FFFF;\r\n            case \"fuchsia\": 0xFF00FF;\r\n            case \"yellow\":  0xFFFF00;\r\n            case \"maroon\":  0x800000;\r\n            case \"green\":   0x008000;\r\n            case \"navy\":    0x000080;\r\n            case \"olive\":   0x808000;\r\n            case \"purple\":  0x800080;\r\n            case \"teal\":    0x008080;\r\n            case \"silver\":  0xC0C0C0;\r\n            case \"gray\", \"grey\": 0x808080;\r\n            default: null;\r\n            }\r\n        case VCall(\"rgba\", [r, g, b, a]):\r\n            var r = getVal(r), g = getVal(g), b = getVal(b), a = getVal(a);\r\n            inline function conv(k:Float) {\r\n                var v = Std.int(k * 255);\r\n                if( v < 0 ) v = 0;\r\n                if( v > 255 ) v = 255;\r\n                return v;\r\n            }\r\n            inline function check(k:Float) {\r\n                var v = Std.int(k);\r\n                if( v < 0 ) v = 0;\r\n                if( v > 255 ) v = 255;\r\n                return v;\r\n            }\r\n            if( r != null && g != null && b != null && a != null ) {\r\n                var a = conv(a); if( a == 0 ) a = 1; // prevent setting alpha to FF afterwards\r\n                (a << 24) | (check(r) << 16) | (check(g) << 8) | check(b);\r\n            }\r\n            else\r\n                null;\r\n        default:\r\n            null;\r\n        };\r\n    }\r\n\r\n    function getFontName( v : Value ) {\r\n        return switch( v ) {\r\n        case VString(s): s;\r\n        case VGroup(_):\r\n            var g = getGroup(v, getIdent);\r\n            if( g == null ) null else g.join(\" \");\r\n        case VIdent(i): i;\r\n        default: null;\r\n        };\r\n    }\r\n\r\n    /*\r\n    function getImage( v : Value ) {\r\n        switch( v ) {\r\n        case VCall(\"url\", [VString(url)]):\r\n            if( !StringTools.startsWith(url, \"data:image/png;base64,\") )\r\n                return null;\r\n            url = url.substr(22);\r\n            if( StringTools.endsWith(url, \"=\") ) url = url.substr(0, -1);\r\n            var bytes = haxe.crypto.Base64.decode(url);\r\n            return hxd.res.Any.fromBytes(\"icon\",bytes).toImage().getPixels();\r\n        default:\r\n            return null;\r\n        }\r\n    }\r\n    */\r\n\r\n    // ---------------------- generic parsing --------------------\r\n\r\n    function unexpected( t : Token ) : Dynamic {\r\n        //throw \"Unexpected \" + Std.string(t);\r\n        return null;\r\n    }\r\n\r\n    function expect( t : Token ) {\r\n        var tk = readToken();\r\n        if( tk != t ) unexpected(tk);\r\n    }\r\n\r\n    inline function push( t : Token ) {\r\n        tokens.push(t);\r\n    }\r\n\r\n    function isToken(t) {\r\n        var tk = readToken();\r\n        if( tk == t ) return true;\r\n        push(tk);\r\n        return false;\r\n    }\r\n\r\n    public function parse( css : String, s : Style ) {\r\n        this.css = css;\r\n        this.s = s;\r\n        pos = 0;\r\n        tokens = [];\r\n        parseStyle(TEof);\r\n    }\r\n\r\n    function valueStr(v) {\r\n        return switch( v ) {\r\n        case VIdent(i): i;\r\n        case VString(s): '\"' + s + '\"';\r\n        case VUnit(f, unit): f + unit;\r\n        case VFloat(f): Std.string(f);\r\n        case VInt(v): Std.string(v);\r\n        case VHex(v): \"#\" + v;\r\n        case VList(l):\r\n            [for( v in l ) valueStr(v)].join(\", \");\r\n        case VGroup(l):\r\n            [for( v in l ) valueStr(v)].join(\" \");\r\n        case VCall(f,args): f+\"(\" + [for( v in args ) valueStr(v)].join(\", \") + \")\";\r\n        case VLabel(label, v): valueStr(v) + \" !\" + label;\r\n        case VSlash: \"/\";\r\n        }\r\n    }\r\n\r\n    function parseStyle( eof ) {\r\n        while( true ) {\r\n            if( isToken(eof) )\r\n                break;\r\n            var r = readIdent();\r\n            if (r == null) {\r\n                break;\r\n            }\r\n            expect(TDblDot);\r\n            var v = readValue();\r\n            if (v == null) {\r\n                break;\r\n            }\r\n            var s = this.s;\r\n            switch( v ) {\r\n            case VLabel(label, val):\r\n                if( label == \"important\" ) {\r\n                    v = val;\r\n                    if( simp == null ) simp = new Style();\r\n                    s = simp;\r\n                }\r\n            default:\r\n            }\r\n            if( !applyStyle(r, v, s) )\r\n                //throw \"Invalid value \" + valueStr(v) + \" for css \" + r;\r\n                #if debug\r\n                trace(\"Invalid value \" + valueStr(v) + \" for css \" + r);\r\n                #end\r\n            if( isToken(eof) )\r\n                break;\r\n            expect(TSemicolon);\r\n        }\r\n    }\r\n\r\n    public function parseRules( css : String ) {\r\n        this.css = css;\r\n        pos = 0;\r\n        tokens = [];\r\n        var rules = [];\r\n        while( true ) {\r\n            if( isToken(TEof) )\r\n                break;\r\n            var classes = readClasses();\r\n            expect(TBrOpen);\r\n            this.s = new Style();\r\n            this.simp = null;\r\n            parseStyle(TBrClose);\r\n            for( c in classes )\r\n                rules.push( { c : c, s : s, imp : false } );\r\n            if( this.simp != null )\r\n                for( c in classes )\r\n                    rules.push( { c : c, s : simp, imp : true } );\r\n        }\r\n        return rules;\r\n    }\r\n\r\n    public function parseClasses( css : String ) {\r\n        this.css = css;\r\n        pos = 0;\r\n        tokens = [];\r\n        var c = readClasses();\r\n        expect(TEof);\r\n        return c;\r\n    }\r\n\r\n    // ----------------- class parser ---------------------------\r\n\r\n    function readClasses() {\r\n        var classes = [];\r\n        while( true ) {\r\n            spacesTokens = true;\r\n            isToken(TSpaces); // skip\r\n            var c = readClass(null);\r\n            spacesTokens = false;\r\n            if( c == null ) break;\r\n            updateClass(c);\r\n            classes.push(c);\r\n            if( !isToken(TComma) )\r\n                break;\r\n        }\r\n        if( classes.length == 0 )\r\n            unexpected(readToken());\r\n        return classes;\r\n    }\r\n\r\n    function updateClass( c : CssClass ) {\r\n        // map html types to comp ones\r\n        switch( c.node ) {\r\n        case \"div\": c.node = \"box\";\r\n        case \"span\": c.node = \"label\";\r\n        case \"h1\", \"h2\", \"h3\", \"h4\":\r\n            c.pseudoClass = c.node;\r\n            c.node = \"label\";\r\n        }\r\n        if( c.parent != null ) updateClass(c.parent);\r\n    }\r\n\r\n    function readClass( parent ) : CssClass {\r\n        var c = new CssClass();\r\n        c.parent = parent;\r\n        var def = false;\r\n        var last = null;\r\n        while( true ) {\r\n            var t = readToken();\r\n            if( last == null )\r\n                switch( t ) {\r\n                case TStar: def = true;\r\n                case TDot, TSharp, TDblDot: last = t;\r\n                case TIdent(i): c.node = i; def = true;\r\n                case TSpaces:\r\n                    return def ? readClass(c) : null;\r\n                case TBrOpen, TComma, TEof:\r\n                    push(t);\r\n                    break;\r\n                default:\r\n                    unexpected(t);\r\n                }\r\n            else\r\n                switch( t ) {\r\n                case TIdent(i):\r\n                    switch( last ) {\r\n                    case TDot: c.className = i; def = true;\r\n                    case TSharp: c.id = i; def = true;\r\n                    case TDblDot: c.pseudoClass = i; def = true;\r\n                    default: throw \"assert\";\r\n                    }\r\n                    last = null;\r\n                default:\r\n                    unexpected(t);\r\n                }\r\n        }\r\n        return def ? c : parent;\r\n    }\r\n\r\n    // ----------------- value parser ---------------------------\r\n\r\n    function readIdent() {\r\n        var t = readToken();\r\n        return switch( t ) {\r\n        case TIdent(i): i;\r\n        default: unexpected(t);\r\n        }\r\n    }\r\n\r\n    function readValue(?opt)  : Value {\r\n        var t = readToken();\r\n        var v = switch( t ) {\r\n        case TSharp:\r\n            VHex(readHex());\r\n        case TIdent(i):\r\n            VIdent(i);\r\n        case TString(s):\r\n            VString(s);\r\n        case TInt(i):\r\n            readValueUnit(i, i);\r\n        case TFloat(f):\r\n            readValueUnit(f, null);\r\n        case TSlash:\r\n            VSlash;\r\n        default:\r\n            if( !opt ) unexpected(t);\r\n            push(t);\r\n            null;\r\n        };\r\n        if( v != null ) v = readValueNext(v);\r\n        return v;\r\n    }\r\n\r\n    function readHex() {\r\n        var start = pos;\r\n        while( true ) {\r\n            var c = next();\r\n            if( (c >= \"A\".code && c <= \"F\".code) || (c >= \"a\".code && c <= \"f\".code) || (c >= \"0\".code && c <= \"9\".code) )\r\n                continue;\r\n            pos--;\r\n            break;\r\n        }\r\n        return css.substr(start, pos - start);\r\n    }\r\n\r\n    function readValueUnit( f : Float, ?i : Int ) {\r\n        var t = readToken();\r\n        return switch( t ) {\r\n        case TIdent(i):\r\n            VUnit(f, i);\r\n        case TPercent:\r\n            VUnit(f, \"%\");\r\n        default:\r\n            push(t);\r\n            if( i != null )\r\n                VInt(i);\r\n            else\r\n                VFloat(f);\r\n        };\r\n    }\r\n\r\n    function readValueNext( v : Value ) : Value {\r\n        var t = readToken();\r\n        return switch( t ) {\r\n        case TPOpen:\r\n            switch( v ) {\r\n            case VIdent(i):\r\n                switch( i ) {\r\n                case \"url\":\r\n                    readValueNext(VCall(\"url\",[VString(readUrl())]));\r\n                default:\r\n                    var args = switch( readValue() ) {\r\n                    case VList(l): l;\r\n                    case x: [x];\r\n                    }\r\n                    expect(TPClose);\r\n                    readValueNext(VCall(i, args));\r\n                }\r\n            default:\r\n                push(t);\r\n                v;\r\n            }\r\n        case TExclam:\r\n            var t = readToken();\r\n            switch( t ) {\r\n            case TIdent(i):\r\n                VLabel(i, v);\r\n            default:\r\n                unexpected(t);\r\n            }\r\n        case TComma:\r\n            loopComma(v, readValue());\r\n        default:\r\n            push(t);\r\n            var v2 = readValue(true);\r\n            if( v2 == null )\r\n                v;\r\n            else\r\n                loopNext(v, v2);\r\n        }\r\n    }\r\n\r\n    function loopNext(v, v2) {\r\n        return switch( v2 ) {\r\n        case VGroup(l):\r\n            l.unshift(v);\r\n            v2;\r\n        case VList(l):\r\n            l[0] = loopNext(v, l[0]);\r\n            v2;\r\n        case VLabel(lab, v2):\r\n            VLabel(lab, loopNext(v, v2));\r\n        default:\r\n            VGroup([v, v2]);\r\n        };\r\n    }\r\n\r\n    function loopComma(v,v2) {\r\n        return switch( v2 ) {\r\n        case VList(l):\r\n            l.unshift(v);\r\n            v2;\r\n        case VLabel(lab, v2):\r\n            VLabel(lab, loopComma(v, v2));\r\n        default:\r\n            VList([v, v2]);\r\n        };\r\n    }\r\n\r\n    // ----------------- lexer -----------------------\r\n\r\n    inline function isSpace(c) {\r\n        return (c == \" \".code || c == \"\\n\".code || c == \"\\r\".code || c == \"\\t\".code);\r\n    }\r\n\r\n    inline function isIdentChar(c) {\r\n        return (c >= \"a\".code && c <= \"z\".code) || (c >= \"A\".code && c <= \"Z\".code) || (c == \"-\".code) || (c == \"_\".code);\r\n    }\r\n\r\n    inline function isNum(c) {\r\n        return c >= \"0\".code && c <= \"9\".code;\r\n    }\r\n\r\n    inline function next() {\r\n        return StringTools.fastCodeAt(css, pos++);\r\n    }\r\n\r\n    function readUrl() {\r\n        var c0 = next();\r\n        while( isSpace(c0) )\r\n            c0 = next();\r\n        var quote = c0;\r\n        if( quote == \"'\".code || quote == '\"'.code ) {\r\n            pos--;\r\n            switch( readToken() ) {\r\n            case TString(s):\r\n                var c0 = next();\r\n                while( isSpace(c0) )\r\n                    c0 = next();\r\n                if( c0 != \")\".code )\r\n                    throw \"Invalid char \" + String.fromCharCode(c0);\r\n                return s;\r\n            default: throw \"assert\";\r\n            }\r\n\r\n        }\r\n        var start = pos - 1;\r\n        while( true ) {\r\n            if( StringTools.isEof(c0) )\r\n                break;\r\n            c0 = next();\r\n            if( c0 == \")\".code ) break;\r\n        }\r\n        return StringTools.trim(css.substr(start, pos - start - 1));\r\n    }\r\n\r\n    #if false\r\n    function readToken( ?pos : haxe.PosInfos ) {\r\n        var t = _readToken();\r\n        haxe.Log.trace(t, pos);\r\n        return t;\r\n    }\r\n\r\n    function _readToken() {\r\n    #else\r\n    function readToken() {\r\n    #end\r\n        var t = tokens.pop();\r\n        if( t != null )\r\n            return t;\r\n        while( true ) {\r\n            var c = next();\r\n            if( StringTools.isEof(c) )\r\n                return TEof;\r\n            if( isSpace(c) ) {\r\n                if( spacesTokens ) {\r\n                    while( isSpace(next()) ) {\r\n                    }\r\n                    pos--;\r\n                    return TSpaces;\r\n                }\r\n\r\n                continue;\r\n            }\r\n            if( isNum(c) || c == '-'.code ) {\r\n                var i = 0, neg = false;\r\n                if( c == '-'.code ) { c = \"0\".code; neg = true; }\r\n                do {\r\n                    i = i * 10 + (c - \"0\".code);\r\n                    c = next();\r\n                } while( isNum(c) );\r\n                if( c == \".\".code ) {\r\n                    var f : Float = i;\r\n                    var k = 0.1;\r\n                    while( isNum(c = next()) ) {\r\n                        f += (c - \"0\".code) * k;\r\n                        k *= 0.1;\r\n                    }\r\n                    pos--;\r\n                    return TFloat(neg? -f : f);\r\n                }\r\n                pos--;\r\n                return TInt(neg ? -i : i);\r\n            }\r\n            if( isIdentChar(c) ) {\r\n                var pos = pos - 1;\r\n                do c = next() while( isIdentChar(c) || isNum(c) );\r\n                this.pos--;\r\n                return TIdent(css.substr(pos,this.pos - pos));\r\n            }\r\n            switch( c ) {\r\n            case \":\".code: return TDblDot;\r\n            case \"#\".code: return TSharp;\r\n            case \"(\".code: return TPOpen;\r\n            case \")\".code: return TPClose;\r\n            case \"!\".code: return TExclam;\r\n            case \"%\".code: return TPercent;\r\n            case \";\".code: return TSemicolon;\r\n            case \".\".code: return TDot;\r\n            case \"{\".code: return TBrOpen;\r\n            case \"}\".code: return TBrClose;\r\n            case \",\".code: return TComma;\r\n            case \"*\".code: return TStar;\r\n            case \"/\".code:\r\n                if( (c = next()) != '*'.code ) {\r\n                    pos--;\r\n                    return TSlash;\r\n                }\r\n                while( true ) {\r\n                    while( (c = next()) != '*'.code ) {\r\n                        if( StringTools.isEof(c) )\r\n                            throw \"Unclosed comment\";\r\n                    }\r\n                    c = next();\r\n                    if( c == \"/\".code ) break;\r\n                    if( StringTools.isEof(c) )\r\n                        throw \"Unclosed comment\";\r\n                }\r\n                return readToken();\r\n            case \"'\".code, '\"'.code:\r\n                var pos = pos;\r\n                var k;\r\n                while( (k = next()) != c ) {\r\n                    if( StringTools.isEof(k) )\r\n                        throw \"Unclosed string constant\";\r\n                    if( k == \"\\\\\".code ) {\r\n                        throw \"todo\";\r\n                        continue;\r\n                    }\r\n                }\r\n                return TString(css.substr(pos, this.pos - pos - 1));\r\n            default:\r\n            }\r\n            pos--;\r\n            throw \"Invalid char \" + css.charAt(pos);\r\n        }\r\n        return null;\r\n    }\r\n\r\n}\r\n","package haxe.ui.styles;\r\nimport haxe.ui.util.MathUtil;\r\n\r\nclass Style {\r\n    public function new() {\r\n    }\r\n\r\n    @style      public var cursor:Null<String>;\r\n    @style      public var hidden:Null<Bool>;\r\n\r\n    @style      public var autoWidth:Null<Bool>;\r\n    @style      public var autoHeight:Null<Bool>;\r\n    @style      public var verticalSpacing:Null<Float>;\r\n    @style      public var horizontalSpacing:Null<Float>;\r\n\r\n    @style      public var offsetLeft:Null<Float>;\r\n    @style      public var offsetTop:Null<Float>;\r\n\r\n    @style      public var width:Null<Float>;\r\n    @style      public var height:Null<Float>;\r\n    @style      public var percentWidth:Null<Float>;\r\n    @style      public var percentHeight:Null<Float>;\r\n\r\n    @style      public var paddingTop:Null<Float>;\r\n    @style      public var paddingLeft:Null<Float>;\r\n    @style      public var paddingRight:Null<Float>;\r\n    @style      public var paddingBottom:Null<Float>;\r\n\r\n    @style      public var marginTop:Null<Float>;\r\n    @style      public var marginLeft:Null<Float>;\r\n    @style      public var marginRight:Null<Float>;\r\n    @style      public var marginBottom:Null<Float>;\r\n\r\n    @style      public var color:Null<Int>;\r\n\r\n    @style      public var backgroundColor:Null<Int>;\r\n    @style      public var backgroundColorEnd:Null<Int>;\r\n    @style      public var backgroundGradientStyle:Null<String>;\r\n    @style      public var backgroundOpacity:Null<Float>;\r\n\r\n    @style      public var backgroundImage:Null<String>;\r\n    @style      public var backgroundImageRepeat:Null<String>;\r\n\r\n    @style      public var backgroundImageClipTop:Null<Float>;\r\n    @style      public var backgroundImageClipLeft:Null<Float>;\r\n    @style      public var backgroundImageClipBottom:Null<Float>;\r\n    @style      public var backgroundImageClipRight:Null<Float>;\r\n\r\n    @style      public var backgroundImageSliceTop:Null<Float>;\r\n    @style      public var backgroundImageSliceLeft:Null<Float>;\r\n    @style      public var backgroundImageSliceBottom:Null<Float>;\r\n    @style      public var backgroundImageSliceRight:Null<Float>;\r\n\r\n    @style      public var borderColor:Null<Int>;\r\n    @style      public var borderTopColor:Null<Int>;\r\n    @style      public var borderLeftColor:Null<Int>;\r\n    @style      public var borderBottomColor:Null<Int>;\r\n    @style      public var borderRightColor:Null<Int>;\r\n    @style      public var borderSize:Null<Float>;\r\n    @style      public var borderTopSize:Null<Float>;\r\n    @style      public var borderLeftSize:Null<Float>;\r\n    @style      public var borderBottomSize:Null<Float>;\r\n    @style      public var borderRightSize:Null<Float>;\r\n    @style      public var borderRadius:Null<Float>;\r\n    @style      public var borderOpacity:Null<Float>;\r\n\r\n    @style      public var filter:Array<Dynamic>;\r\n\r\n    @style      public var icon:Null<String>;\r\n    @style      public var iconPosition:Null<String>;\r\n\r\n    @style      public var horizontalAlign:Null<String>;\r\n    @style      public var verticalAlign:Null<String>;\r\n\r\n    @style      public var opacity:Null<Float>;\r\n\r\n    @style      public var clip:Null<Bool>;\r\n    @style      public var native:Null<Bool>;\r\n\r\n    @style      public var fontName:Null<String>;\r\n    @style      public var fontSize:Null<Float>;\r\n    @style      public var fontBold:Null<Bool>;\r\n    @style      public var fontUnderline:Null<Bool>;\r\n    @style      public var fontItalic:Null<Bool>;\r\n\r\n    public function apply(s:Style) {\r\n        if (s.cursor != null) cursor = s.cursor;\r\n        if (s.hidden != null) hidden = s.hidden;\r\n\r\n        if (s.autoWidth != null) autoWidth = s.autoWidth;\r\n        if (s.autoHeight != null) autoHeight = s.autoHeight;\r\n        if (s.verticalSpacing != null) verticalSpacing = s.verticalSpacing;\r\n        if (s.horizontalSpacing != null) horizontalSpacing = s.horizontalSpacing;\r\n\r\n        if (s.offsetLeft != null) offsetLeft = s.offsetLeft;\r\n        if (s.offsetTop != null) offsetTop = s.offsetTop;\r\n\r\n        if (s.width != null) {\r\n            width = s.width;\r\n            autoWidth = false;\r\n        }\r\n        if (s.height != null) {\r\n            height = s.height;\r\n            autoHeight = false;\r\n        }\r\n        if (s.percentWidth != null) {\r\n            percentWidth = s.percentWidth;\r\n            autoWidth = false;\r\n        }\r\n        if (s.percentHeight != null) {\r\n            percentHeight = s.percentHeight;\r\n            autoHeight = false;\r\n        }\r\n\r\n        if (s.paddingTop != null) paddingTop = s.paddingTop;\r\n        if (s.paddingLeft != null) paddingLeft = s.paddingLeft;\r\n        if (s.paddingRight != null) paddingRight = s.paddingRight;\r\n        if (s.paddingBottom != null) paddingBottom = s.paddingBottom;\r\n\r\n        if (s.marginTop != null) marginTop = s.marginTop;\r\n        if (s.marginLeft != null) marginLeft = s.marginLeft;\r\n        if (s.marginRight != null) marginRight = s.marginRight;\r\n        if (s.marginBottom != null) marginBottom = s.marginBottom;\r\n\r\n        if (s.color != null) color = s.color;\r\n\r\n        if (s.backgroundColor != null) {\r\n            backgroundColor = s.backgroundColor;\r\n            backgroundColorEnd = null;\r\n        }\r\n        if (s.backgroundColorEnd != null) backgroundColorEnd = s.backgroundColorEnd;\r\n        if (s.backgroundGradientStyle != null) backgroundGradientStyle = s.backgroundGradientStyle;\r\n        if (s.backgroundOpacity != null) backgroundOpacity = s.backgroundOpacity;\r\n\r\n        if (s.backgroundImage != null) backgroundImage = s.backgroundImage;\r\n        if (s.backgroundImageRepeat != null) backgroundImageRepeat = s.backgroundImageRepeat;\r\n\r\n        if (s.backgroundImageClipTop != null) backgroundImageClipTop = s.backgroundImageClipTop;\r\n        if (s.backgroundImageClipLeft != null) backgroundImageClipLeft = s.backgroundImageClipLeft;\r\n        if (s.backgroundImageClipBottom != null) backgroundImageClipBottom = s.backgroundImageClipBottom;\r\n        if (s.backgroundImageClipRight != null) backgroundImageClipRight = s.backgroundImageClipRight;\r\n\r\n        if (s.backgroundImageSliceTop != null) backgroundImageSliceTop = s.backgroundImageSliceTop;\r\n        if (s.backgroundImageSliceLeft != null) backgroundImageSliceLeft = s.backgroundImageSliceLeft;\r\n        if (s.backgroundImageSliceBottom != null) backgroundImageSliceBottom = s.backgroundImageSliceBottom;\r\n        if (s.backgroundImageSliceRight != null) backgroundImageSliceRight = s.backgroundImageSliceRight;\r\n\r\n        if (s.borderColor != null) borderColor = s.borderColor;\r\n        if (s.borderTopColor != null) borderTopColor = s.borderTopColor;\r\n        if (s.borderLeftColor != null) borderLeftColor = s.borderLeftColor;\r\n        if (s.borderBottomColor != null) borderBottomColor = s.borderBottomColor;\r\n        if (s.borderRightColor != null) borderRightColor = s.borderRightColor;\r\n\r\n        if (s.borderSize != null) borderSize = s.borderSize;\r\n        if (s.borderTopSize != null) borderTopSize = s.borderTopSize;\r\n        if (s.borderLeftSize != null) borderLeftSize = s.borderLeftSize;\r\n        if (s.borderBottomSize != null) borderBottomSize = s.borderBottomSize;\r\n        if (s.borderRightSize != null) borderRightSize = s.borderRightSize;\r\n\r\n        if (s.borderRadius != null) borderRadius = s.borderRadius;\r\n        if (s.borderOpacity != null) borderOpacity = s.borderOpacity;\r\n\r\n        if (s.filter != null) filter = s.filter.copy();\r\n\r\n        if (s.icon != null) icon = s.icon;\r\n        if (s.iconPosition != null) iconPosition = s.iconPosition;\r\n\r\n        if (s.horizontalAlign != null) horizontalAlign = s.horizontalAlign;\r\n        if (s.verticalAlign != null) verticalAlign = s.verticalAlign;\r\n\r\n        if (s.opacity != null) opacity = s.opacity;\r\n\r\n        if (s.clip != null) clip = s.clip;\r\n        if (s.native != null) native = s.native;\r\n\r\n        if (s.fontName != null) fontName = s.fontName;\r\n        if (s.fontSize != null) fontSize = s.fontSize;\r\n        if (s.fontBold != null) fontBold = s.fontBold;\r\n        if (s.fontUnderline != null) fontUnderline = s.fontUnderline;\r\n        if (s.fontItalic != null) fontItalic = s.fontItalic;\r\n\r\n        assignNulls();\r\n    }\r\n\r\n    public function equalTo(s:Style):Bool {\r\n        if (s.cursor != cursor) return false;\r\n        if (s.hidden != hidden) return false;\r\n\r\n        if (s.autoWidth != autoWidth) return false;\r\n        if (s.autoHeight != autoHeight) return false;\r\n        if (s.verticalSpacing != verticalSpacing) return false;\r\n        if (s.horizontalSpacing != horizontalSpacing) return false;\r\n\r\n        if (s.offsetLeft != offsetLeft) return false;\r\n        if (s.offsetTop != offsetTop) return false;\r\n\r\n        if (s.width != width) return false;\r\n        if (s.height != height) return false;\r\n        if (s.percentWidth != percentWidth) return false;\r\n        if (s.percentHeight != percentHeight) return false;\r\n\r\n        if (s.paddingTop != paddingTop) return false;\r\n        if (s.paddingLeft != paddingLeft) return false;\r\n        if (s.paddingRight != paddingRight) return false;\r\n        if (s.paddingBottom != paddingBottom) return false;\r\n\r\n        if (s.marginTop != marginTop) return false;\r\n        if (s.marginLeft != marginLeft) return false;\r\n        if (s.marginRight != marginRight) return false;\r\n        if (s.marginBottom != marginBottom) return false;\r\n\r\n        if (s.color != color) return false;\r\n\r\n        if (s.backgroundColor != backgroundColor) return false;\r\n        if (s.backgroundColorEnd != backgroundColorEnd) return false;\r\n        if (s.backgroundGradientStyle != backgroundGradientStyle) return false;\r\n        if (s.backgroundOpacity != backgroundOpacity) return false;\r\n\r\n        if (s.backgroundImage != backgroundImage) return false;\r\n        if (s.backgroundImageRepeat != backgroundImageRepeat) return false;\r\n\r\n        if (s.backgroundImageClipTop != backgroundImageClipTop) return false;\r\n        if (s.backgroundImageClipLeft != backgroundImageClipLeft) return false;\r\n        if (s.backgroundImageClipBottom != backgroundImageClipBottom) return false;\r\n        if (s.backgroundImageClipRight != backgroundImageClipRight) return false;\r\n\r\n        if (s.backgroundImageSliceTop != backgroundImageSliceTop) return false;\r\n        if (s.backgroundImageSliceLeft != backgroundImageSliceLeft) return false;\r\n        if (s.backgroundImageSliceBottom != backgroundImageSliceBottom) return false;\r\n        if (s.backgroundImageSliceRight != backgroundImageSliceRight) return false;\r\n\r\n        if (s.borderColor != borderColor) return false;\r\n        if (s.borderTopColor != borderTopColor) return false;\r\n        if (s.borderLeftColor != borderLeftColor) return false;\r\n        if (s.borderBottomColor != borderBottomColor) return false;\r\n        if (s.borderRightColor != borderRightColor) return false;\r\n\r\n        if (s.borderSize != borderSize) return false;\r\n        if (s.borderTopSize != borderTopSize) return false;\r\n        if (s.borderLeftSize != borderLeftSize) return false;\r\n        if (s.borderBottomSize != borderBottomSize) return false;\r\n        if (s.borderRightSize != borderRightSize) return false;\r\n\r\n        if (s.borderRadius != borderRadius) return false;\r\n        if (s.borderOpacity != borderOpacity) return false;\r\n\r\n        if (s.filter != filter) return false;\r\n\r\n        if (s.icon != icon) return false;\r\n        if (s.iconPosition != iconPosition) return false;\r\n\r\n        if (s.horizontalAlign != horizontalAlign) return false;\r\n        if (s.verticalAlign != verticalAlign) return false;\r\n\r\n        if (s.opacity != opacity) return false;\r\n\r\n        if (s.clip != clip) return false;\r\n        if (s.native != native) return false;\r\n\r\n        if (s.fontName != fontName) return false;\r\n        if (s.fontSize != fontSize) return false;\r\n        if (s.fontBold != fontBold) return false;\r\n        if (s.fontUnderline != fontUnderline) return false;\r\n        if (s.fontItalic != fontItalic) return false;\r\n\r\n        return true;\r\n    }\r\n\r\n    private function assignNulls():Void {\r\n        if (color == MathUtil.MIN_INT) color = null;\r\n        if (backgroundColor == MathUtil.MIN_INT) {\r\n            backgroundColor = null;\r\n            backgroundColorEnd = null;\r\n        }\r\n        if (backgroundColorEnd == MathUtil.MIN_INT) {\r\n            backgroundColor = null;\r\n            backgroundColorEnd = null;\r\n        }\r\n        if (borderSize == MathUtil.MIN_INT) borderSize = null;\r\n        if (borderTopSize == MathUtil.MIN_INT) borderTopSize = null;\r\n        if (borderLeftSize == MathUtil.MIN_INT) borderLeftSize = null;\r\n        if (borderBottomSize == MathUtil.MIN_INT) borderBottomSize = null;\r\n        if (borderRightSize == MathUtil.MIN_INT) borderRightSize = null;\r\n        if (borderRadius == MathUtil.MIN_INT) borderRadius = null;\r\n        if (borderColor == MathUtil.MIN_INT) borderColor = null;\r\n        if (borderTopColor == MathUtil.MIN_INT) borderTopColor = null;\r\n        if (borderLeftColor == MathUtil.MIN_INT) borderLeftColor = null;\r\n        if (borderBottomColor == MathUtil.MIN_INT) borderBottomColor = null;\r\n        if (borderRightColor == MathUtil.MIN_INT) borderRightColor = null;\r\n        if (filter != null && filter[0] == \"none\") filter = null;\r\n        if (icon == \"none\") icon = null;\r\n    }\r\n\r\n    public function padding(v:Float) {\r\n        this.paddingTop = v;\r\n        this.paddingLeft = v;\r\n        this.paddingRight = v;\r\n        this.paddingBottom = v;\r\n    }\r\n\r\n    public function margin(v:Float) {\r\n        this.marginTop = v;\r\n        this.marginLeft = v;\r\n        this.marginRight = v;\r\n        this.marginBottom = v;\r\n    }\r\n\r\n    public function toString() {\r\n        var fields = [];\r\n        for( f in Type.getInstanceFields(Style) ) {\r\n            var v : Dynamic = Reflect.field(this, f);\r\n            if( v == null || Reflect.isFunction(v) || f == \"toString\" || f == \"apply\" )\r\n                continue;\r\n            if( f.toLowerCase().indexOf(\"color\") >= 0 && Std.is(v,Int) )\r\n                v = \"#\" + StringTools.hex(v, 6);\r\n            fields.push(f + \": \" + v);\r\n        }\r\n        return \"{\" + fields.join(\", \") + \"}\";\r\n    }\r\n}","package haxe.ui.themes;\r\n\r\nclass Theme {\r\n    public var parent:String = null;\r\n    public var styles:Array<String> = new Array<String>();\r\n\r\n    public function new() {\r\n\r\n    }\r\n}","package haxe.ui.themes;\r\nimport haxe.ui.Toolkit;\r\n\r\nclass ThemeManager {\r\n    private static var _instance:ThemeManager;\r\n    public static var instance(get, null):ThemeManager;\r\n    private static function get_instance():ThemeManager {\r\n        if (_instance == null) {\r\n            _instance = new ThemeManager();\r\n        }\r\n        return _instance;\r\n    }\r\n\r\n    //****************************************************************************************************\r\n    // Instance\r\n    //****************************************************************************************************\r\n    private var _themes:Map<String, Theme>;\r\n\r\n    public function new() {\r\n        _themes = new Map<String, Theme>();\r\n    }\r\n\r\n    public function getTheme(themeName):Theme {\r\n        var theme:Theme = _themes.get(themeName);\r\n        if (theme == null) {\r\n            theme = new Theme();\r\n            _themes.set(themeName, theme);\r\n        }\r\n        return theme;\r\n    }\r\n\r\n    public function addStyleResource(themeName:String, resourceId:String):Void {\r\n        getTheme(themeName).styles.push(resourceId);\r\n    }\r\n\r\n\r\n    public function applyTheme(themeName:String):Void {\r\n        applyThemeStyles(\"global\");\r\n        applyThemeStyles(themeName);\r\n    }\r\n\r\n    public function applyThemeStyles(themeName:String):Void {\r\n        var theme:Theme = _themes.get(themeName);\r\n        if (theme.parent != null) {\r\n            applyThemeStyles(theme.parent);\r\n        }\r\n\r\n        var styles = theme.styles;\r\n        styles.reverse();\r\n        for (s in styles) {\r\n            var css:String = Toolkit.assets.getText(s);\r\n            if (css != null) {\r\n                Toolkit.styleSheet.addRules(css);\r\n            } else {\r\n                #if debug\r\n                trace(\"WARNING: could not find \" + s);\r\n                #end\r\n            }\r\n        }\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nimport haxe.CallStack;\r\n\r\nclass CallStackHelper {\r\n    public static function traceCallStack() {\r\n        var arr:Array<haxe.StackItem> = haxe.CallStack.callStack();\r\n        if (arr == null) {\r\n            trace(\"Callstack is null!\");\r\n            return;\r\n        }\r\n        trace(haxe.CallStack.toString(arr));\r\n        trace(\">>>>>>>>>>>>>>>>>>>>>>>>>>>> END >>>>>>>>>>>>>>>>>>>>>>>>>>>>\");\r\n    }\r\n\r\n    public static function traceExceptionStack() {\r\n        var arr:Array<haxe.StackItem> = haxe.CallStack.exceptionStack();\r\n        if (arr == null) {\r\n            trace(\"Callstack is null!\");\r\n            return;\r\n        }\r\n        trace(haxe.CallStack.toString(arr));\r\n        trace(\">>>>>>>>>>>>>>>>>>>>>>>>>>>> END >>>>>>>>>>>>>>>>>>>>>>>>>>>>\");\r\n    }\r\n\r\n    public static function getCallStackString():String {\r\n        var arr:Array<haxe.StackItem> = haxe.CallStack.callStack();\r\n        if (arr == null) {\r\n            throw \"Callstack is null!\";\r\n        }\r\n        return haxe.CallStack.toString(arr);\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nclass CallbackMap<T> {\r\n    private var _map:Map<String, FunctionArray<T->Void>>;\r\n\r\n    public function new() {\r\n        _map = new Map<String, FunctionArray<T->Void>>();\r\n    }\r\n\r\n    public function add(key:String, callback:T->Void):Bool { // returns true if a new FunctionArray was created\r\n        var b:Bool = false;\r\n        var arr:FunctionArray<T->Void> = _map.get(key);\r\n        if (arr == null) {\r\n            arr = new FunctionArray<T->Void>();\r\n            arr.push(callback);\r\n            _map.set(key, arr);\r\n            b = true;\r\n        } else if (arr.contains(callback) == false) {\r\n            arr.push(callback);\r\n        }\r\n        return b;\r\n    }\r\n\r\n    public function remove(key:String,  callback:T->Void):Bool { // returns true if a FunctionArray was removed\r\n        var b:Bool = false;\r\n        var arr:FunctionArray<T->Void> = _map.get(key);\r\n        if (arr != null) {\r\n            arr.remove(callback);\r\n            if (arr.length == 0) {\r\n                _map.remove(key);\r\n                b = true;\r\n            }\r\n        }\r\n        return b;\r\n    }\r\n\r\n    public function removeAll(key:String) {\r\n        var arr:FunctionArray<T->Void> = _map.get(key);\r\n        if (arr != null) {\r\n            while (arr.length > 0) {\r\n                arr.remove(arr.get(0));\r\n            }\r\n            _map.remove(key);\r\n        }\r\n    }\r\n\r\n    public function invoke(key:String, param:T) {\r\n        var arr:FunctionArray<T->Void> = _map.get(key);\r\n        if (arr != null) {\r\n            arr = arr.copy();\r\n            for (fn in arr) {\r\n                fn(param);\r\n            }\r\n        }\r\n    }\r\n\r\n    public function invokeAndRemove(key:String, param:T) {\r\n        var arr:FunctionArray<T->Void> = _map.get(key);\r\n        if (arr != null) {\r\n            arr = arr.copy();\r\n            removeAll(key);\r\n            for (fn in arr) {\r\n                fn(param);\r\n            }\r\n        }\r\n    }\r\n\r\n    public function count(key:String):Int {\r\n        var n:Int = 0;\r\n        var arr:FunctionArray<T->Void> = _map.get(key);\r\n        if (arr != null) {\r\n            n = arr.length;\r\n        }\r\n        return n;\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nclass ColorUtil {\r\n    public static function buildColorArray(startColor:Int, endColor:Int, size:Float):Array<Int> {\r\n        var array:Array<Int> = new Array<Int>();\r\n\r\n        var r1 = r(startColor), g1 = g(startColor), b1 = b(startColor);\r\n        var r2 = r(endColor), g2 = g(endColor), b2 = b(endColor);\r\n        var rd = r2 - r1, gd = g2 - g1, bd = b2 - b1; // deltas\r\n        var ri:Float = rd / (size - 1), gi:Float = gd / (size - 1), bi:Float = bd / (size - 1); // increments\r\n\r\n        var r:Float = r1, g:Float = g1, b:Float = b1;\r\n        for (n in 0...cast size) {\r\n            var c = color(r, g, b);\r\n            array.push(c);\r\n\r\n            r += ri;\r\n            g += gi;\r\n            b += bi;\r\n        }\r\n\r\n        return array;\r\n    }\r\n\r\n    public static inline function parseColor(s:String):Int {\r\n        if (StringTools.startsWith(s, \"#\")) {\r\n            s = s.substring(1, s.length);\r\n        } else if (StringTools.startsWith(s, \"0x\")) {\r\n            s = s.substring(2, s.length);\r\n        }\r\n        return Std.parseInt(\"0xFF\" + s);\r\n    }\r\n\r\n    private static inline function color(r:Float, g:Float, b:Float):Int {\r\n        return (Math.round(r) << 16) | (Math.round(g) << 8) | Math.round(b);\r\n    }\r\n\r\n    private static inline function r(c:Int):Int {\r\n        return c >> 16 & 0xFF;\r\n    }\r\n\r\n    private static inline function g(c:Int):Int {\r\n        return c >> 8 & 0xFF;\r\n    }\r\n\r\n    private static inline function b(c:Int):Int {\r\n        return c & 0xFF;\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nimport haxe.ui.core.Component;\r\nimport haxe.ui.core.UIEvent;\r\n\r\nclass EventMap  {\r\n    private var _map:Map<String, FunctionArray<UIEvent->Void>>;\r\n\r\n    public function new() {\r\n        _map = new Map<String, FunctionArray<UIEvent->Void>>();\r\n    }\r\n\r\n    public function add(type:String,  listener:UIEvent->Void):Bool { // returns true if a new FunctionArray was created\r\n        var b:Bool = false;\r\n        var arr:FunctionArray<UIEvent->Void> = _map.get(type);\r\n        if (arr == null) {\r\n            arr = new FunctionArray<UIEvent->Void>();\r\n            arr.push(listener);\r\n            _map.set(type, arr);\r\n            b = true;\r\n        } else if (arr.contains(listener) == false) {\r\n            arr.push(listener);\r\n        }\r\n        return b;\r\n    }\r\n\r\n    public function remove(type:String, listener:UIEvent->Void):Bool { // returns true if a FunctionArray was removed\r\n        var b:Bool = false;\r\n        var arr:FunctionArray<UIEvent->Void> = _map.get(type);\r\n        if (arr != null) {\r\n            arr.remove(listener);\r\n            if (arr.length == 0) {\r\n                _map.remove(type);\r\n                b = true;\r\n            }\r\n        }\r\n        return b;\r\n    }\r\n\r\n    public function invoke(type:String, event:UIEvent, target:Component = null) {\r\n        var arr:FunctionArray<UIEvent->Void> = _map.get(type);\r\n        if (arr != null) {\r\n            arr = arr.copy();\r\n            for (fn in arr) {\r\n                var c = event.clone();\r\n                c.target = target;\r\n                fn(c);\r\n            }\r\n        }\r\n    }\r\n\r\n    public function listenerCount(type:String):Int {\r\n        var n:Int = 0;\r\n        var arr:FunctionArray<UIEvent->Void> = _map.get(type);\r\n        if (arr != null) {\r\n            n = arr.length;\r\n        }\r\n        return n;\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nclass FunctionArray<T> {\r\n    private var _array:Array<T>;\r\n\r\n    public function new(array:Array<T> = null) {\r\n        if (array == null) {\r\n            _array = new Array<T>();\r\n        } else {\r\n            _array = array;\r\n        }\r\n    }\r\n\r\n    public function get(index:Int):T {\r\n        return _array[index];\r\n    }\r\n\r\n    public var length(get, null):Int;\r\n    private function get_length():Int {\r\n        return _array.length;\r\n    }\r\n\r\n    public function push(x:T):Int {\r\n        return _array.push(x);\r\n    }\r\n\r\n    public function pop():Null<T> {\r\n        return _array.pop();\r\n    }\r\n\r\n    public function indexOf(x:T, fromIndex:Int = 0):Int {\r\n        #if neko\r\n        if (Reflect.isFunction(x) == false) {\r\n            return _array.indexOf(x);\r\n        } else {\r\n            var index:Int = -1;\r\n            var n:Int = 0;\r\n            for (t in _array) {\r\n                if (Reflect.compareMethods(t, x) == true) {\r\n                    index = n;\r\n                    break;\r\n                }\r\n                n++;\r\n            }\r\n            return index;\r\n        }\r\n        #else\r\n        return _array.indexOf(x, fromIndex);\r\n        #end\r\n    }\r\n\r\n    public function remove(x:T):Bool {\r\n        #if neko\r\n        var b = false;\r\n        if (Reflect.isFunction(x) == false) {\r\n            b = _array.remove(x);\r\n        } else {\r\n            var index = indexOf(x);\r\n            if (index != -1) {\r\n                _array.splice(index, 1);\r\n                b = true;\r\n            }\r\n        }\r\n        return b;\r\n        #else\r\n        return _array.remove(x);\r\n        #end\r\n    }\r\n\r\n    public function contains(x:T):Bool {\r\n        return indexOf(x) != -1;\r\n    }\r\n\r\n    public function iterator():Iterator<T> {\r\n        return _array.iterator();\r\n    }\r\n\r\n    public function copy():FunctionArray<T> {\r\n        return new FunctionArray<T>(_array.copy());\r\n    }\r\n\r\n    public function toString():String {\r\n        var s:String = \"[\";\r\n        var iter = this.iterator();\r\n        while (iter.hasNext()) {\r\n            s += Std.string(iter.next());\r\n            if (iter.hasNext()) {\r\n                s += \", \";\r\n            }\r\n        }\r\n        s += \"]\";\r\n        return s;\r\n    }\r\n\r\n}","package haxe.ui.util;\r\n\r\nclass GUID {\r\n    inline public static function randomIntegerWithinRange(min:Int, max:Int):Int {\r\n        return Math.floor(Math.random() * (1 + max - min) + min);\r\n    }\r\n\r\n    public static function createRandomIdentifier(length:Int, radix:Int = 61):String {\r\n        var characters = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'];\r\n        var id:Array<String>   = new Array<String>();\r\n        radix                  = (radix > 61) ? 61 : radix;\r\n\r\n\r\n        while (length-- > 0) {\r\n           id.push(characters[GUID.randomIntegerWithinRange(0, radix)]);\r\n        }\r\n\r\n        return id.join('');\r\n    }\r\n\r\n    public static function uuid():String {\r\n        var specialChars = ['8', '9', 'A', 'B'];\r\n        return GUID.createRandomIdentifier(8, 15) + '-' +\r\n            GUID.createRandomIdentifier(4, 15) + '-4' +\r\n            GUID.createRandomIdentifier(3, 15) + '-' +\r\n            specialChars[GUID.randomIntegerWithinRange(0, 3)] +\r\n            GUID.createRandomIdentifier(3, 15) + '-' +\r\n            GUID.createRandomIdentifier(12, 15);\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nclass Rectangle {\r\n    public var left(default, default):Float;\r\n    public var top(default, default):Float;\r\n    public var width(default, default):Float;\r\n    public var height(default, default):Float;\r\n\r\n    public function new(left:Float = 0, top:Float = 0, width:Float = 0, height:Float = 0) {\r\n        this.left = left;\r\n        this.top = top;\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n\r\n    public var right(get, set):Float;\r\n    private function get_right():Float {\r\n        return left + width;\r\n    }\r\n    private function set_right(value:Float):Float {\r\n        width = value - left;\r\n        return value;\r\n    }\r\n\r\n    public var bottom(get, set):Float;\r\n    private function get_bottom():Float {\r\n        return top + height;\r\n    }\r\n    private function set_bottom(value:Float):Float {\r\n        height = value - top;\r\n        return value;\r\n    }\r\n\r\n    public function inflate(dx:Float, dy:Float):Void {\r\n        left -= dx; width += dx * 2;\r\n        top -= dy; height += dy * 2;\r\n    }\r\n\r\n    public function toString():String {\r\n        return \"{left: \" + left + \", top: \" + top + \", width: \" + width + \", height: \" + height + \"}\";\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nclass Size {\r\n    public var width(default, default):Float;\r\n    public var height(default, default):Float;\r\n\r\n    public function new(width:Float = 0, height:Float = 0) {\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n\r\n    public function toString():String {\r\n        return '[${width}x${height}]';\r\n    }\r\n}","package haxe.ui.util;\r\n\r\ntypedef Slice9Rects = {\r\n    src:Array<Rectangle>,\r\n    dst:Array<Rectangle>\r\n}\r\n\r\nclass Slice9 {\r\n    public static function buildRects(w:Float, h:Float, bitmapWidth:Float, bitmapHeight:Float, slice:Rectangle):Slice9Rects {\r\n        var srcRects:Array<Rectangle> = buildSrcRects(bitmapWidth, bitmapHeight, slice);\r\n        var dstRects:Array<Rectangle> = buildDstRects(w, h, srcRects);\r\n        return {\r\n            src: srcRects,\r\n            dst: dstRects\r\n        }\r\n    }\r\n\r\n    public static function buildSrcRects(bitmapWidth:Float, bitmapHeight:Float, slice:Rectangle):Array<Rectangle> {\r\n        var x1:Float = slice.left;\r\n        var y1:Float = slice.top;\r\n        var x2:Float = slice.right;\r\n        var y2:Float = slice.bottom;\r\n\r\n        var srcRects:Array<Rectangle> = new Array<Rectangle>();\r\n        srcRects.push(new Rectangle(0, 0, x1, y1)); // top left\r\n        srcRects.push(new Rectangle(x1, 0, x2 - x1, y1)); // top middle\r\n        srcRects.push(new Rectangle(x2, 0, bitmapWidth - x2, y1)); // top right\r\n\r\n        srcRects.push(new Rectangle(0, y1, x1, y2 - y1)); // left middle\r\n        srcRects.push(new Rectangle(x1, y1, x2 - x1, y2 - y1)); // middle\r\n        srcRects.push(new Rectangle(x2, y1, bitmapWidth - x2, y2 - y1)); // left middle\r\n\r\n        srcRects.push(new Rectangle(0, y2, x1, bitmapHeight - y2)); // bottom left\r\n        srcRects.push(new Rectangle(x1, y2, x2 - x1, bitmapHeight - y2)); // bottom middle\r\n        srcRects.push(new Rectangle(x2, y2, bitmapWidth - x2, bitmapHeight - y2)); // bottom right\r\n\r\n        return srcRects;\r\n    }\r\n\r\n    public static function buildDstRects(w:Float, h:Float, srcRects:Array<Rectangle>):Array<Rectangle> {\r\n        var dstRects:Array<Rectangle> = new Array<Rectangle>();\r\n\r\n        dstRects.push(srcRects[0]);\r\n        dstRects.push(new Rectangle(srcRects[0].width, 0, w - srcRects[0].width - srcRects[2].width, srcRects[1].height));\r\n        dstRects.push(new Rectangle(w - srcRects[2].width, 0, srcRects[2].width, srcRects[2].height));\r\n\r\n        dstRects.push(new Rectangle(0, srcRects[0].height, srcRects[3].width, h - srcRects[0].height - srcRects[6].height));\r\n        dstRects.push(new Rectangle(srcRects[3].width, srcRects[0].height, w - srcRects[3].width - srcRects[5].width, h - srcRects[1].height - srcRects[7].height));\r\n        dstRects.push(new Rectangle(w - srcRects[5].width, srcRects[2].height, srcRects[5].width, h - srcRects[2].height - srcRects[8].height));\r\n\r\n        dstRects.push(new Rectangle(0, h - srcRects[6].height, srcRects[6].width, srcRects[6].height));\r\n        dstRects.push(new Rectangle(srcRects[6].width, h - srcRects[7].height, w - srcRects[6].width - srcRects[8].width, srcRects[7].height));\r\n        dstRects.push(new Rectangle(w - srcRects[8].width, h - srcRects[8].height, srcRects[8].width, srcRects[8].height));\r\n\r\n        return dstRects;\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nclass StringUtil {\r\n    public static function capitalizeFirstLetter(s:String):String {\r\n        s = s.substr(0, 1).toUpperCase() + s.substr(1, s.length);\r\n        return s;\r\n    }\r\n\r\n    public static function capitalizeHyphens(s:String):String {\r\n        var r:String = s;\r\n        var n:Int = r.indexOf(\"-\");\r\n        while (n != -1) {\r\n            var before:String = r.substr(0, n);\r\n            var after:String = r.substr(n + 1, r.length);\r\n            r = before + capitalizeFirstLetter(after);\r\n            n = r.indexOf(\"-\", n + 1);\r\n        }\r\n        return r;\r\n    }\r\n}","package haxe.ui.util;\r\n\r\nimport haxe.ui.backend.TimerBase;\r\n\r\nclass Timer extends TimerBase {\r\n    public function new(delay:Int, callback:Void->Void) {\r\n        super(delay, callback);\r\n    }\r\n\r\n    public override function stop() {\r\n        super.stop();\r\n    }\r\n}\r\n","package haxe.ui.util;\r\nimport haxe.ui.core.Component;\r\n\r\nenum VariantType {\r\n    Int(s:Int);\r\n    Float(s:Float);\r\n    String(s:String);\r\n    Bool(s:Bool);\r\n}\r\n\r\nabstract Variant(VariantType) from VariantType {\r\n    // ************************************************************************************************************\r\n    // STRINGS\r\n    // ************************************************************************************************************\r\n    @:from static function fromString(s:String):Variant {\r\n        return String(s);\r\n    }\r\n\r\n    @:to public function toString() {\r\n        return switch(this) {\r\n            case String(s): s;\r\n            case Int(s): return Std.string(s);\r\n            case Float(s): return Std.string(s);\r\n            case Bool(s): return Std.string(s);\r\n            default: throw \"Variant Type Error\";\r\n        }\r\n    }\r\n\r\n    public var isString(get, never):Bool;\r\n    private function get_isString():Bool {\r\n        return this.match(String(_));\r\n    }\r\n\r\n    // ************************************************************************************************************\r\n    // INTS\r\n    // ************************************************************************************************************\r\n    @:from static function fromInt(s:Int):Variant {\r\n        return Int(s);\r\n    }\r\n\r\n    @:to function toInt() {\r\n        return switch(this) {\r\n            case Int(s): return s;\r\n            case Float(s): return Std.int(s);\r\n            default: throw \"Variant Type Error\";\r\n        }\r\n    }\r\n\r\n    public var isInt(get, never):Bool;\r\n    private inline function get_isInt():Bool {\r\n        return this.match(Int(_));\r\n    }\r\n\r\n    // ************************************************************************************************************\r\n    // FLOATS\r\n    // ************************************************************************************************************\r\n    @:from static function fromFloat(s:Float):Variant {\r\n        return Float(s);\r\n    }\r\n\r\n    @:to function toFloat() {\r\n        return switch(this) {\r\n            case Float(s): return s;\r\n            default: throw \"Variant Type Error\";\r\n        }\r\n    }\r\n\r\n    public var isFloat(get, never):Bool;\r\n    private inline function get_isFloat():Bool {\r\n        return this.match(Float(_));\r\n    }\r\n\r\n    // ************************************************************************************************************\r\n    // NUMBERS\r\n    // ************************************************************************************************************\r\n    public var isNumber(get, never):Bool;\r\n    private inline function get_isNumber():Bool {\r\n        return this.match(Int(_) | Float(_));\r\n    }\r\n\r\n    function toNumber():Float {\r\n        return switch(this) {\r\n            case Int(s): return s;\r\n            case Float(s): return s;\r\n            default: throw \"Variant Type Error\";\r\n        }\r\n    }\r\n\r\n    // ************************************************************************************************************\r\n    // BOOLS\r\n    // ************************************************************************************************************\r\n    @:from static function fromBool(s:Bool):Variant {\r\n        return Bool(s);\r\n    }\r\n\r\n    @:to function toBool() {\r\n        return switch(this) {\r\n            case Bool(s): return s;\r\n            default: throw \"Variant Type Error\";\r\n        }\r\n    }\r\n\r\n    public var isBool(get, never):Bool;\r\n    public function get_isBool():Bool {\r\n        switch (this) {\r\n            case Bool(_): return true;\r\n            default:\r\n        }\r\n        return false; // this.match(Bool(_));\r\n    }\r\n\r\n    // ************************************************************************************************************\r\n    // OPERATIONS\r\n    // ************************************************************************************************************\r\n    @:op(A + B)\r\n    private function add(rhs:Variant):Variant {\r\n        if (isNumber && rhs.isNumber) {\r\n            return toNumber() + rhs.toNumber();\r\n        } else if (isString && rhs.isString) {\r\n            return toString() + rhs.toString();\r\n        }\r\n\r\n        throw \"Variant operation error\";\r\n    }\r\n\r\n    @:op(A++)\r\n    private inline function postInc():Variant {\r\n        if (isNumber) {\r\n            var v = toNumber();\r\n            v++;\r\n            this = Float(v);\r\n            return v;\r\n        }\r\n        throw \"Variant operation error\";\r\n    }\r\n\r\n    @:op(++A)\r\n    private inline function preInc():Variant {\r\n        if (isNumber) {\r\n            var v = toNumber();\r\n            ++v;\r\n            this = Float(v);\r\n            return v;\r\n        }\r\n        throw \"Variant operation error\";\r\n    }\r\n\r\n    @:op(A - B)\r\n    private function subtract(rhs:Variant):Variant {\r\n        if (isNumber && rhs.isNumber) {\r\n            return toNumber() - rhs.toNumber();\r\n        } else if (isString && rhs.isString) {\r\n            return StringTools.replace(toString(), rhs.toString(), \"\");\r\n        }\r\n\r\n        throw \"Variant operation error\";\r\n    }\r\n\r\n    @:op(A--)\r\n    private inline function postDeinc():Variant {\r\n        if (isNumber) {\r\n            var v = toNumber();\r\n            v--;\r\n            this = Float(v);\r\n            return v;\r\n        }\r\n        throw \"Variant operation error\";\r\n    }\r\n\r\n    @:op(--A)\r\n    private inline function preDeinc():Variant {\r\n        if (isNumber) {\r\n            var v = toNumber();\r\n            --v;\r\n            this = Float(v);\r\n            return v;\r\n        }\r\n        throw \"Variant operation error\";\r\n    }\r\n\r\n    @:op(A * B)\r\n    private function multiply(rhs:Variant):Variant {\r\n        if (isNumber && rhs.isNumber) {\r\n            return toNumber() * rhs.toNumber();\r\n        }\r\n\r\n        throw \"Variant operation error\";\r\n    }\r\n\r\n    @:op(A / B)\r\n    private function divide(rhs:Variant):Variant {\r\n        if (isNumber && rhs.isNumber) {\r\n            return toNumber() / rhs.toNumber();\r\n        }\r\n\r\n        throw \"Variant operation error\";\r\n    }\r\n\r\n    @:op(!A)\r\n    private function invert():Variant {\r\n        if (isBool) {\r\n            var v = toBool();\r\n            v = !v;\r\n            return v;\r\n        }\r\n        throw \"Variant operation error\";\r\n    }\r\n\r\n    // ************************************************************************************************************\r\n    // HELPERS\r\n    // ************************************************************************************************************\r\n    public var isNull(get, never):Bool;\r\n    public function get_isNull():Bool {\r\n        return toString() == null;\r\n    }\r\n\r\n    public static function fromDynamic(r:Dynamic):Variant {\r\n        var v:Variant = null;\r\n        if (r != null) {\r\n            if (Math.isNaN(Std.parseFloat(\"\" + r)) == false) {\r\n                if (Std.string(r).indexOf(\".\") != -1) {\r\n                    v = Std.parseFloat(\"\" + r);\r\n                } else {\r\n                    v = Std.parseInt(\"\" + r);\r\n                }\r\n            } else if (((\"\" + r) == \"true\" || (r + \"\") == \"false\")) {\r\n                v = ((\"\" + r) == \"true\");\r\n            } else {\r\n                v = Std.string(r);\r\n            }\r\n        }\r\n        return v;\r\n    }\r\n\r\n    public static function toDynamic(v:Variant):Dynamic {\r\n        var d:Dynamic = null;\r\n        if (v != null) {\r\n            switch (v) {\r\n                case VariantType.Int(y):        d = y;\r\n                case VariantType.Float(y):      d = y;\r\n                case VariantType.String(y):     d = y;\r\n                case VariantType.Bool(y):       d = y;\r\n            }\r\n        }\r\n        return d;\r\n    }\r\n}\r\n","/*\n * Copyright (c) 2008, Nicolas Cannasse\n * All rights reserved.\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n *   - Redistributions of source code must retain the above copyright\n *     notice, this list of conditions and the following disclaimer.\n *   - Redistributions in binary form must reproduce the above copyright\n *     notice, this list of conditions and the following disclaimer in the\n *     documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE HAXE PROJECT CONTRIBUTORS \"AS IS\" AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE HAXE PROJECT CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY\n * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH\n * DAMAGE.\n */\npackage hscript;\nimport hscript.Expr;\n\nenum Token {\n\tTEof;\n\tTConst( c : Const );\n\tTId( s : String );\n\tTOp( s : String );\n\tTPOpen;\n\tTPClose;\n\tTBrOpen;\n\tTBrClose;\n\tTDot;\n\tTComma;\n\tTSemicolon;\n\tTBkOpen;\n\tTBkClose;\n\tTQuestion;\n\tTDoubleDot;\n}\n\nclass Parser {\n\n\t// config / variables\n\tpublic var line : Int;\n\tpublic var opChars : String;\n\tpublic var identChars : String;\n\t#if haxe3\n\tpublic var opPriority : Map<String,Int>;\n\tpublic var opRightAssoc : Map<String,Bool>;\n\tpublic var unops : Map<String,Bool>; // true if allow postfix\n\t#else\n\tpublic var opPriority : Hash<Int>;\n\tpublic var opRightAssoc : Hash<Bool>;\n\tpublic var unops : Hash<Bool>; // true if allow postfix\n\t#end\n\n\t/**\n\t\tactivate JSON compatiblity\n\t**/\n\tpublic var allowJSON : Bool;\n\n\t/**\n\t\tallow types declarations\n\t**/\n\tpublic var allowTypes : Bool;\n\n\t// implementation\n\tvar input : haxe.io.Input;\n\tvar char : Int;\n\tvar ops : Array<Bool>;\n\tvar idents : Array<Bool>;\n\tvar uid : Int = 0;\n\n\t#if hscriptPos\n\tvar readPos : Int;\n\tvar tokenMin : Int;\n\tvar tokenMax : Int;\n\tvar oldTokenMin : Int;\n\tvar oldTokenMax : Int;\n\tvar tokens : List<{ min : Int, max : Int, t : Token }>;\n\t#else\n\tstatic inline var p1 = 0;\n\tstatic inline var readPos = 0;\n\tstatic inline var tokenMin = 0;\n\tstatic inline var tokenMax = 0;\n\t#if haxe3\n\tvar tokens : haxe.ds.GenericStack<Token>;\n\t#else\n\tvar tokens : haxe.FastList<Token>;\n\t#end\n\n\t#end\n\n\n\tpublic function new() {\n\t\tline = 1;\n\t\topChars = \"+*/-=!><&|^%~\";\n\t\tidentChars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_\";\n\t\tvar priorities = [\n\t\t\t[\"%\"],\n\t\t\t[\"*\", \"/\"],\n\t\t\t[\"+\", \"-\"],\n\t\t\t[\"<<\", \">>\", \">>>\"],\n\t\t\t[\"|\", \"&\", \"^\"],\n\t\t\t[\"==\", \"!=\", \">\", \"<\", \">=\", \"<=\"],\n\t\t\t[\"...\"],\n\t\t\t[\"&&\"],\n\t\t\t[\"||\"],\n\t\t\t[\"=\",\"+=\",\"-=\",\"*=\",\"/=\",\"%=\",\"<<=\",\">>=\",\">>>=\",\"|=\",\"&=\",\"^=\"],\n\t\t];\n\t\t#if haxe3\n\t\topPriority = new Map();\n\t\topRightAssoc = new Map();\n\t\tunops = new Map();\n\t\t#else\n\t\topPriority = new Hash();\n\t\topRightAssoc = new Hash();\n\t\tunops = new Hash();\n\t\t#end\n\t\tfor( i in 0...priorities.length )\n\t\t\tfor( x in priorities[i] ) {\n\t\t\t\topPriority.set(x, i);\n\t\t\t\tif( i == 9 ) opRightAssoc.set(x, true);\n\t\t\t}\n\t\tfor( x in [\"!\", \"++\", \"--\", \"-\", \"~\"] )\n\t\t\tunops.set(x, x == \"++\" || x == \"--\");\n\t}\n\n\tpublic inline function error( err, pmin, pmax ) {\n\t\t#if hscriptPos\n\t\tthrow new Error(err, pmin, pmax);\n\t\t#else\n\t\tthrow err;\n\t\t#end\n\t}\n\n\tpublic function invalidChar(c) {\n\t\terror(EInvalidChar(c), readPos, readPos);\n\t}\n\n\tpublic function parseString( s : String ) {\n\t\tline = 1;\n\t\tuid = 0;\n\t\treturn parse( new haxe.io.StringInput(s) );\n\t}\n\n\tpublic function parse( s : haxe.io.Input ) {\n\t\t#if hscriptPos\n\t\treadPos = 0;\n\t\ttokenMin = oldTokenMin = 0;\n\t\ttokenMax = oldTokenMax = 0;\n\t\ttokens = new List();\n\t\t#elseif haxe3\n\t\ttokens = new haxe.ds.GenericStack<Token>();\n\t\t#else\n\t\ttokens = new haxe.FastList<Token>();\n\t\t#end\n\t\tchar = -1;\n\t\tinput = s;\n\t\tops = new Array();\n\t\tidents = new Array();\n\t\tfor( i in 0...opChars.length )\n\t\t\tops[opChars.charCodeAt(i)] = true;\n\t\tfor( i in 0...identChars.length )\n\t\t\tidents[identChars.charCodeAt(i)] = true;\n\t\tvar a = new Array();\n\t\twhile( true ) {\n\t\t\tvar tk = token();\n\t\t\tif( tk == TEof ) break;\n\t\t\tpush(tk);\n\t\t\ta.push(parseFullExpr());\n\t\t}\n\t\treturn if( a.length == 1 ) a[0] else mk(EBlock(a),0);\n\t}\n\n\tfunction unexpected( tk ) : Dynamic {\n\t\terror(EUnexpected(tokenString(tk)),tokenMin,tokenMax);\n\t\treturn null;\n\t}\n\n\tinline function push(tk) {\n\t\t#if hscriptPos\n\t\ttokens.push( { t : tk, min : tokenMin, max : tokenMax } );\n\t\ttokenMin = oldTokenMin;\n\t\ttokenMax = oldTokenMax;\n\t\t#else\n\t\ttokens.add(tk);\n\t\t#end\n\t}\n\n\tinline function ensure(tk) {\n\t\tvar t = token();\n\t\tif( t != tk ) unexpected(t);\n\t}\n\n\tinline function expr(e:Expr) {\n\t\t#if hscriptPos\n\t\treturn e.e;\n\t\t#else\n\t\treturn e;\n\t\t#end\n\t}\n\n\tinline function pmin(e:Expr) {\n\t\t#if hscriptPos\n\t\treturn e.pmin;\n\t\t#else\n\t\treturn 0;\n\t\t#end\n\t}\n\n\tinline function pmax(e:Expr) {\n\t\t#if hscriptPos\n\t\treturn e.pmax;\n\t\t#else\n\t\treturn 0;\n\t\t#end\n\t}\n\n\tinline function mk(e,?pmin,?pmax) : Expr {\n\t\t#if hscriptPos\n\t\tif( pmin == null ) pmin = tokenMin;\n\t\tif( pmax == null ) pmax = tokenMax;\n\t\treturn { e : e, pmin : pmin, pmax : pmax };\n\t\t#else\n\t\treturn e;\n\t\t#end\n\t}\n\n\tfunction isBlock(e) {\n\t\treturn switch( expr(e) ) {\n\t\tcase EBlock(_), EObject(_), ESwitch(_): true;\n\t\tcase EFunction(_,e,_,_): isBlock(e);\n\t\tcase EVar(_,_,e): e != null && isBlock(e);\n\t\tcase EIf(_,e1,e2): if( e2 != null ) isBlock(e2) else isBlock(e1);\n\t\tcase EBinop(_,_,e): isBlock(e);\n\t\tcase EUnop(_,prefix,e): !prefix && isBlock(e);\n\t\tcase EWhile(_,e): isBlock(e);\n\t\tcase EFor(_,_,e): isBlock(e);\n\t\tcase EReturn(e): e != null && isBlock(e);\n\t\tcase ETry(_, _, _, e): isBlock(e);\n\t\tdefault: false;\n\t\t}\n\t}\n\n\tfunction parseFullExpr() {\n\t\tvar e = parseExpr();\n\t\tvar tk = token();\n\t\tif( tk != TSemicolon && tk != TEof ) {\n\t\t\tif( isBlock(e) )\n\t\t\t\tpush(tk);\n\t\t\telse\n\t\t\t\tunexpected(tk);\n\t\t}\n\t\treturn e;\n\t}\n\n\tfunction parseObject(p1) {\n\t\t// parse object\n\t\tvar fl = new Array();\n\t\twhile( true ) {\n\t\t\tvar tk = token();\n\t\t\tvar id = null;\n\t\t\tswitch( tk ) {\n\t\t\tcase TId(i): id = i;\n\t\t\tcase TConst(c):\n\t\t\t\tif( !allowJSON )\n\t\t\t\t\tunexpected(tk);\n\t\t\t\tswitch( c ) {\n\t\t\t\tcase CString(s): id = s;\n\t\t\t\tdefault: unexpected(tk);\n\t\t\t\t}\n\t\t\tcase TBrClose:\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tunexpected(tk);\n\t\t\t}\n\t\t\tensure(TDoubleDot);\n\t\t\tfl.push({ name : id, e : parseExpr() });\n\t\t\ttk = token();\n\t\t\tswitch( tk ) {\n\t\t\tcase TBrClose:\n\t\t\t\tbreak;\n\t\t\tcase TComma:\n\t\t\tdefault:\n\t\t\t\tunexpected(tk);\n\t\t\t}\n\t\t}\n\t\treturn parseExprNext(mk(EObject(fl),p1));\n\t}\n\n\tfunction parseExpr() {\n\t\tvar tk = token();\n\t\t#if hscriptPos\n\t\tvar p1 = tokenMin;\n\t\t#end\n\t\tswitch( tk ) {\n\t\tcase TId(id):\n\t\t\tvar e = parseStructure(id);\n\t\t\tif( e == null )\n\t\t\t\te = mk(EIdent(id));\n\t\t\treturn parseExprNext(e);\n\t\tcase TConst(c):\n\t\t\treturn parseExprNext(mk(EConst(c)));\n\t\tcase TPOpen:\n\t\t\tvar e = parseExpr();\n\t\t\tensure(TPClose);\n\t\t\treturn parseExprNext(mk(EParent(e),p1,tokenMax));\n\t\tcase TBrOpen:\n\t\t\ttk = token();\n\t\t\tswitch( tk ) {\n\t\t\tcase TBrClose:\n\t\t\t\treturn parseExprNext(mk(EObject([]),p1));\n\t\t\tcase TId(_):\n\t\t\t\tvar tk2 = token();\n\t\t\t\tpush(tk2);\n\t\t\t\tpush(tk);\n\t\t\t\tswitch( tk2 ) {\n\t\t\t\tcase TDoubleDot:\n\t\t\t\t\treturn parseExprNext(parseObject(p1));\n\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\tcase TConst(c):\n\t\t\t\tif( allowJSON ) {\n\t\t\t\t\tswitch( c ) {\n\t\t\t\t\tcase CString(_):\n\t\t\t\t\t\tvar tk2 = token();\n\t\t\t\t\t\tpush(tk2);\n\t\t\t\t\t\tpush(tk);\n\t\t\t\t\t\tswitch( tk2 ) {\n\t\t\t\t\t\tcase TDoubleDot:\n\t\t\t\t\t\t\treturn parseExprNext(parseObject(p1));\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t}\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tpush(tk);\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t\tpush(tk);\n\t\t\tdefault:\n\t\t\t\tpush(tk);\n\t\t\t}\n\t\t\tvar a = new Array();\n\t\t\twhile( true ) {\n\t\t\t\ta.push(parseFullExpr());\n\t\t\t\ttk = token();\n\t\t\t\tif( tk == TBrClose )\n\t\t\t\t\tbreak;\n\t\t\t\tpush(tk);\n\t\t\t}\n\t\t\treturn mk(EBlock(a),p1);\n\t\tcase TOp(op):\n\t\t\tif( unops.exists(op) )\n\t\t\t\treturn makeUnop(op,parseExpr());\n\t\t\treturn unexpected(tk);\n\t\tcase TBkOpen:\n\t\t\tvar a = new Array();\n\t\t\ttk = token();\n\t\t\twhile( tk != TBkClose ) {\n\t\t\t\tpush(tk);\n\t\t\t\ta.push(parseExpr());\n\t\t\t\ttk = token();\n\t\t\t\tif( tk == TComma )\n\t\t\t\t\ttk = token();\n\t\t\t}\n\t\t\tif( a.length == 1 )\n\t\t\t\tswitch( expr(a[0]) ) {\n\t\t\t\tcase EFor(_), EWhile(_):\n\t\t\t\t\tvar tmp = \"__a_\" + (uid++);\n\t\t\t\t\tvar e = mk(EBlock([\n\t\t\t\t\t\tmk(EVar(tmp, null, mk(EArrayDecl([]), p1)), p1),\n\t\t\t\t\t\tmapCompr(tmp, a[0]),\n\t\t\t\t\t\tmk(EIdent(tmp),p1),\n\t\t\t\t\t]),p1);\n\t\t\t\t\treturn parseExprNext(e);\n\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\treturn parseExprNext(mk(EArrayDecl(a),p1));\n\t\tdefault:\n\t\t\treturn unexpected(tk);\n\t\t}\n\t}\n\n\tfunction mapCompr( tmp : String, e : Expr ) {\n\t\tvar edef = switch( expr(e) ) {\n\t\tcase EFor(v, it, e2):\n\t\t\tEFor(v, it, mapCompr(tmp, e2));\n\t\tcase EWhile(cond, e2):\n\t\t\tEWhile(cond, mapCompr(tmp, e2));\n\t\tcase EIf(cond, e1, e2) if( e2 == null ):\n\t\t\tEIf(cond, mapCompr(tmp, e1), null);\n\t\tcase EBlock([e]):\n\t\t\tEBlock([mapCompr(tmp, e)]);\n\t\tcase EParent(e2):\n\t\t\tEParent(mapCompr(tmp, e2));\n\t\tdefault:\n\t\t\tECall( mk(EField(mk(EIdent(tmp), pmin(e), pmax(e)), \"push\"), pmin(e), pmax(e)), [e]);\n\t\t}\n\t\treturn mk(edef, pmin(e), pmax(e));\n\t}\n\n\tfunction makeUnop( op, e ) {\n\t\treturn switch( expr(e) ) {\n\t\tcase EBinop(bop, e1, e2): mk(EBinop(bop, makeUnop(op, e1), e2), pmin(e1), pmax(e2));\n\t\tcase ETernary(e1, e2, e3): mk(ETernary(makeUnop(op, e1), e2, e3), pmin(e1), pmax(e3));\n\t\tdefault: mk(EUnop(op,true,e),pmin(e),pmax(e));\n\t\t}\n\t}\n\n\tfunction makeBinop( op, e1, e ) {\n\t\treturn switch( expr(e) ) {\n\t\tcase EBinop(op2,e2,e3):\n\t\t\tif( opPriority.get(op) <= opPriority.get(op2) && !opRightAssoc.exists(op) )\n\t\t\t\tmk(EBinop(op2,makeBinop(op,e1,e2),e3),pmin(e1),pmax(e3));\n\t\t\telse\n\t\t\t\tmk(EBinop(op, e1, e), pmin(e1), pmax(e));\n\t\tcase ETernary(e2,e3,e4):\n\t\t\tif( opRightAssoc.exists(op) )\n\t\t\t\tmk(EBinop(op,e1,e),pmin(e1),pmax(e));\n\t\t\telse\n\t\t\t\tmk(ETernary(makeBinop(op, e1, e2), e3, e4), pmin(e1), pmax(e));\n\t\tdefault:\n\t\t\tmk(EBinop(op,e1,e),pmin(e1),pmax(e));\n\t\t}\n\t}\n\n\tfunction parseStructure(id) {\n\t\t#if hscriptPos\n\t\tvar p1 = tokenMin;\n\t\t#end\n\t\treturn switch( id ) {\n\t\tcase \"if\":\n\t\t\tensure(TPOpen);\n\t\t\tvar cond = parseExpr();\n\t\t\tensure(TPClose);\n\t\t\tvar e1 = parseExpr();\n\t\t\tvar e2 = null;\n\t\t\tvar semic = false;\n\t\t\tvar tk = token();\n\t\t\tif( tk == TSemicolon ) {\n\t\t\t\tsemic = true;\n\t\t\t\ttk = token();\n\t\t\t}\n\t\t\tif( Type.enumEq(tk,TId(\"else\")) )\n\t\t\t\te2 = parseExpr();\n\t\t\telse {\n\t\t\t\tpush(tk);\n\t\t\t\tif( semic ) push(TSemicolon);\n\t\t\t}\n\t\t\tmk(EIf(cond,e1,e2),p1,(e2 == null) ? tokenMax : pmax(e2));\n\t\tcase \"var\":\n\t\t\tvar tk = token();\n\t\t\tvar ident = null;\n\t\t\tswitch(tk) {\n\t\t\tcase TId(id): ident = id;\n\t\t\tdefault: unexpected(tk);\n\t\t\t}\n\t\t\ttk = token();\n\t\t\tvar t = null;\n\t\t\tif( tk == TDoubleDot && allowTypes ) {\n\t\t\t\tt = parseType();\n\t\t\t\ttk = token();\n\t\t\t}\n\t\t\tvar e = null;\n\t\t\tif( Type.enumEq(tk,TOp(\"=\")) )\n\t\t\t\te = parseExpr();\n\t\t\telse\n\t\t\t\tpush(tk);\n\t\t\tmk(EVar(ident,t,e),p1,(e == null) ? tokenMax : pmax(e));\n\t\tcase \"while\":\n\t\t\tvar econd = parseExpr();\n\t\t\tvar e = parseExpr();\n\t\t\tmk(EWhile(econd,e),p1,pmax(e));\n\t\tcase \"for\":\n\t\t\tensure(TPOpen);\n\t\t\tvar tk = token();\n\t\t\tvar vname = null;\n\t\t\tswitch( tk ) {\n\t\t\tcase TId(id): vname = id;\n\t\t\tdefault: unexpected(tk);\n\t\t\t}\n\t\t\ttk = token();\n\t\t\tif( !Type.enumEq(tk,TId(\"in\")) ) unexpected(tk);\n\t\t\tvar eiter = parseExpr();\n\t\t\tensure(TPClose);\n\t\t\tvar e = parseExpr();\n\t\t\tmk(EFor(vname,eiter,e),p1,pmax(e));\n\t\tcase \"break\": mk(EBreak);\n\t\tcase \"continue\": mk(EContinue);\n\t\tcase \"else\": unexpected(TId(id));\n\t\tcase \"function\":\n\t\t\tvar tk = token();\n\t\t\tvar name = null;\n\t\t\tswitch( tk ) {\n\t\t\tcase TId(id): name = id;\n\t\t\tdefault: push(tk);\n\t\t\t}\n\t\t\tensure(TPOpen);\n\t\t\tvar args = new Array();\n\t\t\ttk = token();\n\t\t\tif( tk != TPClose ) {\n\t\t\t\tvar done = false;\n\t\t\t\twhile( !done ) {\n\t\t\t\t\tvar name = null, opt = false;\n\t\t\t\t\tswitch( tk ) {\n\t\t\t\t\tcase TQuestion:\n\t\t\t\t\t\topt = true;\n\t\t\t\t\t\ttk = token();\n\t\t\t\t\tdefault:\n\t\t\t\t\t}\n\t\t\t\t\tswitch( tk ) {\n\t\t\t\t\tcase TId(id): name = id;\n\t\t\t\t\tdefault: unexpected(tk);\n\t\t\t\t\t}\n\t\t\t\t\ttk = token();\n\t\t\t\t\tvar arg : Argument = { name : name };\n\t\t\t\t\targs.push(arg);\n\t\t\t\t\tif( opt ) arg.opt = true;\n\t\t\t\t\tif( tk == TDoubleDot && allowTypes ) {\n\t\t\t\t\t\targ.t = parseType();\n\t\t\t\t\t\ttk = token();\n\t\t\t\t\t}\n\t\t\t\t\tswitch( tk ) {\n\t\t\t\t\tcase TComma:\n\t\t\t\t\t\ttk = token();\n\t\t\t\t\tcase TPClose:\n\t\t\t\t\t\tdone = true;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tunexpected(tk);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar ret = null;\n\t\t\tif( allowTypes ) {\n\t\t\t\ttk = token();\n\t\t\t\tif( tk != TDoubleDot )\n\t\t\t\t\tpush(tk);\n\t\t\t\telse\n\t\t\t\t\tret = parseType();\n\t\t\t}\n\t\t\tvar body = parseExpr();\n\t\t\tmk(EFunction(args, body, name, ret),p1,pmax(body));\n\t\tcase \"return\":\n\t\t\tvar tk = token();\n\t\t\tpush(tk);\n\t\t\tvar e = if( tk == TSemicolon ) null else parseExpr();\n\t\t\tmk(EReturn(e),p1,if( e == null ) tokenMax else pmax(e));\n\t\tcase \"new\":\n\t\t\tvar a = new Array();\n\t\t\tvar tk = token();\n\t\t\tswitch( tk ) {\n\t\t\tcase TId(id): a.push(id);\n\t\t\tdefault: unexpected(tk);\n\t\t\t}\n\t\t\tvar next = true;\n\t\t\twhile( next ) {\n\t\t\t\ttk = token();\n\t\t\t\tswitch( tk ) {\n\t\t\t\tcase TDot:\n\t\t\t\t\ttk = token();\n\t\t\t\t\tswitch(tk) {\n\t\t\t\t\tcase TId(id): a.push(id);\n\t\t\t\t\tdefault: unexpected(tk);\n\t\t\t\t\t}\n\t\t\t\tcase TPOpen:\n\t\t\t\t\tnext = false;\n\t\t\t\tdefault:\n\t\t\t\t\tunexpected(tk);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar args = parseExprList(TPClose);\n\t\t\tmk(ENew(a.join(\".\"),args),p1);\n\t\tcase \"throw\":\n\t\t\tvar e = parseExpr();\n\t\t\tmk(EThrow(e),p1,pmax(e));\n\t\tcase \"try\":\n\t\t\tvar e = parseExpr();\n\t\t\tvar tk = token();\n\t\t\tif( !Type.enumEq(tk, TId(\"catch\")) ) unexpected(tk);\n\t\t\tensure(TPOpen);\n\t\t\ttk = token();\n\t\t\tvar vname = switch( tk ) {\n\t\t\tcase TId(id): id;\n\t\t\tdefault: unexpected(tk);\n\t\t\t}\n\t\t\tensure(TDoubleDot);\n\t\t\tvar t = null;\n\t\t\tif( allowTypes )\n\t\t\t\tt = parseType();\n\t\t\telse {\n\t\t\t\ttk = token();\n\t\t\t\tif( !Type.enumEq(tk, TId(\"Dynamic\")) ) unexpected(tk);\n\t\t\t}\n\t\t\tensure(TPClose);\n\t\t\tvar ec = parseExpr();\n\t\t\tmk(ETry(e, vname, t, ec), p1, pmax(ec));\n\t\tcase \"switch\":\n\t\t\tvar e = parseExpr();\n\t\t\tvar def = null, cases = [];\n\t\t\tensure(TBrOpen);\n\t\t\twhile( true ) {\n\t\t\t\tvar tk = token();\n\t\t\t\tswitch( tk ) {\n\t\t\t\tcase TId(\"case\"):\n\t\t\t\t\tvar c = { values : [], expr : null };\n\t\t\t\t\tcases.push(c);\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tvar e = parseExpr();\n\t\t\t\t\t\tc.values.push(e);\n\t\t\t\t\t\ttk = token();\n\t\t\t\t\t\tswitch( tk ) {\n\t\t\t\t\t\tcase TComma:\n\t\t\t\t\t\t\t// next expr\n\t\t\t\t\t\tcase TDoubleDot:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tunexpected(tk);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar exprs = [];\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\ttk = token();\n\t\t\t\t\t\tpush(tk);\n\t\t\t\t\t\tswitch( tk ) {\n\t\t\t\t\t\tcase TId(\"case\"), TId(\"default\"), TBrClose:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\texprs.push(parseFullExpr());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tc.expr = if( exprs.length == 1)\n\t\t\t\t\t\texprs[0];\n\t\t\t\t\telse if( exprs.length == 0 )\n\t\t\t\t\t\tmk(EBlock([]), tokenMin, tokenMin);\n\t\t\t\t\telse\n\t\t\t\t\t\tmk(EBlock(exprs), pmin(exprs[0]), pmax(exprs[exprs.length - 1]));\n\t\t\t\tcase TId(\"default\"):\n\t\t\t\t\tif( def != null ) unexpected(tk);\n\t\t\t\t\tensure(TDoubleDot);\n\t\t\t\t\tvar exprs = [];\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\ttk = token();\n\t\t\t\t\t\tpush(tk);\n\t\t\t\t\t\tswitch( tk ) {\n\t\t\t\t\t\tcase TId(\"case\"), TId(\"default\"), TBrClose:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\texprs.push(parseFullExpr());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdef = if( exprs.length == 1)\n\t\t\t\t\t\texprs[0];\n\t\t\t\t\telse if( exprs.length == 0 )\n\t\t\t\t\t\tmk(EBlock([]), tokenMin, tokenMin);\n\t\t\t\t\telse\n\t\t\t\t\t\tmk(EBlock(exprs), pmin(exprs[0]), pmax(exprs[exprs.length - 1]));\n\t\t\t\tcase TBrClose:\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tunexpected(tk);\n\t\t\t\t}\n\t\t\t}\n\t\t\tmk(ESwitch(e, cases, def), p1, tokenMax);\n\t\tdefault:\n\t\t\tnull;\n\t\t}\n\t}\n\n\tfunction parseExprNext( e1 : Expr ) {\n\t\tvar tk = token();\n\t\tswitch( tk ) {\n\t\tcase TOp(op):\n\t\t\tif( unops.get(op) ) {\n\t\t\t\tif( isBlock(e1) || switch(expr(e1)) { case EParent(_): true; default: false; } ) {\n\t\t\t\t\tpush(tk);\n\t\t\t\t\treturn e1;\n\t\t\t\t}\n\t\t\t\treturn parseExprNext(mk(EUnop(op,false,e1),pmin(e1)));\n\t\t\t}\n\t\t\treturn makeBinop(op,e1,parseExpr());\n\t\tcase TDot:\n\t\t\ttk = token();\n\t\t\tvar field = null;\n\t\t\tswitch(tk) {\n\t\t\tcase TId(id): field = id;\n\t\t\tdefault: unexpected(tk);\n\t\t\t}\n\t\t\treturn parseExprNext(mk(EField(e1,field),pmin(e1)));\n\t\tcase TPOpen:\n\t\t\treturn parseExprNext(mk(ECall(e1,parseExprList(TPClose)),pmin(e1)));\n\t\tcase TBkOpen:\n\t\t\tvar e2 = parseExpr();\n\t\t\tensure(TBkClose);\n\t\t\treturn parseExprNext(mk(EArray(e1,e2),pmin(e1)));\n\t\tcase TQuestion:\n\t\t\tvar e2 = parseExpr();\n\t\t\tensure(TDoubleDot);\n\t\t\tvar e3 = parseExpr();\n\t\t\treturn mk(ETernary(e1,e2,e3),pmin(e1),pmax(e3));\n\t\tdefault:\n\t\t\tpush(tk);\n\t\t\treturn e1;\n\t\t}\n\t}\n\n\tfunction parseType() : CType {\n\t\tvar t = token();\n\t\tswitch( t ) {\n\t\tcase TId(v):\n\t\t\tvar path = [v];\n\t\t\twhile( true ) {\n\t\t\t\tt = token();\n\t\t\t\tif( t != TDot )\n\t\t\t\t\tbreak;\n\t\t\t\tt = token();\n\t\t\t\tswitch( t ) {\n\t\t\t\tcase TId(v):\n\t\t\t\t\tpath.push(v);\n\t\t\t\tdefault:\n\t\t\t\t\tunexpected(t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar params = null;\n\t\t\tswitch( t ) {\n\t\t\tcase TOp(op):\n\t\t\t\tif( op == \"<\" ) {\n\t\t\t\t\tparams = [];\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tparams.push(parseType());\n\t\t\t\t\t\tt = token();\n\t\t\t\t\t\tswitch( t ) {\n\t\t\t\t\t\tcase TComma: continue;\n\t\t\t\t\t\tcase TOp(op):\n\t\t\t\t\t\t\tif( op == \">\" ) break;\n\t\t\t\t\t\t\tif( op.charCodeAt(0) == \">\".code ) {\n\t\t\t\t\t\t\t\t#if hscriptPos\n\t\t\t\t\t\t\t\ttokens.add({ t : TOp(op.substr(1)), min : tokenMax - op.length - 1, max : tokenMax });\n\t\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\ttokens.add(TOp(op.substr(1)));\n\t\t\t\t\t\t\t\t#end\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t}\n\t\t\t\t\t\tunexpected(t);\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t\tpush(t);\n\t\t\tdefault:\n\t\t\t\tpush(t);\n\t\t\t}\n\t\t\treturn parseTypeNext(CTPath(path, params));\n\t\tcase TPOpen:\n\t\t\tvar t = parseType();\n\t\t\tensure(TPClose);\n\t\t\treturn parseTypeNext(CTParent(t));\n\t\tcase TBrOpen:\n\t\t\tvar fields = [];\n\t\t\twhile( true ) {\n\t\t\t\tt = token();\n\t\t\t\tswitch( t ) {\n\t\t\t\tcase TBrClose: break;\n\t\t\t\tcase TId(name):\n\t\t\t\t\tensure(TDoubleDot);\n\t\t\t\t\tfields.push( { name : name, t : parseType() } );\n\t\t\t\t\tt = token();\n\t\t\t\t\tswitch( t ) {\n\t\t\t\t\tcase TComma:\n\t\t\t\t\tcase TBrClose: break;\n\t\t\t\t\tdefault: unexpected(t);\n\t\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tunexpected(t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn parseTypeNext(CTAnon(fields));\n\t\tdefault:\n\t\t\treturn unexpected(t);\n\t\t}\n\t}\n\n\tfunction parseTypeNext( t : CType ) {\n\t\tvar tk = token();\n\t\tswitch( tk ) {\n\t\tcase TOp(op):\n\t\t\tif( op != \"->\" ) {\n\t\t\t\tpush(tk);\n\t\t\t\treturn t;\n\t\t\t}\n\t\tdefault:\n\t\t\tpush(tk);\n\t\t\treturn t;\n\t\t}\n\t\tvar t2 = parseType();\n\t\tswitch( t2 ) {\n\t\tcase CTFun(args, _):\n\t\t\targs.unshift(t);\n\t\t\treturn t2;\n\t\tdefault:\n\t\t\treturn CTFun([t], t2);\n\t\t}\n\t}\n\n\tfunction parseExprList( etk ) {\n\t\tvar args = new Array();\n\t\tvar tk = token();\n\t\tif( tk == etk )\n\t\t\treturn args;\n\t\tpush(tk);\n\t\twhile( true ) {\n\t\t\targs.push(parseExpr());\n\t\t\ttk = token();\n\t\t\tswitch( tk ) {\n\t\t\tcase TComma:\n\t\t\tdefault:\n\t\t\t\tif( tk == etk ) break;\n\t\t\t\tunexpected(tk);\n\t\t\t}\n\t\t}\n\t\treturn args;\n\t}\n\n\tinline function incPos() {\n\t\t#if hscriptPos\n\t\treadPos++;\n\t\t#end\n\t}\n\n\tfunction readChar() {\n\t\tincPos();\n\t\treturn try input.readByte() catch( e : Dynamic ) 0;\n\t}\n\n\tfunction readString( until ) {\n\t\tvar c = 0;\n\t\tvar b = new haxe.io.BytesOutput();\n\t\tvar esc = false;\n\t\tvar old = line;\n\t\tvar s = input;\n\t\t#if hscriptPos\n\t\tvar p1 = readPos - 1;\n\t\t#end\n\t\twhile( true ) {\n\t\t\ttry {\n\t\t\t\tincPos();\n\t\t\t\tc = s.readByte();\n\t\t\t} catch( e : Dynamic ) {\n\t\t\t\tline = old;\n\t\t\t\terror(EUnterminatedString, p1, p1);\n\t\t\t}\n\t\t\tif( esc ) {\n\t\t\t\tesc = false;\n\t\t\t\tswitch( c ) {\n\t\t\t\tcase 'n'.code: b.writeByte(10);\n\t\t\t\tcase 'r'.code: b.writeByte(13);\n\t\t\t\tcase 't'.code: b.writeByte(9);\n\t\t\t\tcase \"'\".code, '\"'.code, '\\\\'.code: b.writeByte(c);\n\t\t\t\tcase '/'.code: if( allowJSON ) b.writeByte(c) else invalidChar(c);\n\t\t\t\tcase \"u\".code:\n\t\t\t\t\tif( !allowJSON ) invalidChar(c);\n\t\t\t\t\tvar code = null;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tincPos();\n\t\t\t\t\t\tincPos();\n\t\t\t\t\t\tincPos();\n\t\t\t\t\t\tincPos();\n\t\t\t\t\t\tcode = s.readString(4);\n\t\t\t\t\t} catch( e : Dynamic ) {\n\t\t\t\t\t\tline = old;\n\t\t\t\t\t\terror(EUnterminatedString, p1, p1);\n\t\t\t\t\t}\n\t\t\t\t\tvar k = 0;\n\t\t\t\t\tfor( i in 0...4 ) {\n\t\t\t\t\t\tk <<= 4;\n\t\t\t\t\t\tvar char = code.charCodeAt(i);\n\t\t\t\t\t\tswitch( char ) {\n\t\t\t\t\t\tcase 48,49,50,51,52,53,54,55,56,57: // 0-9\n\t\t\t\t\t\t\tk += char - 48;\n\t\t\t\t\t\tcase 65,66,67,68,69,70: // A-F\n\t\t\t\t\t\t\tk += char - 55;\n\t\t\t\t\t\tcase 97,98,99,100,101,102: // a-f\n\t\t\t\t\t\t\tk += char - 87;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tinvalidChar(char);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// encode k in UTF8\n\t\t\t\t\tif( k <= 0x7F )\n\t\t\t\t\t\tb.writeByte(k);\n\t\t\t\t\telse if( k <= 0x7FF ) {\n\t\t\t\t\t\tb.writeByte( 0xC0 | (k >> 6));\n\t\t\t\t\t\tb.writeByte( 0x80 | (k & 63));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tb.writeByte( 0xE0 | (k >> 12) );\n\t\t\t\t\t\tb.writeByte( 0x80 | ((k >> 6) & 63) );\n\t\t\t\t\t\tb.writeByte( 0x80 | (k & 63) );\n\t\t\t\t\t}\n\t\t\t\tdefault: invalidChar(c);\n\t\t\t\t}\n\t\t\t} else if( c == 92 )\n\t\t\t\tesc = true;\n\t\t\telse if( c == until )\n\t\t\t\tbreak;\n\t\t\telse {\n\t\t\t\tif( c == 10 ) line++;\n\t\t\t\tb.writeByte(c);\n\t\t\t}\n\t\t}\n\t\treturn b.getBytes().toString();\n\t}\n\n\tfunction token() {\n\t\t#if hscriptPos\n\t\tvar t = tokens.pop();\n\t\tif( t != null ) {\n\t\t\ttokenMin = t.min;\n\t\t\ttokenMax = t.max;\n\t\t\treturn t.t;\n\t\t}\n\t\toldTokenMin = tokenMin;\n\t\toldTokenMax = tokenMax;\n\t\ttokenMin = (this.char < 0) ? readPos : readPos - 1;\n\t\tvar t = _token();\n\t\ttokenMax = (this.char < 0) ? readPos - 1 : readPos - 2;\n\t\treturn t;\n\t}\n\n\tfunction _token() {\n\t\t#else\n\t\tif( !tokens.isEmpty() )\n\t\t\treturn tokens.pop();\n\t\t#end\n\t\tvar char;\n\t\tif( this.char < 0 )\n\t\t\tchar = readChar();\n\t\telse {\n\t\t\tchar = this.char;\n\t\t\tthis.char = -1;\n\t\t}\n\t\twhile( true ) {\n\t\t\tswitch( char ) {\n\t\t\tcase 0: return TEof;\n\t\t\tcase 32,9,13: // space, tab, CR\n\t\t\t\t#if hscriptPos\n\t\t\t\ttokenMin++;\n\t\t\t\t#end\n\t\t\tcase 10: line++; // LF\n\t\t\t\t#if hscriptPos\n\t\t\t\ttokenMin++;\n\t\t\t\t#end\n\t\t\tcase 48,49,50,51,52,53,54,55,56,57: // 0...9\n\t\t\t\tvar n = (char - 48) * 1.0;\n\t\t\t\tvar exp = 0.;\n\t\t\t\twhile( true ) {\n\t\t\t\t\tchar = readChar();\n\t\t\t\t\texp *= 10;\n\t\t\t\t\tswitch( char ) {\n\t\t\t\t\tcase 48,49,50,51,52,53,54,55,56,57:\n\t\t\t\t\t\tn = n * 10 + (char - 48);\n\t\t\t\t\tcase 46:\n\t\t\t\t\t\tif( exp > 0 ) {\n\t\t\t\t\t\t\t// in case of '...'\n\t\t\t\t\t\t\tif( exp == 10 && readChar() == 46 ) {\n\t\t\t\t\t\t\t\tpush(TOp(\"...\"));\n\t\t\t\t\t\t\t\tvar i = Std.int(n);\n\t\t\t\t\t\t\t\treturn TConst( (i == n) ? CInt(i) : CFloat(n) );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinvalidChar(char);\n\t\t\t\t\t\t}\n\t\t\t\t\t\texp = 1.;\n\t\t\t\t\tcase 120: // x\n\t\t\t\t\t\tif( n > 0 || exp > 0 )\n\t\t\t\t\t\t\tinvalidChar(char);\n\t\t\t\t\t\t// read hexa\n\t\t\t\t\t\t#if haxe3\n\t\t\t\t\t\tvar n = 0;\n\t\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\t\tchar = readChar();\n\t\t\t\t\t\t\tswitch( char ) {\n\t\t\t\t\t\t\tcase 48,49,50,51,52,53,54,55,56,57: // 0-9\n\t\t\t\t\t\t\t\tn = (n << 4) + char - 48;\n\t\t\t\t\t\t\tcase 65,66,67,68,69,70: // A-F\n\t\t\t\t\t\t\t\tn = (n << 4) + (char - 55);\n\t\t\t\t\t\t\tcase 97,98,99,100,101,102: // a-f\n\t\t\t\t\t\t\t\tn = (n << 4) + (char - 87);\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthis.char = char;\n\t\t\t\t\t\t\t\treturn TConst(CInt(n));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#else\n\t\t\t\t\t\tvar n = haxe.Int32.ofInt(0);\n\t\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\t\tchar = readChar();\n\t\t\t\t\t\t\tswitch( char ) {\n\t\t\t\t\t\t\tcase 48,49,50,51,52,53,54,55,56,57: // 0-9\n\t\t\t\t\t\t\t\tn = haxe.Int32.add(haxe.Int32.shl(n,4), cast (char - 48));\n\t\t\t\t\t\t\tcase 65,66,67,68,69,70: // A-F\n\t\t\t\t\t\t\t\tn = haxe.Int32.add(haxe.Int32.shl(n,4), cast (char - 55));\n\t\t\t\t\t\t\tcase 97,98,99,100,101,102: // a-f\n\t\t\t\t\t\t\t\tn = haxe.Int32.add(haxe.Int32.shl(n,4), cast (char - 87));\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthis.char = char;\n\t\t\t\t\t\t\t\t// we allow to parse hexadecimal Int32 in Neko, but when the value will be\n\t\t\t\t\t\t\t\t// evaluated by Interpreter, a failure will occur if no Int32 operation is\n\t\t\t\t\t\t\t\t// performed\n\t\t\t\t\t\t\t\tvar v = try CInt(haxe.Int32.toInt(n)) catch( e : Dynamic ) CInt32(n);\n\t\t\t\t\t\t\t\treturn TConst(v);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#end\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthis.char = char;\n\t\t\t\t\t\tvar i = Std.int(n);\n\t\t\t\t\t\treturn TConst( (exp > 0) ? CFloat(n * 10 / exp) : ((i == n) ? CInt(i) : CFloat(n)) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\tcase 59: return TSemicolon;\n\t\t\tcase 40: return TPOpen;\n\t\t\tcase 41: return TPClose;\n\t\t\tcase 44: return TComma;\n\t\t\tcase 46:\n\t\t\t\tchar = readChar();\n\t\t\t\tswitch( char ) {\n\t\t\t\tcase 48,49,50,51,52,53,54,55,56,57:\n\t\t\t\t\tvar n = char - 48;\n\t\t\t\t\tvar exp = 1;\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tchar = readChar();\n\t\t\t\t\t\texp *= 10;\n\t\t\t\t\t\tswitch( char ) {\n\t\t\t\t\t\tcase 48,49,50,51,52,53,54,55,56,57:\n\t\t\t\t\t\t\tn = n * 10 + (char - 48);\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthis.char = char;\n\t\t\t\t\t\t\treturn TConst( CFloat(n/exp) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\tcase 46:\n\t\t\t\t\tchar = readChar();\n\t\t\t\t\tif( char != 46 )\n\t\t\t\t\t\tinvalidChar(char);\n\t\t\t\t\treturn TOp(\"...\");\n\t\t\t\tdefault:\n\t\t\t\t\tthis.char = char;\n\t\t\t\t\treturn TDot;\n\t\t\t\t}\n\t\t\tcase 123: return TBrOpen;\n\t\t\tcase 125: return TBrClose;\n\t\t\tcase 91: return TBkOpen;\n\t\t\tcase 93: return TBkClose;\n\t\t\tcase 39: return TConst( CString(readString(39)) );\n\t\t\tcase 34: return TConst( CString(readString(34)) );\n\t\t\tcase 63: return TQuestion;\n\t\t\tcase 58: return TDoubleDot;\n\t\t\tcase '='.code:\n\t\t\t\tchar = readChar();\n\t\t\t\tif( char == '='.code )\n\t\t\t\t\treturn TOp(\"==\");\n\t\t\t\tthis.char = char;\n\t\t\t\treturn TOp(\"=\");\n\t\t\tdefault:\n\t\t\t\tif( ops[char] ) {\n\t\t\t\t\tvar op = String.fromCharCode(char);\n\t\t\t\t\tvar prev = -1;\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tchar = readChar();\n\t\t\t\t\t\tif( !ops[char] || prev == '='.code ) {\n\t\t\t\t\t\t\tif( op.charCodeAt(0) == '/'.code )\n\t\t\t\t\t\t\t\treturn tokenComment(op,char);\n\t\t\t\t\t\t\tthis.char = char;\n\t\t\t\t\t\t\treturn TOp(op);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprev = char;\n\t\t\t\t\t\top += String.fromCharCode(char);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( idents[char] ) {\n\t\t\t\t\tvar id = String.fromCharCode(char);\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tchar = readChar();\n\t\t\t\t\t\tif( !idents[char] ) {\n\t\t\t\t\t\t\tthis.char = char;\n\t\t\t\t\t\t\treturn TId(id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tid += String.fromCharCode(char);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tinvalidChar(char);\n\t\t\t}\n\t\t\tchar = readChar();\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction tokenComment( op : String, char : Int ) {\n\t\tvar c = op.charCodeAt(1);\n\t\tvar s = input;\n\t\tif( c == '/'.code ) { // comment\n\t\t\ttry {\n\t\t\t\twhile( char != '\\r'.code && char != '\\n'.code ) {\n\t\t\t\t\tincPos();\n\t\t\t\t\tchar = s.readByte();\n\t\t\t\t}\n\t\t\t\tthis.char = char;\n\t\t\t} catch( e : Dynamic ) {\n\t\t\t}\n\t\t\treturn token();\n\t\t}\n\t\tif( c == '*'.code ) { /* comment */\n\t\t\tvar old = line;\n\t\t\tif( op == \"/**/\" ) {\n\t\t\t\tthis.char = char;\n\t\t\t\treturn token();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\twhile( true ) {\n\t\t\t\t\twhile( char != '*'.code ) {\n\t\t\t\t\t\tif( char == '\\n'.code ) line++;\n\t\t\t\t\t\tincPos();\n\t\t\t\t\t\tchar = s.readByte();\n\t\t\t\t\t}\n\t\t\t\t\tincPos();\n\t\t\t\t\tchar = s.readByte();\n\t\t\t\t\tif( char == '/'.code )\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} catch( e : Dynamic ) {\n\t\t\t\tline = old;\n\t\t\t\terror(EUnterminatedComment, tokenMin, tokenMin);\n\t\t\t}\n\t\t\treturn token();\n\t\t}\n\t\tthis.char = char;\n\t\treturn TOp(op);\n\t}\n\n\tfunction constString( c ) {\n\t\treturn switch(c) {\n\t\tcase CInt(v): Std.string(v);\n\t\tcase CFloat(f): Std.string(f);\n\t\tcase CString(s): s; // TODO : escape + quote\n\t\t#if !haxe3\n\t\tcase CInt32(v): Std.string(v);\n\t\t#end\n\t\t}\n\t}\n\n\tfunction tokenString( t ) {\n\t\treturn switch( t ) {\n\t\tcase TEof: \"<eof>\";\n\t\tcase TConst(c): constString(c);\n\t\tcase TId(s): s;\n\t\tcase TOp(s): s;\n\t\tcase TPOpen: \"(\";\n\t\tcase TPClose: \")\";\n\t\tcase TBrOpen: \"{\";\n\t\tcase TBrClose: \"}\";\n\t\tcase TDot: \".\";\n\t\tcase TComma: \",\";\n\t\tcase TSemicolon: \";\";\n\t\tcase TBkOpen: \"[\";\n\t\tcase TBkClose: \"]\";\n\t\tcase TQuestion: \"?\";\n\t\tcase TDoubleDot: \":\";\n\t\t}\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nprivate class HaxeError extends js.Error {\n\n\tvar val:Dynamic;\n\n\tpublic function new(val:Dynamic) untyped {\n\t\tsuper();\n\t\tthis.val = __define_feature__(\"js.Boot.HaxeError\", val);\n\t\tthis.message = String(val);\n\t\tif (js.Error.captureStackTrace) js.Error.captureStackTrace(this, HaxeError);\n\t}\n}\n\n@:dox(hide)\nclass Boot {\n\n\tprivate static function __unhtml(s : String) {\n\t\treturn s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t}\n\n\tprivate static function __trace(v,i : haxe.PosInfos) {\n\t\tuntyped {\n\t\t\tvar msg = if( i != null ) i.fileName+\":\"+i.lineNumber+\": \" else \"\";\n\t\t\t#if jsfl\n\t\t\tmsg += __string_rec(v,\"\");\n\t\t\tfl.trace(msg);\n\t\t\t#else\n\t\t\tmsg += __string_rec(v, \"\");\n\t\t\tif( i != null && i.customParams != null )\n\t\t\t\tfor( v in i.customParams )\n\t\t\t\t\tmsg += \",\" + __string_rec(v, \"\");\n\t\t\tvar d;\n\t\t\tif( __js__(\"typeof\")(document) != \"undefined\" && (d = document.getElementById(\"haxe:trace\")) != null )\n\t\t\t\td.innerHTML += __unhtml(msg)+\"<br/>\";\n\t\t\telse if( __js__(\"typeof console\") != \"undefined\" && __js__(\"console\").log != null )\n\t\t\t\t__js__(\"console\").log(msg);\n\t\t\t#end\n\t\t}\n\t}\n\n\tprivate static function __clear_trace() {\n\t\tuntyped {\n\t\t\t#if jsfl\n\t\t\tfl.outputPanel.clear();\n\t\t\t#else\n\t\t\tvar d = document.getElementById(\"haxe:trace\");\n\t\t\tif( d != null )\n\t\t\t\td.innerHTML = \"\";\n\t\t\t#end\n\t\t}\n\t}\n\n\tstatic inline function isClass(o:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isClass\", o.__name__);\n\t}\n\n\tstatic inline function isEnum(e:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isEnum\", e.__ename__);\n\t}\n\n\tstatic function getClass(o:Dynamic) : Dynamic {\n\t\tif (Std.is(o, Array))\n\t\t\treturn Array;\n\t\telse {\n\t\t\tvar cl = untyped __define_feature__(\"js.Boot.getClass\", o.__class__);\n\t\t\tif (cl != null)\n\t\t\t\treturn cl;\n\t\t\tvar name = __nativeClassName(o);\n\t\t\tif (name != null)\n\t\t\t\treturn __resolveNativeClass(name);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t@:ifFeature(\"has_enum\")\n\tprivate static function __string_rec(o,s:String) {\n\t\tuntyped {\n\t\t\tif( o == null )\n\t\t\t    return \"null\";\n\t\t\tif( s.length >= 5 )\n\t\t\t\treturn \"<...>\"; // too much deep recursion\n\t\t\tvar t = __js__(\"typeof(o)\");\n\t\t\tif( t == \"function\" && (isClass(o) || isEnum(o)) )\n\t\t\t\tt = \"object\";\n\t\t\tswitch( t ) {\n\t\t\tcase \"object\":\n\t\t\t\tif( __js__(\"o instanceof Array\") ) {\n\t\t\t\t\tif( o.__enum__ ) {\n\t\t\t\t\t\tif( o.length == 2 )\n\t\t\t\t\t\t\treturn o[0];\n\t\t\t\t\t\tvar str = o[0]+\"(\";\n\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\tfor( i in 2...o.length ) {\n\t\t\t\t\t\t\tif( i != 2 )\n\t\t\t\t\t\t\t\tstr += \",\" + __string_rec(o[i],s);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tstr += __string_rec(o[i],s);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn str + \")\";\n\t\t\t\t\t}\n\t\t\t\t\tvar l = o.length;\n\t\t\t\t\tvar i;\n\t\t\t\t\tvar str = \"[\";\n\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\tfor( i in 0...l )\n\t\t\t\t\t\tstr += (if (i > 0) \",\" else \"\")+__string_rec(o[i],s);\n\t\t\t\t\tstr += \"]\";\n\t\t\t\t\treturn str;\n\t\t\t\t}\n\t\t\t\tvar tostr;\n\t\t\t\ttry {\n\t\t\t\t\ttostr = untyped o.toString;\n\t\t\t\t} catch( e : Dynamic ) {\n\t\t\t\t\t// strange error on IE\n\t\t\t\t\treturn \"???\";\n\t\t\t\t}\n\t\t\t\tif( tostr != null && tostr != __js__(\"Object.toString\") && __typeof__(tostr) == \"function\" ) {\n\t\t\t\t\tvar s2 = o.toString();\n\t\t\t\t\tif( s2 != \"[object Object]\")\n\t\t\t\t\t\treturn s2;\n\t\t\t\t}\n\t\t\t\tvar k : String = null;\n\t\t\t\tvar str = \"{\\n\";\n\t\t\t\ts += \"\\t\";\n\t\t\t\tvar hasp = (o.hasOwnProperty != null);\n\t\t\t\t__js__(\"for( var k in o ) {\");\n\t\t\t\t\tif( hasp && !o.hasOwnProperty(k) )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\" )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( str.length != 2 )\n\t\t\t\t\t\tstr += \", \\n\";\n\t\t\t\t\tstr += s + k + \" : \"+__string_rec(o[k],s);\n\t\t\t\t__js__(\"}\");\n\t\t\t\ts = s.substring(1);\n\t\t\t\tstr += \"\\n\" + s + \"}\";\n\t\t\t\treturn str;\n\t\t\tcase \"function\":\n\t\t\t\treturn \"<function>\";\n\t\t\tcase \"string\":\n\t\t\t\treturn o;\n\t\t\tdefault:\n\t\t\t\treturn String(o);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static function __interfLoop(cc : Dynamic,cl : Dynamic) {\n\t\tif( cc == null )\n\t\t\treturn false;\n\t\tif( cc == cl )\n\t\t\treturn true;\n\t\tvar intf : Dynamic = cc.__interfaces__;\n\t\tif( intf != null )\n\t\t\tfor( i in 0...intf.length ) {\n\t\t\t\tvar i : Dynamic = intf[i];\n\t\t\t\tif( i == cl || __interfLoop(i,cl) )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\treturn __interfLoop(cc.__super__,cl);\n\t}\n\n\t@:ifFeature(\"typed_catch\") private static function __instanceof(o : Dynamic,cl : Dynamic) {\n\t\tif( cl == null )\n\t\t\treturn false;\n\t\tswitch( cl ) {\n\t\tcase Int:\n\t\t\treturn (untyped __js__(\"(o|0) === o\"));\n\t\tcase Float:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"number\";\n\t\tcase Bool:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"boolean\";\n\t\tcase String:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"string\";\n\t\tcase Array:\n\t\t\treturn (untyped __js__(\"(o instanceof Array)\")) && o.__enum__ == null;\n\t\tcase Dynamic:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tif( o != null ) {\n\t\t\t\t// Check if o is an instance of a Haxe class or a native JS object\n\t\t\t\tif( (untyped __js__(\"typeof\"))(cl) == \"function\" ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tif( __interfLoop(getClass(o),cl) )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse if ( (untyped __js__(\"typeof\"))(cl) == \"object\" && __isNativeObj(cl) ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// do not use isClass/isEnum here\n\t\t\tuntyped __feature__(\"Class.*\",if( cl == Class && o.__name__ != null ) return true);\n\t\t\tuntyped __feature__(\"Enum.*\",if( cl == Enum && o.__ename__ != null ) return true);\n\t\t\treturn o.__enum__ == cl;\n\t\t}\n\t}\n\n\t@:ifFeature(\"typed_cast\") private static function __cast(o : Dynamic, t : Dynamic) {\n\t\tif (__instanceof(o, t)) return o;\n\t\telse throw \"Cannot cast \" +Std.string(o) + \" to \" +Std.string(t);\n\t}\n\n\tstatic var __toStr = untyped __js__(\"{}.toString\");\n\t// get native JS [[Class]]\n\tstatic function __nativeClassName(o:Dynamic):String {\n\t\tvar name = untyped __toStr.call(o).slice(8, -1);\n\t\t// exclude general Object and Function\n\t\t// also exclude Math and JSON, because instanceof cannot be called on them\n\t\tif (name == \"Object\" || name == \"Function\" || name == \"Math\" || name == \"JSON\")\n\t\t\treturn null;\n\t\treturn name;\n\t}\n\n\t// check for usable native JS object\n\tstatic function __isNativeObj(o:Dynamic):Bool {\n\t\treturn __nativeClassName(o) != null;\n\t}\n\n\t// resolve native JS class in the global scope:\n\tstatic function __resolveNativeClass(name:String) {\n\t\treturn untyped js.Lib.global[name];\n\t}\n\n}\n","/*\n * Copyright (C)2005-2015 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\n// This file is generated from mozilla/HTMLCanvasElement.webidl line 17:0. Do not edit!\n\npackage js.html;\n\n@:native(\"HTMLCanvasElement\")\nextern class CanvasElement extends Element\n{\n\tvar width : Int;\n\tvar height : Int;\n\t\n\t/** @throws DOMError */\n\tfunction getContext( contextId : String, ?contextOptions : Dynamic ) : Dynamic/*MISSING nsISupports*/;\n\t/** @throws DOMError */\n\tfunction toDataURL( ?type : String = \"\", ?encoderOptions : Dynamic ) : String;\n\t/** @throws DOMError */\n\tfunction toBlob( callback : Blob -> Void, ?type : String = \"\", ?encoderOptions : Dynamic ) : Void;\n\t\n\t/** Shorthand for getting a CanvasRenderingContext2D. */\n\tinline function getContext2d( ?attribs : {} ) : CanvasRenderingContext2D {\n\t\treturn cast getContext(\"2d\", attribs);\n\t}\n\t/** Shorthand for getting a js.html.webgl.RenderingContext. */\n\tinline function getContextWebGL( ?attribs : js.html.webgl.ContextAttributes ) : js.html.webgl.RenderingContext {\n\t\treturn CanvasUtil.getContextWebGL(this, attribs);\n\t}\n}\n\nprivate class CanvasUtil {\n\tpublic static function getContextWebGL( canvas :CanvasElement, attribs :{} ) {\n\t\tfor (name in [\"webgl\", \"experimental-webgl\"]) {\n\t\t\tvar ctx = canvas.getContext(name, attribs);\n\t\t\tif (ctx != null) return ctx;\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C)2005-2014 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js.html.compat;\n\n@:keep\nclass ArrayBuffer {\n\n\tpublic var byteLength : Int;\n\tvar a : Array<Int>;\n\t\n\tpublic function new( ?a : Dynamic ) {\n\t\tif( Std.is(a,Array) ) {\n\t\t\tthis.a = a;\n\t\t\tbyteLength = a.length;\n\t\t} else {\n\t\t\tvar len : Int = a;\n\t\t\tthis.a = [];\n\t\t\tfor( i in 0...len )\n\t\t\t\tthis.a[i] = 0;\n\t\t\tbyteLength = len;\n\t\t}\n\t}\n\t\n\tpublic function slice(begin,?end) {\n\t\treturn new ArrayBuffer(a.slice(begin,end));\n\t}\n\t\n\tstatic function sliceImpl(begin,?end) {\n\t\tvar u = new js.html.Uint8Array(untyped __js__('this'), begin, end == null ? null : end - begin);\n        var result = new js.html.ArrayBuffer(u.byteLength);\n        var resultArray = new js.html.Uint8Array(result);\n\t\tresultArray.set(u);\n        return result;\n\t}\n\n\tstatic function __init__() untyped {\n\t\tvar ArrayBuffer = js.Lib.global.ArrayBuffer || js.html.compat.ArrayBuffer;\n\t\tif( ArrayBuffer.prototype.slice == null ) ArrayBuffer.prototype.slice = sliceImpl; // IE10\n\t}\n}","/*\n * Copyright (C)2005-2014 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js.html.compat;\nimport haxe.io.Error;\n\n@:keep\n@:access(js.html.compat.ArrayBuffer)\nclass DataView {\n\n\tvar buf : ArrayBuffer;\n\tvar offset : Int;\n\tvar length : Int;\n\n\tpublic function new( buffer : ArrayBuffer, ?byteOffset : Int, ?byteLength : Int ) : Void {\n\t\tthis.buf = buffer;\n\t\tthis.offset = byteOffset == null ? 0 : byteOffset;\n\t\tthis.length = byteLength == null ? buffer.byteLength - this.offset : byteLength;\n\t\tif( offset < 0 || length < 0 || offset+length > buffer.byteLength )\n\t\t\tthrow OutsideBounds;\n\t}\n\n\tpublic function getInt8( byteOffset : Int ) : Int {\n\t\tvar v = buf.a[offset + byteOffset];\n\t\treturn v >= 0x80 ? v - 256 : v;\n\t}\n\n\tpublic function getUint8( byteOffset : Int ) : Int {\n\t\treturn buf.a[offset + byteOffset];\n\t}\n\n\tpublic function getInt16( byteOffset : Int, ?littleEndian : Bool ) : Int {\n\t\tvar v = getUint16(byteOffset, littleEndian);\n\t\treturn v >= 0x8000 ? v - 65536 : v;\n\t}\n\n\tpublic function getUint16( byteOffset : Int, ?littleEndian : Bool ) : Int {\n\t\treturn littleEndian ? buf.a[offset + byteOffset] | (buf.a[offset + byteOffset + 1] << 8) : (buf.a[offset + byteOffset]<<8) | buf.a[offset + byteOffset + 1];\n\t}\n\n\tpublic function getInt32( byteOffset : Int, ?littleEndian : Bool ) : Int {\n\t\tvar p = offset + byteOffset;\n\t\tvar a = buf.a[p++];\n\t\tvar b = buf.a[p++];\n\t\tvar c = buf.a[p++];\n\t\tvar d = buf.a[p++];\n\t\treturn littleEndian ? a | (b<<8) | (c<<16) | (d<<24) : d | (c << 8) | (b << 16) | (a << 24);\n\t}\n\n\tpublic function getUint32( byteOffset : Int, ?littleEndian : Bool ) : Int {\n\t\tvar v = getInt32(byteOffset, littleEndian);\n\t\treturn v < 0 ? cast (v + 4294967296.) : v;\n\t}\n\n\tpublic function getFloat32( byteOffset : Int, ?littleEndian : Bool ) : Float {\n\t\treturn haxe.io.FPHelper.i32ToFloat(getInt32(byteOffset,littleEndian));\n\t}\n\n\tpublic function getFloat64( byteOffset : Int, ?littleEndian : Bool ) : Float {\n\t\tvar a = getInt32(byteOffset, littleEndian);\n\t\tvar b = getInt32(byteOffset + 4, littleEndian);\n\t\treturn haxe.io.FPHelper.i64ToDouble(littleEndian?a:b,littleEndian?b:a);\n\t}\n\n\tpublic function setInt8( byteOffset : Int, value : Int ) : Void {\n\t\tbuf.a[byteOffset + offset] = (value < 0) ? (value + 128) & 0xFF : value & 0xFF;\n\t}\n\n\tpublic function setUint8( byteOffset : Int, value : Int ) : Void {\n\t\tbuf.a[byteOffset + offset] = value & 0xFF;\n\t}\n\n\tpublic function setInt16( byteOffset : Int, value : Int, ?littleEndian : Bool ) : Void {\n\t\tsetUint16(byteOffset, value < 0 ? value + 65536 : value, littleEndian);\n\t}\n\n\tpublic function setUint16( byteOffset : Int, value : Int, ?littleEndian : Bool ) : Void {\n\t\tvar p = byteOffset + offset;\n\t\tif( littleEndian ) {\n\t\t\tbuf.a[p] = value&0xFF;\n\t\t\tbuf.a[p++] = (value>>8) & 0xFF;\n\t\t} else {\n\t\t\tbuf.a[p++] = (value>>8) & 0xFF;\n\t\t\tbuf.a[p] = value&0xFF;\n\t\t}\n\t}\n\n\tpublic function setInt32( byteOffset : Int, value : Int, ?littleEndian : Bool ) : Void {\n\t\tsetUint32(byteOffset, value, littleEndian);\n\t}\n\n\tpublic function setUint32( byteOffset : Int, value : Int, ?littleEndian : Bool ) : Void {\n\t\tvar p = byteOffset + offset;\n\t\tif( littleEndian ) {\n\t\t\tbuf.a[p++] = value & 0xFF;\n\t\t\tbuf.a[p++] = (value>>8) & 0xFF;\n\t\t\tbuf.a[p++] = (value>>16) & 0xFF;\n\t\t\tbuf.a[p++] = value >>> 24;\n\t\t} else {\n\t\t\tbuf.a[p++] = value >>> 24;\n\t\t\tbuf.a[p++] = (value>>16) & 0xFF;\n\t\t\tbuf.a[p++] = (value>>8) & 0xFF;\n\t\t\tbuf.a[p++] = value & 0xFF;\n\t\t}\n\t}\n\n\tpublic function setFloat32( byteOffset : Int, value : Float, ?littleEndian : Bool ) : Void {\n\t\tsetUint32(byteOffset, haxe.io.FPHelper.floatToI32(value),littleEndian);\n\t}\n\n\tpublic function setFloat64( byteOffset : Int, value : Float, ?littleEndian : Bool ) : Void {\n\t\tvar i64 = haxe.io.FPHelper.doubleToI64(value);\n\t\tif( littleEndian ) {\n\t\t\tsetUint32(byteOffset, i64.low);\n\t\t\tsetUint32(byteOffset, i64.high);\n\t\t} else {\n\t\t\tsetUint32(byteOffset, i64.high);\n\t\t\tsetUint32(byteOffset, i64.low);\n\t\t}\n\t}\n\n\tstatic function __init__() {\n\t\tvar DataView = untyped js.Lib.global.DataView || js.html.compat.DataView;\n\t}\n\n}","/*\n * Copyright (C)2005-2014 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js.html.compat;\n\n@:keep\nclass Uint8Array {\n\n\tstatic var BYTES_PER_ELEMENT = 1;\n\n\tstatic function _new( ?arg1 : Dynamic, ?offset : Int, ?length : Int ) : Dynamic {\n\t\tvar arr;\n\t\tif( untyped __typeof__(arg1) == 'number' ) {\n\t\t\tarr = new Array();\n\t\t\tfor( i in 0...arg1 )\n\t\t\t\tarr[i] = 0;\n\t\t\tuntyped {\n\t\t\t\tarr.byteLength = arr.length;\n\t\t\t\tarr.byteOffset = 0;\n\t\t\t\tarr.buffer = new ArrayBuffer(arr);\n\t\t\t}\n\t\t} else if( Std.is(arg1,ArrayBuffer) ) {\n\t\t\tvar buffer : ArrayBuffer = arg1;\n\t\t\tif( offset == null ) offset = 0;\n\t\t\tif( length == null ) length = buffer.byteLength - offset;\n\t\t\tif( offset == 0 )\n\t\t\t\tarr = cast @:privateAccess buffer.a;\n\t\t\telse\n\t\t\t\t// here we are losing the fact that we should reference the same data,\n\t\t\t\t// but I don't see another way to have this behaviour while keeping [] access\n\t\t\t\tarr = cast @:privateAccess buffer.a.slice(offset, offset+length);\n\t\t\tuntyped {\n\t\t\t\tarr.byteLength = arr.length;\n\t\t\t\tarr.byteOffset = offset;\n\t\t\t\tarr.buffer = buffer;\n\t\t\t}\n\t\t} else if( Std.is(arg1, Array) ) {\n\t\t\tarr = (arg1 : Array<Int>).copy();\n\t\t\tuntyped {\n\t\t\t\tarr.byteLength = arr.length;\n\t\t\t\tarr.byteOffset = 0;\n\t\t\t\tarr.buffer = new ArrayBuffer(arr);\n\t\t\t}\n\t\t} else\n\t\t\tthrow \"TODO \"+arg1;\n\t\tuntyped {\n\t\t\tarr.subarray = _subarray;\n\t\t\tarr.set = _set;\n\t\t}\n\t\treturn arr;\n\t}\n\n\tstatic function _set( ?arg : Dynamic, ?offset : Int ) {\n\t\tvar t : Dynamic = untyped __js__(\"this\");\n\t\tif( Std.is(arg.buffer,ArrayBuffer) ) {\n\t\t\tvar a : Array<Int> = arg;\n\t\t\tif( arg.byteLength + offset > t.byteLength )\n\t\t\t\tthrow \"set() outside of range\";\n\t\t\tfor( i in 0...arg.byteLength )\n\t\t\t\tt[i + offset] = a[i];\n\t\t} else if( Std.is(arg,Array) ) {\n\t\t\tvar a : Array<Int> = arg;\n\t\t\tif( a.length + offset > t.byteLength )\n\t\t\t\tthrow \"set() outside of range\";\n\t\t\tfor( i in 0...a.length )\n\t\t\t\tt[i + offset] = a[i];\n\t\t} else\n\t\t\tthrow \"TODO\";\n\t}\n\n\tstatic function _subarray( start : Int, ?end : Int ) {\n\t\tvar t : Dynamic = untyped __js__(\"this\");\n\t\tvar a = _new(t.slice(start,end));\n\t\ta.byteOffset = start;\n\t\treturn a;\n\t}\n\n\tstatic function __init__() {\n\t\tvar Uint8Array = untyped js.Lib.global.Uint8Array || _new;\n\t}\n\n}","﻿package motion.actuators;\n\n\nimport motion.easing.IEasing;\nimport motion.Actuate;\n\n@:keepSub\n\n\nclass GenericActuator<T> implements IGenericActuator {\n\t\n\t\n\tprivate var duration:Float;\n\tprivate var id:String;\n\tprivate var properties:Dynamic;\n\tprivate var target:T;\n\tprivate var _autoVisible:Bool;\n\tprivate var _delay:Float;\n\tprivate var _ease:IEasing;\n\tprivate var _onComplete:Dynamic;\n\tprivate var _onCompleteParams:Array <Dynamic>;\n\tprivate var _onRepeat:Dynamic;\n\tprivate var _onRepeatParams:Array <Dynamic>;\n\tprivate var _onUpdate:Dynamic;\n\tprivate var _onUpdateParams:Array <Dynamic>;\n\tprivate var _onResume:Dynamic;\n\tprivate var _onResumeParams:Array <Dynamic>;\n\tprivate var _onPause:Dynamic;\n\tprivate var _onPauseParams:Array <Dynamic>;\n\tprivate var _reflect:Bool;\n\tprivate var _repeat:Int;\n\tprivate var _reverse:Bool;\n\tprivate var _smartRotation:Bool;\n\tprivate var _snapping:Bool;\n\tprivate var special:Bool;\n\t\n\t\n\tpublic function new (target:T, duration:Float, properties:Dynamic) {\n\t\t\n\t\t_autoVisible = true;\n\t\t_delay = 0;\n\t\t_reflect = false;\n\t\t_repeat = 0;\n\t\t_reverse = false;\n\t\t_smartRotation = false;\n\t\t_snapping = false;\n\t\tspecial = false;\n\t\t\n\t\tthis.target = target;\n\t\tthis.properties = properties;\n\t\tthis.duration = duration;\n\t\t\n\t\t_ease = Actuate.defaultEase;\n\t\t\n\t}\n\t\n\t\n\tprivate function apply ():Void {\n\t\t\n\t\tfor (i in Reflect.fields (properties)) {\n\t\t\t\n\t\t\t#if (haxe_209 || haxe3)\n\t\t\t\n\t\t\tif (#if flash false && #end Reflect.hasField (target, i)) {\n\t\t\t\t\n\t\t\t\tReflect.setField (target, i, Reflect.field (properties, i));\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tReflect.setProperty (target, i, Reflect.field (properties, i));\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\t#else\n\t\t\t\n\t\t\tReflect.setField (target, i, Reflect.field (properties, i));\n\t\t\t\n\t\t\t#end\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Flash performs faster when objects are set to visible = false rather than only alpha = 0. autoVisible toggles automatically based on alpha values\n\t * @param\tvalue\t\tWhether autoVisible should be enabled (Default is true)\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function autoVisible (?value:Null<Bool>):GenericActuator<T> {\n\t\t\n\t\tif (value == null) {\n\t\t\t\n\t\t\tvalue = true;\n\t\t\t\n\t\t}\n\t\t\n\t\t_autoVisible = value;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\tprivate inline function callMethod (method:Dynamic, params:Array<Dynamic> = null):Dynamic {\n\t\t\n\t\tif (params == null) {\n\t\t\t\n\t\t\tparams = [];\n\t\t\t\n\t\t}\n\t\t\n\t\t#if neko\n\t\t\n\t\tvar diff = untyped ($nargs)(method) - params.length;\n\t\t\n\t\tif (diff > 0) {\n\t\t\t\n\t\t\tparams = params.copy ();\n\t\t\t\n\t\t\tfor (i in 0...diff) {\n\t\t\t\t\n\t\t\t\tparams.push (null);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\t#end\n\t\t\n\t\treturn Reflect.callMethod (method, method, params);\n\t\t\n\t}\n\t\n\t\n\tprivate function change ():Void {\n\t\t\n\t\tif (_onUpdate != null) {\n\t\t\t\n\t\t\tcallMethod (_onUpdate, _onUpdateParams);\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\tprivate function complete (sendEvent:Bool = true):Void {\n\t\t\n\t\tif (sendEvent) {\n\t\t\t\n\t\t\tchange ();\n\t\t\t\n\t\t\tif (_onComplete != null) {\n\t\t\t\t\n\t\t\t\tcallMethod (_onComplete, _onCompleteParams);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tActuate.unload (this);\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Increases the delay before a tween is executed\n\t * @param\tduration\t\tThe amount of seconds to delay\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function delay (duration:Float):GenericActuator<T> {\n\t\t\n\t\t_delay = duration;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Sets the easing which is used when running the tween\n\t * @param\teasing\t\tAn easing equation, like Elastic.easeIn or Quad.easeOut\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function ease (easing:IEasing):GenericActuator<T> {\n\t\t\n\t\t_ease = easing;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\tprivate function move ():Void {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Defines a function which will be called when the tween finishes\n\t * @param\thandler\t\tThe function you would like to be called\n\t * @param\tparameters\t\tParameters you would like to pass to the handler function when it is called\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function onComplete (handler:Dynamic, parameters:Array <Dynamic> = null):GenericActuator<T> {\n\t\t\n\t\t_onComplete = handler;\n\t\t\n\t\tif (parameters == null) {\n\t\t\t\n\t\t\t_onCompleteParams = [];\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\t_onCompleteParams = parameters;\n\t\t\t\n\t\t}\n\t\t\n\t\tif (duration == 0) {\n\t\t\t\n\t\t\tcomplete ();\n\t\t\t\n\t\t}\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Defines a function which will be called when the tween repeats\n\t * @param\thandler\t\tThe function you would like to be called\n\t * @param\tparameters\t\tParameters you would like to pass to the handler function when it is called\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function onRepeat (handler:Dynamic, parameters:Array <Dynamic> = null):GenericActuator<T> {\n\t\t\n\t\t_onRepeat = handler;\n\t\t\n\t\tif (parameters == null) {\n\t\t\t\n\t\t\t_onRepeatParams = [];\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\t_onRepeatParams = parameters;\n\t\t\t\n\t\t}\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Defines a function which will be called when the tween updates\n\t * @param\thandler\t\tThe function you would like to be called\n\t * @param\tparameters\t\tParameters you would like to pass to the handler function when it is called\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function onUpdate (handler:Dynamic, parameters:Array <Dynamic> = null):GenericActuator<T> {\n\t\t\n\t\t_onUpdate = handler;\n\t\t\n\t\tif (parameters == null) {\n\t\t\t\n\t\t\t_onUpdateParams = [];\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\t_onUpdateParams = parameters;\n\t\t\t\n\t\t}\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t/**\n\t * Defines a function which will be called when the tween is paused\n\t * @param\thandler\t\tThe function you would like to be called\n\t * @param\tparameters\t\tParameters you would like to pass to the handler function when it is called\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function onPause (handler:Dynamic, parameters:Array <Dynamic> = null):GenericActuator<T> {\n\t\t\n\t\t_onPause = handler;\n\t\t\n\t\tif (parameters == null) {\n\t\t\t\n\t\t\t_onPauseParams = [];\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\t_onPauseParams = parameters;\n\t\t\t\n\t\t}\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t/**\n\t * Defines a function which will be called when the tween resumed after pause\n\t * @param\thandler\t\tThe function you would like to be called\n\t * @param\tparameters\t\tParameters you would like to pass to the handler function when it is called\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function onResume (handler:Dynamic, parameters:Array <Dynamic> = null):GenericActuator<T> {\n\t\t\n\t\t_onResume = handler;\n\t\t\n\t\tif (parameters == null) {\n\t\t\t\n\t\t\t_onResumeParams = [];\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\t_onResumeParams = parameters;\n\t\t\t\n\t\t}\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\tprivate function pause ():Void {\n\t\t\n\t\tif (_onPause != null)\n\t\t\tcallMethod(_onPause, _onPauseParams);\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Automatically changes the reverse value when the tween repeats. Repeat must be enabled for this to have any effect\n\t * @param\tvalue\t\tWhether reflect should be enabled (Default is true)\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function reflect (?value:Null<Bool>):GenericActuator<T> {\n\t\t\n\t\tif (value == null) {\n\t\t\t\n\t\t\tvalue = true;\n\t\t\t\n\t\t}\n\t\t\n\t\t_reflect = value;\n\t\tspecial = true;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Repeats the tween after it finishes\n\t * @param\ttimes\t\tThe number of times you would like the tween to repeat, or -1 if you would like to repeat the tween indefinitely (Default is -1)\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function repeat (?times:Null<Int>):GenericActuator<T> {\n\t\t\n\t\tif (times == null) {\n\t\t\t\n\t\t\ttimes = -1;\n\t\t\t\n\t\t}\n\t\t\n\t\t_repeat = times;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\tprivate function resume ():Void {\n\t\t\n\t\tif (_onResume != null)\n\t\t\tcallMethod(_onResume, _onResumeParams);\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Sets if the tween should be handled in reverse\n\t * @param\tvalue\t\tWhether the tween should be reversed (Default is true)\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function reverse (?value:Null<Bool>):GenericActuator<T> {\n\t\t\n\t\tif (value == null) {\n\t\t\t\n\t\t\tvalue = true;\n\t\t\t\n\t\t}\n\t\t\n\t\t_reverse = value;\n\t\tspecial = true;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Enabling smartRotation can prevent undesired results when tweening rotation values\n\t * @param\tvalue\t\tWhether smart rotation should be enabled (Default is true)\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function smartRotation (?value:Null<Bool>):GenericActuator<T> {\n\t\t\n\t\tif (value == null) {\n\t\t\t\n\t\t\tvalue = true;\n\t\t\t\n\t\t}\n\t\t\n\t\t_smartRotation = value;\n\t\tspecial = true;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Snapping causes tween values to be rounded automatically\n\t * @param\tvalue\t\tWhether tween values should be rounded (Default is true)\n\t * @return\t\tThe current actuator instance\n\t */\n\tpublic function snapping (?value:Null<Bool>):GenericActuator<T> {\n\t\t\n\t\tif (value == null) {\n\t\t\t\n\t\t\tvalue = true;\n\t\t\t\n\t\t}\n\t\t\n\t\t_snapping = value;\n\t\tspecial = true;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\tprivate function stop (properties:Dynamic, complete:Bool, sendEvent:Bool):Void {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n}","﻿package motion.actuators;\n\n\nimport motion.actuators.GenericActuator;\n#if (flash || nme || openfl)\nimport flash.display.DisplayObject;\nimport flash.events.Event;\nimport flash.Lib;\n#elseif lime\nimport lime.app.Application;\nimport lime.system.System;\n#else\n#if neko\nimport haxe.Log;\nimport haxe.PosInfos;\n#end\nimport haxe.Timer;\n#end\n\n\nclass SimpleActuator<T, U> extends GenericActuator<T> {\n\t\n\t\n\t#if actuate_manual_time\n\tpublic static var getTime:Void->Float;\n\t#end\n\t\n\tprivate var timeOffset:Float;\n\t\n\tprivate static var actuators = new Array<SimpleActuator<Dynamic, Dynamic>> ();\n\tprivate static var actuatorsLength = 0;\n\tprivate static var addedEvent = false;\n\t\n\t#if (!flash && !nme && !openfl && !lime)\n\tprivate static var timer:Timer;\n\t#end\n\t\n\tprivate var active:Bool;\n\tprivate var cacheVisible:Bool;\n\tprivate var detailsLength:Int;\n\tprivate var initialized:Bool;\n\tprivate var paused:Bool;\n\tprivate var pauseTime:Float;\n\tprivate var propertyDetails:Array <PropertyDetails<U>>;\n\tprivate var sendChange:Bool;\n\tprivate var setVisible:Bool;\n\tprivate var startTime:Float;\n\tprivate var toggleVisible:Bool;\n\t\n\t\n\tpublic function new (target:T, duration:Float, properties:Dynamic) {\n\t\t\n\t\tactive = true;\n\t\tpropertyDetails = new Array ();\n\t\tsendChange = false;\n\t\tpaused = false;\n\t\tcacheVisible = false;\n\t\tinitialized = false;\n\t\tsetVisible = false;\n\t\ttoggleVisible = false;\n\t\t\n\t\t#if !actuate_manual_time\n\t\t\t#if (flash || nme || openfl)\n\t\t\tstartTime = Lib.getTimer () / 1000;\n\t\t\t#elseif lime\n\t\t\tstartTime = System.getTimer () / 1000;\n\t\t\t#else\n\t\t\tstartTime = Timer.stamp ();\n\t\t\t#end\n\t\t#else\n\t\tstartTime = getTime();\n\t\t#end\n\t\t\n\t\tsuper (target, duration, properties);\n\t\t\n\t\tif (!addedEvent) {\n\t\t\t\n\t\t\taddedEvent = true;\n\t\t\t#if !actuate_manual_update\n\t\t\t\t#if (flash || nme || openfl)\n\t\t\t\tLib.current.stage.addEventListener (Event.ENTER_FRAME, stage_onEnterFrame);\n\t\t\t\t#elseif lime\n\t\t\t\tApplication.current.onUpdate.add (stage_onEnterFrame);\n\t\t\t\t#else\n\t\t\t\ttimer = new Timer (Std.int(1000 / 30));\n\t\t\t\ttimer.run = stage_onEnterFrame;\n\t\t\t\t#end\n\t\t\t#end\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override function autoVisible (?value:Null<Bool>):GenericActuator<T> {\n\t\t\n\t\tif (value == null) {\n\t\t\t\n\t\t\tvalue = true;\n\t\t\t\n\t\t}\n\t\t\n\t\t_autoVisible = value;\n\t\t\n\t\tif (!value) {\n\t\t\t\n\t\t\ttoggleVisible = false;\n\t\t\t\n\t\t\tif (setVisible) {\n\t\t\t\t\n\t\t\t\tsetField (target, \"visible\", cacheVisible);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override function delay (duration:Float):GenericActuator<T> {\n\t\t\n\t\t_delay = duration;\n\t\ttimeOffset = startTime + duration;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\tprivate inline function getField<V> (target:V, propertyName:String):Dynamic {\n\t\t\n\t\t#if (haxe_209 || haxe3)\n\t\t\n\t\tvar value = null;\n\t\t\n\t\tif (Reflect.hasField (target, propertyName)) {\n\t\t\t\n\t\t\t#if flash\n\t\t\tvalue = untyped target[propertyName];\n\t\t\t#else\n\t\t\tvalue = Reflect.field (target, propertyName);\n\t\t\t#end\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\tvalue = Reflect.getProperty (target, propertyName);\n\t\t\t\n\t\t}\n\t\t\n\t\treturn value;\n\t\t\n\t\t#else\n\t\t\n\t\treturn Reflect.field (target, propertyName);\n\t\t\n\t\t#end\n\t\t\n\t}\n\t\n\t\n\tprivate function initialize ():Void {\n\t\t\n\t\tvar details:PropertyDetails<U>;\n\t\tvar start:Dynamic;\n\t\t\n\t\tfor (i in Reflect.fields (properties)) {\n\t\t\t\n\t\t\tvar isField = true;\n\t\t\t\n\t\t\t#if (haxe_209 || haxe3)\n\t\t\t\n\t\t\tif (Reflect.hasField (target, i) #if flash && !untyped (target).hasOwnProperty (\"set_\" + i) #elseif html5 && !(untyped (target).__properties__ && untyped (target).__properties__[\"set_\" + i]) #end) {\n\t\t\t\t\n\t\t\t\tstart = Reflect.field (target, i);\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tisField = false;\n\t\t\t\tstart = Reflect.getProperty (target, i);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\t#else\n\t\t\t\n\t\t\tstart = Reflect.field (target, i);\n\t\t\t\n\t\t\t#end\n\t\t\t\n\t\t\tif (Std.is (start, Float)) {\n\t\t\t\t\n\t\t\t\tvar value:Dynamic = getField (properties, i);\n\t\t\t\t\n\t\t\t\t#if (neko || js)\n\t\t\t\tif (start == null) start = 0;\n\t\t\t\tif (value == null) value = 0;\n\t\t\t\t#end\n\t\t\t\t\n\t\t\t\tdetails = new PropertyDetails (cast target, i, start, value - start, isField);\n\t\t\t\tpropertyDetails.push (details);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tdetailsLength = propertyDetails.length;\n\t\tinitialized = true;\n\t\t\n\t}\n\t\n\t\n\tprivate override function move ():Void {\n\t\t\n\t\t#if (flash || nme || openfl)\n\t\ttoggleVisible = (Reflect.hasField (properties, \"alpha\") && Std.is (target, DisplayObject));\n\t\t#else\n\t\ttoggleVisible = (Reflect.hasField (properties, \"alpha\") && Reflect.hasField (properties, \"visible\"));\n\t\t#end\n\t\t\n\t\tif (toggleVisible && properties.alpha != 0 && !getField (target, \"visible\")) {\n\t\t\t\n\t\t\tsetVisible = true;\n\t\t\tcacheVisible = getField (target, \"visible\");\n\t\t\tsetField (target, \"visible\", true);\n\t\t\t\n\t\t}\n\t\t\n\t\ttimeOffset = startTime;\n\t\tactuators.push (this);\n\t\t++actuatorsLength;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic override function onUpdate (handler:Dynamic, parameters:Array <Dynamic> = null):GenericActuator<T> {\n\t\t\n\t\t_onUpdate = handler;\n\t\t\n\t\tif (parameters == null) {\n\t\t\t\n\t\t\t_onUpdateParams = [];\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\t_onUpdateParams = parameters;\n\t\t\t\n\t\t}\n\t\t\n\t\tsendChange = true;\n\t\t\n\t\treturn this;\n\t\t\n\t}\n\t\n\t\n\tprivate override function pause ():Void {\n\t\t\n\t\tif (!paused)\n\t\t{\n\t\t\tpaused = true;\n\t\t\n\t\t\tsuper.pause();\n\t\t\t\n\t\t\t\n\t\t\t#if !actuate_manual_time\n\t\t\t\t#if (flash || nme || openfl)\n\t\t\t\tpauseTime = Lib.getTimer ();\n\t\t\t\t#elseif lime\n\t\t\t\tpauseTime = System.getTimer ();\n\t\t\t\t#else\n\t\t\t\tpauseTime = Timer.stamp ();\n\t\t\t\t#end\n\t\t\t#else\n\t\t\tpauseTime = getTime();\n\t\t\t#end\n\t\t}\n\t\t\n\t\t\n\t}\n\t\n\t\n\tprivate override function resume ():Void {\n\t\t\n\t\tif (paused) {\n\t\t\t\n\t\t\tpaused = false;\n\t\t\t\n\t\t\t#if !actuate_manual_time\n\t\t\t\t#if (flash || nme || openfl)\n\t\t\t\ttimeOffset += (Lib.getTimer () - pauseTime) / 1000;\n\t\t\t\t#elseif lime\n\t\t\t\ttimeOffset += (System.getTimer () - pauseTime) / 1000;\n\t\t\t\t#else\n\t\t\t\ttimeOffset += (Timer.stamp () - pauseTime);\n\t\t\t\t#end\n\t\t\t#else\n\t\t\ttimeOffset += (getTime() - pauseTime) / 1000;\n\t\t\t#end\n\t\t\t\n\t\t\tsuper.resume();\n\t\t\t\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t@:generic private inline function setField<V> (target:V, propertyName:String, value:Dynamic):Void {\n\t\t\n\t\tif (Reflect.hasField (target, propertyName)) {\n\t\t\t\n\t\t\t#if flash\n\t\t\tuntyped target[propertyName] = value;\n\t\t\t#else\n\t\t\tReflect.setField (target, propertyName, value);\n\t\t\t#end\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\t#if (haxe_209 || haxe3)\n\t\t\tReflect.setProperty (target, propertyName, value);\n\t\t\t#end\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\tprivate inline function setProperty (details:PropertyDetails<U>, value:Dynamic):Void {\n\t\t\n\t\tif (details.isField) {\n\t\t\t\n\t\t\t#if flash\n\t\t\tuntyped details.target[details.propertyName] = value;\n\t\t\t#else\n\t\t\tReflect.setField (details.target, details.propertyName, value);\n\t\t\t#end\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\t#if (haxe_209 || haxe3)\n\t\t\tReflect.setProperty (details.target, details.propertyName, value);\n\t\t\t#end\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\tprivate override function stop (properties:Dynamic, complete:Bool, sendEvent:Bool):Void {\n\t\t\n\t\tif (active) {\n\t\t\t\n\t\t\tif (properties == null) {\n\t\t\t\t\n\t\t\t\tactive = false;\n\t\t\t\t\n\t\t\t\tif (complete) {\n\t\t\t\t\t\n\t\t\t\t\tapply ();\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.complete (sendEvent);\n\t\t\t\treturn;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tfor (i in Reflect.fields (properties)) {\n\t\t\t\t\n\t\t\t\tif (Reflect.hasField (this.properties, i)) {\n\t\t\t\t\t\n\t\t\t\t\tactive = false;\n\t\t\t\t\t\n\t\t\t\t\tif (complete) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tapply ();\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.complete (sendEvent);\n\t\t\t\t\treturn;\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\tprivate function update (currentTime:Float):Void {\n\t\t\n\t\tif (!paused) {\n\t\t\t\n\t\t\tvar details:PropertyDetails<U>;\n\t\t\tvar easing:Float;\n\t\t\tvar i:Int;\n\t\t\t\n\t\t\tvar tweenPosition:Float = (currentTime - timeOffset) / duration;\n\t\t\t\n\t\t\tif (tweenPosition > 1) {\n\t\t\t\t\n\t\t\t\ttweenPosition = 1;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (!initialized) {\n\t\t\t\t\n\t\t\t\tinitialize ();\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (!special) {\n\t\t\t\t\n\t\t\t\teasing = _ease.calculate (tweenPosition);\n\t\t\t\t\n\t\t\t\tfor (i in 0...detailsLength) {\n\t\t\t\t\t\n\t\t\t\t\tdetails = propertyDetails[i];\n\t\t\t\t\tsetProperty (details, details.start + (details.change * easing));\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tif (!_reverse) {\n\t\t\t\t\t\n\t\t\t\t\teasing = _ease.calculate (tweenPosition);\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\t\n\t\t\t\t\teasing = _ease.calculate (1 - tweenPosition);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar endValue:Float;\n\t\t\t\t\n\t\t\t\tfor (i in 0...detailsLength) {\n\t\t\t\t\t\n\t\t\t\t\tdetails = propertyDetails[i];\n\t\t\t\t\t\n\t\t\t\t\tif (_smartRotation && (details.propertyName == \"rotation\" || details.propertyName == \"rotationX\" || details.propertyName == \"rotationY\" || details.propertyName == \"rotationZ\")) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar rotation:Float = details.change % 360;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (rotation > 180) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\trotation -= 360;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t} else if (rotation < -180) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\trotation += 360;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tendValue = details.start + rotation * easing;\n\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\t\n\t\t\t\t\t\tendValue = details.start + (details.change * easing);\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (!_snapping) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tsetProperty (details, endValue);\n\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\t\n\t\t\t\t\t\tsetProperty (details, Math.round (endValue));\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (tweenPosition == 1) {\n\t\t\t\t\n\t\t\t\tif (_repeat == 0) {\n\t\t\t\t\t\n\t\t\t\t\tactive = false;\n\t\t\t\t\t\n\t\t\t\t\tif (toggleVisible && getField (target, \"alpha\") == 0) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tsetField (target, \"visible\", false);\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tcomplete (true);\n\t\t\t\t\treturn;\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\t\n\t\t\t\t\tif (_onRepeat != null) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tcallMethod (_onRepeat, _onRepeatParams);\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (_reflect) {\n\t\t\t\t\t\t\n\t\t\t\t\t\t_reverse = !_reverse;\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tstartTime = currentTime;\n\t\t\t\t\ttimeOffset = startTime + _delay;\n\t\t\t\t\t\n\t\t\t\t\tif (_repeat > 0) {\n\t\t\t\t\t\t\n\t\t\t\t\t\t_repeat --;\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (sendChange) {\n\t\t\t\t\n\t\t\t\tchange ();\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t\n\t\n\t// Event Handlers\n\t\n\t\n\t#if actuate_manual_update \n\tpublic \n\t#else \n\tprivate \n\t#end\n\tstatic function stage_onEnterFrame (#if (flash || nme || openfl) event:Event #elseif lime deltaTime:Int #end):Void {\n\t\t\n\t\t#if !actuate_manual_time\n\t\t\t#if (flash || nme || openfl)\n\t\t\tvar currentTime:Float = Lib.getTimer () / 1000;\n\t\t\t#elseif lime\n\t\t\tvar currentTime = System.getTimer () / 1000;\n\t\t\t#else\n\t\t\tvar currentTime = Timer.stamp ();\n\t\t\t#end\n\t\t#else\n\t\t\tvar currentTime = getTime();\n\t\t#end\n\t\t\n\t\tvar actuator:SimpleActuator<Dynamic, Dynamic>;\n\t\t\n\t\tvar j:Int = 0;\n\t\tvar cleanup = false;\n\t\t\n\t\tfor (i in 0...actuatorsLength) {\n\t\t\t\n\t\t\tactuator = actuators[j];\n\t\t\t\n\t\t\tif (actuator != null && actuator.active) {\n\t\t\t\t\n\t\t\t\tif (currentTime >= actuator.timeOffset) {\n\t\t\t\t\t\n\t\t\t\t\tactuator.update (currentTime);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tj++;\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tactuators.splice (j, 1);\n\t\t\t\t--actuatorsLength;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n}\n\n\n#if ((cpp || neko) && (!openfl && !lime && !nme))\n\n// Custom haxe.Timer implementation for C++ and Neko\n\ntypedef TimerList = Array <Timer>;\n\n\nclass Timer {\n\t\n\t\n\tstatic var sRunningTimers:TimerList = [];\n\t\n\tvar mTime:Float;\n\tvar mFireAt:Float;\n\tvar mRunning:Bool;\n\t\n\t\n\tpublic function new (time:Float) {\n\t\t\n\t\tmTime = time;\n\t\tsRunningTimers.push (this);\n\t\tmFireAt = GetMS () + mTime;\n\t\tmRunning = true;\n\t\t\n\t}\n\t\n\t\n\tpublic static function measure<T>( f : Void -> T, ?pos : haxe.PosInfos ) : T {\n\t\tvar t0 = stamp();\n\t\tvar r = f();\n\t\thaxe.Log.trace((stamp() - t0) + \"s\", pos);\n\t\treturn r;\n\t}\n\t\n\t\n\t// Set this with \"run=...\"\n\tdynamic public function run () {\n\t\t\n\t\t\n\t\t\n\t}\n   \n\t\n\tpublic function stop ():Void {\n\t\t\n\t\tif (mRunning) {\n\t\t\t\n\t\t\tmRunning = false;\n\t\t\tsRunningTimers.remove (this);\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\tstatic function GetMS ():Float {\n\t\t\n\t\treturn stamp () * 1000.0;\n\t\t\n\t}\n\t\n\n   // From std/haxe/Timer.hx\n\tpublic static function delay (f:Void -> Void, time:Int) {\n\t\t\n\t\tvar t = new Timer (time);\n\t\t\n\t\tt.run = function () {\n\t\t\tt.stop ();\n\t\t\tf ();\n\t\t};\n\t\t\n\t\treturn t;\n\t\t\n\t}\n\t\n\t\n\tstatic public function stamp ():Float {\n\t\t\n\t\treturn Date.now().getTime ();\n\t\t\n\t}\n\t\n\t\n}\n\n\n#end","﻿/**\n * @author Joshua Granick\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n */\n\n\npackage motion.easing;\n\n\n\nclass Expo {\n\t\n\t\n\tstatic public var easeIn (get_easeIn, never):IEasing;\n\tstatic public var easeInOut (get_easeInOut, never):IEasing;\n\tstatic public var easeOut (get_easeOut, never):IEasing;\n\t\n\t\n\tprivate static function get_easeIn ():IEasing {\n\t\t\n\t\treturn new ExpoEaseIn ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeInOut ():IEasing {\n\t\t\n\t\treturn new ExpoEaseInOut ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeOut ():IEasing {\n\t\t\n\t\treturn new ExpoEaseOut ();\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass ExpoEaseIn implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn k == 0 ? 0 : Math.pow(2, 10 * (k - 1));\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn t == 0 ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass ExpoEaseInOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\tif (k == 0) { return 0; }\n\t\tif (k == 1) { return 1; }\n\t\tif ((k /= 1 / 2.0) < 1.0) {\n\t\t\treturn 0.5 * Math.pow(2, 10 * (k - 1));\n\t\t}\n\t\treturn 0.5 * (2 - Math.pow(2, -10 * --k));\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\tif (t == 0) {\n\t\t\treturn b;\n\t\t}\n\t\tif (t == d) {\n\t\t\treturn b + c;\n\t\t}\n\t\tif ((t /= d / 2.0) < 1.0) {\n\t\t\treturn c / 2 * Math.pow(2, 10 * (t - 1)) + b;\n\t\t}\n\t\treturn c / 2 * (2 - Math.pow(2, -10 * --t)) + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass ExpoEaseOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn k == 1 ? 1 : (1 - Math.pow(2, -10 * k));\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn t == d ? b + c : c * (1 - Math.pow(2, -10 * t / d)) + b;\n\t\t\n\t}\n\t\n\t\n}","﻿package motion;\n\n\nimport haxe.ds.ObjectMap;\nimport motion.actuators.FilterActuator;\nimport motion.actuators.GenericActuator;\nimport motion.actuators.IGenericActuator;\nimport motion.actuators.MethodActuator;\nimport motion.actuators.MotionPathActuator;\nimport motion.actuators.SimpleActuator;\nimport motion.actuators.TransformActuator;\nimport motion.easing.Expo;\nimport motion.easing.IEasing;\n#if (flash || nme || openfl)\nimport flash.display.DisplayObject;\n#end\n\n@:access(motion.actuators)\n\n\nclass Actuate {\n\t\n\t\n\tpublic static var defaultActuator:Class<IGenericActuator> = SimpleActuator;\n\tpublic static var defaultEase:IEasing = Expo.easeOut;\n\tprivate static var targetLibraries = new ObjectMap<Dynamic, Array<IGenericActuator>> ();\n\t#if neko\n\tprivate static var methodLibraries = new FunctionMap<Dynamic, Array<IGenericActuator>> ();\n\t#end\n\t\n\t\n\t/**\n\t * Copies properties from one object to another. Conflicting tweens are stopped automatically\n\t * @example\t\t<code>Actuate.apply (MyClip, { alpha: 1 } );</code>\n\t * @param\ttarget\t\tThe object to copy to\n\t * @param\tproperties\t\tThe object to copy from\n\t * @param\tcustomActuator\t\tA custom actuator to use instead of the default (Optional)\n\t * @return\t\tThe current actuator instance, which can be used to apply properties like onComplete or onUpdate handlers\n\t */\n\t/*@:generic*/ public static function apply<T> (target:T, properties:Dynamic, customActuator:Class<GenericActuator<T>> = null):GenericActuator<T> {\n\t\t\n\t\tstop (target, properties);\n\t\t\n\t\tif (customActuator == null) {\n\t\t\t\n\t\t\tcustomActuator = cast defaultActuator;\n\t\t\t\n\t\t}\n\t\t\n\t\tvar actuator:GenericActuator<T> = Type.createInstance (customActuator, [ target, 0, properties ]);\n\t\tactuator.apply ();\n\t\t\n\t\treturn actuator;\n\t\t\n\t}\n\t\n\t\n\t#if (flash || nme || openfl)\n\t\n\t/**\n\t * Creates a new effects tween \n\t * @param\ttarget\t\tThe object to tween\n\t * @param\tduration\t\tThe length of the tween in seconds\n\t * @param\toverwrite\t\tSets whether previous tweens for the same target and properties will be overwritten (Default is true)\n\t * @return\t\tAn EffectsOptions instance, which is used to select the kind of effect you would like to apply to the target\n\t */\n\tpublic static function effects (target:DisplayObject, duration:Float, overwrite:Bool = true):EffectsOptions {\n\t\t\n\t\treturn new EffectsOptions (target, duration, overwrite);\n\t\t\n\t}\n\t\n\t#end\n\t\n\t\n\tprivate static function getLibrary<T> (target:T, allowCreation:Bool = true):Array<IGenericActuator> {\n\t\t\n\t\t#if neko\n\t\t\n\t\tif (Reflect.isFunction (target)) {\n\t\t\t\n\t\t\tif (!methodLibraries.exists (target) && allowCreation) {\n\t\t\t\t\n\t\t\t\tmethodLibraries.set (target, new Array<IGenericActuator> ());\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\treturn methodLibraries.get (target);\n\t\t\t\n\t\t}\n\t\t\t\n\t\t#end\n\t\t\n\t\tif (!targetLibraries.exists (target) && allowCreation) {\n\t\t\t\n\t\t\ttargetLibraries.set (target, new Array<IGenericActuator> ());\n\t\t\t\n\t\t}\n\t\t\n\t\treturn targetLibraries.get (target);\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Checks if Actuate has any active tweens \n\t * @return\t\tWhether Actuate is active\n\t */\n\tpublic static function isActive ():Bool {\n\t\t\n\t\tvar result = false;\n\t\t\n\t\tfor (library in targetLibraries) {\n\t\t\t\n\t\t\tresult = true;\n\t\t\tbreak;\n\t\t\t\n\t\t}\n\t\t\n\t\treturn result;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Creates a new MotionPath tween\n\t * @param\ttarget\t\tThe object to tween\n\t * @param\tduration\t\tThe length of the tween in seconds\n\t * @param\tproperties\t\tAn object containing a motion path for each property you wish to tween\n\t * @param\toverwrite\t\tSets whether previous tweens for the same target and properties will be overwritten (Default is true)\n\t * @return\t\tThe current actuator instance, which can be used to apply properties like ease, delay, onComplete or onUpdate\n\t */\n\t/*@:generic*/ public static function motionPath<T> (target:T, duration:Float, properties:Dynamic, overwrite:Bool = true):GenericActuator<T> {\n\t\t\n\t\treturn tween (target, duration, properties, overwrite, MotionPathActuator);\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Pauses tweens for the specified target objects\n\t * @param\t... targets\t\tThe target objects which will have their tweens paused. Passing no value pauses tweens for all objects\n\t */\n\t///*@:generic*/ public static function pause (... targets:Array):void {\n\t/*@:generic*/ public static function pause<T> (target:T):Void {\n\t\t\n\t\tif (Std.is (target, IGenericActuator)) {\n\t\t\t\n\t\t\tvar actuator:IGenericActuator = cast target;\n\t\t\tactuator.pause ();\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\tvar library = getLibrary (target, false);\n\t\t\t\n\t\t\tif (library != null) {\n\t\t\t\t\n\t\t\t\tfor (actuator in library) {\n\t\t\t\t\t\n\t\t\t\t\tactuator.pause ();\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\tpublic static function pauseAll ():Void {\n\t\t\n\t\t#if neko\n\t\t\n\t\tfor (library in methodLibraries) {\n\t\t\t\n\t\t\tfor (actuator in library) {\n\t\t\t\t\n\t\t\t\tactuator.pause ();\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\t#end\n\t\t\n\t\tfor (library in targetLibraries) {\n\t\t\t\n\t\t\tfor (actuator in library) {\n\t\t\t\t\n\t\t\t\tactuator.pause ();\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Resets Actuate by stopping and removing tweens for all objects\n\t */\n\tpublic static function reset ():Void {\n\t\t\n\t\t#if neko\n\t\t\n\t\tfor (library in methodLibraries) {\n\t\t\t\n\t\t\tvar i = library.length - 1;\n\t\t\t\n\t\t\twhile (i >= 0) {\n\t\t\t\t\n\t\t\t\tlibrary[i].stop (null, false, false);\n\t\t\t\ti--;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tmethodLibraries = new FunctionMap<Dynamic, Array<IGenericActuator>> ();\n\t\t\n\t\t#end\n\t\t\n\t\tfor (library in targetLibraries) {\n\t\t\t\n\t\t\tvar i = library.length - 1;\n\t\t\t\n\t\t\twhile (i >= 0) {\n\t\t\t\t\n\t\t\t\tlibrary[i].stop (null, false, false);\n\t\t\t\ti--;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\ttargetLibraries = new ObjectMap<Dynamic, Array<IGenericActuator>> ();\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Resumes paused tweens for the specified target objects\n\t * @param\t... targets\t\tThe target objects which will have their tweens resumed. Passing no value resumes tweens for all objects\n\t */\n\t/*@:generic*/ public static function resume<T> (target:T):Void {\n\t\t\n\t\tif (Std.is (target, IGenericActuator)) {\n\t\t\t\n\t\t\tvar actuator:IGenericActuator = cast target;\n\t\t\tactuator.resume ();\n\t\t\t\n\t\t} else {\n\t\t\t\n\t\t\tvar library = getLibrary (target, false);\n\t\t\t\n\t\t\tif (library != null) {\n\t\t\t\t\n\t\t\t\tfor (actuator in library) {\n\t\t\t\t\t\n\t\t\t\t\tactuator.resume ();\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\tpublic static function resumeAll ():Void {\n\t\t\n\t\t#if neko\n\t\t\n\t\tfor (library in methodLibraries) {\n\t\t\t\n\t\t\tfor (actuator in library) {\n\t\t\t\t\n\t\t\t\tactuator.resume ();\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\t#end\n\t\t\n\t\tfor (library in targetLibraries) {\n\t\t\t\n\t\t\tfor (actuator in library) {\n\t\t\t\t\n\t\t\t\tactuator.resume ();\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Stops all tweens for an individual object\n\t * @param\ttarget\t\tThe target object which will have its tweens stopped, or a generic actuator instance\n\t * @param\tproperties\t\tA string, array or object which contains the properties you wish to stop, like \"alpha\", [ \"x\", \"y\" ] or { alpha: null }. Passing no value removes all tweens for the object (Optional)\n\t * @param\tcomplete\t\tIf tweens should apply their final target values before stopping. Default is false (Optional) \n\t * @param\tsendEvent\tIf a complete() event should be dispatched for the specified target. Default is true (Optional)\n\t */\n\t/*@:generic*/ public static function stop<T> (target:T, properties:Dynamic = null, complete:Bool = false, sendEvent:Bool = true):Void {\n\t\t\n\t\tif (target != null) {\n\t\t\t\n\t\t\tif (Std.is (target, IGenericActuator)) {\n\t\t\t\t\n\t\t\t\tvar actuator:IGenericActuator = cast target;\n\t\t\t\tactuator.stop (null, complete, sendEvent);\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tvar library = getLibrary (target, false);\n\t\t\t\t\n\t\t\t\tif (library != null) {\n\t\t\t\t\t\n\t\t\t\t\tif (Std.is (properties, String)) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar temp = { };\n\t\t\t\t\t\tReflect.setField (temp, properties, null);\n\t\t\t\t\t\tproperties = temp;\n\t\t\t\t\t\t\n\t\t\t\t\t} else if (Std.is (properties, Array)) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar temp = {};\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (property in cast (properties, Array <Dynamic>)) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tReflect.setField (temp, property, null);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tproperties = temp;\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar i = library.length - 1;\n\t\t\t\t\t\n\t\t\t\t\twhile (i >= 0) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tlibrary[i].stop (properties, complete, sendEvent);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Creates a tween-based timer, which is useful for synchronizing function calls with other animations\n\t * @example\t\t<code>Actuate.timer (1).onComplete (trace, [ \"Timer is now complete\" ]);</code>\n\t * @param\tduration\t\tThe length of the timer in seconds\n\t * @param\tcustomActuator\t\tA custom actuator to use instead of the default (Optional)\n\t * @return\t\tThe current actuator instance, which can be used to apply properties like onComplete or to gain a reference to the target timer object\n\t */\n\tpublic static function timer (duration:Float, customActuator:Class<GenericActuator<TweenTimer>> = null):GenericActuator<TweenTimer> {\n\t\t\n\t\treturn cast tween (new TweenTimer (0), duration, new TweenTimer (1), false, cast customActuator);\n\t\t\n\t}\n\t\n\t\n\t#if (flash || nme || openfl)\n\t\n\t/**\n\t * Creates a new transform tween\n\t * @example\t\t<code>Actuate.transform (MyClip, 1).color (0xFF0000);</code>\n\t * @param\ttarget\t\tThe object to tween\n\t * @param\tduration\t\tThe length of the tween in seconds\n\t * @param\toverwrite\t\tSets whether previous tweens for the same target and properties will be overwritten (Default is true)\n\t * @return\t\tA TransformOptions instance, which is used to select the kind of transform you would like to apply to the target\n\t */\n\t/*@:generic*/ public static function transform<T> (target:T, duration:Float = 0, overwrite:Bool = true):TransformOptions<T> {\n\t\t\n\t\treturn new TransformOptions (target, duration, overwrite);\n\t\t\n\t}\n\t\n\t#end\n\t\n\t\n\t/**\n\t * Creates a new tween\n\t * @example\t\t<code>Actuate.tween (MyClip, 1, { alpha: 1 } ).onComplete (trace, [ \"MyClip is now visible\" ]);</code>\n\t * @param\ttarget\t\tThe object to tween\n\t * @param\tduration\t\tThe length of the tween in seconds\n\t * @param\tproperties\t\tThe end values to tween the target to\n\t * @param\toverwrite\t\t\tSets whether previous tweens for the same target and properties will be overwritten (Default is true)\n\t * @param\tcustomActuator\t\tA custom actuator to use instead of the default (Optional)\n\t * @return\t\tThe current actuator instance, which can be used to apply properties like ease, delay, onComplete or onUpdate\n\t */ \n\t/*@:generic*/ public static function tween<T> (target:T, duration:Float, properties:Dynamic, overwrite:Bool = true, customActuator:Class<GenericActuator<T>> = null):GenericActuator<T> {\n\t\t\n\t\tif (target != null) {\n\t\t\t\n\t\t\tif (duration > 0) {\n\t\t\t\t\n\t\t\t\tif (customActuator == null) {\n\t\t\t\t\t\n\t\t\t\t\tcustomActuator = cast defaultActuator;\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar actuator:GenericActuator<T> = Type.createInstance (customActuator, [ target, duration, properties ]);\n\t\t\t\tvar library = getLibrary (actuator.target);\n\t\t\t\t\n\t\t\t\tif (overwrite) {\n\t\t\t\t\t\n\t\t\t\t\tvar i = library.length - 1;\n\t\t\t\t\t\n\t\t\t\t\twhile (i >= 0) {\n\t\t\t\t\t\tlibrary[i].stop (actuator.properties, false, false);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tlibrary = getLibrary (actuator.target);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlibrary.push (actuator);\n\t\t\t\tactuator.move ();\n\t\t\t\t\n\t\t\t\treturn actuator;\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\treturn apply (target, properties, customActuator);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\treturn null;\n\t\t\n\t}\n\t\n\t\n\t/*@:generic*/ public static function unload<T> (actuator:GenericActuator<T>):Void {\n\t\t\n\t\tvar target = actuator.target;\n\t\t\n\t\t#if neko\n\t\t\n\t\tif (Reflect.isFunction (target)) {\n\t\t\t\n\t\t\tif (methodLibraries.exists (target)) {\n\t\t\t\t\n\t\t\t\tmethodLibraries.get (target).remove (actuator);\n\t\t\t\t\n\t\t\t\tif (methodLibraries.get (target).length == 0) {\n\t\t\t\t\t\n\t\t\t\t\tmethodLibraries.remove (target);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\treturn;\n\t\t\t\n\t\t}\n\t\t\n\t\t#end\n\t\t\n\t\tif (targetLibraries.exists (target)) {\n\t\t\t\n\t\t\ttargetLibraries.get (target).remove (actuator);\n\t\t\t\n\t\t\tif (targetLibraries.get (target).length == 0) {\n\t\t\t\t\n\t\t\t\ttargetLibraries.remove (target);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Creates a new tween that updates a method rather than setting the properties of an object\n\t * @example\t\t<code>Actuate.update (trace, 1, [\"Value: \", 0], [\"\", 1]).onComplete (trace, [ \"Finished tracing values between 0 and 1\" ]);</code>\n\t * @param\ttarget\t\tThe method to update\t\t\n\t * @param\tduration\t\tThe length of the tween in seconds\n\t * @param\tstart\t\tThe starting parameters of the method call. You may use both numeric and non-numeric values\n\t * @param\tend\t\tThe ending parameters of the method call. You may use both numeric and non-numeric values, but the signature should match the start parameters\n\t * @param\toverwrite\t\tSets whether previous tweens for the same target and properties will be overwritten (Default is true)\n\t * @return\t\tThe current actuator instance, which can be used to apply properties like ease, delay, onComplete or onUpdate\n\t */\n\t/*@:generic*/ public static function update<T> (target:T, duration:Float, start:Array <Dynamic> = null, end:Array <Dynamic> = null, overwrite:Bool = true):GenericActuator<T> {\n\t\t\t\t\n\t\tvar properties:Dynamic = { start: start, end: end };\n\t\t\n\t\treturn tween (target, duration, properties, overwrite, MethodActuator);\n\t\t\n\t}\n\t\n\t\n}\n\n\n#if !haxe3\nimport com.eclecticdesignstudio.motion.actuators.FilterActuator;\nimport com.eclecticdesignstudio.motion.actuators.GenericActuator;\nimport com.eclecticdesignstudio.motion.actuators.TransformActuator;\nimport com.eclecticdesignstudio.motion.Actuate;\nimport flash.display.DisplayObject;\nimport flash.filters.BitmapFilter;\n//import flash.filters.ColorMatrixFilter;\nimport flash.geom.Matrix;\n#end\n\n\n#if (flash || nme || openfl)\n\nprivate class EffectsOptions {\n\t\n\t\n\tprivate var duration:Float;\n\tprivate var overwrite:Bool;\n\tprivate var target:DisplayObject;\n\t\n\t\n\tpublic function new (target:DisplayObject, duration:Float, overwrite:Bool) {\n\t\t\n\t\tthis.target = target;\n\t\tthis.duration = duration;\n\t\tthis.overwrite = overwrite;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Creates a new BitmapFilter tween\n\t * @param\treference\t\tA reference to the target's filter, which can be an array index or the class of the filter\n\t * @param\tproperties\t\tThe end properties to use for the tween\n\t * @return\t\tThe current actuator instance, which can be used to apply properties like ease, delay, onComplete or onUpdate\n\t */\n\tpublic function filter (reference:Dynamic, properties:Dynamic):IGenericActuator {\n\t\t\n\t\tproperties.filter = reference;\n\t\t\n\t\treturn Actuate.tween (target, duration, properties, overwrite, FilterActuator);\n\t\t\n\t}\n\t\n\t\n}\n\n\nprivate class TransformOptions<T> {\n\t\n\t\n\tprivate var duration:Float;\n\tprivate var overwrite:Bool;\n\tprivate var target:T;\n\t\n\t\n\tpublic function new (target:T, duration:Float, overwrite:Bool) {\n\t\t\n\t\tthis.target = target;\n\t\tthis.duration = duration;\n\t\tthis.overwrite = overwrite;\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Creates a new ColorTransform tween\n\t * @param\tcolor\t\tThe color value\n\t * @param\tstrength\t\tThe percentage amount of tint to apply (Default is 1)\n\t * @param\talpha\t\tThe end alpha of the target. If you wish to tween alpha and tint simultaneously, you must do them both as part of the ColorTransform. A value of null will make no change to the alpha of the object (Default is null)\n\t * @return\t\tThe current actuator instance, which can be used to apply properties like ease, delay, onComplete or onUpdate\n\t */\n\tpublic function color (value:Int = 0x000000, strength:Float = 1, alpha:Null <Float> = null):IGenericActuator {\n\t\t\n\t\tvar properties:Dynamic = { colorValue: value, colorStrength: strength };\n\t\t\n\t\tif (alpha != null) {\n\t\t\t\n\t\t\tproperties.colorAlpha = alpha;\n\t\t\t\n\t\t}\n\t\t\n\t\treturn Actuate.tween (target, duration, properties, overwrite, TransformActuator);\n\t\t\n\t}\n\t\n\t\n\t/**\n\t * Creates a new SoundTransform tween\n\t * @param\tvolume\t\tThe end volume for the target, or null if you would like to ignore this property (Default is null)\n\t * @param\tpan\t\tThe end pan for the target, or null if you would like to ignore this property (Default is null)\n\t * @return\t\tThe current actuator instance, which can be used to apply properties like ease, delay, onComplete or onUpdate\n\t */\n\tpublic function sound (volume:Null <Float> = null, pan:Null <Float> = null):IGenericActuator {\n\t\t\n\t\tvar properties:Dynamic = {};\n\t\t\n\t\tif (volume != null) {\n\t\t\t\n\t\t\tproperties.soundVolume = volume;\n\t\t\t\n\t\t}\n\t\t\n\t\tif (pan != null) {\n\t\t\t\n\t\t\tproperties.soundPan = pan;\n\t\t\t\n\t\t}\n\t\t\n\t\treturn Actuate.tween (target, duration, properties, overwrite, TransformActuator);\n\t\t\n\t}\n\t\n\t\n}\n\n#end\n\n\nprivate class TweenTimer {\n\t\n\t\n\tpublic var progress:Float;\n\t\n\t\n\tpublic function new (progress:Float):Void {\n\t\t\n\t\tthis.progress = progress;\n\t\t\n\t}\n\t\n\t\n}\n\n\n#if neko\nprivate class KVPairMap<K, V> {\n\tvar keyList:Array<K>;\n\tvar valList:Array<V>;\n\tpublic function new() {\n\t\tthis.keyList = [];\n\t\tthis.valList = [];\n\t}\n\tfunction equals(k1:K, k2:K):Bool \n\t\treturn throw 'base';\n\t\n\tfunction indexOf(k:K):Int {\n\t\tfor (i in 0...keyList.length)\n\t\t\tif (equals(k, keyList[i])) return i;\n\t\treturn -1;\n\t}\n\tpublic function get(k:K):Null<V> \n\t\treturn valList[indexOf(k)];\n\t\n\tpublic function set(k:K, v:V):V {\n\t\tvar i = indexOf(k);\n\t\tif (i == -1) {\n\t\t\tkeyList.push(k);\n\t\t\tvalList.push(v);\n\t\t}\n\t\telse {\n\t\t\tkeyList[i] = k;\n\t\t\tvalList[i] = v;\n\t\t}\n\t\treturn v;\n\t}\n\tpublic function exists(k:K):Bool \n\t\treturn indexOf(k) != -1;\n\t\n\tpublic function remove(k:K):Bool {\n\t\tvar i = indexOf(k);\n\t\treturn\n\t\t\tif (i == -1) false;\n\t\t\telse {\n\t\t\t\tkeyList.splice(i, 1);\n\t\t\t\tvalList.splice(i, 1);\n\t\t\t\ttrue;\n\t\t\t}\n\t}\n\tpublic inline function keys():Iterator<K> \n\t\treturn keyList.iterator();\n\t\n\tpublic inline function iterator():Iterator<V> \n\t\treturn valList.iterator();\n\t\n\tpublic function toString() {\n\t\treturn [for (i in 0...keyList.length) Std.string(keyList[i]) => valList[i]].toString();\n\t}\n\t\n}\n\nprivate class FunctionMap < K, V > extends KVPairMap < K, V > {\n                override function equals(k1:K, k2:K):Bool {\n                        return Reflect.compareMethods(k1, k2);\n                }\n        }\n\n#end","﻿package motion.actuators;\n\n\nclass MethodActuator<T> extends SimpleActuator<T, T> {\n\t\n\t\n\tprivate var currentParameters:Array <Dynamic>;\n\tprivate var tweenProperties:Dynamic;\n\t\n\t\n\tpublic function new (target:T, duration:Float, properties:Dynamic) {\n\t\t\n\t\tcurrentParameters = new Array <Dynamic> ();\n\t\ttweenProperties = { };\n\t\t\n\t\tsuper (target, duration, properties);\n\t\t\n\t\tif (!Reflect.hasField (properties, \"start\")) {\n\t\t\t\n\t\t\tthis.properties.start = new Array <Dynamic> ();\n\t\t\t\n\t\t}\n\t\t\n\t\tif (!Reflect.hasField (properties, \"end\")) {\n\t\t\t\n\t\t\tthis.properties.end = this.properties.start;\n\t\t\t\n\t\t}\n\t\t\n\t\tfor (i in 0...this.properties.start.length) {\n\t\t\t\n\t\t\tcurrentParameters.push (this.properties.start[i]);\n\t\t\t\n\t\t}\n\t}\n\t\n\t\n\tprivate override function apply ():Void {\n\t\t\n\t\tcallMethod (target, properties.end);\n\t\t\n\t}\n\t\n\t\n\tprivate override function complete (sendEvent:Bool = true):Void {\n\t\t\n\t\tfor (i in 0...properties.start.length) {\n\t\t\t\n\t\t\tcurrentParameters[i] = Reflect.field (tweenProperties, \"param\" + i);\n\t\t\t\n\t\t}\n\t\t\n\t\tcallMethod (target, currentParameters);\n\t\t\n\t\tsuper.complete (sendEvent);\n\t\t\n\t}\n\t\n\t\n\tprivate override function initialize ():Void {\n\t\t\n\t\tvar details:PropertyDetails<T>;\n\t\tvar propertyName:String;\n\t\tvar start:Dynamic;\n\t\t\n\t\tfor (i in 0...properties.start.length) {\n\t\t\t\n\t\t\tpropertyName = \"param\" + i;\n\t\t\tstart = properties.start[i];\n\t\t\t\n\t\t\tReflect.setField (tweenProperties, propertyName, start);\n\t\t\t\n\t\t\tif (Std.is (start, Float) || Std.is (start, Int)) {\n\t\t\t\t\n\t\t\t\tdetails = new PropertyDetails (tweenProperties, propertyName, start, properties.end[i] - start);\n\t\t\t\tpropertyDetails.push (details);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tdetailsLength = propertyDetails.length;\n\t\tinitialized = true;\n\t\t\n\t}\n\t\n\t\n\tprivate override function update (currentTime:Float):Void {\n\t\t\n\t\tsuper.update (currentTime);\n\t\t\n\t\tif (active && !paused) {\n\t\t\t\n\t\t\tfor (i in 0...properties.start.length) {\n\t\t\t\t\n\t\t\t\tcurrentParameters[i] = Reflect.field (tweenProperties, \"param\" + i);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tcallMethod (target, currentParameters);\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n}","﻿package motion.actuators;\n\n\nimport motion.MotionPath;\n\n\nclass MotionPathActuator<T> extends SimpleActuator<T, T> {\n\t\n\t\n\tpublic function new (target:T, duration:Float, properties:Dynamic) {\n\t\t\n\t\tsuper (target, duration, properties);\n\t\t\n\t}\n\t\n\t\n\tprivate override function apply ():Void {\n\t\t\n\t\tfor (propertyName in Reflect.fields (properties)) {\n\t\t\t\n\t\t\t#if (haxe_209 || haxe3)\n\t\t\t\n\t\t\tif (#if flash false && #end Reflect.hasField (target, propertyName)) {\n\t\t\t\t\n\t\t\t\tReflect.setField (target, propertyName, cast (Reflect.field (properties, propertyName), IComponentPath).end);\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tReflect.setProperty (target, propertyName, cast (Reflect.field (properties, propertyName), IComponentPath).end);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\t#else\n\t\t\t\n\t\t\tReflect.setField (target, propertyName, cast (Reflect.field (properties, propertyName), IComponentPath).end);\n\t\t\t\n\t\t\t#end\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n\tprivate override function initialize ():Void {\n\t\t\n\t\tvar details:PropertyPathDetails<T>;\n\t\tvar path:IComponentPath;\n\t\t\n\t\tfor (propertyName in Reflect.fields (properties)) {\n\t\t\t\n\t\t\tpath = cast (Reflect.field (properties, propertyName), IComponentPath);\n\t\t\t\n\t\t\tif (path != null) {\n\t\t\t\t\n\t\t\t\tvar isField = true;\n\t\t\t\t\n\t\t\t\t#if (haxe_209 || haxe3)\n\t\t\t\t\n\t\t\t\tif (#if flash false && #end Reflect.hasField (target, propertyName)) {\n\t\t\t\t\t\n\t\t\t\t\tpath.start = Reflect.field (target, propertyName);\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\t\n\t\t\t\t\tisField = false;\n\t\t\t\t\tpath.start = Reflect.getProperty (target, propertyName);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t#else\n\t\t\t\t\n\t\t\t\tpath.start = Reflect.field (target, propertyName);\n\t\t\t\t\n\t\t\t\t#end\n\t\t\t\t\n\t\t\t\tdetails = new PropertyPathDetails (target, propertyName, path, isField);\n\t\t\t\tpropertyDetails.push (details);\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tdetailsLength = propertyDetails.length;\n\t\tinitialized = true;\n\t\t\n\t}\n\t\n\t\n\tprivate override function update (currentTime:Float):Void {\n\t\t\n\t\tif (!paused) {\n\t\t\t\n\t\t\tvar details:PropertyPathDetails<T>;\n\t\t\tvar easing:Float;\n\t\t\t\n\t\t\tvar tweenPosition = (currentTime - timeOffset) / duration;\n\t\t\t\n\t\t\tif (tweenPosition > 1) {\n\t\t\t\t\n\t\t\t\ttweenPosition = 1;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (!initialized) {\n\t\t\t\t\n\t\t\t\tinitialize ();\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (!special) {\n\t\t\t\t\n\t\t\t\teasing = _ease.calculate (tweenPosition);\n\t\t\t\t\n\t\t\t\tfor (details in propertyDetails) {\n\t\t\t\t\t\n\t\t\t\t\tif (details.isField) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tReflect.setField (details.target, details.propertyName, cast (details, PropertyPathDetails<Dynamic>).path.calculate (easing));\n\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\t\n\t\t\t\t\t\t#if (haxe_209 || haxe3)\n\t\t\t\t\t\tReflect.setProperty (details.target, details.propertyName, cast (details, PropertyPathDetails<Dynamic>).path.calculate (easing));\n\t\t\t\t\t\t#end\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tif (!_reverse) {\n\t\t\t\t\t\n\t\t\t\t\teasing = _ease.calculate (tweenPosition);\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\t\n\t\t\t\t\teasing = _ease.calculate (1 - tweenPosition);\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar endValue:Float;\n\t\t\t\t\n\t\t\t\tfor (details in propertyDetails) {\n\t\t\t\t\t\n\t\t\t\t\tif (!_snapping) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (details.isField) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tReflect.setField (details.target, details.propertyName, cast (details, PropertyPathDetails<Dynamic>).path.calculate (easing));\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if (haxe_209 || haxe3)\n\t\t\t\t\t\t\tReflect.setProperty (details.target, details.propertyName, cast (details, PropertyPathDetails<Dynamic>).path.calculate (easing));\n\t\t\t\t\t\t\t#end\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (details.isField) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tReflect.setField (details.target, details.propertyName, Math.round (cast (details, PropertyPathDetails<Dynamic>).path.calculate (easing)));\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if (haxe_209 || haxe3)\n\t\t\t\t\t\t\tReflect.setProperty (details.target, details.propertyName, Math.round (cast (details, PropertyPathDetails<Dynamic>).path.calculate (easing)));\n\t\t\t\t\t\t\t#end\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (tweenPosition == 1) {\n\t\t\t\t\n\t\t\t\tif (_repeat == 0) {\n\t\t\t\t\t\n\t\t\t\t\tactive = false;\n\t\t\t\t\t\n\t\t\t\t\tif (toggleVisible && getField (target, \"alpha\") == 0) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tsetField (target, \"visible\", false);\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tcomplete (true);\n\t\t\t\t\treturn;\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\t\n\t\t\t\t\tif (_onRepeat != null) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tcallMethod (_onRepeat, _onRepeatParams);\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (_reflect) {\n\t\t\t\t\t\t\n\t\t\t\t\t\t_reverse = !_reverse;\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tstartTime = currentTime;\n\t\t\t\t\ttimeOffset = startTime + _delay;\n\t\t\t\t\t\n\t\t\t\t\tif (_repeat > 0) {\n\t\t\t\t\t\t\n\t\t\t\t\t\t_repeat --;\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (sendChange) {\n\t\t\t\t\n\t\t\t\tchange ();\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\t\n}\n\n\n#if !haxe3\nimport com.eclecticdesignstudio.motion.MotionPath;\n#end\n\n\nclass PropertyPathDetails<T> extends PropertyDetails<T> {\n\t\n\t\n\tpublic var path:IComponentPath;\n\t\n\t\n\tpublic function new (target:T, propertyName:String, path:IComponentPath, isField:Bool = true) {\n\t\t\n\t\tsuper (target, propertyName, 0, 0, isField);\n\t\t\n\t\tthis.path = path;\n\t\t\n\t}\n\t\n\t\n}","﻿package motion.actuators;\n\n\nclass PropertyDetails<T> {\n\t\n\t\n\tpublic var change:Float;\n\tpublic var isField:Bool;\n\tpublic var propertyName:String;\n\tpublic var start:Float;\n\tpublic var target:T;\n\t\n\t\n\tpublic function new (target:T, propertyName:String, start:Float, change:Float, isField:Bool = true):Void {\n\t\t\n\t\tthis.target = target;\n\t\tthis.propertyName = propertyName;\n\t\tthis.start = start;\n\t\tthis.change = change;\n\t\tthis.isField = isField;\n\t\t\n\t}\n\t\n\t\n}","﻿/**\n * @author Joshua Granick\n * @author Zeh Fernando, Nate Chatellier\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n */\n\n\npackage motion.easing;\n\t\n\t\nclass Back {\n\t\n\t\n\tstatic public var easeIn (get_easeIn, never):IEasing;\n\tstatic public var easeInOut (get_easeInOut, never):IEasing;\n\tstatic public var easeOut (get_easeOut, never):IEasing;\n\t\n\t\n\tprivate static function get_easeIn ():IEasing {\n\t\t\n\t\treturn new BackEaseIn (1.70158);\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeInOut ():IEasing {\n\t\t\n\t\treturn new BackEaseInOut (1.70158);\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeOut ():IEasing {\n\t\t\n\t\treturn new BackEaseOut (1.70158);\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass BackEaseIn implements IEasing {\n\t\n\t\n\tpublic var s:Float;\n\t\n\t\n\tpublic function new (s:Float) {\n\t\t\n\t\tthis.s = s;\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn k * k * ((s + 1) * k - s);\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c*(t/=d)*t*((s+1)*t - s) + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass BackEaseInOut implements IEasing {\n\t\n\t\n\tpublic var s:Float;\n\t\n\t\n\tpublic function new (s:Float) {\n\t\t\n\t\tthis.s = s;\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\tif ((k /= 0.5) < 1) return 0.5 * (k * k * (((s *= (1.525)) + 1) * k - s));\n\t\treturn 0.5 * ((k -= 2) * k * (((s *= (1.525)) + 1) * k + s) + 2);\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\tif ((t/=d/2) < 1) return c/2*(t*t*(((s*=(1.525))+1)*t - s)) + b;\n\t\treturn c/2*((t-=2)*t*(((s*=(1.525))+1)*t + s) + 2) + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass BackEaseOut implements IEasing {\n\t\n\t\n\tpublic var s:Float;\n\t\n\t\n\tpublic function new (s:Float) {\n\t\t\n\t\tthis.s = s;\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn ((k = k - 1) * k * ((s + 1) * k + s) + 1);\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c*((t=t/d-1)*t*((s+1)*t + s) + 1) + b;\n\t\t\n\t}\n\t\n\t\n}","\n/**\n * @author Erik Escoffier\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n */\n\n\npackage motion.easing;\n\n\t\nclass Bounce {\n\n\tstatic public var easeIn (get_easeIn, never):IEasing;\n\tstatic public var easeInOut (get_easeInOut, never):IEasing;\n\tstatic public var easeOut (get_easeOut, never):IEasing;\n\t\n\t\n\tprivate static function get_easeIn ():IEasing {\n\t\t\n\t\treturn new BounceEaseIn ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeInOut ():IEasing {\n\t\t\n\t\treturn new BounceEaseInOut ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeOut ():IEasing {\n\t\t\n\t\treturn new BounceEaseOut ();\n\t\t\n\t}\n\t\n\t\n}\n\n\n\n\n\n\n\nclass BounceEaseIn implements IEasing {\n\t\n\t\t\n\tpublic function new () {\n\t\t\n\t\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\treturn BounceEaseIn._ease(k,0,1,1);\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\treturn BounceEaseIn._ease(t,b,c,d);\n\t}\n\n\tpublic static inline function _ease  (t:Float, b:Float, c:Float, d:Float):Float {\n\t\treturn c - BounceEaseOut._ease (d-t, 0, c, d) + b;\n\t}\n}\n\t\n\n\nclass BounceEaseInOut implements IEasing {\n\t\n\t\t\n\tpublic function new () {\n\t\t\n\t\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\tif (k < .5) {\n\t\t\treturn BounceEaseIn._ease(k*2, 0, 1, 1) * .5;\n\t\t} else {\n\t\t\treturn BounceEaseOut._ease(k*2-1, 0, 1, 1) * .5 + 1*.5; \n\t\t}\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\n\t\tif (t < d/2) {\n\t\t\treturn BounceEaseIn._ease(t*2, 0, c, d) * .5 + b;\n\t\t} else {\n\t\t\treturn BounceEaseOut._ease(t*2-d, 0, c, d) * .5 + c*.5 + b; \n\t\t}\n\t\t\n\t}\n}\n\t\n\n\n\n\nclass BounceEaseOut implements IEasing {\n\t\n\t\t\n\tpublic function new () {\n\t\t\n\t\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn BounceEaseOut._ease(k,0,1,1);\n\t\t\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn BounceEaseOut._ease(t,b,c,d);\n\t\t\n\t}\n\n\tpublic static inline function _ease(t:Float, b:Float, c:Float, d:Float):Float \t{\n\t\tif ((t/=d) < (1/2.75)) {\n\t\t\treturn c*(7.5625*t*t) + b;\n\t\t} else if (t < (2/2.75)) {\n\t\t\treturn c*(7.5625*(t-=(1.5/2.75))*t + .75) + b;\n\t\t} else if (t < (2.5/2.75)) {\n\t\t\treturn c*(7.5625*(t-=(2.25/2.75))*t + .9375) + b;\n\t\t} else {\n\t\t\treturn c*(7.5625*(t-=(2.625/2.75))*t + .984375) + b;\n\t\t}\n\t}\n\n}\n\t\n","/**\n * @author Joshua Granick\n * @author Philippe / http://philippe.elsass.me\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n */\n\n\npackage motion.easing;\n\t\n\t\nclass Cubic {\n\t\n\t\n\tstatic public var easeIn (get_easeIn, never):IEasing;\n\tstatic public var easeInOut (get_easeInOut, never):IEasing;\n\tstatic public var easeOut (get_easeOut, never):IEasing;\n\t\n\t\n\tprivate static function get_easeIn ():IEasing {\n\t\t\n\t\treturn new CubicEaseIn ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeInOut ():IEasing {\n\t\t\n\t\treturn new CubicEaseInOut ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeOut ():IEasing {\n\t\t\n\t\treturn new CubicEaseOut ();\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass CubicEaseIn implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn k * k * k;\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c * (t /= d) * t * t + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass CubicEaseInOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn ((k /= 1 / 2) < 1) ? 0.5 * k * k * k : 0.5 * ((k -= 2) * k * k + 2);\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn ((t /= d / 2) < 1) ? c / 2 * t * t * t + b : c / 2 * ((t -= 2) * t * t + 2) + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass CubicEaseOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn --k * k * k + 1;\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c * ((t = t / d - 1) * t * t + 1) + b;\n\t\t\n\t}\n\t\n\t\n}","/**\n * @author Joshua Granick\n * @author Philippe / http://philippe.elsass.me\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n */\n\n\npackage motion.easing;\n\t\n\t\nclass Linear {\n\t\n\t\n\tstatic public var easeNone (get_easeNone, never):IEasing;\n\t\n\t\n\tprivate static function get_easeNone ():IEasing {\n\t\t\n\t\treturn new LinearEaseNone ();\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass LinearEaseNone implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn k;\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c * t / d + b;\n\t\t\n\t}\n\t\n\t\n}","/**\n * @author Joshua Granick\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n */\n\n\npackage motion.easing;\n\n\n\nclass Quad {\n\t\n\t\n\tstatic public var easeIn (get_easeIn, never):IEasing;\n\tstatic public var easeInOut (get_easeInOut, never):IEasing;\n\tstatic public var easeOut (get_easeOut, never):IEasing;\n\t\n\t\n\tprivate static function get_easeIn ():IEasing {\n\t\t\n\t\treturn new QuadEaseIn ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeInOut ():IEasing {\n\t\t\n\t\treturn new QuadEaseInOut ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeOut ():IEasing {\n\t\t\n\t\treturn new QuadEaseOut ();\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass QuadEaseIn implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn k * k;\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c * (t /= d) * t + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass QuadEaseInOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\tif ((k *= 2) < 1) {\n\t\t\treturn 1 / 2 * k * k;\n\t\t}\n\t\treturn -1 / 2 * ((k - 1) * (k - 3) - 1);\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\tif ((t /= d / 2) < 1) {\n\t\t\treturn c / 2 * t * t + b;\n\t\t}\n\t\treturn -c / 2 * ((t - 1) * (t - 3) - 1) + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass QuadEaseOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn -k * (k - 2);\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn -c * (t /= d) * (t - 2) + b;\n\t\t\n\t}\n\t\n\t\n}","/**\n * @author Joshua Granick\n * @author Philippe / http://philippe.elsass.me\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n */\n\n\npackage motion.easing;\n\t\n\t\nclass Quart {\n\t\n\t\n\tstatic public var easeIn (get_easeIn, never):IEasing;\n\tstatic public var easeInOut (get_easeInOut, never):IEasing;\n\tstatic public var easeOut (get_easeOut, never):IEasing;\n\t\n\t\n\tprivate static function get_easeIn ():IEasing {\n\t\t\n\t\treturn new QuartEaseIn ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeInOut ():IEasing {\n\t\t\n\t\treturn new QuartEaseInOut ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeOut ():IEasing {\n\t\t\n\t\treturn new QuartEaseOut ();\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass QuartEaseIn implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn k * k * k * k;\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c * (t /= d) * t * t * t + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass QuartEaseInOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\tif ((k *= 2) < 1) return 0.5 * k * k * k * k;\n\t\treturn -0.5 * ((k -= 2) * k * k * k - 2);\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\tif ((t /= d / 2) < 1) {\n\t\t\treturn c / 2 * t * t * t * t + b;\n\t\t}\n\t\treturn -c / 2 * ((t -= 2) * t * t * t - 2) + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass QuartEaseOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn -(--k * k * k * k - 1);\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn -c * ((t = t / d - 1) * t * t * t - 1) + b;\n\t\t\n\t}\n\t\n\t\n}","/**\n * @author Joshua Granick\n * @author Philippe / http://philippe.elsass.me\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n */\n\n\npackage motion.easing;\n\t\n\t\nclass Quint {\n\t\n\t\n\tstatic public var easeIn (get_easeIn, never):IEasing;\n\tstatic public var easeInOut (get_easeInOut, never):IEasing;\n\tstatic public var easeOut (get_easeOut, never):IEasing;\n\t\n\t\n\tprivate static function get_easeIn ():IEasing {\n\t\t\n\t\treturn new QuintEaseIn ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeInOut ():IEasing {\n\t\t\n\t\treturn new QuintEaseInOut ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeOut ():IEasing {\n\t\t\n\t\treturn new QuintEaseOut ();\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass QuintEaseIn implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn k * k * k * k * k;\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c * (t /= d) * t * t * t * t + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass QuintEaseInOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\tif ((k *= 2) < 1) return 0.5 * k * k * k * k * k;\n\t\treturn 0.5 * ((k -= 2) * k * k * k * k + 2);\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\tif ((t /= d / 2) < 1) {\n\t\t\treturn c / 2 * t * t * t * t * t + b;\n\t\t}\n\t\treturn c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass QuintEaseOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn --k * k * k * k * k + 1;\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n\t\t\n\t}\n\t\n\t\n}","﻿/**\n * @author Joshua Granick\n * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html\n */\n\n\npackage motion.easing;\n\t\n\t\nclass Sine {\n\t\n\t\n\tstatic public var easeIn (get_easeIn, never):IEasing;\n\tstatic public var easeInOut (get_easeInOut, never):IEasing;\n\tstatic public var easeOut (get_easeOut, never):IEasing;\n\t\n\t\n\tprivate static function get_easeIn ():IEasing {\n\t\t\n\t\treturn new SineEaseIn ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeInOut ():IEasing {\n\t\t\n\t\treturn new SineEaseInOut ();\n\t\t\n\t}\n\t\n\t\n\tprivate static function get_easeOut ():IEasing {\n\t\t\n\t\treturn new SineEaseOut ();\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass SineEaseIn implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn 1 - Math.cos(k * (Math.PI / 2));\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn -c * Math.cos(t / d * (Math.PI / 2)) + c + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass SineEaseInOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn - (Math.cos(Math.PI * k) - 1) / 2;\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b;\n\t\t\n\t}\n\t\n\t\n}\n\n\nclass SineEaseOut implements IEasing {\n\t\n\t\n\tpublic function new () {\n\t\t\n\t\t\n\t\t\n\t}\n\t\n\t\n\tpublic function calculate (k:Float):Float {\n\t\t\n\t\treturn Math.sin(k * (Math.PI / 2));\n\t\t\n\t}\n\t\n\t\n\tpublic function ease (t:Float, b:Float, c:Float, d:Float):Float {\n\t\t\n\t\treturn c * Math.sin(t / d * (Math.PI / 2)) + b;\n\t\t\n\t}\n\t\n\t\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage;\n\n// Can't enable @:coreApi because some fields are now inline getters\n// @:coreApi\n@:keepInit\nextern class Math\n{\n\tstatic var PI(default,null) : Float;\n\n\tstatic var NEGATIVE_INFINITY(get, null) : Float;\n\tprivate static inline function get_NEGATIVE_INFINITY () : Float {\n\t\treturn -(untyped __js__(\"Infinity\"));\n\t}\n\n\tstatic var POSITIVE_INFINITY(get,null) : Float;\n\tprivate static inline function get_POSITIVE_INFINITY () : Float {\n\t\treturn (untyped __js__(\"Infinity\"));\n\t}\n\n\tstatic var NaN(get, null) : Float;\n\tprivate static inline function get_NaN () : Float {\n\t\treturn (untyped __js__(\"NaN\"));\n\t}\n\n\tstatic function abs(v:Float):Float;\n\tstatic function acos(v:Float):Float;\n\tstatic function asin(v:Float):Float;\n\tstatic function atan(v:Float):Float;\n\tstatic function atan2(y:Float, x:Float):Float;\n\tstatic function ceil(v:Float):Int;\n\tstatic function cos(v:Float):Float;\n\tstatic function exp(v:Float):Float;\n\tstatic function floor(v:Float):Int;\n\tstatic function log(v:Float):Float;\n\tstatic function max(a:Float, b:Float):Float;\n\tstatic function min(a:Float, b:Float):Float;\n\tstatic function pow(v:Float, exp:Float):Float;\n\tstatic function random() : Float;\n\tstatic function round(v:Float):Int;\n\tstatic function sin(v:Float):Float;\n\tstatic function sqrt(v:Float):Float;\n\tstatic function tan(v:Float):Float;\n\n\tstatic inline function ffloor( v : Float ) : Float {\n\t\treturn floor(v);\n\t}\n\n\tstatic inline function fceil( v : Float ) : Float {\n\t\treturn ceil(v);\n\t}\n\n\tstatic inline function fround( v : Float ) : Float {\n\t\treturn round(v);\n\t}\n\n\tstatic inline function isFinite( f : Float ) : Bool {\n\t\treturn (untyped __js__(\"isFinite\"))(f);\n\t}\n\n\tstatic inline function isNaN( f : Float ) : Bool {\n\t\treturn (untyped __js__(\"isNaN\"))(f);\n\t}\n\n\tstatic function __init__() : Void {\n\t\tuntyped __feature__(\"Type.resolveClass\", $hxClasses[\"Math\"] = Math);\n\t}\n}\n","//\n// Flambe - Rapid game development\n// https://github.com/aduros/flambe/blob/master/LICENSE.txt\n\npackage flambe.platform;\n\nimport sys.FileSystem;\nimport sys.io.File;\n\nimport haxe.macro.Context;\n\nusing StringTools;\n\n/**\n * Creates the asset manifests from the files in /assets\n */\nclass ManifestBuilder\n{\n    macro public static function use (assetsDir :String)\n    {\n        switch (Context.getType(\"flambe.asset.Manifest\")) {\n        case TInst(cl,_):\n            var cl = cl.get();\n            var meta = cl.meta;\n\n            if (!assetsDir.endsWith(\"/\")) {\n                assetsDir += \"/\";\n            }\n\n            var data = {};\n            for (packName in FileSystem.readDirectory(assetsDir)) {\n                var entries = [];\n                if (FileSystem.isDirectory(assetsDir + packName)) {\n                    for (file in readRecursive(assetsDir + packName)) {\n                        var path = assetsDir + packName + \"/\" + file;\n                        entries.push({\n                            name: file,\n                            md5: Context.signature(File.getBytes(path)),\n                            bytes: FileSystem.stat(path).size,\n                        });\n                    }\n                }\n                Reflect.setField(data, packName, entries);\n            }\n\n            meta.remove(\"assets\");\n            meta.add(\"assets\", [macro $v{data}], cl.pos);\n\n        default:\n            throw \"assert\";\n        }\n\n        return macro {};\n    }\n\n    private static function readRecursive (root, dir = \"\")\n    {\n        var result = [];\n        for (file in readDirectoryNoHidden(root + \"/\" + dir)) {\n            var fullPath = root + \"/\" + dir + \"/\" + file;\n            var relPath = if (dir == \"\") file else dir + \"/\" + file;\n            if (FileSystem.isDirectory(fullPath)) {\n                result = result.concat(readRecursive(root, relPath));\n            } else {\n                result.push(relPath);\n            }\n        }\n        return result;\n    }\n\n    private static function readDirectoryNoHidden (dir :String)\n    {\n        if (dir.fastCodeAt(dir.length - 1) == \"/\".code) {\n            // Trim off the trailing slash. On Windows, FileSystem.exists() doesn't find directories\n            // with trailing slashes?\n            dir = dir.substr(0, -1);\n        }\n        return FileSystem.exists(dir) && FileSystem.isDirectory(dir) ?\n            FileSystem.readDirectory(dir).filter(\n                function (file) return file.fastCodeAt(0) != \".\".code) :\n            cast [];\n    }\n}\n"],
"names":[],
"mappings":"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"
}